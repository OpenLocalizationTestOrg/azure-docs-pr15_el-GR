> [AZURE.SELECTOR]
- [Linux](../articles/iot-hub/iot-hub-linux-gateway-sdk-simulated-device.md)
- [Τα Windows](../articles/iot-hub/iot-hub-windows-gateway-sdk-simulated-device.md)

Αυτή η αναλυτική παρουσίαση του [Πρόχειρες σύννεφο συσκευή αποστολή δείγματος] δείχνει τον τρόπο χρήσης του [SDK πύλη IoT Azure] [ lnk-sdk] για την αποστολή τηλεμετρία συσκευή-σύννεφο IoT διανομέα από συσκευές προσομοίωσης.

Αυτή η αναλυτική παρουσίαση καλύπτει:

1. **Αρχιτεκτονική**: σημαντικές αρχιτεκτονικά πληροφορίες σχετικά με το δείγμα προσομοιωμένες αποστολή σύννεφο συσκευή.

2. **Δημιουργία και εκτέλεση**: τα βήματα που απαιτούνται για να δημιουργήσετε και να εκτελέσετε το δείγμα.

## <a name="architecture"></a>Αρχιτεκτονική

Το δείγμα Πρόχειρες σύννεφο συσκευή αποστολή δείχνει πώς μπορείτε να χρησιμοποιήσετε το SDK για να δημιουργήσετε μια πύλη, η οποία αποστέλλει τηλεμετρία από συσκευές προσομοίωσης σε ένα διανομέα IoT. Οι συσκευές προσομοίωσης δεν μπορεί να συνδεθεί άμεσα με διανομέα IoT επειδή:

- Οι συσκευές δεν χρησιμοποιούν ένα πρωτόκολλο επικοινωνιών κατανοητή από IoT διανομέα.
- Οι συσκευές δεν είναι αρκετά έξυπνη ώστε να θυμάστε την ταυτότητα που τους από διανομέα IoT.

Η πύλη λύνει αυτό το πρόβλημα για την προσομοίωση συσκευές με τους εξής τρόπους:

- Η πύλη κατανοεί το πρωτόκολλο που χρησιμοποιείται από τις συσκευές προσομοίωσης, λαμβάνει συσκευή-σύννεφο τηλεμετρία από τις συσκευές και προωθεί τα μηνύματα IoT διανομέα, χρησιμοποιώντας ένα πρωτόκολλο που αναγνωρίζεται από το διανομέα.
- Η πύλη αποθηκεύει διανομέα IoT ταυτότητες για λογαριασμό τις συσκευές προσομοίωσης και ενεργεί ως διακομιστής μεσολάβησης, όταν οι συσκευές προσομοίωσης αποστέλλουν μηνύματα σε διανομέα IoT.

Το παρακάτω διάγραμμα παρουσιάζει τα κύρια στοιχεία του δείγματος, καθώς και τις λειτουργικές μονάδες της πύλης:

![][1]


> [AZURE.NOTE] Οι λειτουργικές μονάδες δεν περάσουν μηνύματα απευθείας σε μεταξύ τους. Οι λειτουργικές μονάδες να δημοσιεύσετε μηνύματα σε ένα εσωτερικό broker που παραδίδει τα μηνύματα σε άλλες ενότητες χρησιμοποιώντας ένα μηχανισμό εγγραφής, όπως φαίνεται στο παρακάτω διάγραμμα. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Γρήγορα αποτελέσματα με το SDK πύλη IoT][lnk-gw-getstarted].

### <a name="protocol-ingestion-module"></a>Λειτουργική μονάδα του πρωτοκόλλου κατάποσης

Η ενότητα αυτή είναι το σημείο εκκίνησης για τη λήψη δεδομένων από τις συσκευές, μέσω της πύλης, καθώς και στο σύννεφο. Στο δείγμα, η λειτουργική μονάδα εκτελεί τέσσερις εργασίες:

1.  Δημιουργεί δεδομένα προσομοίωση θερμοκρασίας.
    
    Σημείωση: Εάν χρησιμοποιείτε πραγματικές συσκευές, η λειτουργική μονάδα θα ανάγνωση δεδομένων από τις φυσικές συσκευές.

2.  Τοποθετεί τα δεδομένα Πρόχειρες θερμοκρασία στα περιεχόμενα ενός μηνύματος.

3.  Προσθέτει μια ιδιότητα με μια ψεύτικη διεύθυνση MAC στο μήνυμα που περιέχει τα δεδομένα προσομοίωση θερμοκρασίας.

4.  Καθιστά το μήνυμα διαθέσιμο την επόμενη λειτουργική μονάδα στην αλυσίδα.

> [AZURE.NOTE] Η λειτουργική μονάδα που ονομάζεται **κατάποση πρωτόκολλο X** στο παραπάνω διάγραμμα ονομάζεται **προσομοιωμένες συσκευής** στον πηγαίο κώδικα.

### <a name="mac-lt-gt-iot-hub-id-module"></a>MAC &lt; - &gt; λειτουργική μονάδα ID διανομέα IoT

Η ενότητα αυτή σαρώνει για μηνύματα που περιλαμβάνουν μια ιδιότητα που περιέχει τη διεύθυνση MAC, προστίθενται από τη λειτουργική μονάδα κατάποση πρωτόκολλο, της συσκευής προσομοίωσης. Εάν η λειτουργική μονάδα εντοπίσει μια τέτοια ιδιότητα, προσθέτει μια άλλη ιδιότητα με ένα κλειδί συσκευής IoT διανομέα στο μήνυμα και στη συνέχεια καθιστά το μήνυμα που είναι διαθέσιμη για την επόμενη ενότητα στην αλυσίδα. Αυτό είναι πώς το δείγμα συσχετίζει IoT διανομέα συσκευή ταυτότητες με συσκευές προσομοίωσης. Ο προγραμματιστής ορίζει την αντιστοίχιση μεταξύ διευθύνσεις MAC και ταυτότητες IoT διανομέα με μη αυτόματο τρόπο, ως μέρος της ρύθμισης παραμέτρων της λειτουργικής μονάδας. 

> [AZURE.NOTE]  Αυτό το δείγμα χρησιμοποιεί μια διεύθυνση MAC ως αναγνωριστικό ειδικών συσκευών και αυτό συσχετίζεται με μια ταυτότητα συσκευής IoT διανομέα. Ωστόσο, μπορείτε να γράψετε τη δική σας λειτουργική μονάδα που χρησιμοποιεί ένα διαφορετικό, μοναδικό αναγνωριστικό. Για παράδειγμα, μπορεί να έχετε σε συσκευές με μοναδικούς αριθμούς σειράς ή τα δεδομένα τηλεμετρία που έχει ένα μοναδικό όνομα συσκευής ενσωματωμένα σε αυτό που μπορείτε να χρησιμοποιήσετε για να προσδιορίσετε την ταυτότητα της συσκευής IoT διανομέα.

### <a name="iot-hub-communication-module"></a>Λειτουργική μονάδα επικοινωνίας διανομέα IoT

Η ενότητα αυτή λαμβάνει μηνύματα με έναν διανομέα IoT ταυτότητα συσκευής που εκχωρείται από την προηγούμενη ενότητα και στέλνει το περιεχόμενο του μηνύματος IoT διανομέα μέσω HTTP. Το HTTP είναι ένα από τα τρία πρωτόκολλα κατανοητή από IoT διανομέα.

Αντί να ανοίξετε μια σύνδεση σε διανομέα IoT για κάθε συσκευή προσομοίωσης, αυτή η λειτουργική μονάδα ανοίγει μίας σύνδεσης HTTP από την πύλη στο διανομέα IoT και multiplexes συνδέσεις από όλες τις συσκευές προσομοίωσης μέσω της συγκεκριμένης σύνδεσης. Αυτό επιτρέπει μια μοναδική πύλη για να συνδεθεί πολλές περισσότερες συσκευές, προσομοίωση ή με άλλο τρόπο, από θα ήταν δυνατόν αν αυτό ανοίγει μια μοναδική σύνδεση για κάθε συσκευή.

![][2]


<!-- Images -->
[1]: media/iot-hub-gateway-sdk-simulated-selector/image1.png
[2]: media/iot-hub-gateway-sdk-simulated-selector/image2.png

<!-- Links -->
[Προσομοίωση συσκευή σύννεφο αποστολή δείγματος]: https://github.com/Azure/azure-iot-gateway-sdk/blob/master/doc/sample_simulated_device_cloud_upload.md
[lnk-sdk]: https://github.com/Azure/azure-iot-gateway-sdk
[lnk-gw-getstarted]: ../articles/iot-hub/iot-hub-linux-gateway-sdk-get-started.md
<properties
    pageTitle="Πώς μπορείτε να του μοντέλου σύνθετους τύπους δεδομένων στο πλαίσιο Αναζήτηση Azure | Αναζήτηση Microsoft Azure"
    description="Ένθετες ή μπορεί να διαμορφωθεί δομές ιεραρχικά δεδομένα σε ένα ευρετήριο αναζήτησης Azure χρησιμοποιώντας επίπεδη σύνολο γραμμών και τύπο δεδομένων συλλογών."
    services="search"
    documentationCenter=""
    authors="LiamCa"
    manager="pablocas"
    editor=""
    tags="complex data types; compound data types; aggregate data types"
/>

<tags
    ms.service="search"
    ms.devlang="na"
    ms.workload="search"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.date="09/07/2016"
    ms.author="liamca"
/>

# <a name="how-to-model-complex-data-types-in-azure-search"></a>Πώς να μοντέλο σύνθετους τύπους δεδομένων στο πλαίσιο Αναζήτηση Azure

Εξωτερική συνόλων δεδομένων που χρησιμοποιείται για τη συμπλήρωση του ευρετηρίου αναζήτησης Azure μερικές φορές περιλαμβάνουν ιεραρχική ή ένθετος τμήματα που δεν διασπάστε τακτοποιημένα σε ένα σύνολο γραμμών σε μορφή πίνακα. Παραδείγματα τέτοιου είδους δομές ενδέχεται να περιλαμβάνουν πολλές θέσεις και οι αριθμοί τηλεφώνου για έναν πελάτη, πολλά χρώματα και μεγέθη για μια μεμονωμένη SKU, πολλοί συντάκτες από ένα βιβλίο, και ούτω καθεξής. Στο μοντελοποίησης όρους, ενδέχεται να δείτε αυτές τις δομές αναφέρεται ως *σύνθετους τύπους δεδομένων*, *Σύνθετες τους τύπους δεδομένων*, *τύποι σύνθετων δεδομένων*ή *συγκέντρωση τους τύπους δεδομένων*, μόνο μερικά.

Σύνθετους τύπους δεδομένων δεν υποστηρίζονται στο πλαίσιο Αναζήτηση Azure, αλλά αποδεδειγμένη λύση περιλαμβάνει μια διαδικασία δύο βημάτων ισοπέδωση τη δομή και, στη συνέχεια, χρησιμοποιώντας έναν τύπο δεδομένων **συλλογής** για να αποκαταστήσουν τη δομή του εσωτερικού. Μετά την τεχνική που περιγράφονται σε αυτό το άρθρο επιτρέπει το περιεχόμενο που θα γίνει η αναζήτηση, με συνθήκη, φιλτράρισμα και ταξινόμηση.

## <a name="example-of-a-complex-data-structure"></a>Παράδειγμα μιας δομής σύνθετα δεδομένα

Συνήθως, βρίσκονται τα δεδομένα εν λόγω ως ένα σύνολο εγγράφων JSON ή XML ή ως στοιχεία σε ένα χώρο αποθήκευσης NoSQL όπως DocumentDB. Δομικά, το δύσκολο οφείλεται αντιμετωπίζετε πολλά θυγατρικά στοιχεία που πρέπει να γίνει αναζήτηση και να φιλτραριστούν.  Ως σημείο εκκίνησης για την απεικόνιση η λύση, εκτελέστε το ακόλουθο έγγραφο JSON που παραθέτει ένα σύνολο των επαφών ως παράδειγμα:

~~~~~
[
  {
    "id": "1",
    "name": "John Smith",
    "company": "Adventureworks",
    "locations": [
      {
        "id": "1",
        "description": "Adventureworks Headquarters"
      },
      {
        "id": "2",
        "description": "Home Office"
      }
    ]
  }, 
  {
    "id": "2",
    "name": "Jen Campbell",
    "company": "Northwind",
    "locations": [
      {
        "id": "3",
        "description": "Northwind Headquarter"
      },
      {
        "id": "4",
        "description": "Home Office"
      }
    ]
}]
~~~~~

Ενώ τα πεδία που ονομάζεται 'id', 'όνομα' και 'company' μπορεί εύκολα να αντιστοιχιστεί-προς-ένα ως πεδία μέσα σε ένα ευρετήριο αναζήτησης Azure, το πεδίο "Θέσεις" περιέχει έναν πίνακα από θέσεις, χρειάζεται δύο ένα σύνολο αναγνωριστικών θέση, καθώς και περιγραφές θέση. Δεδομένου ότι Azure αναζήτησης δεν έχει έναν τύπο δεδομένων που υποστηρίζει αυτήν τη δυνατότητα, χρειαζόμαστε διαφορετικό τρόπο μοντέλο αυτό στην αναζήτηση Azure. 

> [AZURE.NOTE] Αυτή η τεχνική περιγράφεται επίσης με Kirk Evans σε μια καταχώρηση ιστολογίου [DocumentDB δημιουργίας ευρετηρίου με αναζήτηση Azure](https://blogs.msdn.microsoft.com/kaevans/2015/03/09/indexing-documentdb-with-azure-seach/), που εμφανίζει μια τεχνική που ονομάζεται "Ισοπέδωση τα δεδομένα", με τις οποίες μπορείτε να έχουν ένα πεδίο που ονομάζεται `locationsID` και `locationsDescription` που είναι [συλλογές](https://msdn.microsoft.com/library/azure/dn798938.aspx) (ή ένας πίνακας συμβολοσειρών).   

## <a name="part-1-flatten-the-array-into-individual-fields"></a>Μέρος 1: Ισοπέδωση έναν πίνακα σε μεμονωμένα πεδία

Για να δημιουργήσετε ένα ευρετήριο αναζήτησης Azure που εξυπηρετεί αυτό το σύνολο δεδομένων, δημιουργήστε μεμονωμένα πεδία για την ένθετη στο παράθυρο του εγγράφου: `locationsID` και `locationsDescription` με έναν τύπο δεδομένων [συλλογές](https://msdn.microsoft.com/library/azure/dn798938.aspx) (ή ένας πίνακας συμβολοσειρών). Σε αυτά τα πεδία που θα δημιουργήσετε ευρετήριο τις τιμές "1" και "2" σε το `locationsID` πεδίων για Γιάννης Παπαδόπουλος και οι τιμές '3' και '4' σε το `locationsID` πεδίο για Jen Campbell.  

Τα δεδομένα σας σε Azure αναζήτησης θα μοιάζει κάπως έτσι: 

![Δείγμα δεδομένων, 2 γραμμές](./media/search-howto-complex-data-types/sample-data.png)


## <a name="part-2-add-a-collection-field-in-the-index-definition"></a>Μέρος 2: Προσθήκη πεδίου συλλογής στον ορισμό ευρετηρίου

Στο σχήμα ευρετήριο, οι ορισμοί πεδίο ενδέχεται να μοιάζει με αυτό το παράδειγμα.

~~~~
var index = new Index()
{
    Name = indexName,
    Fields = new[]
    {
        new Field("id", DataType.String) { IsKey = true },
        new Field("name", DataType.String) { IsSearchable = true, IsFilterable = false, IsSortable = false, IsFacetable = false },
        new Field("company", DataType.String) { IsSearchable = true, IsFilterable = false, IsSortable = false, IsFacetable = false },
        new Field("locationsId", DataType.Collection(DataType.String)) { IsSearchable = true, IsFilterable = true, IsFacetable = true },
        new Field("locationsDescription", DataType.Collection(DataType.String)) { IsSearchable = true, IsFilterable = true, IsFacetable = true }
    }
};
~~~~

## <a name="validate-search-behaviors-and-optionally-extend-the-index"></a>Επικυρώστε συμπεριφορές αναζήτησης και προαιρετικά επεκτείνετε το ευρετήριο

Υπό την προϋπόθεση ότι έχετε δημιουργήσει το ευρετήριο και φόρτωση των δεδομένων, μπορείτε τώρα να ελέγξετε τη λύση για να επαληθεύσετε την εκτέλεση του ερωτήματος αναζήτησης σε σχέση με το σύνολο δεδομένων. Κάθε πεδίο **συλλογή** πρέπει να είναι **με δυνατότητα αναζήτησης**, **με δυνατότητα φιλτραρίσματος** και **facetable**. Θα πρέπει να μπορείτε να εκτελέσετε ερωτήματα όπως:

* Βρείτε όλα τα άτομα που εργάζονται στην 'Έδρα Adventureworks'.
* Έχετε μια καταμέτρηση του αριθμού των ατόμων που εργάζονται σε ένα γραφείο' Κεντρική'.  
* Τα άτομα που εργάζονται σε ένα γραφείο' Κεντρική', εμφανίζουν ποιες άλλες γραφεία λειτουργούν μαζί με ένα πλήθος των ατόμων σε κάθε θέση.  

Όπου εμπίπτει απέχουν αυτήν την τεχνική είναι όταν πρέπει να κάνετε μια αναζήτηση που συνδυάζει τόσο το αναγνωριστικό θέση, καθώς και την περιγραφή της τοποθεσίας. Για παράδειγμα:

* Βρείτε όλα τα άτομα έχουν ένα γραφείο κεντρική και έχει ένα Αναγνωριστικό θέση 4.  

Εάν μπορείτε να ανακαλέσετε το αρχικό περιεχόμενο αναζητήσει ως εξής:

~~~~
   {
        id: '4',
        description: 'Home Office'
   }
~~~~

Ωστόσο, τώρα που θα σας έχουν διαχωρίζονται τα δεδομένα σε ξεχωριστά πεδία, έχουμε υπάρχει τρόπος να if, εάν γνωρίζετε το Office κεντρική για Jen Campbell σχετίζεται με `locationsID 3` ή `locationsID 4`.  

Για να χειριστείτε αυτήν την περίπτωση, ορισμός ένα άλλο πεδίο στο ευρετήριο που συνδυάζει όλα τα δεδομένα σε μια ενιαία συλλογή.  Για παράδειγμά μας, θα ονομάζουμε αυτό το πεδίο `locationsCombined` και θα σας θα διαχωρίσετε το περιεχόμενο με ένα `||` Παρόλο που μπορείτε να επιλέξετε οποιοδήποτε διαχωριστικό που πιστεύετε ότι θα ήταν ένα μοναδικό σύνολο χαρακτήρων για το περιεχόμενό σας. Για παράδειγμα: 

![Δείγμα δεδομένων, 2 γραμμές με διαχωριστικό](./media/search-howto-complex-data-types/sample-data-2.png)

Χρήση αυτό `locationsCombined` πεδίο, θα σας τώρα μπορεί να χωρέσει ακόμα περισσότερα ερωτήματα, όπως:

* Εμφανίσει τον αριθμό των ατόμων που εργάζονται στο ένα 'Κεντρική του Office' με θέση αναγνωριστικό '4'.  
* Πραγματοποιήστε αναζήτηση για άτομα που εργάζονται σε ένα γραφείο' Κεντρική' με το αναγνωριστικό '4' θέση. 

## <a name="limitations"></a>Περιορισμοί

Αυτή η τεχνική είναι χρήσιμη για διάφορα σενάρια, αλλά δεν ισχύει σε κάθε περίπτωση.  Για παράδειγμα:

1. Εάν δεν έχετε ένα στατικό σύνολο πεδίων σε τύπο σύνθετα δεδομένα σας και δεν υπήρχε τρόπος για να αντιστοιχίσετε όλων των πιθανών τύπων σε ένα πεδίο. 
2. Ενημέρωση των ένθετων αντικειμένων απαιτεί επιπλέον εργασίες για να καθορίσετε ακριβώς τι πρέπει να ενημερωθεί στο ευρετήριο αναζήτησης Azure

## <a name="sample-code"></a>Δείγμα κώδικα

Μπορείτε να δείτε ένα παράδειγμα σχετικά με τον τρόπο για να δημιουργήσετε ευρετήριο ένα σύνθετο σύνολο δεδομένων JSON σε Azure αναζήτησης και να εκτελέσετε έναν αριθμό ερωτημάτων επάνω σε αυτό το dataset στο αυτό [GitHub repo](https://github.com/liamca/AzureSearchComplexTypes).

## <a name="next-step"></a>Επόμενο βήμα

[Ψηφοφορία για εγγενή υποστήριξη για σύνθετους τύπους δεδομένων](https://feedback.azure.com/forums/263029-azure-search) του UserVoice αναζήτησης Azure σελίδα και να εισαγάγετε επιπλέον στοιχεία που θέλετε να λάβετε υπόψη σας σχετικά με την εφαρμογή τη δυνατότητα. Μπορείτε να βρείτε σε εμένα απευθείας στο Twitter στο @liamca.


 
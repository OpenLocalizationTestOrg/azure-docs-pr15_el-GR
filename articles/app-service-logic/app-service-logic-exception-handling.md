<properties
   pageTitle="Χειρισμός εξαίρεσης εφαρμογές λογικής | Microsoft Azure"
   description="Μάθετε μοτίβα για σφάλματος και χειρισμού με εφαρμογές λογικής Azure εξαίρεσης"
   services="logic-apps"
   documentationCenter=".net,nodejs,java"
   authors="jeffhollan"
   manager="erikre"
   editor=""/>

<tags
   ms.service="logic-apps"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration"
   ms.date="10/18/2016"
   ms.author="jehollan"/>

# <a name="logic-apps-error-and-exception-handling"></a>Σφάλμα εφαρμογές λογικής και χειρισμού εξαιρέσεων

Λογική εφαρμογών παρέχει ένα εμπλουτισμένο σύνολο εργαλείων και μοτίβα για να διασφαλίσετε την ενοποιήσεις είναι ισχυρό και είναι ανθεκτικά έναντι αποτυχίες.  Είναι μία από τις προκλήσεις με οποιαδήποτε αρχιτεκτονική ενοποίησης να εξασφαλίσετε ότι οι χρόνου εκτός λειτουργίας ή θέματα εξαρτώμενα συστημάτων γίνεται σωστά.  Λογική εφαρμογές κάνει χειρισμού σφαλμάτων μια εμπειρία πρώτης κλάσης, παρέχοντας τα εργαλεία που χρειάζεστε για εκτέλεση ενεργειών σε εξαιρέσεις και σφάλματα σε ροών εργασίας.

## <a name="retry-policies"></a>Επανάληψη πολιτικές

Ο πιο βασικός τύπος εξαίρεσης και χειρισμού σφαλμάτων είναι μια πολιτική "Επανάληψη".  Αυτή η πολιτική καθορίζει αν θα πρέπει να επαναλάβετε την ενέργεια εάν αρχική αίτηση έληξε ή απέτυχε (οποιαδήποτε αίτηση που οδήγησε σε μια 429 ή απόκριση 5xx).  Από προεπιλογή, όλες οι ενέργειες επανάληψης 4 ώρες επιπλέον επάνω σε διαστήματα 20 δευτερολέπτων.  Επομένως, εάν λάβει την πρώτη αίτηση ένα `500 Internal Server Error` απόκρισης, το μηχανισμό ροής εργασίας διακόπτει προσωρινά για 20 δευτερόλεπτα και η προσπάθεια την αίτηση ξανά.  Εάν ύστερα από όλες τις επαναλήψεις απάντηση εξακολουθεί να είναι μια εξαίρεση ή την αποτυχία, η ροή εργασίας θα συνεχίσετε και να επισημάνετε την κατάσταση ενέργεια ως `Failed`.

Μπορείτε να ρυθμίσετε πολιτικές "Επανάληψη" με τα **δεδομένα εισόδου** από μια συγκεκριμένη ενέργεια.  Μια πολιτική "Επανάληψη" μπορεί να ρυθμιστεί για να δοκιμάσετε έως και 4 ώρες πάνω από 1 ώρα χρονικά διαστήματα.  Πλήρεις λεπτομέρειες σχετικά με τις ιδιότητες εισόδου μπορεί να [βρεθεί στο MSDN][retryPolicyMSDN].

```json
"retryPolicy" : {
      "type": "<type-of-retry-policy>",
      "interval": <retry-interval>,
      "count": <number-of-retry-attempts>
    }
```

Εάν θέλετε την ενέργεια HTTP για να επαναλάβετε 4 ώρες και να περιμένετε 10 λεπτά μεταξύ κάθε προσπάθειας θα έχετε τον ορισμό της παρακάτω:

```json
"HTTP": 
{
    "inputs": {
        "method": "GET",
        "uri": "http://myAPIendpoint/api/action",
        "retryPolicy" : {
            "type": "fixed",
            "interval": "PT10M",
            "count": 4
        }
    },
    "runAfter": {},
    "type": "Http"
}
```

Για περισσότερες λεπτομέρειες σχετικά με υποστηριζόμενες σύνταξη, προβάλετε την [ενότητα "Επανάληψη"-πολιτική στο MSDN][retryPolicyMSDN].

## <a name="runafter-property-to-catch-failures"></a>Ιδιότητα RunAfter για να ενημερωθείτε αποτυχίες

Κάθε ενέργεια εφαρμογής λογικής δηλώνει ποιες ενέργειες πρέπει να ολοκληρωθεί πριν από την ενέργεια θα ξεκινήσει.  Μπορείτε να θεωρήσετε από αυτές με την ταξινόμηση των βημάτων της ροής εργασίας σας.  Αυτήν την ταξινόμηση είναι γνωστό ως το `runAfter` ιδιότητα στον ορισμό ενέργεια.  Είναι ένα αντικείμενο που περιγράφει ποιες ενέργειες και καταστάσεις ενέργεια θα εκτελεστεί η ενέργεια.  Από προεπιλογή, έχουν οριστεί όλες τις ενέργειες που προστίθεται μέσω στη σχεδίαση `runAfter` το προηγούμενο βήμα αν το προηγούμενο βήμα ήταν `Succeeded`.  Ωστόσο, μπορείτε να προσαρμόσετε αυτή την τιμή για να ξεκινήσετε ενέργειες όταν οι προηγούμενες ενέργειες είναι `Failed`, `Skipped`, ή ένα σύνολο πιθανές από αυτές τις τιμές.  Εάν θέλετε να προσθέσετε ένα στοιχείο σε ένα θέμα που έχει οριστεί ως υπηρεσία Bus μετά από μια συγκεκριμένη ενέργεια `Insert_Row` αποτύχει, θα μπορούσατε να χρησιμοποιήσετε τα παρακάτω `runAfter` ρύθμισης παραμέτρων:

```json
"Send_message": {
    "inputs": {
        "body": {
            "ContentData": "@{encodeBase64(body('Insert_Row'))}",
            "ContentType": "{ \"content-type\" : \"application/json\" }"
        },
        "host": {
            "api": {
                "runtimeUrl": "https://logic-apis-westus.azure-apim.net/apim/servicebus"
            },
            "connection": {
                "name": "@parameters('$connections')['servicebus']['connectionId']"
            }
        },
        "method": "post",
        "path": "/@{encodeURIComponent('failures')}/messages"
    },
    "runAfter": {
        "Insert_Row": [
            "Failed"
        ]
    }
}
```

Ειδοποίηση του `runAfter` ιδιότητα έχει οριστεί σε εφαρμόζεται εάν το `Insert_Row` ενέργεια είναι `Failed`.  Για να εκτελέσετε την ενέργεια, αν η κατάσταση ενέργειας είναι `Succeeded`, `Failed`, ή `Skipped` θα είναι η σύνταξη:

```json
"runAfter": {
        "Insert_Row": [
            "Failed", "Succeeded", "Skipped"
        ]
    }
```

>[AZURE.TIP] Ενέργειες που εκτελούνται αφού έχουν αποτύχει μια προηγούμενη ενέργεια και ολοκληρώθηκε με επιτυχία, θα επισημανθούν ως `Succeeded`.  Αυτή η συμπεριφορά σημαίνει ότι εάν κάνετε όλων προϊόντα αποτυχίες με επιτυχία σε μια ροή εργασίας την εκτέλεση του εαυτού έχει επισημανθεί ως `Succeeded`.

## <a name="scopes-and-results-to-evaluate-actions"></a>Εύρος και αποτελεσμάτων για να αξιολογήσετε ενέργειες

Παρόμοιο με το πώς μπορείτε να εκτελέσετε μετά από μεμονωμένες ενέργειες, μπορείτε επίσης να ενέργειες ομάδα μαζί μέσα σε ένα [εύρος](app-service-logic-loops-and-scopes.md) - που λειτουργεί ως μια λογική ομαδοποίηση των ενεργειών.  Εύρος είναι χρήσιμες για την οργάνωση των ενεργειών εφαρμογής λογικής, και για την εκτέλεση συγκεντρωτικών αποτελεσμάτων αξιολογήσεις σχετικά με την κατάσταση του πεδίου εφαρμογής ενός.  Το εύρος ίδια θα λάβουν μια κατάσταση αφού έχετε ολοκληρώσει όλες τις ενέργειες μέσα σε ένα πεδίο.  Η κατάσταση εύρος προσδιορίζεται με τα ίδια κριτήρια μια εκτέλεση--εάν η τελική ενέργεια σε ένα κλάδο εκτέλεσης είναι `Failed` ή `Aborted` η κατάσταση είναι `Failed`.

Μπορείτε να κάνετε `runAfter` εμβέλεια έχει σημανθεί ως `Failed` για να ξεκινήσετε συγκεκριμένες ενέργειες για τυχόν σφάλματα που προέκυψε στο πεδίο εφαρμογής.  Εκτελείται μετά την αποτυχία εμβέλεια σάς επιτρέπει να δημιουργήσετε μια μεμονωμένη ενέργεια για να ενημερωθείτε αποτυχίες εάν αποτύχει *τυχόν* ενέργειες εντός του πεδίου εφαρμογής.

### <a name="getting-the-context-of-failures-with-results"></a>Γρήγορα το περιβάλλον αποτυχιών με αποτελέσματα

Αλίευση αποτυχίες από ένα εύρος είναι πολύ χρήσιμο, αλλά μπορεί επίσης να θέλετε το περιβάλλον για να κατανοήσετε ακριβώς τις ενέργειες που απέτυχε, και σφάλματα ή κωδικούς κατάστασης που επιστράφηκαν.  Το `@result()` συνάρτηση ροής εργασίας παρέχει περιβάλλοντος σε το αποτέλεσμα της όλες οι ενέργειες μέσα σε ένα πεδίο.

`@result()`λαμβάνει μια μοναδική παράμετρο, όνομα πεδίου και επιστρέφει έναν πίνακα του συνόλου των ενεργειών αποτελεσμάτων από μέσα σε αυτό το εύρος.  Αυτά τα αντικείμενα ενέργεια περιλαμβάνουν τα ίδια χαρακτηριστικά με το `@actions()` εξόδους αντικείμενο, συμπεριλαμβανομένων ενέργεια ώρα έναρξης, ώρα λήξης ενέργεια, κατάστασης ενέργειας, εισροές ενέργειας, ενέργεια συσχέτισης αναγνωριστικά και ενέργεια.  Μπορείτε εύκολα να σύζευξη μια `@result()` λειτουργούν με μια `runAfter` για να στείλετε περιβάλλον τυχόν ενέργειες που απέτυχε μέσα σε ένα πεδίο.

Εάν θέλετε να εκτελεί μια ενέργεια *για κάθε* ενέργεια σε ένα εύρος που `Failed`, μπορείτε να πραγματοποιήσετε ζεύξη `@result()` με μια ενέργεια **[Φίλτρου πίνακα](../connectors/connectors-native-query.md)** και ενός βρόχου **[ForEach](app-service-logic-loops-and-scopes.md)** .  Αυτό σας επιτρέπει να φιλτράρετε έναν πίνακα αποτελεσμάτων για τις ενέργειες που απέτυχε.  Μπορείτε να κάνετε το αποτέλεσμα του φιλτραρίσματος πίνακα και να εκτελεί μια ενέργεια για κάθε αποτυχία χρησιμοποιώντας το **ForEach** βρόχο.  Ακολουθεί ένα παράδειγμα παρακάτω, ακολουθούμενο από μια αναλυτική εξήγηση.  Αυτό το παράδειγμα θα στείλετε μια αίτηση HTTP POST με το κυρίως κείμενο απάντησης τυχόν ενέργειες που απέτυχε εντός της εμβέλειας `My_Scope`.

```json
"Filter_array": {
    "inputs": {
        "from": "@result('My_Scope')",
        "where": "@equals(item()['status'], 'Failed')"
    },
    "runAfter": {
        "My_Scope": [
            "Failed"
        ]
    },
    "type": "Query"
},
"For_each": {
    "actions": {
        "Log_Exception": {
            "inputs": {
                "body": "@item()['outputs']['body']",
                "method": "POST",
                "headers": {
                    "x-failed-action-name": "@item()['name']",
                    "x-failed-tracking-id": "@item()['clientTrackingId']"
                },
                "uri": "http://requestb.in/"
            },
            "runAfter": {},
            "type": "Http"
        }
    },
    "foreach": "@body('Filter_array')",
    "runAfter": {
        "Filter_array": [
            "Succeeded"
        ]
    },
    "type": "Foreach"
}
```

Ακολουθεί μια λεπτομερή ανάλυση του τι συμβαίνει:

1. Η ενέργεια **Φίλτρου πίνακα** για να φιλτράρετε την `@result('My_Scope')` για το αποτέλεσμα της όλες οι ενέργειες μέσα σε`My_Scope`
1. Η συνθήκη του **Φίλτρου πίνακα** είναι οποιαδήποτε `@result()` στοιχείο με την κατάσταση ισούται με `Failed`.  Αυτό θα φιλτράρετε έναν πίνακα όλων των αποτελεσμάτων ενέργεια από `My_Scope` να μόνο έναν πίνακα αποτελεσμάτων αποτυχίας ενέργειας.
1. Εκτελεί μια ενέργεια **για κάθε** σε εξόδους του **Πίνακα φιλτραρισμένη** .  Αυτό θα εκτελέσει μια ενέργεια *για κάθε* απέτυχε ενέργεια αποτέλεσμα μας φιλτραρισμένο παραπάνω.
    - Εάν υπήρχε μια μεμονωμένη ενέργεια στο πεδίο που απέτυχε, οι ενέργειες του `foreach` θα εκτελεστεί μόνο μία φορά.  Πολλές ενέργειες αποτυχίας θα προκαλέσει την ίδια ενέργεια ανά αποτυχία.
1. Στείλτε μια ΔΗΜΟΣΊΕΥΣΗ HTTP το `foreach` στοιχείο απόκρισης σώμα, ή `@item()['outputs']['body']`.  Το `@result()` σχήματος στοιχείου είναι ίδια με την `@actions()` διαμόρφωση και μπορούν να αναλυθούν τον ίδιο τρόπο.
1. Περιλαμβάνονται επίσης δύο προσαρμοσμένες κεφαλίδες με το όνομα της αποτυχίας ενέργειας `@item()['name']` και το αποτυχίας εκτέλεση προγράμματος-πελάτη παρακολούθησης Αναγνωριστικό `@item()['clientTrackingId']`.

Για αναφορά, ακολουθεί ένα παράδειγμα μιας μεμονωμένης `@result()` στοιχείου.  Μπορείτε να δείτε το `name`, `body`, και `clientTrackingId` ιδιότητες αναλυθούν στο παραπάνω παράδειγμα.  Πρέπει να αναφερθεί που έξω από μια `foreach`, `@result()` επιστρέφει έναν πίνακα από αυτά τα αντικείμενα.

```json
{
    "name": "Example_Action_That_Failed",
    "inputs": {
        "uri": "https://myfailedaction.azurewebsites.net",
        "method": "POST"
    },
    "outputs": {
        "statusCode": 404,
        "headers": {
            "Date": "Thu, 11 Aug 2016 03:18:18 GMT",
            "Server": "Microsoft-IIS/8.0",
            "X-Powered-By": "ASP.NET",
            "Content-Length": "68",
            "Content-Type": "application/json"
        },
        "body": {
            "code": "ResourceNotFound",
            "message": "/docs/foo/bar does not exist"
        }
    },
    "startTime": "2016-08-11T03:18:19.7755341Z",
    "endTime": "2016-08-11T03:18:20.2598835Z",
    "trackingId": "bdd82e28-ba2c-4160-a700-e3a8f1a38e22",
    "clientTrackingId": "08587307213861835591296330354",
    "code": "NotFound",
    "status": "Failed"
}
```

Μπορείτε να χρησιμοποιήσετε τις παραπάνω παραστάσεις για να εκτελέσετε διαφορετικές χειρισμού μοτίβα εξαίρεσης.  Μπορείτε να επιλέξετε να εκτελεί μια μεμονωμένη εξαίρεση χειρισμός ενέργεια εκτός του αντικειμένου που δέχεται ολόκληρη τη συστοιχία φιλτραρισμένη αποτυχίες και κατάργηση του `foreach`.  Μπορείτε, επίσης, να συμπεριλάβετε άλλα χρήσιμες ιδιότητες από την `@result()` απόκριση φαίνεται παραπάνω.

## <a name="azure-diagnostics-and-telemetry"></a>Διαγνωστικά του Azure και τηλεμετρίας

Τα μοτίβα παραπάνω είναι ιδανικά τρόπο για να χειριστείτε σφάλματα και εξαιρέσεις μέσα σε έναν κύκλο, αλλά μπορείτε επίσης να προσδιορίσετε και να απαντούν σε σφάλματα ανεξάρτητα από την εκτέλεση του εαυτού.  [Διαγνωστικά Azure](app-service-logic-monitor-your-logic-apps.md) παρέχει έναν απλό τρόπο για να στείλετε όλα τα συμβάντα ροής εργασίας (συμπεριλαμβανομένων των όλες οι καταστάσεις εκτέλεσης και μια ενέργεια) σε ένα λογαριασμό αποθήκευσης Azure ή μια ενότητα συμβάντων Azure.  Μπορείτε να παρακολουθείτε τα αρχεία καταγραφής και μετρήσεις ή να τα δημοσιεύσετε σε οποιαδήποτε εργαλείου παρακολούθησης που προτιμάτε, να αξιολογήσετε εκτέλεση καταστάσεις.  Μία πιθανή επιλογή είναι για τη ροή όλα τα συμβάντα μέσω διανομέα Azure συμβάντος σε [Ροή ανάλυσης](https://azure.microsoft.com/services/stream-analytics/).  Στην ανάλυση ροή μπορείτε να συντάξετε ζωντανή ερωτήματα καταργήσω τυχόν ανωμαλίες, μέσους όρους ή αποτυχίες από αρχεία καταγραφής διαγνωστικών.  Ανάλυση ροή εύκολα να εξαγάγετε σε άλλες προελεύσεις δεδομένων όπως ουρές, θέματα, SQL, DocumentDB και το Power BI.

## <a name="next-steps"></a>Επόμενα βήματα
- [Ανατρέξτε στο θέμα Πώς ένας πελάτης ενσωματωμένη χειρισμού με εφαρμογές λογικής ισχυρό σφαλμάτων](app-service-logic-scenario-error-and-exception-handling.md)
- [Εύρεση περισσότερων εφαρμογών λογικής παραδείγματα και σενάρια](app-service-logic-examples-and-scenarios.md)
- [Μάθετε πώς να δημιουργείτε αυτοματοποιημένων αναπτύξεων εφαρμογών λογικής](app-service-logic-create-deploy-template.md)
- [Σχεδίαση και ανάπτυξη εφαρμογών λογικής από το Visual Studio](app-service-logic-deploy-from-vs.md)


<!-- References -->
[retryPolicyMSDN]: https://msdn.microsoft.com/library/azure/mt643939.aspx#Anchor_9
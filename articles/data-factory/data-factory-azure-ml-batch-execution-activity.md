<properties 
    pageTitle="Χρήση δραστηριότητες μηχανικής εκμάθησης | Microsoft Azure" 
    description="Περιγράφει τον τρόπο δημιουργίας δημιουργία πρόβλεψης αγωγούς χρησιμοποιώντας εργοστασίου δεδομένων Azure και Azure μηχανικής εκμάθησης" 
    services="data-factory" 
    documentationCenter="" 
    authors="sharonlo101" 
    manager="jhubbard" 
    editor="monicar"/>

<tags 
    ms.service="data-factory" 
    ms.workload="data-services" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="09/06/2016" 
    ms.author="shlo"/>

# <a name="create-predictive-pipelines-using-azure-machine-learning-activities"></a>Δημιουργία πρόβλεψης αγωγούς χρησιμοποιώντας δραστηριότητες Azure μηχανικής εκμάθησης   
> [AZURE.SELECTOR]
[Ομάδα](data-factory-hive-activity.md)  
[Γουρούνι](data-factory-pig-activity.md)  
[MapReduce](data-factory-map-reduce.md)  
[Ροή Hadoop](data-factory-hadoop-streaming-activity.md)
[Μηχανικής εκμάθησης](data-factory-azure-ml-batch-execution-activity.md) 
[Αποθηκευμένη διαδικασία](data-factory-stored-proc-activity.md)
[U-SQL ανάλυσης δεδομένων λίμνης](data-factory-usql-activity.md)
[.NET προσαρμοσμένο](data-factory-use-custom-activities.md)

## <a name="introduction"></a>Εισαγωγή

[Azure μηχανικής εκμάθησης](https://azure.microsoft.com/documentation/services/machine-learning/) σάς επιτρέπει να δημιουργήσετε, δοκιμή και ανάπτυξη λύσεων πρόβλεψης ανάλυσης. Από μια υψηλού επιπέδου άποψη, γίνεται σε τρία βήματα: 

1. **Δημιουργία μιας έρευνας εκπαίδευσης**. Μπορείτε να κάνετε αυτό το βήμα, χρησιμοποιώντας το Studio ML Azure. Το studio ML είναι ένα περιβάλλον συνεργασίας οπτική ανάπτυξης που χρησιμοποιείτε για να εκπαιδεύσετε και δοκιμάστε ένα μοντέλο πρόβλεψης αναλυτικών στοιχείων χρήσης δεδομένων εκπαίδευσης.
2. **Μετατρέψτε το σε μια έρευνα πρόβλεψης**. Όταν έχει γίνει εκπαίδευση του μοντέλου σας με υπάρχοντα δεδομένα και είστε έτοιμοι να το χρησιμοποιήσετε για τη βαθμολογία νέα δεδομένα, μπορείτε να προετοιμάσετε και να βελτιστοποιήσετε την έρευνα για βαθμολογίας.
3. **Ανάπτυξη ως μια υπηρεσία web**. Μπορείτε να δημοσιεύσετε το βαθμολογίας έρευνας ως υπηρεσία Azure web. Να αποστολή δεδομένων στο μοντέλο σας μέσω αυτό τελικού σημείου υπηρεσίας web και να λαμβάνετε προβλέψεων αποτέλεσμα από το μοντέλο.  

Azure εργοστασίου δεδομένων σάς επιτρέπει να δημιουργήσετε εύκολα αγωγών που χρησιμοποιούν ένα δημοσιευμένο [Azure μηχανικής εκμάθησης] [ azure-machine-learning] υπηρεσία για ανάλυση πρόβλεψης web. Ανατρέξτε στο θέμα [Εισαγωγή στις εργοστασιακές δεδομένων Azure](data-factory-introduction.md) και [Δημιουργήστε το πρώτο διοχέτευσης](data-factory-build-your-first-pipeline.md) άρθρα για να ξεκινήσετε γρήγορα με την υπηρεσία Azure εργοστασίου δεδομένων. 

Χρησιμοποιώντας τη **Μαζική εκτέλεσης δραστηριότητας** μια διοχέτευση Azure εργοστασίου δεδομένων, μπορείτε να ενεργοποιήσετε μια υπηρεσία web Azure ML για να κάνετε προβλέψεις επάνω στα δεδομένα της δέσμης. Ανατρέξτε στην ενότητα [κλήση μιας ML Azure υπηρεσία χρησιμοποιώντας τη δραστηριότητα εκτέλεσης δέσμης web](#invoking-an-azure-ml-web-service-using-the-batch-execution-activity) για λεπτομέρειες.

Διάρκεια του χρόνου, το πρόβλεψης μοντέλα σε τα ML Azure βαθμολογίας δοκιμών πρέπει να είναι retrained με νέα σύνολα δεδομένων εισόδου. Μπορείτε να Επαναρύθμιση ένα μοντέλο Azure ML από μια προέλευση δεδομένων διοχέτευσης, κάνοντας τα εξής βήματα: 

1. Δημοσιεύστε την έρευνα εκπαίδευση (δεν πρόβλεψης έρευνα) ως υπηρεσία web. Μπορείτε να κάνετε αυτό το βήμα στο το Studio ML Azure όπως κάνατε για να εκθέσετε πρόβλεψης έρευνας ως μια υπηρεσία web στο προηγούμενο σενάριο.
2. Χρησιμοποιήστε τη δραστηριότητα εκτέλεσης Azure ML δέσμη για να καλέσετε την υπηρεσία web για την εκπαίδευση έρευνας. Βασικά, μπορείτε να χρησιμοποιήσετε τη δραστηριότητα Azure ML δέσμη εκτέλεσης για να καλέσετε υπηρεσία web εκπαίδευσης και βαθμολογίας υπηρεσία web. 
  
Αφού ολοκληρώσετε με επιμόρφωση, που θέλετε να ενημερώσετε την υπηρεσία web βαθμολογίας (πρόβλεψης έρευνας που εκτίθεται ως υπηρεσία web) με το μοντέλο που μόλις εκπαιδευμένο. Ακολουθούν τα βήματα: 

1. Προσθέστε ένα τελικό σημείο μη προεπιλεγμένες βαθμολογίας υπηρεσία web. Το προεπιλεγμένο τελικό σημείο της υπηρεσίας web δεν είναι δυνατό να ενημερωθούν, ώστε να πρέπει να δημιουργήσετε ένα τελικό σημείο μη προεπιλεγμένες με την πύλη Azure. Ανατρέξτε στο άρθρο [Δημιουργία τελικά σημεία](../machine-learning/machine-learning-create-endpoint.md) για γενικές πληροφορίες και βήματα σχετικά με τη διαδικασία.
2. Ενημέρωση υπάρχουσας ML Azure συνδεδεμένες υπηρεσίες για βαθμολογίας για να χρησιμοποιήσετε το τελικό σημείο μη προεπιλεγμένες. Ξεκινήστε να χρησιμοποιείτε το νέο τελικό σημείο για να χρησιμοποιήσετε την υπηρεσία web που είναι ενημερωθεί.
3. Χρησιμοποιήστε τη **Δραστηριότητα Azure ML ενημέρωση πόρων** για την ενημέρωση της υπηρεσίας web με το μοντέλο που μόλις εκπαιδευμένο.  

Ανατρέξτε στην ενότητα [Ενημέρωση ML Azure μοντέλα χρησιμοποιώντας τη δραστηριότητα πόρων ενημέρωσης](#updating-azure-ml-models-using-the-update-resource-activity) για λεπτομέρειες. 

## <a name="invoking-a-web-service-using-batch-execution-activity"></a>Κλήση μιας υπηρεσίας web χρησιμοποιώντας δέσμη εκτέλεσης δραστηριότητας

Χρησιμοποιήστε Azure εργοστασίου δεδομένων για να οργανώσετε κίνηση δεδομένων και την επεξεργασία και, στη συνέχεια, εκτελέστε εκτέλεσης δέσμης χρησιμοποιώντας Azure μηχανικής εκμάθησης. Τα βήματα είναι τα ανώτατου επιπέδου:

1. Δημιουργία μιας υπηρεσίας Azure μηχανικής εκμάθησης συνδεδεμένες. Χρειάζεστε τα εξής:
    1. **Αίτηση URI** για την εκτέλεση δέσμης API. Μπορείτε να βρείτε το URI αίτηση κάνοντας κλικ στη σύνδεση **ΕΚΤΈΛΕΣΗΣ ΔΈΣΜΗΣ** στη σελίδα υπηρεσιών web.
    1. **Πλήκτρο API** για δημοσιευμένους υπηρεσίας web Azure μηχανικής εκμάθησης. Μπορείτε να βρείτε τον αριθμό-κλειδί API κάνοντας κλικ στην επιλογή της υπηρεσίας web που έχετε δημοσιεύσει. 
 2. Χρησιμοποιήστε τη δραστηριότητα **AzureMLBatchExecution** .

    ![Πίνακας εργαλείων μηχανικής εκμάθησης](./media/data-factory-azure-ml-batch-execution-activity/AzureMLDashboard.png)

    ![Μαζική URI](./media/data-factory-azure-ml-batch-execution-activity/batch-uri.png)


### <a name="scenario-experiments-using-web-service-inputsoutputs-that-refer-to-data-in-azure-blob-storage"></a>Σενάριο: Πειραματισμούς χρησιμοποιώντας Web υπηρεσίας εισόδων/εξόδους που αναφέρονται σε δεδομένα στο χώρο αποθήκευσης Blob του Azure
Σε αυτό το σενάριο, η υπηρεσία Azure μηχανικής εκμάθησης Web κάνει προβλέψεων με χρήση δεδομένων από ένα αρχείο στο χώρο αποθήκευσης αντικειμένων blob του Azure και αποθηκεύει τα αποτελέσματα πρόβλεψη στο χώρο αποθήκευσης αντικειμένων blob του. Το παρακάτω JSON καθορίζει μια διοχέτευση εργοστασίου δεδομένων με μια δραστηριότητα AzureMLBatchExecution. Η δραστηριότητα έχει του συνόλου δεδομένων **DecisionTreeInputBlob** ως είσοδο και **DecisionTreeResultBlob** ως το αποτέλεσμα. Το **DecisionTreeInputBlob** μεταβιβάζεται ως εισαγωγή στην υπηρεσία web, χρησιμοποιώντας την ιδιότητα JSON **webServiceInput** . Το **DecisionTreeResultBlob** μεταβιβάζεται ως το αποτέλεσμα της υπηρεσίας Web, χρησιμοποιώντας την ιδιότητα JSON **webServiceOutputs** .  

> [AZURE.IMPORTANT] 
> Εάν η υπηρεσία web διαρκεί πολλές εισόδων, χρησιμοποιήστε την ιδιότητα **webServiceInputs** αντί για τη χρήση **webServiceInput**. Ανατρέξτε στην ενότητα [υπηρεσία Web απαιτεί πολλά εισόδων](#web-service-requires-multiple-inputs) για ένα παράδειγμα της χρήσης της ιδιότητας webServiceInputs.
>  
> Σύνολα δεδομένων που αναφέρονται από το **webServiceInput**/**webServiceInputs** και **webServiceOutputs** Ιδιότητες (στο **typeProperties**) πρέπει να περιλαμβάνεται στη δραστηριότητα **εισροές** και **εξόδους**.
> 
> Στο σας Azure ML έρευνας, εισαγωγή δεδομένων υπηρεσίας web και θύρες εξόδου και καθολικές παράμετροι έχουν προεπιλεγμένα ονόματα ("input1", "input2") που μπορείτε να προσαρμόσετε. Τα ονόματα που χρησιμοποιείτε για webServiceInputs, webServiceOutputs και ρυθμίσεις globalParameters πρέπει να αντιστοιχεί ακριβώς τα ονόματα στη τις δοκιμές. Μπορείτε να προβάλετε το φορτίο αίτηση δείγμα στη σελίδα δέσμη εκτέλεσης Βοήθεια για το τελικό σημείο Azure ML σας για να επιβεβαιώσετε την αναμενόμενη αντιστοίχιση. 


    {
      "name": "PredictivePipeline",
      "properties": {
        "description": "use AzureML model",
        "activities": [
          {
            "name": "MLActivity",
            "type": "AzureMLBatchExecution",
            "description": "prediction analysis on batch input",
            "inputs": [
              {
                "name": "DecisionTreeInputBlob"
              }
            ],
            "outputs": [
              {
                "name": "DecisionTreeResultBlob"
              }
            ],
            "linkedServiceName": "MyAzureMLLinkedService",
            "typeProperties":
            {
                "webServiceInput": "DecisionTreeInputBlob",
                "webServiceOutputs": {
                    "output1": "DecisionTreeResultBlob"
                }                
            },
            "policy": {
              "concurrency": 3,
              "executionPriorityOrder": "NewestFirst",
              "retry": 1,
              "timeout": "02:00:00"
            }
          }
        ],
        "start": "2016-02-13T00:00:00Z",
        "end": "2016-02-14T00:00:00Z"
      }
    }

> [AZURE.NOTE] Μόνο εισροές και εκροές της δραστηριότητας AzureMLBatchExecution μπορούν να περάσουν ως παραμέτρων της υπηρεσίας Web. Για παράδειγμα, στο τμήμα JSON παραπάνω, DecisionTreeInputBlob είναι με τη δραστηριότητα AzureMLBatchExecution, η οποία μεταβιβάζεται ως είσοδο στην υπηρεσία Web από την παράμετρο webServiceInput δεδομένα.   

### <a name="example"></a>Παράδειγμα

Αυτό το παράδειγμα χρησιμοποιεί Azure χώρο αποθήκευσης για τη διατήρηση τόσο τα δεδομένα εισόδου και εξόδου. 

Σας συνιστούμε να ακολουθήσετε τη [Δημιουργία του πρώτου σωλήνωσης με εργοστασίου δεδομένων] [ adf-build-1st-pipeline] προγραμμάτων εκμάθησης πριν μεταβείτε σε αυτό το παράδειγμα. Χρήση του προγράμματος επεξεργασίας εργοστασίου δεδομένων για να δημιουργήσετε αντικείμενα εργοστασίου δεδομένων (συνδεδεμένες υπηρεσίες, σύνολα δεδομένων, διοχέτευσης) σε αυτό το παράδειγμα.   
 

1. Δημιουργία **συνδεδεμένων υπηρεσίας** για το **Χώρο αποθήκευσης Azure**. Εάν τα αρχεία εισόδου και εξόδου είναι σε διαφορετικό χώρο αποθήκευσης λογαριασμούς, χρειάζεστε δύο συνδεδεμένες υπηρεσίες. Ακολουθεί ένα παράδειγμα JSON:

        {
          "name": "StorageLinkedService",
          "properties": {
            "type": "AzureStorage",
            "typeProperties": {
              "connectionString": "DefaultEndpointsProtocol=https;AccountName=[acctName];AccountKey=[acctKey]"
            }
          }
        }

2. Δημιουργήστε το **εισαγωγής** εργοστασίου δεδομένων Azure **συνόλου δεδομένων**. Σε αντίθεση με ορισμένα άλλα δεδομένα εργοστασίου σύνολα δεδομένων, αυτά τα σύνολα δεδομένων πρέπει να περιέχει τιμές **folderPath** και το **όνομα αρχείου** . Μπορείτε να χρησιμοποιήσετε διαμερισμάτων προκάλεσε κάθε εκτέλεσης δέσμης (κάθε φέτα δεδομένα) για την επεξεργασία ή αγροτικά προϊόντα μοναδικό εισόδου και εξόδου αρχείων. Ίσως χρειαστεί να συμπεριλάβετε κάποια νέα δραστηριότητα για να μετατρέψετε την εισαγωγή δεδομένων σε μορφή αρχείου CSV και να την τοποθετήσετε στο λογαριασμό χώρου αποθήκευσης για κάθε φέτα. Σε αυτή την περίπτωση, δεν θα περιλαμβάνει τις ρυθμίσεις **εξωτερικής** και **externalData** φαίνεται στο παρακάτω παράδειγμα και σας DecisionTreeInputBlob θα ήταν του συνόλου δεδομένων εξόδου από μια διαφορετική δραστηριότητα.

        {
          "name": "DecisionTreeInputBlob",
          "properties": {
            "type": "AzureBlob",
            "linkedServiceName": "StorageLinkedService",
            "typeProperties": {
              "folderPath": "azuremltesting/input",
              "fileName": "in.csv",
              "format": {
                "type": "TextFormat",
                "columnDelimiter": ","
              }
            },
            "external": true,
            "availability": {
              "frequency": "Day",
              "interval": 1
            },
            "policy": {
              "externalData": {
                "retryInterval": "00:01:00",
                "retryTimeout": "00:10:00",
                "maximumRetry": 3
              }
            }
          }
        }
    
    Το αρχείο εισαγωγής csv πρέπει να έχετε τη γραμμή κεφαλίδας στήλης. Εάν χρησιμοποιείτε τη **Δραστηριότητα αντιγραφή** για να δημιουργήσετε/μετακινήσετε το csv το χώρο αποθήκευσης αντικειμένων blob, θα πρέπει να μπορείτε να ορίσετε την ιδιότητα δέκτη **blobWriterAddHeader** στην **τιμή true**. Για παράδειγμα:
    
         sink: 
         {
             "type": "BlobSink",     
             "blobWriterAddHeader": true 
         }
     
    Εάν το αρχείο csv δεν έχει γραμμή κεφαλίδων, μπορείτε να δείτε το ακόλουθο σφάλμα: **σφάλματος στη δραστηριότητα: σφάλμα κατά την ανάγνωση συμβολοσειρά. Μη αναμενόμενο διακριτικό: StartObject. Διαδρομή '', γραμμή 1, τοποθετήστε 1**.
3. Δημιουργία **εξόδου** εργοστασίου δεδομένων Azure **συνόλου δεδομένων**. Σε αυτό το παράδειγμα χρησιμοποιεί διαμερισμάτων για να δημιουργήσετε μια διαδρομή μοναδικό εξόδου για κάθε εκτέλεσης φέτα. Χωρίς τη δημιουργία διαμερισμάτων, τη δραστηριότητα θα αντικαταστήσει το αρχείο.

        {
          "name": "DecisionTreeResultBlob",
          "properties": {
            "type": "AzureBlob",
            "linkedServiceName": "StorageLinkedService",
            "typeProperties": {
              "folderPath": "azuremltesting/scored/{folderpart}/",
              "fileName": "{filepart}result.csv",
              "partitionedBy": [
                {
                  "name": "folderpart",
                  "value": {
                    "type": "DateTime",
                    "date": "SliceStart",
                    "format": "yyyyMMdd"
                  }
                },
                {
                  "name": "filepart",
                  "value": {
                    "type": "DateTime",
                    "date": "SliceStart",
                    "format": "HHmmss"
                  }
                }
              ],
              "format": {
                "type": "TextFormat",
                "columnDelimiter": ","
              }
            },
            "availability": {
              "frequency": "Day",
              "interval": 15
            }
          }
        }

4. Δημιουργία **συνδεδεμένων υπηρεσίας** του τύπου: **AzureMLLinkedService**, παρέχοντας το API κλειδί και διεύθυνση URL δέσμης εκτέλεσης του μοντέλου.
        
        {
          "name": "MyAzureMLLinkedService",
          "properties": {
            "type": "AzureML",
            "typeProperties": {
              "mlEndpoint": "https://[batch execution endpoint]/jobs",
              "apiKey": "[apikey]"
            }
          }
        }
5. Τέλος, να συντάξουν μια διαδικασία που περιέχει μια δραστηριότητα **AzureMLBatchExecution** . Κατά το χρόνο εκτέλεσης, διοχέτευσης εκτελεί τα ακόλουθα βήματα:
    1. Λαμβάνει τη θέση του αρχείου εισόδου από το εισαγωγής συνόλων δεδομένων.
    2. Ενεργοποιεί την εκτέλεση δέσμη Azure μηχανικής εκμάθησης API
    3. Αντιγράφει την έξοδο εκτέλεσης δέσμης το αντικείμενο blob δίνεται στο σύνολο δεδομένων σας εξόδου. 

    > [AZURE.NOTE] Δραστηριότητα AzureMLBatchExecution μπορεί να έχει κανέναν ή περισσότερους εισροές και εκροές μία ή περισσότερες.

        {
          "name": "PredictivePipeline",
          "properties": {
            "description": "use AzureML model",
            "activities": [
              {
                "name": "MLActivity",
                "type": "AzureMLBatchExecution",
                "description": "prediction analysis on batch input",
                "inputs": [
                  {
                    "name": "DecisionTreeInputBlob"
                  }
                ],
                "outputs": [
                  {
                    "name": "DecisionTreeResultBlob"
                  }
                ],
                "linkedServiceName": "MyAzureMLLinkedService",
                "typeProperties":
                {
                    "webServiceInput": "DecisionTreeInputBlob",
                    "webServiceOutputs": {
                        "output1": "DecisionTreeResultBlob"
                    }                
                },
                "policy": {
                  "concurrency": 3,
                  "executionPriorityOrder": "NewestFirst",
                  "retry": 1,
                  "timeout": "02:00:00"
                }
              }
            ],
            "start": "2016-02-13T00:00:00Z",
            "end": "2016-02-14T00:00:00Z"
          }
        }

    Ημερομηνίες-ώρες **έναρξης** και **λήξης** πρέπει να είναι σε [μορφή ISO](http://en.wikipedia.org/wiki/ISO_8601). Για παράδειγμα: 2014-10-14T16:32:41Z. Την ώρα **λήξης** είναι προαιρετικό. Εάν δεν καθορίσετε τιμή για την ιδιότητα **Τέλος** , υπολογίζεται ως "**Έναρξη + 48 ώρες.**" Για να εκτελέσετε τη διαδικασία απεριόριστο χρονικό διάστημα, καθορίστε **9999-09-09** ως η τιμή για την ιδιότητα **Τέλος** . Για λεπτομέρειες σχετικά με τις ιδιότητες JSON, ανατρέξτε στο θέμα [Αναφορά δέσμες ενεργειών JSON](https://msdn.microsoft.com/library/dn835050.aspx) .

    > [AZURE.NOTE] Καθορισμός εισόδου για το AzureMLBatchExecution δραστηριότητας είναι προαιρετικό. 

### <a name="scenario-experiments-using-readerwriter-modules-to-refer-to-data-in-various-storages"></a>Σενάριο: Πειραματισμούς χρησιμοποιώντας λειτουργικές μονάδες ανάγνωσης/εγγραφής για να χρησιμοποιείτε αναφορές σε δεδομένα σε διάφορες χώρων αποθήκευσης

Άλλο ένα κοινό σενάριο κατά τη δημιουργία Azure ML δοκιμών είναι να χρησιμοποιήσετε λειτουργικές μονάδες ανάγνωσης και εγγραφής. Τη λειτουργική μονάδα ανάγνωσης χρησιμοποιείται για τη φόρτωση των δεδομένων σε μια έρευνα και τη λειτουργική μονάδα εγγραφής είναι να αποθηκεύσετε τα δεδομένα από τις δοκιμές. Για λεπτομέρειες σχετικά με τις λειτουργικές μονάδες ανάγνωσης και εγγραφής, ανατρέξτε στο θέμα θέματα της [ανάγνωσης](https://msdn.microsoft.com/library/azure/dn905997.aspx) και [εγγραφής](https://msdn.microsoft.com/library/azure/dn905984.aspx) στη βιβλιοθήκη MSDN.     

Όταν χρησιμοποιείτε τις λειτουργικές μονάδες ανάγνωσης και εγγραφής, είναι καλό να χρησιμοποιήσετε μια παράμετρο υπηρεσίας Web για κάθε ιδιότητα του αυτές οι λειτουργικές μονάδες ανάγνωσης/εγγραφής. Αυτές οι παράμετροι web σάς επιτρέπουν να ρυθμίσετε τις παραμέτρους των τιμών κατά τη διάρκεια του χρόνου εκτέλεσης. Για παράδειγμα, μπορείτε να δημιουργήσετε μια έρευνα με μια λειτουργική μονάδα ανάγνωσης που χρησιμοποιεί μια βάση δεδομένων SQL Azure: XXX.database.windows.net. Μετά την ανάπτυξη της υπηρεσίας web, που θέλετε να ενεργοποιήσετε τους καταναλωτές της υπηρεσίας web για να καθορίσετε μια άλλη Azure SQL Server που ονομάζεται YYY.database.windows.net. Μπορείτε να χρησιμοποιήσετε μια παράμετρο υπηρεσίας Web για να επιτρέψετε σε αυτή την τιμή να ρυθμιστούν.

> [AZURE.NOTE] Εισαγωγή δεδομένων υπηρεσίας Web και εξόδου είναι διαφορετικές των παραμέτρων της υπηρεσίας Web. Στο πρώτο σενάριο, που είδατε πώς ένα εισόδου και εξόδου μπορεί να καθοριστεί για μια υπηρεσία Azure ML Web. Σε αυτό το σενάριο, μπορείτε να μεταβιβάσετε παραμέτρους για μια υπηρεσία Web που αντιστοιχούν στις ιδιότητες των λειτουργικών μονάδων, ανάγνωσης/εγγραφής. 

Ας δούμε ένα σενάριο για τη χρήση των παραμέτρων της υπηρεσίας Web. Έχετε μια υπηρεσία web Azure μηχανικής εκμάθησης ανεπτυγμένος που χρησιμοποιεί μια λειτουργική μονάδα ανάγνωσης για την ανάγνωση δεδομένων από μία από τις προελεύσεις δεδομένων που υποστηρίζονται από το Azure μηχανικής εκμάθησης (για παράδειγμα: βάση δεδομένων SQL Azure). Μετά την εκτέλεση της εκτέλεσης της δέσμης, τα αποτελέσματα είναι γραμμένες χρησιμοποιώντας μια λειτουργική μονάδα εγγραφής (βάση δεδομένων SQL Azure).  Δεν υπάρχει εισόδων υπηρεσίας web και των εξόδων ορίζονται σε τις δοκιμές. Σε αυτήν την περίπτωση, συνιστάται να ρυθμίσετε τις παραμέτρους των παραμέτρων της υπηρεσίας web σχετικές για τις λειτουργικές μονάδες ανάγνωσης και εγγραφής. Αυτή η ρύθμιση παραμέτρων επιτρέπει ανάγνωσης/εγγραφής της λειτουργικές μονάδες να ρυθμιστούν όταν χρησιμοποιείτε τη δραστηριότητα AzureMLBatchExecution. Καθορίζετε των παραμέτρων της υπηρεσίας Web στην ενότητα **globalParameters** στη δραστηριότητα JSON ως εξής. 


    "typeProperties": {
        "globalParameters": {
            "Param 1": "Value 1",
            "Param 2": "Value 2"
        }
    }

Μπορείτε επίσης να χρησιμοποιήσετε [Συναρτήσεις εργοστασίου δεδομένων](https://msdn.microsoft.com/library/dn835056.aspx) στο διέρχεται τιμές για τις παραμέτρους της υπηρεσίας Web όπως φαίνεται στο ακόλουθο παράδειγμα:

    "typeProperties": {
        "globalParameters": {
           "Database query": "$$Text.Format('SELECT * FROM myTable WHERE timeColumn = \\'{0:yyyy-MM-dd HH:mm:ss}\\'', Time.AddHours(WindowStart, 0))"
        }
    }
 
> [AZURE.NOTE] Οι παράμετροι της υπηρεσίας Web διάκριση πεζών-κεφαλαίων, επομένως, βεβαιωθείτε ότι τα ονόματα που καθορίζετε στη δραστηριότητα JSON συμφωνούν με αυτά που εκτίθεται από την υπηρεσία Web. 

### <a name="using-a-reader-module-to-read-data-from-multiple-files-in-azure-blob"></a>Χρησιμοποιώντας μια λειτουργική μονάδα ανάγνωσης για να διαβάσετε δεδομένων από πολλά αρχεία στο αντικειμένων Blob του Azure
Μεγάλο δεδομένων διοχετεύσεων με δραστηριότητες όπως γουρούνι και της ομάδας μπορούν να δημιουργήσουν ένα ή περισσότερα αρχεία εξόδου χωρίς επέκταση. Για παράδειγμα, όταν ορίζετε έναν εξωτερικό πίνακα ομάδας, τα δεδομένα για τον εξωτερικό πίνακα Hive μπορεί να είναι αποθηκευμένα στο χώρο αποθήκευσης αντικειμένων blob του Azure με το ακόλουθο όνομα 000000_0. Μπορείτε να χρησιμοποιήσετε τη λειτουργική μονάδα ανάγνωσης σε μια έρευνα για να διαβάσετε πολλών αρχείων, και να τις χρησιμοποιήσετε για προβλέψεων. 

Όταν χρησιμοποιείτε τη λειτουργική μονάδα ανάγνωσης σε μια έρευνα Azure μηχανικής εκμάθησης, μπορείτε να καθορίσετε αντικειμένων Blob του Azure ως εισαγωγή. Τα αρχεία στο το χώρο αποθήκευσης αντικειμένων blob του Azure μπορεί να είναι τα αρχεία εξόδου (παράδειγμα: 000000_0) που παράγονται από μια γουρούνι και Hive δέσμη ενεργειών που εκτελούνται στο HDInsight. Τη λειτουργική μονάδα ανάγνωσης σας επιτρέπει να διαβάσει τα αρχεία (με επεκτάσεις χωρίς), ρυθμίζοντας τις παραμέτρους του **διαδρομή σε κοντέινερ, καταλόγου/blob**. Τα σημεία **διαδρομή κοντέινερ** σε κοντέινερ και **καταλόγου/blob** σημεία φάκελο που περιέχει τα αρχεία, όπως φαίνεται στην παρακάτω εικόνα. Ο αστερίσκος, δηλαδή \*) **Καθορίζει ότι όλα τα αρχεία στο κοντέινερ φάκελο (δηλαδή, δεδομένων/aggregateddata/έτος = μήνας/2014-6 /\*)** διαβάζονται ως μέρος του την έρευνα.

![Ιδιότητες Azure Blob](./media/data-factory-create-predictive-pipelines/azure-blob-properties.png)


### <a name="example"></a>Παράδειγμα 
#### <a name="pipeline-with-azuremlbatchexecution-activity-with-web-service-parameters"></a>Σωλήνωση με δραστηριότητα AzureMLBatchExecution με παραμέτρους υπηρεσίας Web

    {
      "name": "MLWithSqlReaderSqlWriter",
      "properties": {
        "description": "Azure ML model with sql azure reader/writer",
        "activities": [
          {
            "name": "MLSqlReaderSqlWriterActivity",
            "type": "AzureMLBatchExecution",
            "description": "test",
            "inputs": [
              {
                "name": "MLSqlInput"
              }
            ],
            "outputs": [
              {
                "name": "MLSqlOutput"
              }
            ],
            "linkedServiceName": "MLSqlReaderSqlWriterDecisionTreeModel",
            "typeProperties":
            {
                "webServiceInput": "MLSqlInput",
                "webServiceOutputs": {
                    "output1": "MLSqlOutput"
                }
                "globalParameters": {
                    "Database server name": "<myserver>.database.windows.net",
                    "Database name": "<database>",
                    "Server user account name": "<user name>",
                    "Server user account password": "<password>"
                }              
            },
            "policy": {
              "concurrency": 1,
              "executionPriorityOrder": "NewestFirst",
              "retry": 1,
              "timeout": "02:00:00"
            },
          }
        ],
        "start": "2016-02-13T00:00:00Z",
        "end": "2016-02-14T00:00:00Z"
      }
    }
 
Στο παραπάνω παράδειγμα JSON:

- Ανεπτυγμένος υπηρεσίας Azure μηχανικής εκμάθησης Web χρησιμοποιεί ένα πρόγραμμα ανάγνωσης και μια λειτουργική μονάδα εγγραφής για να ανάγνωσης/εγγραφής δεδομένων από/προς μια βάση δεδομένων SQL Azure. Αυτή η υπηρεσία Web εκθέτει τις ακόλουθες παραμέτρους τέσσερις: το όνομα του διακομιστή, όνομα βάσης δεδομένων, όνομα διακομιστή του λογαριασμού χρήστη και κωδικό πρόσβασης του λογαριασμού χρήστη διακομιστή της βάσης δεδομένων.  
- Ημερομηνίες-ώρες **έναρξης** και **λήξης** πρέπει να είναι σε [μορφή ISO](http://en.wikipedia.org/wiki/ISO_8601). Για παράδειγμα: 2014-10-14T16:32:41Z. Την ώρα **λήξης** είναι προαιρετικό. Εάν δεν καθορίσετε τιμή για την ιδιότητα **Τέλος** , υπολογίζεται ως "**Έναρξη + 48 ώρες.**" Για να εκτελέσετε τη διαδικασία απεριόριστο χρονικό διάστημα, καθορίστε **9999-09-09** ως η τιμή για την ιδιότητα **Τέλος** . Για λεπτομέρειες σχετικά με τις ιδιότητες JSON, ανατρέξτε στο θέμα [Αναφορά δέσμες ενεργειών JSON](https://msdn.microsoft.com/library/dn835050.aspx) .

### <a name="other-scenarios"></a>Άλλα σενάρια

#### <a name="web-service-requires-multiple-inputs"></a>Υπηρεσία Web απαιτεί πολλά εισόδων
Εάν η υπηρεσία web διαρκεί πολλές εισόδων, χρησιμοποιήστε την ιδιότητα **webServiceInputs** αντί για τη χρήση **webServiceInput**. Σύνολα δεδομένων που αναφέρονται από το **webServiceInputs** πρέπει να περιλαμβάνεται στο τη δραστηριότητα **εισόδων**.
 
Στο σας Azure ML έρευνας, εισαγωγή δεδομένων υπηρεσίας web και θύρες εξόδου και καθολικές παράμετροι έχουν προεπιλεγμένα ονόματα ("input1", "input2") που μπορείτε να προσαρμόσετε. Τα ονόματα που χρησιμοποιείτε για webServiceInputs, webServiceOutputs και ρυθμίσεις globalParameters πρέπει να αντιστοιχεί ακριβώς τα ονόματα στη τις δοκιμές. Μπορείτε να προβάλετε το φορτίο αίτηση δείγμα στη σελίδα δέσμη εκτέλεσης Βοήθεια για το τελικό σημείο Azure ML σας για να επιβεβαιώσετε την αναμενόμενη αντιστοίχιση.


    {
        "name": "PredictivePipeline",
        "properties": {
            "description": "use AzureML model",
            "activities": [{
                "name": "MLActivity",
                "type": "AzureMLBatchExecution",
                "description": "prediction analysis on batch input",
                "inputs": [{
                    "name": "inputDataset1"
                }, {
                    "name": "inputDataset2"
                }],
                "outputs": [{
                    "name": "outputDataset"
                }],
                "linkedServiceName": "MyAzureMLLinkedService",
                "typeProperties": {
                    "webServiceInputs": {
                        "input1": "inputDataset1",
                        "input2": "inputDataset2"
                    },
                    "webServiceOutputs": {
                        "output1": "outputDataset"
                    }
                },
                "policy": {
                    "concurrency": 3,
                    "executionPriorityOrder": "NewestFirst",
                    "retry": 1,
                    "timeout": "02:00:00"
                }
            }],
            "start": "2016-02-13T00:00:00Z",
            "end": "2016-02-14T00:00:00Z"
        }
    }

#### <a name="web-service-does-not-require-an-input"></a>Υπηρεσία Web δεν απαιτεί μια εισαγωγής

Azure ML δέσμη εκτέλεσης υπηρεσίες web μπορεί να χρησιμοποιηθεί για την εκτέλεση των ροών εργασίας, για παράδειγμα R ή Python δέσμες ενεργειών, που δεν μπορεί να απαιτεί οποιαδήποτε δεδομένα εισόδου. Εναλλακτικά, μπορείτε να την έρευνα ενδέχεται να ρυθμιστούν με μια λειτουργική μονάδα ανάγνωσης που δεν εκθέτει οποιαδήποτε GlobalParameters. Σε αυτή την περίπτωση, τη δραστηριότητα AzureMLBatchExecution μπορεί να ρυθμιστεί ως εξής:

    {
        "name": "scoring service",
        "type": "AzureMLBatchExecution",
        "outputs": [
            {
                "name": "myBlob"
            }
        ],
        "typeProperties": {
            "webServiceOutputs": {
                "output1": "myBlob"
            }              
         },
        "linkedServiceName": "mlEndpoint",
        "policy": {
            "concurrency": 1,
            "executionPriorityOrder": "NewestFirst",
            "retry": 1,
            "timeout": "02:00:00"
        }
    },
   

#### <a name="web-service-does-not-require-an-inputoutput"></a>Υπηρεσία Web δεν απαιτεί μια εισόδου/εξόδου
Η υπηρεσία web Azure ML δέσμη εκτέλεσης ενδέχεται να μην έχετε κανένα αποτέλεσμα υπηρεσίας Web έχει ρυθμιστεί. Σε αυτό το παράδειγμα, δεν υπάρχει υπηρεσία Web εισόδου ή εξόδου, ούτε έχουν ρυθμιστεί οποιαδήποτε GlobalParameters. Εξακολουθεί να είναι το αποτέλεσμα έχει ρυθμιστεί στη δραστηριότητα ίδιο, αλλά δεν έχει δοθεί ως μια webServiceOutput.

    {
        "name": "retraining",
        "type": "AzureMLBatchExecution",
        "outputs": [
            {
                "name": "placeholderOutputDataset"
            }
        ],
        "typeProperties": {
         },
        "linkedServiceName": "mlEndpoint",
        "policy": {
            "concurrency": 1,
            "executionPriorityOrder": "NewestFirst",
            "retry": 1,
            "timeout": "02:00:00"
        }
    },

#### <a name="web-service-uses-readers-and-writers-and-the-activity-runs-only-when-other-activities-have-succeeded"></a>Οι αναγνώστες χρήσεις υπηρεσίας Web και συντάκτες και η δραστηριότητα εκτελείται μόνο όταν άλλες δραστηριότητες έχουν ολοκληρώθηκε με επιτυχία

Το Azure ML web υπηρεσίας ανάγνωσης και εγγραφής λειτουργικές μονάδες μπορεί να είναι διαμορφωμένη για να εκτελέσετε με ή χωρίς οποιαδήποτε GlobalParameters. Ωστόσο, ενδέχεται να θέλετε να ενσωματώσετε κλήσεις υπηρεσίας στο δίκτυο αγωγών που χρησιμοποιεί εξαρτήσεις σύνολο δεδομένων για να καλέσετε την υπηρεσία μόνο όταν έχει ολοκληρωθεί ορισμένα νέα επεξεργασίας. Μπορείτε επίσης να ενεργοποιήσετε κάποια άλλη ενέργεια μετά την ολοκλήρωση της εκτέλεσης δέσμης χρησιμοποιώντας αυτήν την προσέγγιση. Σε αυτή την περίπτωση, να μπορείτε να εκφράσετε τις εξαρτήσεις χρήση δραστηριότητας εισροές και εκροές, χωρίς ονομασία οποιαδήποτε από αυτές ως υπηρεσία Web εισόδων ή εξόδους.

    {
        "name": "retraining",
        "type": "AzureMLBatchExecution",
        "inputs": [
            {
                "name": "upstreamData1"
            },
            {
                "name": "upstreamData2"
            }
        ],
        "outputs": [
            {
                "name": "downstreamData"
            }
        ],
        "typeProperties": {
         },
        "linkedServiceName": "mlEndpoint",
        "policy": {
            "concurrency": 1,
            "executionPriorityOrder": "NewestFirst",
            "retry": 1,
            "timeout": "02:00:00"
        }
    },

Το **takeaways** είναι οι εξής:

-   Εάν το τελικό σημείο έρευνας χρησιμοποιεί μια webServiceInput: το αντιπροσωπεύεται από ένα σύνολο αντικειμένων blob δεδομένων και περιλαμβάνει τα δεδομένα εισόδου δραστηριότητας και την ιδιότητα webServiceInput. Διαφορετικά, παραλείπεται η ιδιότητα webServiceInput. 
-   Εάν το τελικό σημείο έρευνας χρησιμοποιεί webServiceOutput(s): μπορούν αντιπροσωπεύονται από blob συνόλων δεδομένων και περιλαμβάνονται στο εξόδους τη δραστηριότητα και στην ιδιότητα webServiceOutputs. Εξάγει τη δραστηριότητα και webServiceOutputs έχουν αντιστοιχιστεί από το όνομα του κάθε εξόδου στο την έρευνα. Διαφορετικά, παραλείπεται η ιδιότητα webServiceOutputs.
-   Εάν το τελικό σημείο έρευνας εκθέτει globalParameter(s), τους δίνεται στην ιδιότητα globalParameters δραστηριότητας ως ζεύγη κλειδιών, τιμή. Διαφορετικά, παραλείπεται η ιδιότητα globalParameters. Τα πλήκτρα με διάκριση πεζών-κεφαλαίων. [Συναρτήσεις Azure εργοστασίου δεδομένων](data-factory-scheduling-and-execution.md#data-factory-functions-reference) μπορεί να χρησιμοποιηθεί στις τιμές. 
- Επιπλέον συνόλων δεδομένων ενδέχεται να συμπεριληφθούν στις δραστηριότητας εισροές και εκροές ιδιότητες, χωρίς να αναφέρεται σε typeProperties τη δραστηριότητα. Αυτά τα σύνολα δεδομένων διέπουν εκτέλεσης χρησιμοποιώντας εξαρτήσεις φέτα αλλά παραβλέπονται διαφορετικά από τη δραστηριότητα AzureMLBatchExecution. 


## <a name="updating-models-using-update-resource-activity"></a>Ενημέρωση μοντέλα χρησιμοποιώντας ενημέρωση πόρων δραστηριότητας
Διάρκεια του χρόνου, το πρόβλεψης μοντέλα σε τα ML Azure βαθμολογίας δοκιμών πρέπει να είναι retrained με νέα σύνολα δεδομένων εισόδου. Αφού ολοκληρώσετε με επιμόρφωση, που θέλετε να ενημερώσετε βαθμολογίας υπηρεσίας web με το μοντέλο retrained ML. Το τυπικό βήματα για να ενεργοποιήσετε την επαναπροσαρμογής και ενημέρωση μοντέλα Azure ML μέσω των υπηρεσιών web είναι: 

1. Δημιουργία μιας έρευνας στο [Azure ML Studio](https://studio.azureml.net). 
2. Όταν είστε ικανοποιημένοι με το μοντέλο, χρησιμοποιήστε το Azure ML Studio για τη δημοσίευση υπηρεσιών web για τόσο την **εκπαίδευση πειραματιστείτε** και βαθμολογίας /**πρόβλεψης έρευνας**.

Ο παρακάτω πίνακας περιγράφει τις υπηρεσίες web που χρησιμοποιούνται σε αυτό το παράδειγμα.  Για λεπτομέρειες, ανατρέξτε στο θέμα [Επαναρύθμιση μηχανικής εκμάθησης μοντέλα μέσω προγραμματισμού](../machine-learning/machine-learning-retrain-models-programmatically.md) .

| Τύπος υπηρεσίας web | Περιγραφή 
| :------------------ | :---------- 
| **Υπηρεσία web εκπαίδευσης** | Λαμβάνει δεδομένα εκπαίδευση και παράγει εκπαιδευμένο μοντέλα. Το αποτέλεσμα του επαγγελματικού επαναπροσανατολισμού είναι ένα αρχείο .ilearner στο χώρο αποθήκευσης αντικειμένων Blob του Azure.  Το **προεπιλεγμένο τελικό σημείο** δημιουργείται αυτόματα για εσάς όταν δημοσιεύετε το έρευνας εκπαίδευση ως υπηρεσία web. Μπορείτε να δημιουργήσετε περισσότερες τελικά σημεία, αλλά το παράδειγμα χρησιμοποιεί μόνο το προεπιλεγμένο τελικό σημείο |
| **Βαθμολογίας υπηρεσίας web** | Λαμβάνει παραδείγματα χωρίς ετικέτα δεδομένων και κάνει προβλέψεων. Το αποτέλεσμα της πρόβλεψης θα μπορούσε να έχει διάφορες μορφές, όπως ένα αρχείο .csv ή γραμμές σε μια βάση δεδομένων Azure SQL, ανάλογα με τη ρύθμιση παραμέτρων για την έρευνα. Το προεπιλεγμένο τελικό σημείο δημιουργείται αυτόματα για εσάς όταν δημοσιεύετε το πρόβλεψης έρευνας ως υπηρεσία web. Δημιουργήστε το δεύτερο **μη προεπιλεγμένες και ενημέρωσης τελικού σημείου** χρησιμοποιώντας την [πύλη του Azure](https://manage.windowsazure.com). Μπορείτε να δημιουργήσετε περισσότερες τελικά σημεία, αλλά αυτό το παράδειγμα χρησιμοποιεί μόνο ένα τελικό σημείο ενημέρωσης μη προεπιλεγμένες. Ανατρέξτε στο άρθρο [Δημιουργία τελικά σημεία](../machine-learning/machine-learning-create-endpoint.md) για τα βήματα.       
 
Η παρακάτω εικόνα απεικονίζει τη σχέση μεταξύ εκπαίδευση και βαθμολογίας τελικά σημεία σε Azure ML. 

![Υπηρεσίες Web](./media/data-factory-azure-ml-batch-execution-activity/web-services.png)


Μπορείτε να ενεργοποιήσετε την **υπηρεσία web εκπαίδευσης** , χρησιμοποιώντας τη **Δραστηριότητα εκτέλεσης δέσμης ML Azure**. Κλήση μιας υπηρεσίας web εκπαίδευση είναι ίδια με την κλήση μιας υπηρεσίας web Azure ML (υπηρεσία web βαθμολογίας) για βαθμολογίας δεδομένα. Προηγούμενες ενότητες καλύπτει τον τρόπο ενεργοποίησης μιας υπηρεσίας web Azure ML από μια διοχέτευση εργοστασίου δεδομένων Azure με λεπτομέρειες. 
  
Μπορείτε να ενεργοποιήσετε τη **βαθμολογία υπηρεσίας web** , χρησιμοποιώντας τη **Δραστηριότητα Azure ML ενημέρωση πόρων** για την ενημέρωση της υπηρεσίας web με το μοντέλο που μόλις εκπαιδευμένο. Όπως αναφέρθηκε στον παραπάνω πίνακα, πρέπει να δημιουργήσετε και να χρησιμοποιήσετε το τελικό σημείο ενημέρωσης μη προεπιλεγμένες. Επιπλέον, ενημερώστε τις υπάρχουσες υπηρεσίες συνδεδεμένων του εργοστασίου σας δεδομένων για να χρησιμοποιήσετε το τελικό σημείο μη προεπιλεγμένες ώστε να χρησιμοποιούν πάντα την πιο πρόσφατη retrained μοντέλο. 

Το ακόλουθο σενάριο παρέχει περισσότερες λεπτομέρειες. Έχει ένα παράδειγμα για επιμόρφωση και την ενημέρωση μοντέλων Azure ML από μια διοχέτευση Azure εργοστασίου δεδομένων. 
 
### <a name="scenario-retraining-and-updating-an-azure-ml-model"></a>Σενάριο: επιμόρφωση και την ενημέρωση ενός μοντέλου Azure ML
Αυτή η ενότητα παρέχει ένα δείγμα διοχέτευσης που χρησιμοποιεί τη **δραστηριότητα Azure ML δέσμη εκτέλεσης** για Επαναρύθμιση μοντέλου. Η διαδικασία χρησιμοποιεί επίσης τη **δραστηριότητα πόρος ενημερώστε ML Azure** για να ενημερώσετε το μοντέλο στο βαθμολογίας υπηρεσίας web. Η ενότητα παρέχει επίσης τμήματα κώδικα JSON για όλα τα συνδεδεμένες υπηρεσίες, σύνολα δεδομένων και διοχέτευσης στο παράδειγμα. 

Παρακάτω θα δείτε την προβολή διαγράμματος του της διοχέτευσης δείγμα. Όπως μπορείτε να δείτε τη δραστηριότητα Azure ML δέσμη εκτέλεσης λαμβάνει την είσοδο εκπαίδευση και παράγει ένα αποτέλεσμα εκπαίδευση (αρχείο iLearner). Τη δραστηριότητα Azure ML ενημέρωση πόρων λαμβάνει αυτό το αποτέλεσμα εκπαίδευση και ενημερώνει το μοντέλο στο βαθμολογίας τελικού σημείου υπηρεσίας web. Τη δραστηριότητα πόρων Update δεν δημιουργεί κανένα αποτέλεσμα. Το placeholderBlob είναι απλώς ένα σύνολο δεδομένων εικονική εξόδου που απαιτείται από την υπηρεσία Azure εργοστασίου δεδομένων για να εκτελέσετε τη διαδικασία. 

![Διάγραμμα δικτύου αγωγών](./media/data-factory-azure-ml-batch-execution-activity/update-activity-pipeline-diagram.png)


#### <a name="azure-blob-storage-linked-service"></a>Χώρο αποθήκευσης Blob του Azure συνδεδεμένα υπηρεσίας:
Το χώρο αποθήκευσης Azure διατηρεί τα εξής δεδομένα:

- εκπαίδευση δεδομένα. Δεδομένα εισόδου για την υπηρεσία web εκπαίδευση Azure ML.  
- αρχείο iLearner. Το αποτέλεσμα από την υπηρεσία web εκπαίδευση Azure ML. Αυτό το αρχείο είναι επίσης την είσοδο με τη δραστηριότητα πόρος ενημέρωσης.  
   
Εδώ είναι ο ορισμός JSON δείγμα της συνδεδεμένων υπηρεσίας: 

    {
        "name": "StorageLinkedService",
        "properties": {
            "type": "AzureStorage",
            "typeProperties": {
                "connectionString": "DefaultEndpointsProtocol=https;AccountName=name;AccountKey=key"
            }
        }
    }


#### <a name="training-input-dataset"></a>Σύνολο δεδομένων εισαγωγής εκπαίδευση:
Το παρακάτω dataset αντιπροσωπεύει τα δεδομένα εισαγωγής εκπαίδευση για την υπηρεσία web εκπαίδευση Azure ML. Η δραστηριότητα Azure ML δέσμη εκτέλεσης μεταφέρει σε αυτό το σύνολο δεδομένων ως εισαγωγή. 

    {
        "name": "trainingData",
        "properties": {
            "type": "AzureBlob",
            "linkedServiceName": "StorageLinkedService",
            "typeProperties": {
                "folderPath": "labeledexamples",
                "fileName": "labeledexamples.arff",
                "format": {
                    "type": "TextFormat"
                }
            },
            "availability": {
                "frequency": "Week",
                "interval": 1
            },
            "policy": {          
                "externalData": {
                    "retryInterval": "00:01:00",
                    "retryTimeout": "00:10:00",
                    "maximumRetry": 3
                }
            }
        }
    }

#### <a name="training-output-dataset"></a>Σύνολο δεδομένων εξόδου εκπαίδευση:
Το παρακάτω dataset αντιπροσωπεύει το αρχείο εξόδου iLearner από την υπηρεσία web εκπαίδευση Azure ML. Η δραστηριότητα Azure ML δέσμη εκτέλεσης υπολογίζονται σε αυτό το σύνολο δεδομένων. Σε αυτό το σύνολο δεδομένων είναι επίσης την είσοδο με τη δραστηριότητα Azure ML ενημέρωση πόρων.

    {
        "name": "trainedModelBlob",
        "properties": {
            "type": "AzureBlob",
            "linkedServiceName": "StorageLinkedService",
            "typeProperties": {
                "folderPath": "trainingoutput",
                "fileName": "model.ilearner",
                "format": {
                    "type": "TextFormat"
                }
            },
            "availability": {
                "frequency": "Week",
                "interval": 1
            }
        }
    }

#### <a name="linked-service-for-azure-ml-training-endpoint"></a>Συνδεδεμένο υπηρεσίας για το τελικό εκπαίδευση Azure ML 
Το παρακάτω τμήμα κώδικα JSON καθορίζει μια υπηρεσία Azure μηχανικής εκμάθησης συνδεδεμένες που δείχνει το προεπιλεγμένο τελικό σημείο της υπηρεσίας web εκπαίδευσης. 

    {   
        "name": "trainingEndpoint",
        "properties": {
            "type": "AzureML",
            "typeProperties": {
                "mlEndpoint": "https://ussouthcentral.services.azureml.net/workspaces/xxx/services/--training experiment--/jobs",
                "apiKey": "myKey"
            }
        }
    }

**Azure ML Studio**, κάντε τα εξής για να λάβετε τιμές για **mlEndpoint** και **apiKey**:

1. Κάντε κλικ στην επιλογή **ΥΠΗΡΕΣΊΕΣ WEB** από το αριστερό μενού.
2. Κάντε κλικ στην **υπηρεσία web εκπαίδευσης** στη λίστα των υπηρεσιών web. 
3. Κάντε κλικ στο κουμπί Αντιγραφή δίπλα στο πλαίσιο κειμένου **API του αριθμού-κλειδιού** . Επικολλήστε τον αριθμό-κλειδί στο Πρόχειρο στο πρόγραμμα επεξεργασίας δεδομένων JSON Factory.
4. Στο **Azure ML studio**, κάντε κλικ στην επιλογή σύνδεση **ΕΚΤΈΛΕΣΗΣ ΔΈΣΜΗΣ** .
5. Αντιγράψτε την **Αίτηση URI** από την ενότητα **αίτηση** και επικολλήστε το στο πρόγραμμα επεξεργασίας δεδομένων JSON Factory.   


#### <a name="linked-service-for-azure-ml-updatable-scoring-endpoint"></a>Συνδεδεμένο υπηρεσίας για το τελικό σημείο βαθμολογίας με δυνατότητα ενημέρωσης Azure ML:
Το παρακάτω τμήμα κώδικα JSON καθορίζει μια υπηρεσία Azure μηχανικής εκμάθησης συνδεδεμένες που οδηγεί στο τελικό σημείο μη προεπιλεγμένες ενημέρωσης της βαθμολογίας υπηρεσίας web.  

    {
        "name": "updatableScoringEndpoint2",
        "properties": {
            "type": "AzureML",
            "typeProperties": {
                "mlEndpoint": "https://ussouthcentral.services.azureml.net/workspaces/xxx/services/--scoring experiment--/jobs",
                "apiKey": "endpoint2Key",
                "updateResourceEndpoint": "https://management.azureml.net/workspaces/xxx/webservices/--scoring experiment--/endpoints/endpoint2"
            }
        }
    }


Πριν από τη δημιουργία και την ανάπτυξη μιας ML Azure συνδεδεμένο υπηρεσίας, ακολουθήστε τα βήματα στο άρθρο [Δημιουργία τελικά σημεία](../machine-learning/machine-learning-create-endpoint.md) για να δημιουργήσετε ένα δεύτερο (μη προεπιλεγμένες και ενημέρωσης) τελικό σημείο για την υπηρεσία web βαθμολογίας.

Αφού δημιουργήσετε το τελικό σημείο ενημέρωσης μη προεπιλεγμένες, κάντε τα εξής:

- Κάντε κλικ στην επιλογή **ΕΚΤΈΛΕΣΗ ενεργειών ΔΈΣΜΗΣ** για να λάβετε την τιμή URI για την ιδιότητα JSON **mlEndpoint** .
- Κάντε κλικ στην επιλογή σύνδεση **ΠΌΡΩΝ UPDATE** για να λάβετε την τιμή URI για την ιδιότητα JSON **updateResourceEndpoint** . Το κλειδί API είναι στην τελικού σημείου ίδια τη σελίδα (στην κάτω δεξιά γωνία). 

![δυνατότητα ενημέρωσης τελικού σημείου](./media/data-factory-azure-ml-batch-execution-activity/updatable-endpoint.png)

 
#### <a name="placeholder-output-dataset"></a>Σύνολο δεδομένων εξόδου κράτησης θέσης:
Τη δραστηριότητα πόρος ενημέρωσης ML Azure παράγει κανένα αποτέλεσμα. Ωστόσο, Azure εργοστασίου δεδομένων απαιτεί ένα σύνολο δεδομένων εξόδου να καθοδηγούν το χρονοδιάγραμμα των μια διαδικασία. Επομένως, χρησιμοποιούμε ένα σύνολο δεδομένων ανδρεικέλου/κράτησης θέσης σε αυτό το παράδειγμα.  

    {
        "name": "placeholderBlob",
        "properties": {
            "availability": {
                "frequency": "Week",
                "interval": 1
            },
            "type": "AzureBlob",
            "linkedServiceName": "StorageLinkedService",
            "typeProperties": {
                "folderPath": "any",
                "format": {
                    "type": "TextFormat"
                }
            }
        }
    }


#### <a name="pipeline"></a>Διοχέτευση
Η διαδικασία περιλαμβάνει δύο δραστηριότητες: **AzureMLBatchExecution** και **AzureMLUpdateResource**. Η δραστηριότητα Azure ML δέσμη εκτέλεσης λαμβάνει τα δεδομένα εκπαίδευση ως είσοδο και δημιουργεί ένα αρχείο iLearner ως το αποτέλεσμα. Τη δραστηριότητα ενεργοποιεί την υπηρεσία web εκπαίδευσης (εκπαίδευση έρευνας που εκτίθεται ως υπηρεσία web) με τα δεδομένα εισαγωγής εκπαίδευση και λαμβάνει το αρχείο ilearner από το webservice. Το placeholderBlob είναι απλώς ένα σύνολο δεδομένων εικονική εξόδου που απαιτείται από την υπηρεσία Azure εργοστασίου δεδομένων για να εκτελέσετε τη διαδικασία. 

![Διάγραμμα δικτύου αγωγών](./media/data-factory-azure-ml-batch-execution-activity/update-activity-pipeline-diagram.png)


    {
        "name": "pipeline",
        "properties": {
            "activities": [
                {
                    "name": "retraining",
                    "type": "AzureMLBatchExecution",
                    "inputs": [
                        {
                            "name": "trainingData"
                        }
                    ],
                    "outputs": [
                        {
                            "name": "trainedModelBlob"
                        }
                    ],
                    "typeProperties": {
                        "webServiceInput": "trainingData",
                        "webServiceOutputs": {
                            "output1": "trainedModelBlob"
                        }              
                     },
                    "linkedServiceName": "trainingEndpoint",
                    "policy": {
                        "concurrency": 1,
                        "executionPriorityOrder": "NewestFirst",
                        "retry": 1,
                        "timeout": "02:00:00"
                    }
                },
                {
                    "type": "AzureMLUpdateResource",
                    "typeProperties": {
                        "trainedModelName": "Training Exp for ADF ML [trained model]",
                        "trainedModelDatasetName" :  "trainedModelBlob"
                    },
                    "inputs": [
                        {
                            "name": "trainedModelBlob"
                        }
                    ],
                    "outputs": [
                        {
                            "name": "placeholderBlob"
                        }
                    ],
                    "policy": {
                        "timeout": "01:00:00",
                        "concurrency": 1,
                        "retry": 3
                    },
                    "name": "AzureML Update Resource",
                    "linkedServiceName": "updatableScoringEndpoint2"
                }
            ],
            "start": "2016-02-13T00:00:00Z",
            "end": "2016-02-14T00:00:00Z"
        }
    }


### <a name="reader-and-writer-modules"></a>Πρόγραμμα ανάγνωσης και εγγραφής λειτουργικές μονάδες

Ένα συνηθισμένο σενάριο για τη χρήση των παραμέτρων της υπηρεσίας Web είναι τη χρήση προγραμμάτων ανάγνωσης SQL Azure και συντάκτες. Τη λειτουργική μονάδα ανάγνωσης χρησιμοποιείται για τη φόρτωση των δεδομένων σε μια έρευνα από τις υπηρεσίες διαχείρισης δεδομένων εκτός του Azure μηχανικής εκμάθησης Studio. Η λειτουργική μονάδα εγγραφής είναι να αποθηκεύσετε τα δεδομένα από τις δοκιμές σε υπηρεσίες διαχείρισης δεδομένων εκτός του Azure μηχανικής εκμάθησης Studio.  

Για λεπτομέρειες σχετικά με το πρόγραμμα ανάγνωσης/εγγραφής Azure Blob/Azure SQL, ανατρέξτε στο θέμα θέματα της [ανάγνωσης](https://msdn.microsoft.com/library/azure/dn905997.aspx) και [εγγραφής](https://msdn.microsoft.com/library/azure/dn905984.aspx) στη βιβλιοθήκη MSDN. Το παράδειγμα στην προηγούμενη ενότητα χρησιμοποιείται το Azure Blob ανάγνωσης και εγγραφής αντικειμένων Blob του Azure. Αυτή η ενότητα ασχολείται με χρήση Azure SQL ανάγνωσης και εγγραφής Azure SQL.


## <a name="frequently-asked-questions"></a>Συνήθεις ερωτήσεις

**Q:** Έχω πολλαπλά αρχεία που δημιουργούνται από μου αγωγούς μεγάλο δεδομένων. Μπορώ να χρησιμοποιήσω τη δραστηριότητα AzureMLBatchExecution σε όλα τα αρχεία;

**A:** Ναι. Ανατρέξτε στην ενότητα **Χρήση λειτουργικής μονάδας ανάγνωσης για την ανάγνωση δεδομένων από πολλά αρχεία στο αντικειμένων Blob του Azure** για λεπτομέρειες. 

## <a name="azure-ml-batch-scoring-activity"></a>Δραστηριότητα βαθμολογίας Azure ML δέσμης
Εάν χρησιμοποιείτε τη δραστηριότητα **AzureMLBatchScoring** για την ενοποίηση με το Azure μηχανικής εκμάθησης, συνιστάται να χρησιμοποιείτε την πιο πρόσφατη δραστηριότητα **AzureMLBatchExecution** . 

Εισάγεται η δραστηριότητα AzureMLBatchExecution στην έκδοση Αυγούστου 2015 Azure SDK και Azure PowerShell.

Εάν θέλετε να συνεχίσετε να χρησιμοποιείτε τη δραστηριότητα AzureMLBatchScoring, συνεχίστε να διαβάζετε μέσω αυτής της ενότητας.  

### <a name="azure-ml-batch-scoring-activity-using-azure-storage-for-inputoutput"></a>Azure δραστηριότητας βαθμολογίας δέσμη ML με χρήση του χώρου αποθήκευσης Azure για εισόδου/εξόδου 

    {
      "name": "PredictivePipeline",
      "properties": {
        "description": "use AzureML model",
        "activities": [
          {
            "name": "MLActivity",
            "type": "AzureMLBatchScoring",
            "description": "prediction analysis on batch input",
            "inputs": [
              {
                "name": "ScoringInputBlob"
              }
            ],
            "outputs": [
              {
                "name": "ScoringResultBlob"
              }
            ],
            "linkedServiceName": "MyAzureMLLinkedService",
            "policy": {
              "concurrency": 3,
              "executionPriorityOrder": "NewestFirst",
              "retry": 1,
              "timeout": "02:00:00"
            }
          }
        ],
        "start": "2016-02-13T00:00:00Z",
        "end": "2016-02-14T00:00:00Z"
      }
    }

### <a name="web-service-parameters"></a>Παράμετροι υπηρεσίας Web
Για να καθορίσετε τιμές για τις παραμέτρους της υπηρεσίας Web, προσθέστε μια ενότητα **typeProperties** στην ενότητα **AzureMLBatchScoringActivty** στη διοχέτευση JSON όπως φαίνεται στο ακόλουθο παράδειγμα: 

    "typeProperties": {
        "webServiceParameters": {
            "Param 1": "Value 1",
            "Param 2": "Value 2"
        }
    }


Μπορείτε επίσης να χρησιμοποιήσετε [Συναρτήσεις εργοστασίου δεδομένων](https://msdn.microsoft.com/library/dn835056.aspx) στο διέρχεται τιμές για τις παραμέτρους της υπηρεσίας Web όπως φαίνεται στο ακόλουθο παράδειγμα:

    "typeProperties": {
        "webServiceParameters": {
           "Database query": "$$Text.Format('SELECT * FROM myTable WHERE timeColumn = \\'{0:yyyy-MM-dd HH:mm:ss}\\'', Time.AddHours(WindowStart, 0))"
        }
    }
 
> [AZURE.NOTE] Οι παράμετροι της υπηρεσίας Web διάκριση πεζών-κεφαλαίων, επομένως, βεβαιωθείτε ότι τα ονόματα που καθορίζετε στη δραστηριότητα JSON συμφωνούν με αυτά που εκτίθεται από την υπηρεσία Web. 

## <a name="see-also"></a>Δείτε επίσης

- [Δημοσίευση ιστολογίου Azure: γρήγορα αποτελέσματα με το Azure δεδομένων εργοστασίου και εκμάθηση μηχανικής Azure](https://azure.microsoft.com/blog/getting-started-with-azure-data-factory-and-azure-machine-learning-4/)





[adf-build-1st-pipeline]: data-factory-build-your-first-pipeline.md

[azure-machine-learning]: http://azure.microsoft.com/services/machine-learning/


 

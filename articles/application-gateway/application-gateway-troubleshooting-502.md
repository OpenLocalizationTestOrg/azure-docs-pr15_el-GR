<properties
   pageTitle="Αντιμετώπιση σφαλμάτων εφαρμογής πύλης εσφαλμένη πύλη (502) | Microsoft Azure"
   description="Μάθετε πώς μπορείτε να αντιμετωπίσετε τα σφάλματα 502 πύλης εφαρμογής"
   services="application-gateway"
   documentationCenter="na"
   authors="amitsriva"
   manager="rossort"
   editor=""
   tags="azure-resource-manager"
/>
<tags  
   ms.service="application-gateway"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="infrastructure-services"
   ms.date="09/02/2016"
   ms.author="amitsriva" />

# <a name="troubleshooting-bad-gateway-errors-in-application-gateway"></a>Αντιμετώπιση σφαλμάτων εσφαλμένη πύλη στην πύλη εφαρμογής

## <a name="overview"></a>Επισκόπηση

Αφού ρυθμίσετε μια πύλη εφαρμογής Azure, ένα από τα σφάλματα που μπορεί να αντιμετωπίσετε χρήστες είναι "σφάλμα διακομιστή: 502 - διακομιστή Web έλαβε μη έγκυρη απόκριση ενώ, ως μια πύλη ή διακομιστή μεσολάβησης". Αυτό μπορεί να συμβεί τους ακόλουθους κύριο λόγους:

- Χώρος συγκέντρωσης παρασκηνίου Azure πύλη εφαρμογής δεν έχει ρυθμιστεί ή κενό.
- Καμία του ΣΠΣ ή παρουσίες του συνόλου κλίμακα Εικονική δεν είναι σε καλή κατάσταση.
- Για τη δοκιμή του προεπιλεγμένου εύρυθμης λειτουργίας δεν ανταποκρίνεται ΣΠΣ ή παρουσίες του συνόλου κλίμακα Εικονική παρασκηνίου.
- Δεν είναι έγκυρη ή εσφαλμένη ρύθμιση των παραμέτρων του καθετήρες προσαρμοσμένο εύρυθμης λειτουργίας.
- Αίτηση χρονικού ορίου ή αντιμετωπίζετε προβλήματα συνδεσιμότητας με αιτήσεις χρήστη.

## <a name="empty-backendaddresspool"></a>Κενή BackendAddressPool

### <a name="cause"></a>Αιτία

Εάν η πύλη εφαρμογής δεν έχει ΣΠΣ ή Εικονική κλίμακα που έχει ρυθμιστεί στο χώρο συγκέντρωσης διεύθυνση παρασκηνίου, δεν είναι δυνατή η δρομολόγηση οποιαδήποτε αίτηση πελατών και εμφανίζει ένα σφάλμα εσφαλμένη πύλη.

### <a name="solution"></a>Λύση

Βεβαιωθείτε ότι το σύνολο των διευθύνσεων παρασκηνίου δεν είναι κενή. Αυτό μπορεί να γίνει είτε μέσω του PowerShell, CLI ή πύλη.

    Get-AzureRmApplicationGateway -Name "SampleGateway" -ResourceGroupName "ExampleResourceGroup"

Το αποτέλεσμα από το προηγούμενο cmdlet πρέπει να περιέχει μη κενή παρασκηνίου διεύθυνση χώρου συγκέντρωσης. Ακολουθεί ένα παράδειγμα όπου δύο σύνολα επιστρέφονται που έχουν ρυθμιστεί με διευθύνσεις FQDN ή IP για παρασκηνίου ΣΠΣ. Της παροχής κατάστασης του BackendAddressPool πρέπει να είναι 'ολοκληρώθηκε με επιτυχία".
    
    BackendAddressPoolsText: 
            [{
                "BackendAddresses": [{
                    "ipAddress": "10.0.0.10",
                    "ipAddress": "10.0.0.11"
                }],
                "BackendIpConfigurations": [],
                "ProvisioningState": "Succeeded",
                "Name": "Pool01",
                "Etag": "W/\"00000000-0000-0000-0000-000000000000\"",
                "Id": "/subscriptions/<subscription id>/resourceGroups/<resource group name>/providers/Microsoft.Network/applicationGateways/<application gateway name>/backendAddressPools/pool01"
            }, {
                "BackendAddresses": [{
                    "Fqdn": "xyx.cloudapp.net",
                    "Fqdn": "abc.cloudapp.net"
                }],
                "BackendIpConfigurations": [],
                "ProvisioningState": "Succeeded",
                "Name": "Pool02",
                "Etag": "W/\"00000000-0000-0000-0000-000000000000\"",
                "Id": "/subscriptions/<subscription id>/resourceGroups/<resource group name>/providers/Microsoft.Network/applicationGateways/<application gateway name>/backendAddressPools/pool02"
            }]


## <a name="unhealthy-instances-in-backendaddresspool"></a>Κατεστραμμένη παρουσιών στο BackendAddressPool

### <a name="cause"></a>Αιτία

Εάν όλες οι εμφανίσεις της BackendAddressPool είναι κατεστραμμένη, στη συνέχεια, τα πύλη εφαρμογής δεν θα έχει τυχόν παρασκηνίου για δρομολόγηση αίτησης του χρήστη για να. Επίσης, αυτό μπορεί να συμβαίνει όταν παρασκηνίου παρουσίες είναι σε καλή κατάσταση αλλά δεν έχετε την απαραίτητη εφαρμογή αναπτυχθεί.

### <a name="solution"></a>Λύση

Βεβαιωθείτε ότι οι εμφανίσεις είναι σε καλή κατάσταση και η εφαρμογή έχει ρυθμιστεί σωστά. Ελέγξτε εάν μπορείτε να απαντήσετε σε μια εντολή ping από μια άλλη Εικονική στα το ίδιο VNet τις παρουσίες παρασκηνίου. Εάν έχουν ρυθμιστεί με μια δημόσια τελικού σημείου, βεβαιωθείτε ότι η αίτηση ενός προγράμματος περιήγησης στην εφαρμογή web είναι δυνατότητα συντήρησης.

## <a name="problems-with-default-health-probe"></a>Προβλήματα με τη δοκιμή του προεπιλεγμένου εύρυθμης λειτουργίας

### <a name="cause"></a>Αιτία

502 σφάλματα μπορεί επίσης να συχνές ενδείξεις ότι η δοκιμή του προεπιλεγμένου εύρυθμης λειτουργίας δεν μπορούν να αποκτήσουν ΣΠΣ παρασκηνίου. Όταν παρέχεται μια παρουσία πύλη εφαρμογής, ρυθμίζει αυτόματα μια δοκιμή του εύρυθμης λειτουργίας προεπιλογή για κάθε BackendAddressPool χρησιμοποιώντας τις ιδιότητες από την BackendHttpSetting. Εισαγωγή από το χρήστη δεν είναι απαραίτητη για να ορίσετε αυτήν τη δοκιμή του. Συγκεκριμένα, όταν μια φόρτωση εξισορρόπηση κανόνας έχει ρυθμιστεί, γίνεται μια συσχέτιση μεταξύ BackendHttpSetting και BackendAddressPool. Μια δοκιμή του προεπιλεγμένου έχει ρυθμιστεί για κάθε μία από αυτές τις συσχετίσεων και πύλη εφαρμογής ξεκινά μια σύνδεση ελέγχου περιοδικό εύρυθμης λειτουργίας για κάθε παρουσία στο το BackendAddressPool στη θύρα που καθορίζεται στο στοιχείο BackendHttpSetting. Πίνακας που ακολουθεί παραθέτει τις τιμές που σχετίζονται με τη δοκιμή του προεπιλεγμένου εύρυθμης λειτουργίας.


|Δοκιμή του ιδιότητα | Τιμή | Περιγραφή|
|---|---|---|
| Δοκιμή του διεύθυνσης URL| http://127.0.0.1/ | Διαδρομή διεύθυνσης URL |
| Χρονικό διάστημα | 30 | Δοκιμή του χρονικού διαστήματος σε δευτερόλεπτα |
| Λήξη χρονικού ορίου  | 30 | Δοκιμή του χρονικού ορίου σε δευτερόλεπτα |
| Κατεστραμμένη όριο | 3 | Διερεύνηση των επαναλήψεων. Ο διακομιστής παρασκηνίου έχει επισημανθεί ως προς τα κάτω αφού η καταμέτρηση αποτυχιών διαδοχικές δοκιμή του φτάσει το όριο κατεστραμμένες. |

### <a name="solution"></a>Λύση

- Βεβαιωθείτε ότι η προεπιλεγμένη τοποθεσία έχει ρυθμιστεί και πραγματοποιεί ακρόαση στο 127.0.0.1.
- Εάν BackendHttpSetting καθορίζει μια θύρα εκτός από 80, της προεπιλεγμένης τοποθεσίας θα πρέπει να είναι διαμορφωμένη για να ακούσετε σε αυτήν τη θύρα.
- Την κλήση σε http://127.0.0.1:port πρέπει να επιστρέφουν έναν κωδικό αποτέλεσμα HTTP από 200. Αυτό πρέπει να επιστρέφεται μέσα στο χρονικό 30 δευτερόλεπτα.
- Βεβαιωθείτε ότι η ρύθμιση παραμέτρων θύρας είναι ανοιχτό και ότι δεν υπάρχουν κανόνες τείχους προστασίας ή ομάδες ασφαλείας δικτύου Azure, οι οποίες αποκλεισμός Εισερχόμενα ή εξερχόμενα κυκλοφορία στη θύρα έχει ρυθμιστεί.
- Εάν Azure κλασική ΣΠΣ ή μια υπηρεσία Cloud χρησιμοποιείται με το FQDN ή δημόσια IP, βεβαιωθείτε ότι το αντίστοιχο ανοίγει [τελικού σημείου](../virtual-machines/virtual-machines-windows-classic-setup-endpoints.md) .
- Εάν η Εικονική έχει ρυθμιστεί μέσω της διαχείρισης πόρων Azure και είναι εκτός του VNet όπου έχει αναπτυχθεί πύλη εφαρμογής, [Ομάδα ασφαλείας δικτύου](../virtual-network/virtual-networks-nsg.md) πρέπει να ρυθμιστεί για να επιτρέψετε την πρόσβαση στην επιθυμητή θύρα.


## <a name="problems-with-custom-health-probe"></a>Προβλήματα με τη δοκιμή του προσαρμοσμένου εύρυθμης λειτουργίας

### <a name="cause"></a>Αιτία

Προσαρμοσμένη εύρυθμης λειτουργίας καθετήρες επιτρέπουν επιπλέον ευελιξία για την προεπιλεγμένη συμπεριφορά Διερεύνηση. Κατά τη χρήση προσαρμοσμένης καθετήρες, οι χρήστες να ρυθμίσετε τις παραμέτρους του χρονικού διαστήματος δοκιμή του, τη διεύθυνση URL, και διαδρομή για να ελέγξετε και πόσες αποτυχίας απαντήσεων για να αποδεχτείτε πριν από τη σήμανση την παρουσία του χώρου συγκέντρωσης παρασκηνίου ως κατεστραμμένο. Προστίθενται οι ακόλουθες πρόσθετες ιδιότητες.

|Δοκιμή του ιδιότητα| Περιγραφή|
|---|---|
| Όνομα | Όνομα της τη διερεύνηση. Αυτό το όνομα χρησιμοποιείται για να ανατρέξετε στις τη διερεύνηση στις ρυθμίσεις HTTP παρασκηνίου. |
| Πρωτόκολλο | Πρωτόκολλο που χρησιμοποιείται για να στείλετε τη διερεύνηση. Η δοκιμή του θα χρησιμοποιήσει το πρωτόκολλο που καθορίζεται στις ρυθμίσεις HTTP παρασκηνίου |
| Κεντρικός υπολογιστής |  Όνομα κεντρικού υπολογιστή για να στείλετε τη διερεύνηση. Ισχύει μόνο όταν πολλών τοποθεσιών έχει ρυθμιστεί στην πύλη εφαρμογής. Αυτό είναι διαφορετικό από το όνομα κεντρικού υπολογιστή Εικονική.  |
| Διαδρομή | Σχετική διαδρομή του τη διερεύνηση. Η διαδρομή έγκυρη ξεκινά από '/'. Αποστέλλεται η δοκιμή του \<πρωτόκολλο\>://\<host\>:\<θύρα\>\<διαδρομή\> |
| Χρονικό διάστημα | Διερεύνηση χρονικού διαστήματος σε δευτερόλεπτα. Αυτό είναι το χρονικό διάστημα μεταξύ των δύο διαδοχικές καθετήρες.|
| Λήξη χρονικού ορίου | Διερεύνηση λήξης χρονικού ορίου σε δευτερόλεπτα. Η δοκιμή του επισημαίνεται ως απέτυχε εάν μια έγκυρη απόκριση δεν ληφθεί σε αυτό το χρονικό. |
| Κατεστραμμένη όριο | Διερεύνηση των επαναλήψεων. Ο διακομιστής παρασκηνίου έχει επισημανθεί ως προς τα κάτω αφού η καταμέτρηση αποτυχιών διαδοχικές δοκιμή του φτάσει το όριο κατεστραμμένες. |


### <a name="solution"></a>Λύση

Επαλήθευση ότι η διερεύνηση εύρυθμης λειτουργίας προσαρμοσμένη έχει ρυθμιστεί σωστά με το προηγούμενο πίνακα. Εκτός από τα προηγούμενα βήματα αντιμετώπισης προβλημάτων, βεβαιωθείτε επίσης τα εξής:

- Βεβαιωθείτε ότι η δοκιμή του έχει οριστεί σωστά σύμφωνα με τον [Οδηγό](application-gateway-create-probe-ps.md).
- Εάν πύλη εφαρμογής έχει ρυθμιστεί για μια μεμονωμένη τοποθεσία, από προεπιλογή ο κεντρικός υπολογιστής όνομα πρέπει να καθορίζεται ως "127.0.0.1", εκτός εάν διαφορετικά έχει ρυθμιστεί στο προσαρμοσμένο δοκιμή του.
- Βεβαιωθείτε ότι μια κλήση σε http://\<host\>:\<θύρα\>\<διαδρομή\> επιστρέφει έναν κωδικό αποτέλεσμα HTTP από 200.
- Βεβαιωθείτε ότι χρονικό διάστημα, λήξης χρονικού ορίου και UnhealtyThreshold μέσα στις περιοχές αποδεκτή.

## <a name="request-time-out"></a>Αίτηση χρονικού ορίου

### <a name="cause"></a>Αιτία

Όταν λαμβάνεται μια αίτηση χρήστη, πύλη εφαρμογής εφαρμόζει τους κανόνες που έχει ρυθμιστεί για την αίτηση και δρομολογεί σε μια παρουσία χώρου συγκέντρωσης παρασκηνίου. Αναμένει για ένα διάστημα με δυνατότητα ρύθμισης παραμέτρων του χρόνου για μια απάντηση από την παρουσία παρασκηνίου. Από προεπιλογή, αυτό το χρονικό διάστημα είναι **30 δευτερόλεπτα**. Εάν πύλη εφαρμογής δεν λαμβάνετε μια απάντηση από εφαρμογή παρασκηνίου σε αυτό το χρονικό διάστημα, αίτησης του χρήστη θα δείτε ένα σφάλμα 502.

### <a name="solution"></a>Λύση

Πύλη εφαρμογής επιτρέπει στους χρήστες να αυτήν τη ρύθμιση μέσω BackendHttpSetting, τα οποία μπορούν να εφαρμοστούν, στη συνέχεια, σε διαφορετικά σύνολα. Διαφορετικά σύνολα παρασκηνίου μπορεί να έχει διαφορετικό BackendHttpSetting και επομένως διαφορετικό αίτηση λήξει το χρονικό όριο έχει ρυθμιστεί.

    New-AzureRmApplicationGatewayBackendHttpSettings -Name 'Setting01' -Port 80 -Protocol Http -CookieBasedAffinity Enabled -RequestTimeout 60

## <a name="next-steps"></a>Επόμενα βήματα

Εάν τα προηγούμενα βήματα δεν επιλύσουν το πρόβλημα, ανοίξτε μια [δελτίων υποστήριξης](https://azure.microsoft.com/support/options/).

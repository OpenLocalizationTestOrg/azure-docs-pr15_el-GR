<properties
   pageTitle="Πρόγραμμα εκμάθησης: Επεξεργασία EDIFACT τιμολόγια, χρήση των υπηρεσιών Azure BizTalk | Υπηρεσίες BizTalk Microsoft Azure"
   description="Πώς μπορείτε να δημιουργήσετε και ρυθμίσετε τις παραμέτρους της εφαρμογής σύνδεσης πλαίσιο ή API και χρησιμοποιήστε το σε μια εφαρμογή λογικής στο Azure εφαρμογής υπηρεσίας"
   services="logic-apps"
   documentationCenter=".net,nodejs,java"
   authors="msftman"
   manager="erikre"
   editor=""/>

<tags
   ms.service="logic-apps"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="integration"
   ms.date="05/31/2016"
   ms.author="deonhe"/>

# <a name="tutorial-process-edifact-invoices-using-azure-biztalk-services"></a>Πρόγραμμα εκμάθησης: Διαδικασία EDIFACT τιμολόγια χρησιμοποιώντας τις υπηρεσίες BizTalk Azure
Μπορείτε να χρησιμοποιήσετε την πύλη υπηρεσιών BizTalk για ρύθμιση παραμέτρων και την ανάπτυξη X12 και τις συμβάσεις EDIFACT. Σε αυτό το πρόγραμμα εκμάθησης, δείτε πώς μπορείτε να δημιουργήσετε μια συμφωνία EDIFACT για την ανταλλαγή τιμολογίων μεταξύ συναλλαγών συνεργάτες. Αυτό το πρόγραμμα εκμάθησης είναι γραμμένο γύρω από μια λύση για να ολοκληρωμένες επιχειρήσεις που αφορούν δύο συναλλαγών συνεργάτες, οι Northwind και Contoso EDIFACT μηνυμάτων του exchange.  

## <a name="sample-based-on-this-tutorial"></a>Δείγμα που βασίζονται σε αυτό το πρόγραμμα εκμάθησης
Αυτό το πρόγραμμα εκμάθησης είναι γραμμένο γύρω από ένα δείγμα, **Αποστολή EDIFACT τιμολόγια χρησιμοποιώντας BizTalk τις υπηρεσίες**, που είναι διαθέσιμο για λήψη από τη [Συλλογή κωδίκων MSDN](http://go.microsoft.com/fwlink/?LinkId=401005). Μπορείτε να χρησιμοποιήσετε το δείγμα και να περνούν από αυτό το πρόγραμμα εκμάθησης για να κατανοήσετε τον τρόπο που δημιουργήθηκε το δείγμα. Εναλλακτικά, μπορείτε να χρησιμοποιήσετε αυτό το πρόγραμμα εκμάθησης για να δημιουργήσετε τη δική σας λύση αρχής προς τα επάνω. Αυτό το πρόγραμμα εκμάθησης έχει στόχο τη δεύτερη προσέγγιση, έτσι ώστε να μπορείτε να κατανοήσετε τον τρόπο δημιουργήθηκε αυτήν τη λύση. Επίσης, όσο είναι δυνατό, το πρόγραμμα εκμάθησης είναι συνεπείς με το δείγμα και χρησιμοποιεί τα ίδια ονόματα για αντικείμενα (για παράδειγμα, οι διατάξεις, μετασχηματισμούς) που χρησιμοποιούνται στο δείγμα.  

>[AZURE.NOTE] Επειδή αυτή η λύση περιλαμβάνει την αποστολή ενός μηνύματος από μια γέφυρα EAI σε μια γέφυρα Επεξεργασία, χρησιμοποιούνται ξανά το δείγμα [γέφυρα υπηρεσίες BizTalk αλυσιδωτή δείγμα](http://code.msdn.microsoft.com/BizTalk-Bridge-chaining-2246b104) .  

## <a name="what-does-the-solution-do"></a>Τι κάνει η λύση;

Σε αυτήν τη λύση, Northwind λαμβάνει EDIFACT τιμολόγια από Contoso. Αυτά τα τιμολόγια δεν βρίσκονται σε μια τυπική μορφή Επεξεργασία. Επομένως, πριν να στείλετε το τιμολόγιο σε Northwind, αυτό πρέπει να είναι μετατραπεί σε ένα έγγραφο EDIFACT τιμολόγιο (ονομάζεται επίσης INVOIC). Μετά την παραλαβή, Northwind πρέπει να επεξεργαστεί το τιμολόγιο EDIFACT και επιστροφή ένα μήνυμα έλεγχος (ονομάζεται επίσης CONTRL) Contoso.

![][1]  

Για να επιτύχετε αυτό το σενάριο επιχειρήσεις, Contoso χρησιμοποιεί τις δυνατότητες που παρέχονται με το Microsoft Azure BizTalk Services.

*   Contoso χρησιμοποιεί γέφυρες EAI για να μετατρέψετε το αρχικό τιμολόγιο EDIFACT INVOIC.

*   Η γέφυρα EAI, στη συνέχεια, στέλνει το μήνυμα σε μια γέφυρα αποστολή Επεξεργασία αναπτυχθεί ως μέρος μιας σύμβασης έχει ρυθμιστεί στην πύλη του BizTalk υπηρεσίες.

*   Η Επεξεργασία γέφυρα αποστολή επεξεργάζεται το INVOIC EDIFACT και δρομολογεί στον Northwind.

*   Μετά τη λήψη του τιμολογίου, επιστρέφει Northwind CONTRL ένα μήνυμα για την Επεξεργασία λαμβάνουν γέφυρα αναπτυχθεί ως μέρος της συμφωνίας.  

> [AZURE.NOTE] Προαιρετικά, αυτή η λύση επίσης παρουσιάζει πώς μπορείτε να χρησιμοποιήσετε δέσμης για να στείλετε τα τιμολόγια σε δέσμες, αντί να στέλνετε ξεχωριστά κάθε τιμολόγιο.  

Για να ολοκληρώσετε το σενάριο, χρησιμοποιούμε ουρές Bus υπηρεσίας για να στείλετε ένα τιμολόγιο από Contoso Northwind ή να λάβετε βεβαίωση λήψης από Northwind. Αυτές οι ουρές μπορούν να δημιουργηθούν χρησιμοποιώντας μια εφαρμογή προγράμματος-πελάτη, το οποίο είναι διαθέσιμο ως στοιχείο λήψης και περιλαμβάνεται στο πακέτο του δείγματος που είναι διαθέσιμα ως μέρος αυτού του προγράμματος εκμάθησης.  

## <a name="prerequisites"></a>Προαπαιτούμενα στοιχεία

*   Πρέπει να έχετε ένα χώρο ονομάτων Bus υπηρεσίας. Για οδηγίες σχετικά με τη δημιουργία ενός χώρου ονομάτων, ανατρέξτε στο θέμα [How To: δημιουργία ή τροποποίηση ενός Namespace υπηρεσίας Bus υπηρεσίας](https://msdn.microsoft.com/library/azure/hh674478.aspx). Ας υποθέσουμε ότι έχετε ήδη ένα χώρο ονομάτων Bus υπηρεσία παροχή της υπηρεσίας, που ονομάζεται **edifactbts**.

*   Πρέπει να έχετε μια συνδρομή BizTalk υπηρεσίες. Για οδηγίες, ανατρέξτε στο θέμα [Δημιουργία μιας υπηρεσίας BizTalk με Azure κλασική πύλη](http://go.microsoft.com/fwlink/?LinkID=302280). Για αυτό το πρόγραμμα εκμάθησης, ας υποθέσουμε ότι έχετε μια συνδρομή BizTalk υπηρεσίες, που ονομάζεται **contosowabs**.

*   Καταχωρήστε τη συνδρομή σας BizTalk υπηρεσιών στην πύλη υπηρεσιών BizTalk. Για οδηγίες, ανατρέξτε στο θέμα [την καταχώρηση μιας ανάπτυξης BizTalk υπηρεσίας στην πύλη υπηρεσιών BizTalk](https://msdn.microsoft.com/library/hh689837.aspx)

*   Πρέπει να έχετε εγκατεστημένο το Visual Studio.

*   Πρέπει να έχετε BizTalk υπηρεσίες SDK εγκατεστημένο. Μπορείτε να κάνετε λήψη του SDK από [http://go.microsoft.com/fwlink/?LinkId=235057](http://go.microsoft.com/fwlink/?LinkId=235057)  

## <a name="step-1-create-the-service-bus-queues"></a>Βήμα 1: Δημιουργία τις ουρές Bus υπηρεσίας  
Αυτή η λύση χρησιμοποιεί ουρές Bus υπηρεσία για την ανταλλαγή μηνυμάτων μεταξύ συναλλαγών συνεργάτες. Το Contoso και Northwind στέλνει μηνύματα στις ουρές από όπου το EAI ή/και Επεξεργασία γέφυρες εκμετάλλευση τους. Για αυτήν τη λύση, χρειάζεστε τρεις ουρές Bus υπηρεσίας:

*   **northwindreceive** – Northwind λαμβάνει το τιμολόγιο από Contoso πάνω από αυτήν την ουρά.

*   **contosoreceive** – Contoso λαμβάνει την βεβαίωση λήψης από Northwind πάνω από αυτήν την ουρά.

*   **σε αναστολή** – όλα σε αναστολή δρομολόγησης των μηνυμάτων σε αυτήν την ουρά. Μηνύματα εξαιρούνται εάν παραλείπουν στη διάρκεια της επεξεργασίας.

Μπορείτε να δημιουργήσετε αυτές τις ουρές Bus υπηρεσία, χρησιμοποιώντας μια εφαρμογή προγράμματος-πελάτη που περιλαμβάνεται στο πακέτο δείγμα.  

1.  Από τη θέση όπου έχετε κάνει λήψη του δείγματος, ανοίξτε **Το πρόγραμμα εκμάθησης αποστολή τιμολόγια χρησιμοποιώντας BizTalk υπηρεσίες Επεξεργασία Bridges.sln**.

2.  Πατήστε το πλήκτρο **F5** να δημιουργήσετε και να ξεκινήσετε το πρόγραμμα εκμάθησης εφαρμογή **Προγράμματος-πελάτη** .

3.  Στην οθόνη, πληκτρολογήστε το χώρο ονομάτων ACS Bus υπηρεσίας, όνομα εκδότη και κλειδί εκδότη.

    ![][2]  
4.  Πλαίσιο μηνύματος ζητά ότι θα δημιουργηθούν τρεις ουρές στο σας Bus υπηρεσίας ονομάτων. Κάντε κλικ στο **κουμπί OK**.

5.  Αφήστε το πρόγραμμα-πελάτη πρόγραμμα εκμάθησης εκτελείται. Άνοιγμα, κάντε κλικ στην επιλογή **Υπηρεσία Bus** > **_το χώρο ονομάτων υπηρεσίας Bus_** > **ουρές**, και βεβαιωθείτε ότι δημιουργούνται τις τρεις ουρές.  

## <a name="step-2-create-and-deploy-trading-partner-agreement"></a>Βήμα 2: Δημιουργία και ανάπτυξη των συναλλαγών συμφωνία συνεργάτη
Δημιουργήστε μια συναλλαγών συμφωνία συνεργάτη μεταξύ Contoso και Northwind. Μια συναλλαγών συμφωνία συνεργάτη ορίζει ένα συμβόλαιο trade ανάμεσα στους δύο συνεργάτες, όπως ποιες σχήμα μηνύματος για να χρησιμοποιήσετε, ποια πρωτοκόλλου ανταλλαγής μηνυμάτων για να χρησιμοποιήσετε, κ.λπ. Μια συμφωνία με συνεργάτη συναλλαγών περιλαμβάνει δύο Επεξεργασία γέφυρες, μία για την αποστολή μηνυμάτων σε συναλλαγών συνεργάτες (που ονομάζεται η **Αποστολή Επεξεργασία bridge**) και μία για να λαμβάνετε μηνύματα από συναλλαγών συνεργάτες (που ονομάζεται τη **λήψη Επεξεργασία bridge**).

Στο πλαίσιο της αυτήν τη λύση, η γέφυρα αποστολή Επεξεργασία αντιστοιχεί στο πλάι αποστολή της συμφωνίας και χρησιμοποιείται για να στείλετε το τιμολόγιο EDIFACT από Contoso σε Northwind. Ομοίως, η γέφυρα παραλαβής Επεξεργασία αντιστοιχεί παραλαβής πλευρά της συμφωνίας και χρησιμοποιείται για την επιβεβαίωση παραλαβής από Northwind.  

### <a name="create-the-trading-partners"></a>Δημιουργία του συναλλαγών συνεργάτες

Για να ξεκινήσετε με, δημιουργήστε συναλλαγών συνεργάτες για Contoso και Northwind.  

1.  Στην πύλη υπηρεσιών BizTalk, στην καρτέλα **συνεργάτες** , κάντε κλικ στην επιλογή **Προσθήκη**.

2.  Στη σελίδα νέα συνεργάτη, πληκτρολογήστε **Contoso** ως όνομα συνεργάτη και, στη συνέχεια, κάντε κλικ στην επιλογή **Αποθήκευση**.

3.  Επαναλάβετε το βήμα για να δημιουργήσετε το δεύτερο συνεργάτη, **Northwind**.  

### <a name="create-the-agreement"></a>Δημιουργία της συμφωνίας
Συναλλαγών συμφωνίες συνεργάτη δημιουργούνται μεταξύ προφίλ επιχειρηματικών συναλλαγών συνεργάτες. Αυτή η λύση χρησιμοποιεί τα προεπιλεγμένα προφίλ συνεργάτη που δημιουργούνται αυτόματα όταν που δημιουργήσαμε τους συνεργάτες.  

1.  Στην πύλη του BizTalk υπηρεσίες, κάντε κλικ στο κουμπί **τις συμβάσεις** > **Προσθήκη**.

2.  Στη σελίδα της νέας συμφωνίας **Γενικές ρυθμίσεις** , καθορίστε τις τιμές, όπως φαίνεται στην παρακάτω εικόνα και, στη συνέχεια, κάντε κλικ στην επιλογή **Continue**.

    ![][3]  

    Αφού κάνετε κλικ στο κουμπί **Continue**, δύο καρτέλες, **Λαμβάνετε ρυθμίσεις** και **Ρυθμίσεις αποστολής** γίνονται διαθέσιμες.

3.  Δημιουργήστε τη συμφωνία αποστολή μεταξύ Contoso και Northwind. Η παρούσα σύμβαση καθορίζει τον τρόπο Contoso στέλνει το τιμολόγιο EDIFACT Northwind.

    1.  Κάντε κλικ στην επιλογή **Ρυθμίσεις αποστολής**.

    2.  Διατηρεί τις προεπιλεγμένες τιμές στις καρτέλες **Εισερχόμενη διεύθυνση URL**, **Μετασχηματισμός**και **Batching** .

    3.  Στην καρτέλα **πρωτόκολλο** , κάτω από την ενότητα **σχήματα** , αποστείλετε το σχήμα **EFACT_D93A_INVOIC.xsd** . Αυτό το σχήμα είναι διαθέσιμη με το πακέτο του δείγματος.

        ![][4]  
    4.  Στην καρτέλα **μεταφοράς** , καθορίστε τις λεπτομέρειες για τις ουρές Bus υπηρεσίας. Για τη συμφωνία αποστολή πλευρά, μπορούμε να χρησιμοποιήσουμε την ουρά **northwindreceive** για να στείλετε το τιμολόγιο EDIFACT Northwind και ουρά **σε αναστολή** για τη δρομολόγηση τα μηνύματα που αποτυγχάνει κατά την επεξεργασία και είναι σε αναστολή. Δημιουργήσατε αυτές τις ουρές στο **βήμα 1: δημιουργία τις ουρές Bus υπηρεσίας** (σε αυτό το θέμα).

        ![][5]  

        Στην περιοχή **Ρυθμίσεις μεταφοράς > μεταφοράς τύπου** και **ρυθμίσεων αναστολή μήνυμα > Μεταφορά τύπο**, επιλέξτε Bus υπηρεσίας Azure και παρέχουν τις τιμές, όπως φαίνεται στην εικόνα.

4.  Δημιουργήστε τη συμφωνία παραλαβής μεταξύ Contoso και Northwind. Η παρούσα σύμβαση καθορίζει τον τρόπο Contoso λαμβάνει την βεβαίωση λήψης από Northwind.

    1.  Κάντε κλικ στην επιλογή **ρυθμίσεων λήψης**.

    2.  Διατηρεί τις προεπιλεγμένες τιμές στις καρτέλες **μεταφοράς** και **Μετασχηματισμός** .

    3.  Στην καρτέλα **πρωτόκολλο** , κάτω από την ενότητα **σχήματα** , αποστείλετε το σχήμα **EFACT_4.1_CONTRL.xsd** . Αυτό το σχήμα είναι διαθέσιμη με το πακέτο του δείγματος.

    4.  Στην καρτέλα **δρομολόγηση** , δημιουργήστε ένα φίλτρο για να εξασφαλίσετε ότι μόνο επιβεβαίωση από Northwind δρομολογούνται Contoso. Στην περιοχή **Δρομολόγηση ρυθμίσεις**, κάντε κλικ στην επιλογή **Προσθήκη** για να δημιουργήσετε το φίλτρο δρομολόγησης.

        ![][6]  
        1.  Δώστε τιμές για **Το όνομα του κανόνα**, **κανόνα δρομολόγηση**και **δρομολόγηση προορισμού** , όπως φαίνεται στην εικόνα.

        2.  Κάντε κλικ στην επιλογή **Αποθήκευση**.

    5.  Στην καρτέλα **δρομολόγηση** ξανά, καθορίστε όπου δρομολογούνται σε αναστολή επιβεβαίωση (επιβεβαίωση που αποτυγχάνουν κατά την επεξεργασία). Ορισμός του τύπου μεταφοράς σε Azure Service Bus, δρομολόγηση τύπο προορισμού σε **ουρά**, ο τύπος ελέγχου ταυτότητας για να **Θέσει σε κοινή χρήση υπογραφής Access** (συσχετισμών Ασφαλείας), δώστε τη συμβολοσειρά σύνδεσης συσχετισμών Ασφαλείας για το χώρο ονομάτων Bus υπηρεσίας και, στη συνέχεια, πληκτρολογήστε το όνομα ουρά ως **σε αναστολή**.

5.  Τέλος, κάντε κλικ στην επιλογή **Ανάπτυξη** για την ανάπτυξη της συμφωνίας. Σημειώστε τα τελικά σημεία όπου η αποστολή και λήψη αναπτύσσονται τις συμβάσεις.

    *   Στην καρτέλα **Ρυθμίσεις αποστολής** , στην περιοχή **Εισερχόμενη διεύθυνση URL**, σημειώστε το τελικό σημείο. Για να στείλετε ένα μήνυμα από Contoso Northwind χρησιμοποιώντας την Επεξεργασία bridge αποστολή, που πρέπει να στείλετε ένα μήνυμα σε αυτό το τελικό σημείο.

    *   Στην καρτέλα **Λήψη ρυθμίσεις** , στην περιοχή **μεταφοράς**, σημειώστε το τελικό σημείο. Για να στείλετε ένα μήνυμα από Northwind σε Contoso χρησιμοποιώντας την Επεξεργασία λαμβάνουν bridge, πρέπει να στείλετε ένα μήνυμα σε αυτό το τελικό σημείο.  

## <a name="step-3-create-and-deploy-the-biztalk-services-project"></a>Βήμα 3: Δημιουργήστε και αναπτύξτε το έργο υπηρεσιών BizTalk

Στο προηγούμενο βήμα, αναπτυχθεί Επεξεργασία αποστολή και λήψη συμφωνίες για την επεξεργασία EDIFACT τιμολόγια και επιβεβαίωση. Αυτές οι συμφωνίες να διαδικασία μόνο τα μηνύματα που συμμορφώνεται με το τυπικό σχήμα EDIFACT στο μήνυμα. Ωστόσο, ανά το σενάριο για αυτήν τη λύση, Contoso αποστέλλει ένα τιμολόγιο Northwind σε ένα σχήμα εσωτερικά ΚΥΡΙΟΤΗΤΑΣ. Επομένως, πριν από την αποστολή του μηνύματος στη γέφυρα αποστολή Επεξεργασία, το πρέπει να είναι μετασχηματισμό από το σχήμα εντός της εταιρείας με το τυπικό σχήμα EDIFACT στο τιμολόγιο. Το έργο EAI υπηρεσίες BizTalk κάνει αυτό.

Το στοιχείο έργο υπηρεσιών BizTalk, **InvoiceProcessingBridge**, που μετατρέπει το μήνυμα περιλαμβάνεται επίσης ως τμήμα του δείγματος που λάβατε. Το project περιλαμβάνει τα ακόλουθα αντικείμενα:

*   **INHOUSEINVOICE. XSD** – σχήματος του τιμολογίου εντός της εταιρείας που αποστέλλονται σε Northwind.

*   **EFACT_D93A_INVOIC. XSD** – σχήματος του τιμολογίου για το τυπικό EDIFACT.

*   **EFACT_4.1_CONTRL. XSD** – σχήματος από το βεβαίωση λήψης EDIFACT που Northwind αποστέλλει Contoso.

*   **INHOUSEINVOICE_to_D93AINVOIC. TRFM** – το μετασχηματισμό που χαρτών το σχήμα εσωτερικά τιμολόγιο με το τυπικό σχήμα EDIFACT στο τιμολόγιο.  

### <a name="create-the-biztalk-services-project"></a>Δημιουργήστε το έργο υπηρεσιών BizTalk
1.  Στη λύση Visual Studio, αναπτύξτε το έργο InvoiceProcessingBridge και, στη συνέχεια, ανοίξτε το αρχείο **MessageFlowItinerary.bcs** .

2.  Κάντε κλικ σε οποιοδήποτε σημείο στον καμβά και ορίστε τη **Διεύθυνση URL της υπηρεσίας BizTalk** στο πλαίσιο της ιδιότητας για να καθορίσετε το όνομα της συνδρομής σας BizTalk υπηρεσίες. Για παράδειγμα, `https://contosowabs.biztalk.windows.net`.

    ![][7]  
3.  Από την εργαλειοθήκη, σύρετε μια **Γέφυρα One-Way Xml** στον καμβά. Ορίστε τις ιδιότητες **Όνομα οντότητα** και τη **Σχετική διεύθυνση** της γέφυρας σε **ProcessInvoiceBridge**. Κάντε διπλό κλικ για να ανοίξετε την επιφάνεια της ρύθμισης παραμέτρων γέφυρας **ProcessInvoiceBridge** .

4.  Μέσα στο πλαίσιο **Τύποι μηνυμάτων** , κάντε κλικ στο κουμπί συν (**+**) κουμπί για να καθορίσετε το σχήμα του εισερχόμενου μηνύματος. Επειδή το εισερχόμενο μήνυμα για τη γέφυρα EAI είναι πάντα εσωτερικά τιμολογίου, ορίστε αυτή σε **INHOUSEINVOICE**.

    ![][8]  
5.  Κάντε κλικ στο σχήμα **Xml μετασχηματισμός** και στο πλαίσιο της ιδιότητας, για την ιδιότητα **χάρτες** , κάντε κλικ στο κουμπί έλλειψη (****...). Στο παράθυρο διαλόγου **Επιλογή χάρτες** , επιλέξτε το αρχείο μετασχηματισμού **INHOUSEINVOICE_to_D93AINVOIC** και, στη συνέχεια, κάντε κλικ στο κουμπί **OK**.

    ![][9]  
6.  Επιστρέψτε στο **MessageFlowItinerary.bcs**, και από την εργαλειοθήκη, σύρετε ένα **Τελικό σημείο Two-Way εξωτερική υπηρεσία** στη δεξιά πλευρά του **ProcessInvoiceBridge**. Ορίστε την ιδιότητα **Όνομα οντότητα** **EDIBridge**.

7.  Στην Εξερεύνηση λύσεων, αναπτύξτε το **MessageFlowItinerary.bcs** και κάντε διπλό κλικ στο αρχείο **EDIBridge.config** . Αντικαταστήστε το περιεχόμενο του **EDIBridge.config** με τα εξής.

    > [AZURE.NOTE] Γιατί πρέπει να επεξεργαστείτε το αρχείο .config; Το τελικό σημείο εξωτερική υπηρεσία που έχουμε προσθέσει στον καμβά σχεδίασης γέφυρα αντιπροσωπεύει το γέφυρες Επεξεργασία που θα σας αναπτυχθεί νωρίτερα. Επεξεργασία γέφυρες είναι αμφίδρομη γέφυρες, με μια αποστολή και λήψη πλευρά. Ωστόσο, η γέφυρα EAI που έχουμε προσθέσει στη σχεδίαση bridge είναι μια μονόδρομη γέφυρα. Επομένως, για να χειριστείτε τα μοτίβα exchange διαφορετικό μήνυμα από τα δύο γέφυρες, χρησιμοποιούμε μια προσαρμοσμένη γέφυρα συμπεριφορά, συμπεριλαμβανομένης της ρύθμισης παραμέτρων στο αρχείο .config. Επιπλέον, η προσαρμοσμένη συμπεριφορά χειρίζεται επίσης τον έλεγχο ταυτότητας στο τελικό σημείο γέφυρα αποστολή Επεξεργασία. Αυτή η συμπεριφορά προσαρμοσμένο είναι διαθέσιμη ως ξεχωριστή δείγμα στο [Bridge υπηρεσίες BizTalk αλυσιδωτή δείγμα - EAI για Επεξεργασία](http://code.msdn.microsoft.com/BizTalk-Bridge-chaining-2246b104). Αυτή η λύση χρησιμοποιεί ξανά το δείγμα.  
    
    ```
<?xml version="1.0" encoding="utf-8"?>
    <configuration>
      <system.serviceModel>
        <extensions>
          <behaviorExtensions>
            <add name="BridgeAuthentication" 
                  type="Microsoft.BizTalk.Bridge.Behaviour.BridgeBehaviorElement, Microsoft.BizTalk.Bridge.Behaviour, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ae58f69b69495c05" />
          </behaviorExtensions>
        </extensions>
        <behaviors>
          <endpointBehaviors>
            <behavior name="BridgeAuthenticationConfiguration">
              <!-- Enter the ACS namespace, issuer name and issuer secret of the BizTalk Services deployment -->
              <BridgeAuthentication acsnamespace="[YOUR ACS NAMESPACE]" 
                                    issuername="owner" 
                                    issuersecret="[YOUR ACS SECRET]" />
              <webHttp />
            </behavior>
          </endpointBehaviors>
        </behaviors>
        <bindings>
          <webHttpBinding>
            <binding name="BridgeBindingConfiguration">
              <security mode="Transport" />
            </binding>
          </webHttpBinding>
        </bindings>
        <client>
          <clear />
          <!--
            Go BizTalk Portal > Agreement > Send Settings > Inbound URL
            Copy the Endpoint URL and paste it in the below address field
          -->
          <endpoint name="TwoWayExternalServiceEndpointReference1" 
                    address="[YOUR EDI BRIDGE SEND URI]" 
                    behaviorConfiguration="BridgeAuthenticationConfiguration" 
                    binding="webHttpBinding" 
                    bindingConfiguration="BridgeBindingConfiguration" 
                    contract="System.ServiceModel.Routing.IRequestReplyRouter" />
        </client>
      </system.serviceModel>
    </configuration>

    ```
8.  Να ενημερώσετε το αρχείο EDIBridge.config για να συμπεριλάβετε λεπτομέρειες ρύθμισης παραμέτρων

    *   Στην περιοχή _<behaviors>_, δώστε το χώρο ονομάτων ACS και το κλειδί που σχετίζεται με τη συνδρομή BizTalk υπηρεσίες.

    *   Στην περιοχή _<client>_, δώστε το τελικό σημείο όπου έχει αναπτυχθεί τη συμφωνία αποστολή Επεξεργασία.

    Αποθηκεύστε τις αλλαγές και κλείστε το αρχείο ρύθμισης παραμέτρων.

9.  Από την εργαλειοθήκη, κάντε κλικ στην επιλογή γραμμή **σύνδεσης** και τη συμμετοχή των στοιχείων **ProcessInvoiceBridge** και **EDIBridge** . Επιλέξτε τη γραμμή σύνδεσης και, στο πλαίσιο ιδιοτήτων, ορίστε **Συνθήκη φίλτρου** σε **Ταίριασμα όλων**. Αυτό εξασφαλίζει ότι όλα τα μηνύματα που υποβάλλονται σε επεξεργασία από τη γέφυρα EAI δρομολογούνται στη γέφυρα Επεξεργασία.

    ![][10]  
10.  Αποθηκεύστε τις αλλαγές στη λύση.  

### <a name="deploy-the-project"></a>Αναπτύξτε το έργο

1.  Στον υπολογιστή όπου δημιουργήσατε το έργο υπηρεσιών BizTalk, λήψη και εγκατάσταση του πιστοποιητικού SSL για τη συνδρομή σας BizTalk υπηρεσίες. Από, στην περιοχή BizTalk υπηρεσίες, κάντε κλικ στην επιλογή **Πίνακας εργαλείων**και, στη συνέχεια, κάντε κλικ στην επιλογή **Κάντε λήψη του πιστοποιητικού SSL**. Κάντε διπλό κλικ στο πιστοποιητικό και ακολουθήστε στην ερώτηση για να ολοκληρώσετε την εγκατάσταση. Βεβαιωθείτε ότι μπορείτε να εγκαταστήσετε το πιστοποιητικό στο χώρο αποθήκευσης πιστοποιητικού **Αξιόπιστες αρχές έκδοσης πιστοποιητικών ρίζας** .

2.  Στην Εξερεύνηση λύσεων Visual Studio, κάντε δεξί κλικ στο έργο **InvoiceProcessingBridge** και, στη συνέχεια, κάντε κλικ στην επιλογή **Ανάπτυξη**.

3.  Παρέχουν τις τιμές, όπως φαίνεται στην εικόνα και, στη συνέχεια, κάντε κλικ στην επιλογή **Ανάπτυξη**. Μπορείτε να λάβετε τα διαπιστευτήρια ACS για τις υπηρεσίες BizTalk κάνοντας κλικ στην επιλογή **Πληροφορίες σύνδεσης** από τον πίνακα εργαλείων BizTalk υπηρεσίες.

    ![][11]  

    Από το παράθυρο εξόδου, αντιγράψτε το τελικό σημείο όπου η γέφυρα EAI έχει αναπτυχθεί, για παράδειγμα, `https://contosowabs.biztalk.windows.net/default/ProcessInvoiceBridge`. Θα χρειαστείτε αργότερα αυτήν τη διεύθυνση URL τελικού σημείου.  

## <a name="step-4-test-the-solution"></a>Βήμα 4: Έλεγχος της λύσης


Σε αυτό το θέμα, δείτε πώς μπορείτε να δοκιμάσετε τη λύση, χρησιμοποιώντας το πρόγραμμα εκμάθησης εφαρμογή **Προγράμματος-πελάτη** που παρέχεται ως τμήμα του δείγματος.  

1.  Στο Visual Studio, πατήστε το πλήκτρο F5 για να ξεκινήσετε το **Πρόγραμμα εκμάθησης προγράμματος-πελάτη**.

2.  Στην οθόνη πρέπει να έχετε τις τιμές συμπληρωθεί εκ των προτέρων από το βήμα όπου που δημιουργήσαμε τις ουρές Bus υπηρεσίας. Κάντε κλικ στο κουμπί **Επόμενο**.

3.  Στο επόμενο παράθυρο, δώστε διαπιστευτήρια ACS για τη συνδρομή BizTalk υπηρεσίες και τα τελικά σημεία όπου EAI και Επεξεργασία (λήψη) αναπτύσσονται γέφυρες.

    Είχατε αντιγράψατε το τελικό σημείο γέφυρα EAI στο προηγούμενο βήμα. Για Επεξεργασία λάβετε τελικού σημείου γέφυρα, στην πύλη του BizTalk υπηρεσίες, μεταβείτε στις επιλογές της συμφωνίας > λήψη ρυθμίσεις > μεταφοράς > τελικού σημείου.

    ![][12]  
4.  Στο επόμενο παράθυρο, στην περιοχή Contoso, κάντε κλικ στο κουμπί **Αποστολή εσωτερικά τιμολόγιο** . Στο αρχείο, ανοίξτε το παράθυρο διαλόγου, ανοίξτε το αρχείο INHOUSEINVOICE.txt. Εξετάστε το περιεχόμενο του αρχείου και, στη συνέχεια, κάντε κλικ στο **κουμπί OK** για να στείλετε το τιμολόγιο.

    ![][13]  
5.  Σε μερικά δευτερόλεπτα τιμολογίου παραλαμβάνεται στην Northwind. Κάντε κλικ στη σύνδεση **Προβολή μηνύματος** για να δείτε το τιμολόγιο που λάβατε από Northwind. Παρατηρήστε πώς το τιμολόγιο που λάβατε από Northwind είναι τυπική EDIFACT σχήματος ενώ αυτό αποστέλλονται από Contoso έχει ένα σχήμα εντός της εταιρείας.

    ![][14]  
6.  Επιλέξτε το τιμολόγιο και, στη συνέχεια, κάντε κλικ στην επιλογή **Αποστολή επιβεβαίωσης**. Στο παράθυρο διαλόγου που αναδύεται, παρατηρήστε ότι το Αναγνωριστικό ανταλλαγής είναι ίδιο στο received τιμολογίου και η αναφορά που στέλνεται. Κάντε κλικ στο κουμπί OK στο παράθυρο διαλόγου **Αποστολή επιβεβαίωσης** .

    ![][15]  
7.  Σε μερικά δευτερόλεπτα, η βεβαίωση λήψης λαμβάνεται με επιτυχία στο Contoso.

    ![][16]  

## <a name="step-5-optional-send-edifact-invoice-in-batches"></a>Βήμα 5 (προαιρετικό): Αποστολή EDIFACT τιμολόγιο σε δέσμες 
Επεξεργασία υπηρεσίες BizTalk γέφυρες υποστηρίζει επίσης δέσμης των εξερχόμενων μηνυμάτων. Αυτή η δυνατότητα είναι χρήσιμη για τη λήψη συνεργάτες που προτιμάτε για να λάβετε μια δέσμη μηνυμάτων (σύσκεψης συγκεκριμένο κριτήριο) αντί για μεμονωμένα μηνύματα.

Τα σημαντικότερα αναλογίες κατά την εργασία με δέσμες είναι την πραγματική έκδοση της δέσμης, που ονομάζεται επίσης τα κριτήρια κυκλοφορίας. Τα κριτήρια κυκλοφορίας μπορεί να βασίζονται σε πώς ο συνεργάτης παραλαβής θέλει να λαμβάνετε μηνύματα. Εάν είναι ενεργοποιημένη η δέσμη, η Επεξεργασία γέφυρα δεν αποστέλλει το εξερχόμενο μήνυμα για λήψη συνεργάτη μέχρι να πληρούνται τα κριτήρια κυκλοφορίας. Για παράδειγμα, ένα κριτήριο διαδικασίας δέσμης που βασίζονται σε μήνυμα μέγεθος αποστέλλει μια δέσμη μόνο όταν «ν» μηνυμάτων είναι μαζικής. Ένα κριτήριο δέσμη μπορεί επίσης να βάσει χρόνου, τέτοια ώστε μια δέσμη αποστέλλεται μια σταθερή ώρα κάθε ημέρα. Σε αυτήν τη λύση, Προσπαθούμε το μέγεθος του μηνύματος με βάση κριτήρια.

1.  Στην πύλη του BizTalk υπηρεσίες, κάντε κλικ στην επιλογή τη συμφωνία που δημιουργήσατε νωρίτερα. Κάντε κλικ στην επιλογή ρυθμίσεις Αποστολή > δέσμης > Προσθήκη δέσμης.

2.  Για μαζική όνομα, πληκτρολογήστε **InvoiceBatch**, δώστε μια περιγραφή και, στη συνέχεια, κάντε κλικ στο κουμπί **Επόμενο**.

3.  Καθορίστε τα κριτήρια δέσμη, που ορίζει ποια μηνύματα πρέπει να είναι batched. Σε αυτήν τη λύση, θα σας μαζική όλα τα μηνύματα. Επομένως, επιλέξτε τη χρήση των ορισμών επιλογή για προχωρημένους και πληκτρολογήστε **1 = 1**. Αυτή είναι μια συνθήκη που θα είναι πάντα true και, επομένως θα batched όλα τα μηνύματα. Κάντε κλικ στο κουμπί **Επόμενο**.

    ![][17]  
4.  Καθορίστε ένα κριτήριο κυκλοφορίας δέσμης. Από το πλαίσιο σχολίων, επιλέξτε **MessageCountBased**και **Πλήθος**, καθορίστε **3**. Αυτό σημαίνει ότι θα σταλεί μια δέσμη τρία μηνύματα σε Northwind. Κάντε κλικ στο κουμπί **Επόμενο**.

    ![][18]  
5.  Ελέγξτε τη σύνοψη και, στη συνέχεια, κάντε κλικ στην επιλογή **Αποθήκευση**. Κάντε κλικ στην επιλογή **Ανάπτυξη** να αναπτύξετε εκ νέου τη συμφωνία.

6.  Επιστρέψτε στον **Υπολογιστή-πελάτη το πρόγραμμα εκμάθησης**, κάντε κλικ στην επιλογή **Αποστολή εσωτερικά τιμολόγιο**και ακολουθήστε τις οδηγίες για να στείλετε το τιμολόγιο. Θα παρατηρήσετε ότι δεν υπάρχει τιμολόγιο παραλαμβάνεται στην Northwind, επειδή δεν ικανοποιείται το μέγεθος δέσμης. Επαναλάβετε αυτό το βήμα δύο φορές, ώστε να έχετε τρεις τιμολόγιο μηνύματα που αποστέλλονται σε Northwind. Αυτό ικανοποιεί τα κριτήρια κυκλοφορίας δέσμη 3 μηνύματα και τώρα θα πρέπει να βλέπετε ένα τιμολόγιο στο Northwind.


<!--Image references-->
[1]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-1.PNG  
[2]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-2.PNG  
[3]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-3.PNG
[4]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-4.PNG  
[5]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-5.PNG  
[6]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-6.PNG  
[7]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-7.PNG  
[8]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-8.PNG
[9]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-9.PNG  
[10]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-10.PNG  
[11]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-11.PNG  
[12]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-12.PNG  
[13]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-13.PNG
[14]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-14.PNG  
[15]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-15.PNG  
[16]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-16.PNG  
[17]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-17.PNG  
[18]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-18.PNG


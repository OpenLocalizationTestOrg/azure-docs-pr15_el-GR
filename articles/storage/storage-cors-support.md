<properties
    pageTitle="Υποστήριξη κοινής χρήσης (CORS) πόρων σταυρό Origin | Microsoft Azure"
    description="Μάθετε πώς μπορείτε να ενεργοποιήσετε την υποστήριξη CORS για τις υπηρεσίες Microsoft Azure του χώρου αποθήκευσης."
    services="storage"
    documentationCenter=".net"
    authors="cbrooks"
    manager="carmonm"
    editor="tysonn"/>

<tags
    ms.service="storage"
    ms.workload="storage"
    ms.tgt_pltfrm="na"
    ms.devlang="dotnet"
    ms.topic="article"
    ms.date="09/07/2016"
    ms.author="cbrooks"/>

# <a name="cross-origin-resource-sharing-cors-support-for-the-azure-storage-services"></a>Κοινή χρήση υποστήριξης (CORS) για τις υπηρεσίες του Azure αποθήκευσης σταυρό Origin πόρων

Ξεκινώντας με έκδοση 2013-08-15, των υπηρεσιών Azure αποθήκευσης υποστήριξης κοινή χρήση πόρων μεταξύ Origin (CORS) για τις υπηρεσίες Blob, πίνακα, ουρά και αρχείων. CORS είναι μια δυνατότητα HTTP που επιτρέπει σε μια εφαρμογή web εκτελείται σε ένα τομέα για να αποκτήσετε πρόσβαση σε πόρους σε άλλον τομέα. Προγράμματα περιήγησης Web εφαρμογή ενός περιορισμού ασφαλείας γνωστό ως [ίδια προέλευση πολιτικής](http://www.w3.org/Security/wiki/Same_Origin_Policy) που αποτρέπει μιας ιστοσελίδας από κλήσης APIs σε διαφορετικό τομέα; CORS παρέχει έναν ασφαλή τρόπο για να επιτρέψετε σε έναν τομέα (τον τομέα origin) για να καλέσετε APIs σε άλλον τομέα. Δείτε την [προδιαγραφή CORS](http://www.w3.org/TR/cors/) για λεπτομέρειες σχετικά με CORS.

Μπορείτε να ορίσετε κανόνες CORS μεμονωμένα για κάθε μία από τις υπηρεσίες χώρου αποθήκευσης, καλώντας την [Ορίσετε ιδιότητες υπηρεσίας Blob](https://msdn.microsoft.com/library/hh452235.aspx), [Ορισμός ιδιοτήτων υπηρεσίας ουράς](https://msdn.microsoft.com/library/hh452232.aspx)και [Ορίσετε ιδιότητες υπηρεσίας πίνακα](https://msdn.microsoft.com/library/hh452240.aspx). Αφού ορίσετε τους κανόνες CORS για την υπηρεσία, στη συνέχεια, θα αξιολογείται αίτησης σωστά με έλεγχο ταυτότητας που έγιναν σε σχέση με την υπηρεσία από διαφορετικό τομέα για να προσδιορίσετε εάν αυτό επιτρέπεται σύμφωνα με τους κανόνες που έχετε καθορίσει.

>[AZURE.NOTE] Σημειώστε ότι CORS δεν είναι ένας μηχανισμός ελέγχου ταυτότητας. Οποιαδήποτε αίτηση που έγιναν σε σχέση με έναν πόρο χώρου αποθήκευσης, όταν είναι ενεργοποιημένη η CORS πρέπει να έχετε είτε μια υπογραφή proper ελέγχου ταυτότητας, ή πρέπει να γίνουν σε σχέση με μια δημόσια πόρων.

## <a name="understanding-cors-requests"></a>Κατανόηση των αιτήσεων CORS

Μια αίτηση CORS από έναν τομέα origin μπορεί να αποτελείται από δύο ξεχωριστές προσκλήσεις:

- Μια αίτηση προκαταρκτικού ελέγχου, η οποία ερωτήματα τους CORS περιορισμούς που επιβάλλονται από την υπηρεσία. Η αίτηση προκαταρκτικού ελέγχου απαιτείται, εκτός εάν η πρόσκληση σε μέθοδος είναι μια [απλή μέθοδο](http://www.w3.org/TR/cors/), γεγονός που σημαίνει ότι ΛΉΨΗ, το ΚΕΦΆΛΙ ή ΔΗΜΟΣΊΕΥΣΗ.

- Η πραγματική αίτηση, που έγιναν σε σχέση με την επιθυμητή πόρων.

### <a name="preflight-request"></a>Αίτηση προκαταρκτικού ελέγχου

Τα ερωτήματα προκαταρκτικού αίτηση τους περιορισμούς CORS που έχουν καθοριστεί για την υπηρεσία αποθήκευσης από τον κάτοχο του λογαριασμού. Το πρόγραμμα περιήγησης web (ή άλλα παράγοντα χρήστη) στέλνει μια πρόσκληση ΕΠΙΛΟΓΏΝ που περιλαμβάνει τις κεφαλίδες αίτησης, η μέθοδος και origin τομέα. Η υπηρεσία αποθήκευσης υπολογίζει την προβλεπόμενη λειτουργία με βάση ένα προκαθορισμένο σύνολο των κανόνων CORS που καθορίζουν ποιες origin τομείς, μεθόδους αίτηση και κεφαλίδες αίτησης μπορεί να καθοριστεί σε μια πραγματική πρόσκληση σε σχέση με έναν πόρο χώρου αποθήκευσης.

Εάν CORS είναι ενεργοποιημένη για την υπηρεσία και υπάρχει ένας κανόνας CORS που ταιριάζει με την αίτηση προκαταρκτικού ελέγχου, η υπηρεσία αποκρίνεται με κωδικό κατάστασης 200 (OK) και περιλαμβάνει τις απαιτούμενες κεφαλίδες ελέγχου πρόσβασης στην απάντηση.

Εάν CORS δεν είναι ενεργοποιημένη για την υπηρεσία ή κανένας κανόνας CORS συμφωνεί με την αίτηση προκαταρκτικού ελέγχου, η υπηρεσία θα απαντήσετε με κωδικό κατάστασης 403 (Απαγορεύεται).

Εάν η πρόσκληση σε ΕΠΙΛΟΓΈΣ δεν περιέχει τις απαιτούμενες κεφαλίδες CORS (τις κεφαλίδες Origin και πρόσβασης--αίτηση-μέθοδος ελέγχου), η υπηρεσία θα απαντήσετε με κωδικό κατάστασης 400 (ακατάλληλη αίτηση).

Σημειώστε ότι αίτησης προκαταρκτικού αξιολογείται σε σχέση με την υπηρεσία (Blob ουρά και πίνακα) και όχι ως προς τον πόρο που ζητήθηκε. Ο κάτοχος λογαριασμού πρέπει να έχουν ενεργοποιημένη CORS ως μέρος των ιδιοτήτων της υπηρεσίας λογαριασμού για την αίτηση για να ολοκληρωθεί με επιτυχία.

### <a name="actual-request"></a>Πραγματική αίτηση

Αφού γίνει αποδεκτή την αίτηση προκαταρκτικού και επιστρέφεται η τιμή της απόκρισης, το πρόγραμμα περιήγησης θα αποστολής την πραγματική αίτηση σε σχέση με το χώρο αποθήκευσης πόρων. Το πρόγραμμα περιήγησης θα αρνηθεί την πραγματική αίτηση αμέσως εάν η πρόσκληση σε προκαταρκτικού έχει απορριφθεί.

Η πραγματική αίτηση εκλαμβάνεται ως κανονική πρόσκληση σε σχέση με την υπηρεσία αποθήκευσης. Η παρουσία της κεφαλίδας Origin υποδεικνύει ότι η αίτηση είναι μια αίτηση CORS και την υπηρεσία θα ελεγχθούν από τους κανόνες που ταιριάζει CORS. Εάν βρεθεί αντιστοίχιση, οι κεφαλίδες ελέγχου πρόσβασης προστίθενται στην απάντηση και αποστέλλονται πίσω στο πρόγραμμα-πελάτη. Εάν δεν βρεθεί, των κεφαλίδων ελέγχου πρόσβασης CORS δεν επιστρέφονται.

## <a name="enabling-cors-for-the-azure-storage-services"></a>Ενεργοποίηση CORS για τις υπηρεσίες αποθήκευσης Azure

Κανόνες CORS έχουν οριστεί στο επίπεδο της υπηρεσίας, ώστε να πρέπει να ενεργοποιήσετε ή να απενεργοποιήσετε CORS για κάθε υπηρεσία (Blob, ουρά και πίνακα) ξεχωριστά. Από προεπιλογή, CORS είναι απενεργοποιημένη για κάθε υπηρεσία. Για να ενεργοποιήσετε CORS, πρέπει να ορίσετε τις ιδιότητες κατάλληλη υπηρεσία χρησιμοποιώντας την έκδοση 2013-08-15 ή νεότερη έκδοση, και προσθέστε τους κανόνες CORS τις ιδιότητες της υπηρεσίας. Για λεπτομέρειες σχετικά με τον τρόπο ενεργοποίησης ή απενεργοποίησης CORS για μια υπηρεσία και πώς μπορείτε να ορίσετε κανόνες CORS, ανατρέξτε να [Ορίσετε ιδιότητες υπηρεσίας Blob](https://msdn.microsoft.com/library/hh452235.aspx), [Ορισμός ιδιοτήτων υπηρεσίας ουράς](https://msdn.microsoft.com/library/hh452232.aspx)και να [Ορίσετε ιδιότητες υπηρεσίας πίνακα](https://msdn.microsoft.com/library/hh452240.aspx).

Ακολουθεί ένα δείγμα έναν CORS κανόνα, που καθορίζεται μέσω μιας λειτουργίας ορίσετε ιδιότητες υπηρεσίας:

    <Cors>    
        <CorsRule>
            <AllowedOrigins>http://www.contoso.com, http://www.fabrikam.com</AllowedOrigins>
            <AllowedMethods>PUT,GET</AllowedMethods>
            <AllowedHeaders>x-ms-meta-data*,x-ms-meta-target*,x-ms-meta-abc</AllowedHeaders>
            <ExposedHeaders>x-ms-meta-*</ExposedHeaders>
            <MaxAgeInSeconds>200</MaxAgeInSeconds>
        </CorsRule>
    <Cors>

Κάθε στοιχείο περιλαμβάνονται στον κανόνα CORS περιγράφεται παρακάτω:

- **AllowedOrigins**: οι τομείς origin που επιτρέπεται να κάνετε μια αίτηση σε σχέση με την υπηρεσία αποθήκευσης μέσω CORS. Ο τομέας προέλευσης είναι ο τομέας από την οποία προέρχεται η αίτηση. Σημειώστε ότι η προέλευση πρέπει να είναι μια ακριβή αντιστοιχία διάκριση πεζών-κεφαλαίων με την προέλευση που στέλνει την ηλικία του χρήστη στην υπηρεσία. Μπορείτε επίσης να χρησιμοποιήσετε το χαρακτήρα μπαλαντέρ ' *' για να επιτρέψετε σε όλους τους τομείς προέλευσης για να κάνετε αιτήσεις μέσω CORS. Στο παραπάνω παράδειγμα, η τομείς [http://www.contoso.com](http://www.contoso.com) και [http://www.fabrikam.com](http://www.fabrikam.com) να κάνετε προσκλήσεις σε σχέση με την υπηρεσία χρησιμοποιώντας CORS.

- **AllowedMethods**: τις μεθόδους (ρήματα αίτηση HTTP) που μπορεί να χρησιμοποιεί τον τομέα προέλευσης για ένα αίτημα CORS. Στο παραπάνω παράδειγμα, επιτρέπονται μόνο οι αιτήσεις ΤΟΠΟΘΈΤΗΣΗ και ΛΉΨΗ.

- **AllowedHeaders**: τις κεφαλίδες αίτησης που μπορεί να καθορίσει τον τομέα origin στην την αίτηση CORS. Στο παραπάνω παράδειγμα, επιτρέπεται ξεκινώντας με το x-ms-μετα-δεδομένα, x-ms-μετα-προορισμού και x-ms-μετα-abc όλων των κεφαλίδων μετα-δεδομένων. Λάβετε υπόψη ότι ο χαρακτήρας μπαλαντέρ ' *' υποδηλώνει ότι επιτρέπεται οποιαδήποτε επικεφαλίδα αρχίζει με το καθορισμένο πρόθεμα.

- **ExposedHeaders**: τις κεφαλίδες απόκρισης που μπορεί να αποσταλεί στην απάντηση στην πρόσκληση σε CORS και που εκτίθεται από το πρόγραμμα περιήγησης για να τον εκδότη αίτηση. Στο παραπάνω παράδειγμα, το πρόγραμμα περιήγησης του έχουν ανατεθεί για να εκθέσετε οποιαδήποτε επικεφαλίδα που ξεκινά με μετα-ms-x.

- **MaxAgeInSeconds**: αίτηση για την ώρα μέγιστο βαθμό ότι οι ΕΠΙΛΟΓΈΣ του ελέγχου θα πρέπει να προσωρινή αποθήκευση ένα πρόγραμμα περιήγησης.

Των υπηρεσιών Azure αποθήκευσης υποστήριξης που καθορίζει το πρόθεμα κεφαλίδων για τα **AllowedHeaders** και **ExposedHeaders** στοιχεία. Για να επιτρέψετε σε μια κατηγορία κεφαλίδων, μπορείτε να καθορίσετε ένα κοινό πρόθεμα σε αυτήν την κατηγορία. Για παράδειγμα, καθορίζοντας *μετα-ms-x** όπως prefixed κεφαλίδας δημιουργεί έναν κανόνα που θα ταιριάζουν με όλες τις κεφαλίδες που ξεκινούν με μετα-ms-x.

Οι παρακάτω περιορισμοί ισχύουν για τους κανόνες CORS:

- Μπορείτε να καθορίσετε έως και πέντε CORS κανόνων ανά υπηρεσία αποθήκευσης (Blob πίνακα και ουρά).
- Το μέγιστο μέγεθος των όλες CORS κανόνες ρυθμίσεις για την αίτηση, εκτός από ετικέτες XML, δεν θα πρέπει να υπερβαίνει τα 2 KB.
- Το μήκος της μια επιτρεπόμενων κεφαλίδας, εκτεθειμένης κεφαλίδα ή επιτρεπόμενων προέλευσης δεν πρέπει να υπερβαίνει 256 χαρακτήρες.
- Οι επιτρεπόμενοι κεφαλίδες και εκτεθειμένης κεφαλίδες μπορεί να είναι είτε:
  - Ακριβές κεφαλίδες, όπου το ακριβές κεφαλίδα όνομα παρέχεται, όπως **x-ms-μετα-υποβάλλονται σε επεξεργασία**. Έως 64 ακριβές κεφαλίδες ενδέχεται να έχει καθοριστεί για την αίτηση.
  - Το πρόθεμα κεφαλίδες, όπου παρέχεται ένα πρόθεμα της κεφαλίδας, όπως **x-ms-μετα-δεδομένα***. Καθορίζοντας ένα πρόθεμα με αυτόν τον τρόπο επιτρέπει ή εκθέτει οποιαδήποτε επικεφαλίδα που αρχίζει με το πρόθεμα που δίνεται. Έως και δύο κεφαλίδες το πρόθεμα μπορεί να καθοριστεί για την αίτηση.
- Τις μεθόδους (ή στο ρήματα HTTP) που καθορίζεται στο στοιχείο **AllowedMethods** πρέπει να συμμορφώνονται με τις μεθόδους που υποστηρίζεται από χώρο αποθήκευσης Azure υπηρεσία APIs. Υποστηριζόμενες μεθόδους είναι ΔΙΑΓΡΑΦΉ, ΛΉΨΗ, το ΚΕΦΆΛΙ, ΣΥΓΧΏΝΕΥΣΗ, ΔΗΜΟΣΊΕΥΣΗ, ΕΠΙΛΟΓΈΣ και ΤΟΠΟΘΈΤΗΣΗ.

## <a name="understanding-cors-rule-evaluation-logic"></a>Κατανόηση της λογικής αξιολόγησης CORS κανόνα

Όταν μια υπηρεσία αποθήκευσης λαμβάνει μια αίτηση προκαταρκτικού ή πραγματική, αποτιμάται που ζητούν με βάση τους κανόνες CORS που έχετε καθορίσει για την υπηρεσία μέσω την κατάλληλη λειτουργία ορίσετε ιδιότητες υπηρεσίας. Κανόνες CORS αξιολογούνται με τη σειρά με την οποία έχουν οριστεί στο σώμα της αίτησης της λειτουργίας ορίσετε ιδιότητες υπηρεσίας.

Κανόνες CORS αξιολογούνται ως εξής:

1. Πρώτα, τον τομέα origin της αίτησης ελέγχεται σε σχέση με τους τομείς που παρατίθενται για το στοιχείο **AllowedOrigins** . Εάν ο τομέας origin περιλαμβάνεται στη λίστα ή όλους τους τομείς επιτρέπονται με το χαρακτήρα μπαλαντέρ ' *', στη συνέχεια, κανόνες έσοδα αξιολόγησης. Εάν ο τομέας προέλευσης δεν περιλαμβάνεται, στη συνέχεια, η αίτηση αποτυγχάνει.

2. Στη συνέχεια, η μέθοδος (ή Ρηματικές HTTP) της αίτησης ελέγχεται σύμφωνα με τις μεθόδους που παρατίθενται στο στοιχείο **AllowedMethods** . Εάν η μέθοδος περιλαμβάνεται στη λίστα, στη συνέχεια, προχωρά αξιολόγηση κανόνων; Εάν όχι, στη συνέχεια, η αίτηση αποτυγχάνει.

3. Εάν η πρόσκληση σε ταιριάζει με έναν κανόνα στο τον τομέα προέλευσης και τη μέθοδο, αυτόν τον κανόνα είναι επιλεγμένο στη διαδικασία αξιολογούνται αίτησης και χωρίς περαιτέρω κανόνες. Πριν από την αίτηση μπορεί να ολοκληρωθεί με επιτυχία, ωστόσο, τις κεφαλίδες που καθορίζεται στην αίτηση ελέγχονται σύμφωνα με τις κεφαλίδες που αναφέρονται στο στοιχείο **AllowedHeaders** . Εάν στις κεφαλίδες αποστέλλονται δεν ταιριάζουν με τις κεφαλίδες επιτρεπόμενων, η αίτηση αποτυγχάνει.

Επειδή οι κανόνες υποβάλλονται σε επεξεργασία με τη σειρά που υπάρχουν στο σώμα της αίτησης, βέλτιστες πρακτικές συνιστούν που καθορίζετε τους πιο περιοριστική κανόνες σε σχέση με προελεύσεις πρώτα στη λίστα, ώστε αυτές αξιολογούνται πρώτα. Καθορίστε τους κανόνες που είναι λιγότερο περιοριστικό – για παράδειγμα, ένας κανόνας για αποδοχή όλων προελεύσεις – στο τέλος της λίστας.

### <a name="example--cors-rules-evaluation"></a>Παράδειγμα – CORS κανόνες αξιολόγησης

Το παρακάτω παράδειγμα εμφανίζει έναν οργανισμό μερική αίτηση για μια λειτουργία για να ορίσετε κανόνες CORS για τις υπηρεσίες του χώρου αποθήκευσης. Ανατρέξτε στο θέμα [Ορισμός ιδιοτήτων υπηρεσίας Blob](https://msdn.microsoft.com/library/hh452235.aspx), [Ορισμός ιδιοτήτων υπηρεσίας ουράς](https://msdn.microsoft.com/library/hh452232.aspx)και [Ορίσετε ιδιότητες υπηρεσίας πίνακα](https://msdn.microsoft.com/library/hh452240.aspx) για λεπτομέρειες σχετικά με τη δημιουργία της αίτησης.

    <Cors>
        <CorsRule>
            <AllowedOrigins>http://www.contoso.com</AllowedOrigins>
            <AllowedMethods>PUT,HEAD</AllowedMethods>
            <MaxAgeInSeconds>5</MaxAgeInSeconds>
            <ExposedHeaders>x-ms-*</ExposedHeaders>
            <AllowedHeaders>x-ms-blob-content-type, x-ms-blob-content-disposition</AllowedHeaders>
        </CorsRule>
        <CorsRule>
            <AllowedOrigins>*</AllowedOrigins>
            <AllowedMethods>PUT,GET</AllowedMethods>
            <MaxAgeInSeconds>5</MaxAgeInSeconds>
            <ExposedHeaders>x-ms-*</ExposedHeaders>
            <AllowedHeaders>x-ms-blob-content-type, x-ms-blob-content-disposition</AllowedHeaders>
        </CorsRule>
        <CorsRule>
            <AllowedOrigins>http://www.contoso.com</AllowedOrigins>
            <AllowedMethods>GET</AllowedMethods>
            <MaxAgeInSeconds>5</MaxAgeInSeconds>
            <ExposedHeaders>x-ms-*</ExposedHeaders>
            <AllowedHeaders>x-ms-client-request-id</AllowedHeaders>
        </CorsRule>
    </Cors>

Στη συνέχεια, εξετάστε τις ακόλουθες αιτήσεις CORS:

Αίτηση||| Απόκριση||
---|---|---|---|---
**Μέθοδος** |**Προέλευση** |**Κεφαλίδες αίτησης** |**Αντιστοίχιση κανόνα** |**Αποτέλεσμα**
**ΤΟΠΟΘΈΤΗΣΗ** | http://www.contoso.com |x-ms-blob-τύπου περιεχομένου | Πρώτος κανόνας |Επιτυχίας
**ΛΉΨΗ** | http://www.contoso.com| x-ms-blob-τύπου περιεχομένου | Δεύτερο κανόνα |Επιτυχίας
**ΛΉΨΗ** | http://www.contoso.com| x-ms-blob-τύπου περιεχομένου | Δεύτερο κανόνα | Αποτυχία

Την πρώτη αίτηση συμφωνεί με τον πρώτο κανόνα – τομέα origin συμφωνεί με το επιτρεπόμενο προελεύσεις, η μέθοδος ταιριάζει τις μεθόδους επιτρεπόμενων και στην κεφαλίδα ταιριάζει με τις κεφαλίδες επιτρεπόμενων – και επομένως ολοκληρωθεί με επιτυχία.

Η δεύτερη αίτηση δεν ταιριάζουν με τον πρώτο κανόνα επειδή η μέθοδος δεν ταιριάζουν με τις μεθόδους επιτρεπόμενων. Ωστόσο, το, συμφωνεί με τον δεύτερο κανόνα, ώστε να επιτύχει.

Την τρίτη αίτηση συμφωνεί με τον δεύτερο κανόνα στις origin τομέα και τη μέθοδο, ώστε να υπολογιστούν οι περαιτέρω κανόνες. Ωστόσο, στην *κεφαλίδα x-ms-αναγνωριστικό υπολογιστή-πελάτη-αίτηση* δεν επιτρέπεται από τον δεύτερο κανόνα, ώστε η αίτηση αποτύχει, παρά το γεγονός ότι η σημασιολογία του κανόνα τρίτο θα του επέτρεπε με επιτυχία.

>[AZURE.NOTE] Παρόλο που αυτό το παράδειγμα εμφανίζει έναν κανόνα λιγότερο περιοριστικό πριν από ένα πιο περιοριστικό, σε γενικές γραμμές η βέλτιστη πρακτική είναι στη λίστα των πιο περιοριστική κανόνων πρώτα.

## <a name="understanding-how-the-vary-header-is-set"></a>Κατανόηση πώς έχει οριστεί στην κεφαλίδα διαφορετικό

Η κεφαλίδα *διαφορετικό* είναι μια τυπική κεφαλίδα HTTP/1.1 που αποτελείται από ένα σύνολο πεδίων κεφαλίδας αίτησης που παρέχετε συμβουλές σχετικά με το πρόγραμμα περιήγησης ή χρήστη παράγοντας σχετικά με τα κριτήρια που έχουν επιλεγεί από το διακομιστή για την επεξεργασία της αίτησης. Στην κεφαλίδα *διαφορετικό* χρησιμοποιείται κυρίως για προσωρινή αποθήκευση διακομιστές μεσολάβησης, προγράμματα περιήγησης και CDN, το οποίο θα χρησιμοποιήσετε για να καθορίσετε πώς θα πρέπει να είναι προσωρινά την απάντηση. Για λεπτομέρειες, ανατρέξτε στο θέμα της προδιαγραφής για την [κεφαλίδα ανάλογα](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html).

Όταν το πρόγραμμα περιήγησης ή άλλο παράγοντα χρήστη αποθηκεύει προσωρινά την απόκριση από μια πρόσκληση σε CORS, ο τομέας origin είναι προσωρινά ως το επιτρεπόμενο origin. Όταν μια δεύτερη τομέα ζητήματα ίδια αίτηση για έναν πόρο χώρου αποθήκευσης με ενεργοποιημένο το cache, τον παράγοντα χρήστη ανακτά τον τομέα στο cache origin. Τον τομέα δεύτερου δεν ταιριάζουν με τον τομέα στο cache, ώστε να την αίτηση αποτυγχάνει, όταν το διαφορετικά θα επιτύχουν. Σε ορισμένες περιπτώσεις, αποθήκευσης Azure ορίζει την κεφαλίδα διαφορετικό **Origin** για να ζητήσετε από τον παράγοντα χρήστη για να στείλετε την αίτηση οι επόμενες CORS για την υπηρεσία κατά την υποβολή αίτησης τομέα διαφέρει από το αρχικό σημείο στο cache.

Azure αποθήκευσης ορίζει την κεφαλίδα *διαφορετικό* **Origin** για πραγματική αιτήσεις GET/ΚΕΦΑΛΉ στις ακόλουθες περιπτώσεις:

- Όταν η προέλευση αίτηση αντιστοιχεί ακριβώς σε το επιτρεπόμενο origin που ορίζονται από έναν κανόνα CORS. Για να είναι ακριβή αντιστοιχία, ο κανόνας CORS δεν μπορεί να περιλαμβάνει ένα χαρακτήρα μπαλαντέρ ' * ' χαρακτήρα.

- Δεν υπάρχει κανένας κανόνας που ταιριάζουν με την προέλευση αίτηση, αλλά CORS είναι ενεργοποιημένη για την υπηρεσία αποθήκευσης.

Στην περίπτωση όπου μια αίτηση GET/ΚΕΦΑΛΉ ταιριάζει με έναν κανόνα CORS που επιτρέπει σε όλες τις προελεύσεις, την απάντηση δηλώνει ότι όλες οι προελεύσεις επιτρέπονται και το cache παράγοντα χρήστη επιτρέπουν οι επακόλουθες απαιτήσεις από οποιονδήποτε τομέα origin με ενεργοποιημένο το cache.

Σημειώστε ότι για αιτήσεις χρησιμοποιώντας μεθόδους εκτός από ΛΉΨΗ/ΚΕΦΑΛΉ, τις υπηρεσίες του χώρου αποθήκευσης θα δεν έχει οριστεί στην κεφαλίδα διαφορετικό, επειδή απαντήσεων σε αυτές τις μεθόδους δεν αποθηκεύονται στο cache από παραγόντων χρήστη.

Ο παρακάτω πίνακας δείχνει πώς Azure χώρου αποθήκευσης θα απάντηση σε αιτήματα GET/ΚΕΦΑΛΉ με βάση τις παραπάνω περιπτώσεις:

Αίτηση|Ρύθμιση του λογαριασμού και το αποτέλεσμα της αξιολόγησης κανόνα|||Απόκριση|||
---|---|---|---|---|---|---|---|---
**Παρουσίαση αίτημα origin κεφαλίδας** | **CORS κανόνων που έχουν καθοριστεί για αυτήν την υπηρεσία** | **Υπάρχει Matching κανόνας που επιτρέπει σε όλες τις προελεύσεις (*)** | **Υπάρχει κανόνας που ταιριάζει για origin ακριβή αντιστοιχία** | **Απόκριση περιλαμβάνει διαφορετικό κεφαλίδα που ορίζετε έως την προέλευση** | **Απόκριση περιλαμβάνει πρόσβαση-ελέγχου-επιτρέπεται-Origin: "*"** | **Απόκριση περιλαμβάνει πρόσβαση-ελέγχου-εκτίθεται-κεφαλίδες**
Όχι|Όχι|Όχι|Όχι|Όχι|Όχι|Όχι
Όχι|Ναι|Όχι|Όχι|Ναι|Όχι|Όχι
Όχι|Ναι|Ναι|Όχι|Όχι|Ναι|Ναι
Ναι|Όχι|Όχι|Όχι|Όχι|Όχι|Όχι
Ναι|Ναι|Όχι|Ναι|Ναι|Όχι|Ναι
Ναι|Ναι|Όχι|Όχι|Ναι|Όχι|Όχι
Ναι|Ναι|Ναι|Όχι|Όχι|Ναι|Ναι


## <a name="billing-for-cors-requests"></a>Χρέωση για αιτήσεις CORS

Επιτυχής προκαταρκτικού αιτήσεις χρέωσης εάν έχετε ενεργοποιήσει το CORS για οποιαδήποτε από τις υπηρεσίες χώρου αποθήκευσης για το λογαριασμό σας (καλώντας [Ορίσετε ιδιότητες υπηρεσίας Blob](https://msdn.microsoft.com/library/hh452235.aspx), [Ορισμός ιδιοτήτων υπηρεσίας ουράς](https://msdn.microsoft.com/library/hh452232.aspx)ή [Ορίσετε ιδιότητες υπηρεσίας πίνακα](https://msdn.microsoft.com/library/hh452240.aspx)). Για να ελαχιστοποιήσετε χρεώσεων, εξετάστε το ενδεχόμενο τη ρύθμιση στο στοιχείο **MaxAgeInSeconds** στο CORS κανόνων σε μια μεγάλη τιμή ώστε να τον παράγοντα χρήστη αποθηκεύει προσωρινά την αίτηση.

Επιτυχής προκαταρκτικού αιτήσεις δεν θα χρεώνεστε.

## <a name="next-steps"></a>Επόμενα βήματα

[Ορισμός ιδιοτήτων υπηρεσίας Blob](https://msdn.microsoft.com/library/hh452235.aspx)

[Ορισμός ιδιοτήτων υπηρεσίας Ουράς](https://msdn.microsoft.com/library/hh452232.aspx)

[Ρύθμιση ιδιοτήτων υπηρεσίας πίνακα](https://msdn.microsoft.com/library/hh452240.aspx)

[Κοινή χρήση προδιαγραφή πόρων σταυρό Origin W3C](http://www.w3.org/TR/cors/)

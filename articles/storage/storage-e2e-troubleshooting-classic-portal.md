<properties 
    pageTitle="Για να ολοκληρωμένες αντιμετώπιση προβλημάτων με χρήση μετρικά αποθήκευσης Azure και καταγραφή, AzCopy και το μήνυμα "Ανάλυση" | Microsoft Azure" 
    description="Ένα πρόγραμμα εκμάθησης που καταδεικνύουν ολοκληρωμένες για αντιμετώπιση προβλημάτων με την ανάλυση Azure χώρου αποθήκευσης, AzCopy και Microsoft μήνυμα Analyzer" 
    services="storage" 
    documentationCenter="dotnet" 
    authors="robinsh" 
    manager="carmonm"/>

<tags 
    ms.service="storage" 
    ms.workload="storage" 
    ms.tgt_pltfrm="na" 
    ms.devlang="dotnet" 
    ms.topic="article" 
    ms.date="08/03/2016" 
    ms.author="robinsh"/>

# <a name="end-to-end-troubleshooting-using-azure-storage-metrics-and-logging-azcopy-and-message-analyzer"></a>Αντιμετώπιση προβλημάτων σε ολοκληρωμένες χρησιμοποιώντας μετρικά αποθήκευσης Azure και καταγραφή, AzCopy και το μήνυμα "Ανάλυση" 

[AZURE.INCLUDE [storage-selector-portal-e2e-troubleshooting](../../includes/storage-selector-portal-e2e-troubleshooting.md)]

## <a name="overview"></a>Επισκόπηση

Διάγνωση και αντιμετώπιση προβλημάτων είναι ένα πλήκτρο δεξιοτήτων για τη δημιουργία και υποστήριξης, εφαρμογές προγράμματος-πελάτη με το Microsoft Azure αποθήκευσης. Λόγω της φύσης κατανέμεται μια εφαρμογή του Azure, ενδέχεται να είναι πιο σύνθετο από σε παραδοσιακά περιβάλλοντα διάγνωση και αντιμετώπιση σφαλμάτων και θέματα απόδοσης.

Σε αυτό το πρόγραμμα εκμάθησης, θα θα δείξουμε πώς να εντοπίζετε προγράμματος-πελάτη ορισμένα σφάλματα που μπορεί να επηρεάσει την απόδοση και αντιμετώπιση προβλημάτων αυτά τα σφάλματα από λήξη-σε-end χρησιμοποιώντας τα εργαλεία που παρέχονται από τη Microsoft και αποθήκευσης Azure, προκειμένου να βελτιστοποιήσετε την εφαρμογή-πελάτη. 

Αυτό το πρόγραμμα εκμάθησης παρέχει μια πρακτικής Εξερεύνηση ενός σεναρίου αντιμετώπισης προβλημάτων για να ολοκληρωμένες. Μια αναλυτικά εννοιολογική οδηγού για την αντιμετώπιση προβλημάτων εφαρμογών Azure χώρου αποθήκευσης, ανατρέξτε στο θέμα [Εποπτεία, διάγνωση, και αντιμετώπιση προβλημάτων του Microsoft Azure αποθήκευσης](storage-monitoring-diagnosing-troubleshooting.md). 

## <a name="tools-for-troubleshooting-azure-storage-applications"></a>Εργαλεία για την αντιμετώπιση προβλημάτων εφαρμογών αποθήκευσης Azure

Για την αντιμετώπιση προβλημάτων σε εφαρμογές προγράμματος-πελάτη με χρήση του Microsoft Azure αποθήκευσης, μπορείτε να χρησιμοποιήσετε ένα συνδυασμό των εργαλείων για να καθορίσετε πότε Παρουσιάστηκε κάποιο πρόβλημα και τι μπορεί να είναι η αιτία του προβλήματος. Αυτά τα εργαλεία περιλαμβάνουν:

- **Ανάλυση azure χώρου αποθήκευσης**. [Ανάλυση αποθήκευσης Azure](http://msdn.microsoft.com/library/azure/hh343270.aspx) παρέχει μετρήσεις και καταγραφής για το χώρο αποθήκευσης Azure.
    - **Μετρικών αποθήκευσης που** παρακολουθεί τις μετρήσεις συναλλαγή και χωρητικότητα μετρήσεις για το λογαριασμό χώρου αποθήκευσης. Χρήση μετρικά, μπορείτε να προσδιορίσετε την απόδοση της εφαρμογής σας σύμφωνα με μια ποικιλία διάφορα μέτρα. Για περισσότερες πληροφορίες σχετικά με τους τύπους μετρικά παρακολουθείται από ανάλυση χώρου αποθήκευσης, ανατρέξτε στο θέμα [Σχήματος πίνακα μετρικά αποθήκευσης ανάλυσης](http://msdn.microsoft.com/library/azure/hh343264.aspx) . 

    - **Χώρος αποθήκευσης καταγραφής** καταγράφει κάθε αίτηση με τις υπηρεσίες αποθήκευσης Azure σε ένα αρχείο καταγραφής πλευρά του διακομιστή. Το αρχείο καταγραφής παρακολουθεί λεπτομερή δεδομένα για κάθε αίτηση, συμπεριλαμβανομένης της λειτουργίας που εκτελούνται, την κατάσταση της εργασίας, καθώς και πληροφορίες λανθάνοντος χρόνου. Για περισσότερες πληροφορίες σχετικά με τα δεδομένα αίτησης και απόκρισης που έχει συνταχθεί στα αρχεία καταγραφής από ανάλυση χώρου αποθήκευσης, ανατρέξτε στο θέμα [Μορφή αρχείου καταγραφής ανάλυσης χώρου αποθήκευσης](http://msdn.microsoft.com/library/azure/hh343259.aspx) .

> [AZURE.NOTE] Οι λογαριασμοί χώρου αποθήκευσης με έναν τύπο αναπαραγωγής της ζώνης πλεονάζοντα χώρο αποθήκευσης (ZRS) δεν διαθέτουν το μετρικά ή τη δυνατότητα καταγραφής ενεργοποιήσει αυτήν τη στιγμή. 

- **Azure κλασική πύλη**. Μπορείτε να ρυθμίσετε τις μετρήσεις και καταγραφής για το λογαριασμό χώρου αποθήκευσης στην [Πύλη κλασική Azure](https://manage.windowsazure.com). Μπορείτε επίσης να προβάλετε γραφήματα και γραφικά που σας δείχνουν πώς αποδίδει την εφαρμογή σας με τον καιρό, και ρύθμιση παραμέτρων ειδοποιήσεων για να σας ειδοποιεί όταν η εφαρμογή σας εκτελεί διαφορετική από την αναμενόμενη για ένα συγκεκριμένο μετρικό. 
    
    Για πληροφορίες σχετικά με τη ρύθμιση των παραμέτρων παρακολούθησης στην πύλη κλασική Azure, ανατρέξτε στο θέμα [παρακολούθηση ενός λογαριασμού χώρου αποθήκευσης στην πύλη του Azure](storage-monitor-storage-account.md) .

- **AzCopy**. Αρχεία καταγραφής του διακομιστή για το χώρο αποθήκευσης Azure αποθηκεύονται ως αντικείμενα blob, ώστε να μπορείτε να χρησιμοποιήσετε για να αντιγράψετε τα αντικείμενα BLOB καταγραφής σε έναν τοπικό κατάλογο για την ανάλυση χρησιμοποιώντας την ανάλυση μήνυμα Microsoft AzCopy. Για περισσότερες πληροφορίες σχετικά με το AzCopy, ανατρέξτε στο θέμα [μεταφορά δεδομένων με το βοηθητικό πρόγραμμα γραμμής εντολών AzCopy](storage-use-azcopy.md) .

- **Ανάλυση μηνύματος της Microsoft**. Μήνυμα Analyzer είναι ένα εργαλείο που χρησιμοποιεί τα αρχεία καταγραφής και εμφανίζει δεδομένα του αρχείου καταγραφής σε μορφή οπτική που διευκολύνει την φιλτράρισμα, αναζήτηση και ομαδοποίηση δεδομένων αρχείου καταγραφής σε χρήσιμες σύνολα που μπορείτε να χρησιμοποιήσετε για την ανάλυση σφαλμάτων και θέματα απόδοσης. Για περισσότερες πληροφορίες σχετικά με το μήνυμα "Ανάλυση", ανατρέξτε στο θέμα [Οδηγός λειτουργικό Analyzer μήνυμα Microsoft](http://technet.microsoft.com/library/jj649776.aspx) .

## <a name="about-the-sample-scenario"></a>Σχετικά με το δείγμα σεναρίου

Για αυτό το πρόγραμμα εκμάθησης, θα σας θα εξετάζει ένα σενάριο όπου μετρικά αποθήκευσης Azure υποδεικνύει χαμηλό ποσοστό επιτυχίας χρέωσης για μια εφαρμογή που καλεί Azure χώρου αποθήκευσης. Τη μέτρηση επιτόκιο χαμηλής ποσοστό επιτυχίας (εμφανίζεται ως **PercentSuccess** στην πύλη κλασική Azure και στους πίνακες μετρήσεις) παρακολουθεί τις λειτουργίες που είναι επιτυχής, αλλά που επιστρέφουν έναν κωδικό κατάστασης HTTP που είναι μεγαλύτερη από 299. Στα αρχεία καταγραφής χώρο αποθήκευσης στο διακομιστή, αυτές οι λειτουργίες καταγράφονται με κατάσταση συναλλαγής **ClientOtherErrors**. Για περισσότερες λεπτομέρειες σχετικά με τη μέτρηση χαμηλής ποσοστού επιτυχίας, ανατρέξτε στο θέμα [μετρικά εμφάνιση χαμηλής PercentSuccess ή εγγραφές καταγραφής αναλυτικών στοιχείων έχουν λειτουργιών με κατάσταση συναλλαγής ClientOtherErrors](storage-monitoring-diagnosing-troubleshooting.md#metrics-show-low-percent-success).

Azure εργασίες αποθήκευσης ενδέχεται να επιστρέψει κωδικοί κατάστασης HTTP μεγαλύτερο από 299 ως μέρος της κανονικής τη λειτουργία τους. Αλλά αυτά τα σφάλματα σε ορισμένες περιπτώσεις υποδεικνύουν ότι ενδέχεται να μπορείτε να βελτιστοποιήσετε την εφαρμογή-πελάτη για βελτιωμένη απόδοση. 

Σε αυτό το σενάριο, θα σας θα μπορείτε να χρέωσης χαμηλής ποσοστού επιτυχίας να είναι οτιδήποτε κάτω από 100%. Μπορείτε να επιλέξετε διαφορετικό επίπεδο μετρικό, ωστόσο, σύμφωνα με τις ανάγκες σας. Συνιστάται να ότι κατά τον έλεγχο της εφαρμογής σας, μπορείτε να δημιουργήσετε ανοχή γραμμής βάσης για τις επιδόσεις του κλειδιού μετρικά. Για παράδειγμα, μπορεί να διαπιστώσετε, με βάση τον έλεγχο, ότι η εφαρμογή σας πρέπει να έχουν μια συνεπή ποσοστού επιτυχίας χρέωση 90% ή 85%. Εάν τα δεδομένα σας μετρικά δείχνει ότι η εφαρμογή απόκλισης από αυτόν τον αριθμό και, στη συνέχεια, μπορείτε να εξετάσετε τι μπορεί να προκαλεί την αύξηση. 

Σενάριο μας δείγμα, όταν θα σας έχετε δημιουργήσει ότι τη μέτρηση ποσοστού επιτυχίας επιτόκιο είναι κάτω από 100%, θα σας θα εξετάστε τα αρχεία καταγραφής για να βρείτε τα σφάλματα που συσχετίζονται τα μετρικά και χρησιμοποιήστε τους για να υπολογίσετε τι προκαλεί τη χαμηλότερη χρέωση ποσοστού επιτυχίας. Θα εξετάσουμε συγκεκριμένα σφάλματα στην περιοχή 400. Στη συνέχεια, θα εξετάσουμε πιο προσεκτικά 404 σφάλματα (δεν βρέθηκε).

### <a name="some-causes-of-400-range-errors"></a>Ορισμένες αιτίες σφαλμάτων 400-περιοχή

Στα παρακάτω παραδείγματα εμφανίζει ένα δείγμα ορισμένα σφάλματα 400-περιοχή για προσκλήσεις σε σχέση με το χώρο αποθήκευσης Blob του Azure και τις πιθανές αιτίες. Οποιαδήποτε από αυτά τα σφάλματα, καθώς και σφαλμάτων σε 300 περιοχή και περιοχή 500, μπορούν να συμβάλλουν χαμηλής ποσοστού επιτυχίας χρέωσης. 

Σημειώστε ότι οι παρακάτω λίστες από ολοκλήρωσης. Δείτε [την κατάσταση και τους κωδικούς σφάλματος](http://msdn.microsoft.com/library/azure/dd179382.aspx) για λεπτομέρειες σχετικά με γενικά σφάλματα αποθήκευσης Azure και σφάλματα για κάθε μία από τις υπηρεσίες του χώρου αποθήκευσης.

**Παραδείγματα κώδικα 404 (δεν βρέθηκε) κατάστασης**

Πραγματοποιείται όταν μια λειτουργία ανάγνωσης σε κοντέινερ ή blob αποτύχει επειδή δεν βρέθηκε το blob ή κοντέινερ.

- Παρουσιάζεται εάν ένα κοντέινερ ή blob έχει διαγραφεί από άλλο πρόγραμμα-πελάτη πριν από αυτήν την αίτηση. 
- Παρουσιάζεται εάν χρησιμοποιείτε μια κλήση API που δημιουργεί το κοντέινερ ή blob μετά τον έλεγχο εάν υπάρχει. Τα API CreateIfNotExists πραγματοποίηση κλήσης ΚΕΦΑΛΉ πρώτα, για να ελέγξετε για την ύπαρξη του κοντέινερ ή blob; Εάν δεν υπάρχει, επιστρέφεται ένα σφάλμα 404 και, στη συνέχεια, μια δεύτερη κλήση ΤΟΠΟΘΈΤΗΣΗ πραγματοποιείται για να γράψετε το κοντέινερ ή blob.

**Κωδικός κατάστασης 409 παραδείγματα (διένεξη)**

- Παρουσιάζεται εάν χρησιμοποιείτε ένα API Δημιουργία για να δημιουργήσετε ένα νέο κοντέινερ ή blob, χωρίς να ελέγξετε για την ύπαρξη πρώτα και υπάρχει ήδη ένα κοντέινερ ή blob με αυτό το όνομα. 
- Παρουσιάζεται όταν διαγράφεται ένα κοντέινερ και προσπαθείτε να δημιουργήσετε ένα νέο κοντέινερ με το ίδιο όνομα, πριν να ολοκληρωθεί η λειτουργία διαγραφής.
- Παρουσιάζεται εάν καθορίσετε μια μίσθωση σε κοντέινερ ή blob και υπάρχει ήδη μια παρουσίαση μίσθωση.
 
**Ο κωδικός κατάστασης 412 (προϋπόθεση απέτυχε) παραδείγματα**

- Πραγματοποιείται όταν η συνθήκη που καθορίζεται από μια επικεφαλίδα υπό όρους δεν τηρείται.
- Πραγματοποιείται όταν το καθορισμένο Αναγνωριστικό μίσθωσης δεν ταιριάζουν με το Αναγνωριστικό μίσθωσης στο κοντέινερ ή blob.

## <a name="generate-log-files-for-analysis"></a>Δημιουργία αρχείων καταγραφής για την ανάλυση

Σε αυτό το πρόγραμμα εκμάθησης, θα χρησιμοποιήσουμε το μήνυμα "Ανάλυση" για να εργαστείτε με τρεις διαφορετικοί τύποι αρχείων καταγραφής, παρόλο που μπορείτε να επιλέξετε για να εργαστείτε με ένα από τα εξής:

- **Αρχείο καταγραφής διακομιστή**, που δημιουργείται κατά την ενεργοποίηση της καταγραφής αποθήκευσης Azure. Το αρχείο καταγραφής διακομιστή περιέχει δεδομένα σχετικά με κάθε λειτουργίας που ονομάζεται σύμφωνα με μία από τις υπηρεσίες αποθήκευσης Azure - blob, ουρά, πίνακα και αρχείων. Το αρχείο καταγραφής διακομιστή υποδεικνύει ποια λειτουργία ονομαζόταν και τι ο κωδικός κατάστασης ήταν επιστρέφεται, καθώς και άλλες λεπτομέρειες σχετικά με το αίτησης και απόκρισης.
- **Αρχείο καταγραφής πελάτη .NET**, που δημιουργείται όταν ενεργοποιείτε την καταγραφή από την πλευρά του προγράμματος-πελάτη από μέσα από την εφαρμογή .NET. Το αρχείο καταγραφής πελάτη περιλαμβάνει λεπτομερείς πληροφορίες σχετικά με τον τρόπο ο υπολογιστής-πελάτης προετοιμάζει την αίτηση και λαμβάνει και επεξεργάζεται την απάντηση. 
- **Αρχείο καταγραφής ανίχνευσης δικτύου HTTP**, που συλλέγει δεδομένα σε HTTP/HTTPS αίτησης και απόκρισης δεδομένα, συμπεριλαμβανομένων των για λειτουργίες σε σχέση με το χώρο αποθήκευσης Azure. Σε αυτό το πρόγραμμα εκμάθησης, θα σας θα δημιουργήσει την ανίχνευση δικτύου μέσω υπηρεσίας ανάλυσης του μηνύματος.

### <a name="configure-server-side-logging-and-metrics"></a>Ρύθμιση παραμέτρων καταγραφή από την πλευρά του διακομιστή και μετρήσεις

Πρώτα, θα πρέπει να ρυθμίσετε τις παραμέτρους καταγραφής αποθήκευσης Azure και μετρήσεις, ώστε να έχουμε δεδομένα από την εφαρμογή-πελάτη για την ανάλυση. Μπορείτε να ρυθμίσετε καταγραφή και μετρήσεις με διάφορους τρόπους - μέσω του [Azure κλασική πύλη](https://manage.windowsazure.com), με χρήση του PowerShell, ή μέσω προγραμματισμού. Ανατρέξτε στο θέμα [Ενεργοποίηση μετρικά αποθήκευσης και προβολή μετρικά δεδομένων](http://msdn.microsoft.com/library/azure/dn782843.aspx) και [Ενεργοποίηση καταγραφής αποθήκευσης και πρόσβαση σε δεδομένα του αρχείου καταγραφής](http://msdn.microsoft.com/library/azure/dn782840.aspx) για λεπτομέρειες σχετικά με τη ρύθμιση των παραμέτρων καταγραφής και μετρήσεις.

**Μέσω κλασική πύλη του Azure**

Για να ρυθμίσετε τις παραμέτρους καταγραφής και μετρήσεις για το λογαριασμό χώρου αποθήκευσης με την πύλη, ακολουθήστε τις οδηγίες στην [οθόνη ενός λογαριασμού χώρου αποθήκευσης στην πύλη του Azure](storage-monitor-storage-account.md).

> [AZURE.NOTE] Δεν είναι δυνατός ο ορισμός minute μετρικά με την πύλη κλασική Azure. Ωστόσο, συνιστάται να ορίσετε τους για τους σκοπούς αυτού του προγράμματος εκμάθησης, καθώς και για τη διερεύνηση θέματα απόδοσης με την εφαρμογή σας. Μπορείτε να ορίσετε minute μετρικά με χρήση του PowerShell, όπως φαίνεται παρακάτω, ή μέσω προγραμματισμού ή μέσω της πύλης κλασική Azure.
>
> Σημειώστε ότι η πύλη κλασική Azure δεν μπορεί να εμφανίσει minute μετρήσεις, μόνο ωριαία μετρικά. 

**Μέσω του PowerShell**

Για να ξεκινήσετε με το PowerShell για Azure, δείτε [πώς μπορείτε να εγκαταστήσετε και να ρυθμίσετε τις παραμέτρους του PowerShell Azure](../powershell-install-configure.md).

1. Χρησιμοποιήστε το cmdlet [AzureAccount Προσθήκη](http://msdn.microsoft.com/library/azure/dn722528.aspx) για να προσθέσετε το λογαριασμό χρήστη Azure στο παράθυρο του PowerShell:

    ```
    Add-AzureAccount
    ```

2. Στο παράθυρο **συνδεθείτε στο Windows Azure** , πληκτρολογήστε τη διεύθυνση ηλεκτρονικού ταχυδρομείου και τον κωδικό πρόσβασης που σχετίζεται με το λογαριασμό σας. Azure πραγματοποιεί έλεγχο ταυτότητας και αποθηκεύει τις πληροφορίες διαπιστευτηρίων και, στη συνέχεια, κλείνει το παράθυρο.
3. Ορισμός του προεπιλεγμένου λογαριασμού χώρου αποθήκευσης για το λογαριασμό χώρου αποθήκευσης που χρησιμοποιείτε για το πρόγραμμα εκμάθησης με την εκτέλεση αυτών των εντολών στο παράθυρο του PowerShell:

    ```
    $SubscriptionName = 'Your subscription name'
    $StorageAccountName = 'yourstorageaccount' 
    Set-AzureSubscription -CurrentStorageAccountName $StorageAccountName -SubscriptionName $SubscriptionName 
    ```

4. Ενεργοποίηση της καταγραφής χώρου αποθήκευσης για την υπηρεσία Blob: 
 
    ```
    Set-AzureStorageServiceLoggingProperty -ServiceType Blob -LoggingOperations Read,Write,Delete -PassThru -RetentionDays 7 -Version 1.0 
    ```
5. Ενεργοποίηση μετρικά αποθήκευσης για την υπηρεσία Blob, φροντίζοντας να ρυθμίσετε **- MetricsType** `Minute`:

    ```
    Set-AzureStorageServiceMetricsProperty -ServiceType Blob -MetricsType Minute -MetricsLevel ServiceAndApi -PassThru -RetentionDays 7 -Version 1.0 
    ```

### <a name="configure-net-client-side-logging"></a>Ρύθμιση παραμέτρων .NET καταγραφή από την πλευρά του προγράμματος-πελάτη

Για να ρυθμίσετε τις παραμέτρους καταγραφή από την πλευρά του προγράμματος-πελάτη για μια εφαρμογή .NET, ενεργοποιήστε τα Διαγνωστικά του .NET στο αρχείο ρύθμισης παραμέτρων της εφαρμογής (web.config ή app.config). Ανατρέξτε στο θέμα [καταγραφή από την πλευρά του προγράμματος-πελάτη με τη βιβλιοθήκη .NET αποθήκευσης προγράμματος-πελάτη](http://msdn.microsoft.com/library/azure/dn782839.aspx) και [- πελάτη σύνδεση με το Microsoft Azure αποθήκευσης SDK για Java](http://msdn.microsoft.com/library/azure/dn782844.aspx) για λεπτομέρειες.

Το αρχείο καταγραφής πλευρά του προγράμματος-πελάτη περιλαμβάνει λεπτομερείς πληροφορίες σχετικά με τον τρόπο ο υπολογιστής-πελάτης προετοιμάζει την αίτηση και λαμβάνει και επεξεργάζεται την απάντηση.

Η βιβλιοθήκη προγράμματος-πελάτη αποθήκευσης αποθηκεύει δεδομένα του αρχείου καταγραφής πλευρά του προγράμματος-πελάτη στη θέση που καθορίζεται στο αρχείο ρύθμισης παραμέτρων της εφαρμογής (web.config ή app.config). 

### <a name="collect-a-network-trace"></a>Συλλογή ανίχνευση δικτύου

Μπορείτε να χρησιμοποιήσετε το μήνυμα "Ανάλυση" για τη συλλογή μια ανίχνευση δικτύου HTTP/HTTPS ενώ εκτελείται την εφαρμογή-πελάτη. Μήνυμα "Ανάλυση" χρησιμοποιεί [Fiddler](http://www.telerik.com/fiddler) στο παρασκήνιο. Πριν από την συλλέγετε ανίχνευση δικτύου, συνιστάται να ρυθμίζετε τις παραμέτρους Fiddler για την εγγραφή χωρίς κρυπτογράφηση κίνηση HTTPS:

1. Εγκαταστήστε το [Fiddler](http://www.telerik.com/download/fiddler).
2. Εκκίνηση Fiddler.
2. Επιλέξτε Εργαλεία **| Επιλογές fiddler**.
3. Στο παράθυρο διαλόγου Επιλογές, βεβαιωθείτε ότι **Αποκρυπτογράφηση κυκλοφορία HTTPS** και **Καταγραφή δημιουργεί σύνδεση HTTPS** είναι και τα δύο επιλεγεί, όπως φαίνεται παρακάτω.

![Ρύθμιση παραμέτρων επιλογών Fiddler](./media/storage-e2e-troubleshooting-classic-portal/fiddler-options-1.png)

Για το πρόγραμμα εκμάθησης, συλλογή και αποθήκευση πρώτα ανίχνευση δικτύου στο μήνυμα "Ανάλυση" και, στη συνέχεια, δημιουργήστε μια περίοδο λειτουργίας ανάλυσης για την ανάλυση της ανίχνευσης και τα αρχεία καταγραφής. Για να συλλέξετε ανίχνευση δικτύου στο μήνυμα Analyzer:

1. Στο μήνυμα "Ανάλυση", επιλέξτε **αρχείο | Γρήγορη ανίχνευση | Χωρίς κρυπτογράφηση HTTPS**.
2. Η ανίχνευση θα ξεκινήσει αμέσως. Επιλέξτε **Διακοπή** για να διακόψετε την ανίχνευση, έτσι ώστε να σας μπορεί να ρυθμίσετε τις παραμέτρους της στην ανίχνευση κυκλοφορία αποθήκευσης μόνο.
3. Επιλέξτε " **Επεξεργασία** " για να επεξεργαστείτε την περίοδο λειτουργίας ανίχνευσης.
4. Επιλέξτε τη σύνδεση **Ρύθμιση παραμέτρων** στα δεξιά της υπηρεσίας παροχής ETW του **Microsoft-Pef-WebProxy** .
5. Στο παράθυρο διαλόγου **Ρυθμίσεις για προχωρημένους** , κάντε κλικ στην καρτέλα **υπηρεσία παροχής που χρησιμοποιείτε** .
6. Στο πεδίο **Όνομα κεντρικού υπολογιστή φίλτρου** , καθορίστε το τελικά σημεία του χώρου αποθήκευσης, διαχωρισμένες με κενά διαστήματα. Για παράδειγμα, μπορείτε να καθορίσετε ως εξής; σας τελικά σημεία Αλλαγή `storagesample` στο όνομα του λογαριασμού σας χώρου αποθήκευσης:
    
    ``` 
    storagesample.blob.core.windows.net storagesample.queue.core.windows.net storagesample.table.core.windows.net 
    ```

7. Έξοδος από το παράθυρο διαλόγου και κάντε κλικ στην επιλογή **επανεκκίνηση** για να ξεκινήσετε τη συλλογή ανίχνευση με το φίλτρο hostname στη θέση, έτσι ώστε μόνο κίνηση του δικτύου αποθήκευσης Azure περιλαμβάνεται στην ανίχνευση.

>[AZURE.NOTE] Αφού ολοκληρώσετε τη συλλογή ανίχνευση του δικτύου σας, συνιστάται να επαναφέρετε τις ρυθμίσεις που μπορεί να έχετε αλλάξει σε Fiddler αποκρυπτογράφηση HTTPS κίνηση. Στο παράθυρο διαλόγου Επιλογές Fiddler, απενεργοποιήστε τα πλαίσια ελέγχου **Καταγραφή δημιουργεί σύνδεση HTTPS** και **Αποκρυπτογράφηση κίνηση HTTPS** .

Ανατρέξτε στο θέμα [χρήση των δυνατοτήτων ανίχνευση δικτύου](http://technet.microsoft.com/library/jj674819.aspx) στο Technet για περισσότερες λεπτομέρειες.

## <a name="review-metrics-data-in-the-azure-classic-portal"></a>Αναθεώρηση δεδομένων μετρικά στην πύλη κλασική Azure

Όταν η εφαρμογή σας έχει εκτελεστεί για μια χρονική περίοδο, μπορείτε να δείτε τα γραφήματα μετρικά που εμφανίζονται στην πύλη του Azure κλασική για να δείτε πώς έχει αποδίδει την υπηρεσία. Πρώτα, θα προσθέσουμε τη μέτρηση **Ποσοστού επιτυχίας** στη σελίδα "Παρακολούθηση":

1. Μεταβείτε στον πίνακα εργαλείων για το λογαριασμό χώρου αποθήκευσης στην [Πύλη κλασική Azure](https://manage.windowsazure.com)και, στη συνέχεια, επιλέξτε **την οθόνη** για να προβάλετε τη σελίδα παρακολούθησης.
2. Κάντε κλικ στην επιλογή **Προσθήκη μετρικά** για να εμφανίσετε το παράθυρο διαλόγου **Επιλέξτε μετρήσεις** .
3. Κάντε κύλιση προς τα κάτω, βρείτε την ομάδα **Ποσοστό επιτυχίας** , αναπτύξτε ξανά, στη συνέχεια, επιλέξτε **συγκεντρωτικών αποτελεσμάτων**, όπως φαίνεται στην παρακάτω εικόνα. Αυτό το μετρικό συγκεντρώνει δεδομένα ποσοστό επιτυχίας από όλες οι λειτουργίες Blob.

![Επιλέξτε μετρήσεις](./media/storage-e2e-troubleshooting-classic-portal/choose-metrics-portal-1.png)

Στην κλασική πύλη Azure, τώρα βλέπετε **Ποσοστό επιτυχίας** στο γράφημα παρακολούθησης, μαζί με οποιαδήποτε άλλα μετρικά ενδέχεται να έχετε προσθέσει (έως έξι μπορούν να εμφανιστούν στο γράφημα κάθε φορά). Στην παρακάτω εικόνα, μπορείτε να δείτε ότι το ποσοστό ποσοστού επιτυχίας είναι λίγο κάτω από 100%, το οποίο είναι το σενάριο, θα εξετάσουμε δίπλα από την ανάλυση των αρχείων καταγραφής στο μήνυμα Analyzer:

![Γράφημα μετρικά στην πύλη](./media/storage-e2e-troubleshooting-classic-portal/portal-metrics-chart-1.png)

Για περισσότερες λεπτομέρειες σχετικά με την προσθήκη μετρικά στη σελίδα παρακολούθησης, ανατρέξτε στο θέμα [ΔΙΑΔΙΚΑΣΙΕΣ: Προσθήκη μετρικά στον πίνακα μετρικά](storage-monitor-storage-account.md#how-to-add-metrics-to-the-metrics-table).

> [AZURE.NOTE] Ενδέχεται να χρειαστεί κάποιος χρόνος για τα δεδομένα σας μετρικά να εμφανίζεται στην πύλη κλασική Azure μετά την ενεργοποίηση της μετρικά αποθήκευσης. Αυτό συμβαίνει επειδή ωριαία μετρήσεις για την προηγούμενη ώρα δεν εμφανίζονται στην πύλη κλασική Azure μέχρι να έχει παρέλθει της τρέχουσας ώρας. Επίσης, δεν εμφανίζονται λεπτό μετρικά στην πύλη κλασική Azure. Επομένως, ανάλογα με το όταν ενεργοποιείτε μετρικά, ενδέχεται να χρειαστούν έως και δύο ώρες για να δείτε μετρικά δεδομένα.

## <a name="use-azcopy-to-copy-server-logs-to-a-local-directory"></a>Χρησιμοποιήστε AzCopy για να αντιγράψετε αρχεία καταγραφής του διακομιστή σε έναν τοπικό κατάλογο

Azure αποθήκευσης εγγράφει δεδομένα του αρχείου καταγραφής διακομιστή αντικείμενα blob, ενώ μετρικά είναι γραμμένες σε πίνακες. Αρχείο καταγραφής αντικείμενα BLOB είναι διαθέσιμες στο τις γνωστές `$logs` κοντέινερ για το λογαριασμό χώρου αποθήκευσης. Αρχείο καταγραφής αντικείμενα BLOB ονομάζονται ιεραρχικά από έτος, μήνας, ημέρα και ώρα, ώστε να μπορείτε εύκολα να εντοπίσετε το εύρος χρόνου που θέλετε να ερευνήσετε. Για παράδειγμα, το `storagesample` λογαριασμό, το κοντέινερ για το αρχείο καταγραφής αντικείμενα BLOB 01/02/2015, από 8-9 π.μ., έχει `https://storagesample.blob.core.windows.net/$logs/blob/2015/01/08/0800`. Τα μεμονωμένα αντικείμενα BLOB σε αυτό το κοντέινερ είναι καθορισμένοι διαδοχικά, ξεκινώντας με `000000.log`.

Μπορείτε να χρησιμοποιήσετε το εργαλείο γραμμής εντολών AzCopy για να κάνετε λήψη αυτών των αρχείων καταγραφής διακομιστή σε μια θέση της επιλογής σας στον τοπικό υπολογιστή σας. Για παράδειγμα, μπορείτε να χρησιμοποιήσετε την παρακάτω εντολή για να κάνετε λήψη των αρχείων καταγραφής για λειτουργίες blob που πραγματοποιήθηκαν σε 2 Ιανουαρίου 2015 στο φάκελο `C:\Temp\Logs\Server`; Αντικατάσταση `<storageaccountname>` με το όνομα του λογαριασμού σας χώρου αποθήκευσης, και `<storageaccountkey>` με το κλειδί πρόσβασης του λογαριασμού σας:

    AzCopy.exe /Source:http://<storageaccountname>.blob.core.windows.net/$logs /Dest:C:\Temp\Logs\Server /Pattern:"blob/2015/01/02" /SourceKey:<storageaccountkey> /S /V

AzCopy είναι διαθέσιμο για λήψη από τη σελίδα [Λήψεων του Azure](https://azure.microsoft.com/downloads/) . Για λεπτομέρειες σχετικά με τη χρήση AzCopy, ανατρέξτε στο θέμα [μεταφορά δεδομένων με το βοηθητικό πρόγραμμα γραμμής εντολών AzCopy](storage-use-azcopy.md).

Για πρόσθετες πληροφορίες σχετικά με τη λήψη αρχεία καταγραφής από την πλευρά του διακομιστή, ανατρέξτε στο θέμα [λήψη καταγραφής αποθήκευσης δεδομένων καταγραφής](http://msdn.microsoft.com/library/azure/dn782840.aspx#DownloadingStorageLogginglogdata). 

## <a name="use-microsoft-message-analyzer-to-analyze-log-data"></a>Χρήση υπηρεσίας ανάλυσης του Microsoft μήνυμα για την ανάλυση δεδομένων αρχείου καταγραφής

Microsoft μήνυμα Analyzer είναι ένα εργαλείο για την καταγραφή, εμφάνιση και την ανάλυση πρωτόκολλο μηνυμάτων κίνηση, συμβάντων και άλλα μηνύματα συστήματος ή την εφαρμογή στην αντιμετώπιση προβλημάτων και διαγνωστικά σενάρια. Μήνυμα "Ανάλυση" σάς επιτρέπει να φορτώσετε, συγκέντρωση και ανάλυση των δεδομένων από αρχείο καταγραφής επίσης και αποθηκεύονται αρχεία παρακολούθησης. Για περισσότερες πληροφορίες σχετικά με το μήνυμα "Ανάλυση", ανατρέξτε στο θέμα [Οδηγός λειτουργικό Analyzer μήνυμα Microsoft](http://technet.microsoft.com/library/jj649776.aspx).

Μήνυμα "Ανάλυση" περιλαμβάνει περιουσιακών στοιχείων για το χώρο αποθήκευσης Azure που σας βοηθούν να αναλύσετε διακομιστή, προγράμματος-πελάτη και των αρχείων καταγραφής δικτύου. Σε αυτήν την ενότητα, θα εξετάσουμε πώς μπορείτε να χρησιμοποιήσετε αυτά τα εργαλεία για να αντιμετωπίσετε το πρόβλημα χαμηλής ποσοστού επιτυχίας στα αρχεία καταγραφής αποθήκευσης.

### <a name="download-and-install-message-analyzer-and-the-azure-storage-assets"></a>Λήψη και εγκατάσταση υπηρεσίας ανάλυσης του μηνύματος και τα στοιχεία αποθήκευσης Azure

1. Κάντε λήψη του [Μηνύματος "Ανάλυση"](http://www.microsoft.com/download/details.aspx?id=44226) από το Κέντρο λήψης της Microsoft και εκτελέστε το πρόγραμμα εγκατάστασης.
2. Εκκινήστε το μήνυμα "Ανάλυση".
3. Από το μενού **Εργαλεία** , επιλέξτε **Διαχείριση περιουσιακών στοιχείων**. Στο παράθυρο διαλόγου **Διαχείριση περιουσιακών στοιχείων** , επιλέξτε **στοιχεία λήψης**και, στη συνέχεια, φιλτράρετε **Αποθήκευσης Azure**. Θα δείτε το χώρο αποθήκευσης πόρους Azure, όπως φαίνεται στην παρακάτω εικόνα.
4. Κάντε κλικ στο κουμπί **Συγχρονισμός όλα εμφανίζονται τα στοιχεία** για την εγκατάσταση των περιουσιακών στοιχείων Azure χώρου αποθήκευσης. Τα διαθέσιμα στοιχεία περιλαμβάνουν τα εξής:
    - **Κανόνες χρώμα azure χώρου αποθήκευσης:** Azure κανόνες χρώμα χώρου αποθήκευσης σάς επιτρέπουν να ορίσετε ειδική φίλτρα που χρησιμοποιούν χρώμα, το κείμενο και στυλ γραμματοσειράς για να επισημάνετε τα μηνύματα που περιέχουν συγκεκριμένες πληροφορίες σε μια ανίχνευση.
    - **Γραφήματα azure χώρου αποθήκευσης:** Τα γραφήματα Azure χώρου αποθήκευσης είναι προκαθορισμένες γραφήματα που γράφημα δεδομένα του αρχείου καταγραφής διακομιστή. Σημειώστε ότι για να χρησιμοποιήσετε γραφήματα αποθήκευσης Azure αυτήν τη στιγμή, ενδέχεται να μόνο φορτώσετε το αρχείο καταγραφής διακομιστή στο πλέγμα ανάλυσης.
    - **Ανάλυσης azure χώρου αποθήκευσης:** Το χώρο αποθήκευσης Azure ανάλυσης ανάλυση το χώρο αποθήκευσης Azure προγράμματος-πελάτη, διακομιστή και αρχεία καταγραφής HTTP για να εμφανίσετε στο πλέγμα ανάλυσης.
    - **Φίλτρα azure χώρου αποθήκευσης:** Azure φίλτρα χώρου αποθήκευσης είναι προκαθορισμένες κριτήρια που μπορείτε να χρησιμοποιήσετε ερώτημα για τα δεδομένα σας στο πλέγμα ανάλυσης.
    - **Διατάξεις προβολή azure χώρου αποθήκευσης:** Azure διατάξεις προβολή χώρου αποθήκευσης είναι προκαθορισμένων διατάξεων στηλών και ομαδοποιήσεων στο πλέγμα ανάλυσης.
4. Επανεκκινήστε το μήνυμα "Ανάλυση" μετά την εγκατάσταση των περιουσιακών στοιχείων.

![Διαχείριση περιουσιακών στοιχείων υπηρεσίας ανάλυσης του μηνύματος](./media/storage-e2e-troubleshooting-classic-portal/mma-start-page-1.png)

> [AZURE.NOTE] Εγκατάσταση όλων των στο χώρο αποθήκευσης Azure ενεργητικό για τους σκοπούς αυτού του προγράμματος εκμάθησης.

### <a name="import-your-log-files-into-message-analyzer"></a>Εισαγωγή των αρχείων καταγραφής στο μήνυμα "Ανάλυση"

Μπορείτε να εισαγάγετε όλα τα αρχεία καταγραφής αποθηκευμένο (πλευρά του διακομιστή, πλευρά του προγράμματος-πελάτη και δίκτυο) σε μια μεμονωμένη περίοδο λειτουργίας στο Microsoft μήνυμα ανάλυσης για την ανάλυση.

1. Στο μενού " **αρχείο** " στο Microsoft Analyzer μήνυμα, κάντε κλικ στην επιλογή **Νέα περίοδο λειτουργίας**και, στη συνέχεια, κάντε κλικ στην επιλογή **Κενό περιόδου λειτουργίας**. Στο παράθυρο διαλόγου **Νέα περίοδο λειτουργίας** , πληκτρολογήστε ένα όνομα για την περίοδο λειτουργίας σας ανάλυσης. Στον πίνακα " **Λεπτομέρειες περιόδου λειτουργίας** ", κάντε κλικ στο κουμπί **αρχεία** . 
1. Για να φορτώσετε τα δεδομένα ανίχνευσης δικτύου που δημιουργούνται από το μήνυμα "Ανάλυση", κάντε κλικ στην εντολή **Προσθήκη αρχείων**, μεταβείτε στη θέση όπου αποθηκεύσατε το αρχείο .matp από την περίοδο λειτουργίας ανίχνευσης web, επιλέξτε το αρχείο .matp και κάντε κλικ στην επιλογή **Άνοιγμα**. 
1. Για να φορτώσετε τα δεδομένα του αρχείου καταγραφής πλευρά του διακομιστή, κάντε κλικ στην εντολή **Προσθήκη αρχείων**, μεταβείτε στη θέση όπου έχετε κάνει λήψη του αρχεία καταγραφής από την πλευρά του διακομιστή, επιλέξτε τα αρχεία καταγραφής για το χρονικό διάστημα που θέλετε να αναλύσετε και κάντε κλικ στην επιλογή **Άνοιγμα**. Στη συνέχεια, στον πίνακα **Λεπτομέρειες περιόδου λειτουργίας** , ορίστε τη **Ρύθμιση παραμέτρων καταγραφής κειμένου** αναπτυσσόμενη για κάθε αρχείο καταγραφής διακομιστή σε **AzureStorageLog** για να βεβαιωθείτε ότι το Microsoft μήνυμα Analyzer μπορεί να ανάλυσης του αρχείου καταγραφής σωστά.
1. Για να φορτώσετε τα δεδομένα του αρχείου καταγραφής πλευρά του προγράμματος-πελάτη, κάντε κλικ στην εντολή **Προσθήκη αρχείων**, μεταβείτε στη θέση όπου αποθηκεύσατε το αρχεία καταγραφής από την πλευρά του προγράμματος-πελάτη, επιλέξτε τα αρχεία καταγραφής που θέλετε να αναλύσετε και κάντε κλικ στην επιλογή **Άνοιγμα**. Στη συνέχεια, στον πίνακα **Λεπτομέρειες περιόδου λειτουργίας** , ορίστε τη **Ρύθμιση παραμέτρων καταγραφής κειμένου** αναπτυσσόμενη για κάθε αρχείο καταγραφής πλευρά του προγράμματος-πελάτη σε **AzureStorageClientDotNetV4** για να βεβαιωθείτε ότι το Microsoft μήνυμα Analyzer μπορεί να ανάλυσης του αρχείου καταγραφής σωστά.
1. Στο παράθυρο διαλόγου **Νέα περίοδο λειτουργίας** για τη φόρτωση και ανάλυση των δεδομένων αρχείου καταγραφής, κάντε κλικ στο κουμπί **Έναρξη** . Εμφανίζει τα δεδομένα του αρχείου καταγραφής στο πλέγμα ανάλυσης υπηρεσίας ανάλυσης του μηνύματος.

Η παρακάτω εικόνα εμφανίζει μια περίοδο λειτουργίας παράδειγμα έχει ρυθμιστεί με διακομιστή, το πρόγραμμα-πελάτη και αρχεία καταγραφής ανίχνευσης δικτύου.

![Ρύθμιση παραμέτρων λειτουργίας υπηρεσίας ανάλυσης του μηνύματος](./media/storage-e2e-troubleshooting-classic-portal/configure-mma-session-1.png)

Σημειώστε ότι το μήνυμα "Ανάλυση" φορτώνει αρχεία καταγραφής στη μνήμη. Εάν έχετε ένα μεγάλο σύνολο δεδομένων αρχείου καταγραφής, που θα θέλετε να φιλτράρετε, για να λάβετε τις καλύτερες επιδόσεις από το μήνυμα "Ανάλυση".

Πρώτα, προσδιορίστε το χρονικό πλαίσιο που σας ενδιαφέρει αναθεώρηση και διατηρήστε αυτό χρονικό πλαίσιο όσο το δυνατό. Σε πολλές περιπτώσεις που θα θέλετε να αναθεωρήσετε μια περίοδο λεπτά ή ώρες σε πιο. Εισαγάγετε το μικρότερο σύνολο των αρχείων καταγραφής που να ανταποκρίνεται στις ανάγκες σας.

Εάν εξακολουθείτε να έχετε μια μεγάλη ποσότητα δεδομένων καταγραφής, στη συνέχεια, ενδέχεται να θέλετε να καθορίσετε μια περίοδο λειτουργίας φίλτρο για να φιλτράρετε τα δεδομένα σας καταγραφής πριν να το φορτώσετε. Στο παράθυρο διαλόγου **Φίλτρο περίοδο λειτουργίας** , επιλέξτε το κουμπί **βιβλιοθήκη** για να επιλέξετε ένα προκαθορισμένο φίλτρο; Για παράδειγμα, επιλέξτε **καθολικού ώρα φίλτρο ι** από τα φίλτρα αποθήκευσης Azure στο φίλτρο σε ένα χρονικό διάστημα. Στη συνέχεια, μπορείτε να επεξεργαστείτε τα κριτήρια φίλτρου για να καθορίσετε τις έναρξης και λήξης χρονικής σήμανσης για το χρονικό διάστημα που θέλετε να δείτε. Μπορείτε επίσης να φιλτράρετε έναν συγκεκριμένο κωδικό κατάστασης; Για παράδειγμα, μπορείτε να επιλέξετε για να φορτώσετε μόνο τις καταχωρήσεις καταγραφής όπου ο κωδικός κατάστασης είναι 404.

Για περισσότερες πληροφορίες σχετικά με την εισαγωγή δεδομένων του αρχείου καταγραφής στο Microsoft μήνυμα Analyzer, ανατρέξτε στο θέμα [Ανάκτηση δεδομένων μηνυμάτων](http://technet.microsoft.com/library/dn772437.aspx) στο TechNet.

### <a name="use-the-client-request-id-to-correlate-log-file-data"></a>Χρησιμοποιήστε το Αναγνωριστικό αίτησης προγράμματος-πελάτη για να συσχετίσετε δεδομένων αρχείου καταγραφής

Στη βιβλιοθήκη Azure χώρο αποθήκευσης στο πρόγραμμα-πελάτης δημιουργεί αυτόματα ένα Αναγνωριστικό αίτησης μοναδικό προγράμματος-πελάτη για κάθε αίτηση. Αυτή η τιμή εγγράφεται για το αρχείο καταγραφής του προγράμματος-πελάτη, το αρχείο καταγραφής διακομιστή και την ανίχνευση δικτύου, ώστε να μπορείτε να το χρησιμοποιήσετε για να συσχετίσετε δεδομένων σε όλα τα αρχεία καταγραφής τρία μέσα σε υπηρεσίας ανάλυσης του μηνύματος. Ανατρέξτε στο θέμα [Αναγνωριστικό υπολογιστή-πελάτη αίτηση](storage-monitoring-diagnosing-troubleshooting.md#client-request-id) για πρόσθετες πληροφορίες σχετικά με την αίτηση προγράμματος-πελάτη ID σας.

Οι παρακάτω ενότητες περιγράφουν πώς μπορείτε να χρησιμοποιήσετε τις προκαθορισμένες ρυθμίσεις παραμέτρων και προσαρμοσμένη διάταξη προβολές για να συσχετίσετε και ομαδοποίηση δεδομένων με βάση το αναγνωριστικό αίτησης του προγράμματος-πελάτη.

### <a name="select-a-view-layout-to-display-in-the-analysis-grid"></a>Επιλέξτε μια διάταξη προβολής για να εμφανίσετε στο πλέγμα ανάλυσης

Τα στοιχεία χώρου αποθήκευσης για το μήνυμα "Ανάλυση" περιλαμβάνουν Azure αποθήκευσης προβολή διατάξεις, οι οποίες είναι προρυθμισμένες παραμέτρους, ώστε οι προβολές που μπορείτε να χρησιμοποιήσετε για να εμφανίσετε τα δεδομένα σας με χρήσιμες ομαδοποιήσεις και στήλες για διαφορετικά σενάρια. Μπορείτε επίσης να δημιουργήσετε προσαρμοσμένη προβολή διατάξεις και να αποθήκευσή τους για επαναχρησιμοποίηση. 

Στην παρακάτω εικόνα εμφανίζει το μενού **Προβολή διάταξης** , διαθέσιμο, επιλέγοντας **Προβολή διάταξης** από την κορδέλα εργαλείων. Οι διατάξεις προβολή για το χώρο αποθήκευσης Azure είναι ομαδοποιημένα κάτω από τον κόμβο **Αποθήκευσης Azure** στο μενού. Μπορείτε να αναζητήσετε `Azure Storage` στο πλαίσιο αναζήτησης για να φιλτράρετε αποθήκευσης Azure προβολή μόνο διατάξεις. Μπορείτε επίσης να επιλέξετε το αστέρι δίπλα σε μια διάταξη προβολή για να ορίσετε ως Αγαπημένα και να εμφανίσετε στο επάνω μέρος του μενού.

![Μενού "Προβολή διάταξης"](./media/storage-e2e-troubleshooting-classic-portal/view-layout-menu.png)

Για να αρχήν με, επιλέξτε **ομαδοποιημένη, ClientRequestID και λειτουργική μονάδα**. Αυτό προβολή ομάδων διάταξη καταγραφή δεδομένων από όλα τα αρχεία καταγραφής τρία πρώτα κατά Αναγνωριστικό αίτηση προγράμματος-πελάτη, στη συνέχεια, από αρχείο καταγραφής προέλευσης (ή **λειτουργικής μονάδας** στο μήνυμα Analyzer). Με αυτήν την προβολή, μπορείτε να κάνετε Διερεύνηση σε ένα συγκεκριμένο πρόγραμμα-πελάτη Αναγνωριστικό αίτησης και δείτε δεδομένα από όλα τα αρχεία καταγραφής τρεις για αυτήν την αίτηση προγράμματος-πελάτη ID σας.

Στην εικόνα παρακάτω εμφανίζει αυτής της προβολής διάταξης εφαρμοστεί το δείγμα δεδομένων καταγραφής, με ένα υποσύνολο των στηλών που εμφανίζονται. Μπορείτε να δείτε ότι για το Αναγνωριστικό αίτησης ένα συγκεκριμένο πρόγραμμα-πελάτη, πλέγμα ανάλυσης εμφανίζει δεδομένα από το αρχείο καταγραφής προγράμματος-πελάτη, διακομιστή καταγραφής και ανίχνευση δικτύου.

![Διάταξη προβολής Azure χώρου αποθήκευσης](./media/storage-e2e-troubleshooting-classic-portal/view-layout-client-request-id-module.png)

>[AZURE.NOTE] Αρχεία καταγραφής διαφορετικό έχουν διαφορετικές στήλες, έτσι ώστε όταν τα δεδομένα από πολλά αρχεία καταγραφής εμφανίζονται στο πλέγμα ανάλυσης, ορισμένες στήλες δεν μπορεί να περιέχει δεδομένα για μια δεδομένη γραμμή. Για παράδειγμα, στην παραπάνω εικόνα, οι γραμμές καταγραφής προγράμματος-πελάτη δεν εμφανίζονται όλα τα δεδομένα για τη **χρονική σήμανση**, **TimeElapsed**, **προέλευσης**και **προορισμού** στήλες, επειδή αυτές οι στήλες δεν υπάρχουν στο αρχείο καταγραφής του προγράμματος-πελάτη, αλλά υπάρχουν στην ανίχνευση δικτύου. Ομοίως, η στήλη **χρονικής σήμανσης** εμφανίζει χρονικής σήμανσης δεδομένα από το αρχείο καταγραφής διακομιστή, αλλά δεν εμφανίζονται δεδομένα για τις στήλες **TimeElapsed**, **προέλευσης**και **προορισμού** , που δεν αποτελούν μέρος του αρχείου καταγραφής διακομιστή. 

Εκτός από τη χρήση των διατάξεων προβολή αποθήκευσης Azure, μπορείτε επίσης να ορίσετε και να αποθηκεύστε τις δικές σας διατάξεις προβολή. Μπορείτε να επιλέξετε άλλα πεδία θέλετε για την ομαδοποίηση δεδομένων και να αποθηκεύσετε την ομαδοποίηση ως μέρος της καθώς και την προσαρμοσμένη διάταξη. 

### <a name="apply-color-rules-to-the-analysis-grid"></a>Εφαρμογή κανόνων χρώμα στο πλέγμα ανάλυσης

Τα στοιχεία του χώρου αποθήκευσης να περιλαμβάνουν κανόνες χρώμα, οι οποίοι παρέχουν μια οπτική σημαίνει ότι για τον προσδιορισμό διαφορετικούς τύπους σφαλμάτων στο πλέγμα ανάλυσης. Οι κανόνες προκαθορισμένες χρώμα ισχύουν για σφάλματα HTTP, ώστε να εμφανίζονται μόνο για την ανίχνευση δικτύου και καταγραφής διακομιστή.

Για να εφαρμόσετε χρώμα κανόνες, επιλέξτε **Χρώμα κανόνες** από την κορδέλα εργαλείων. Θα δείτε τους κανόνες αποθήκευσης Azure χρώμα στο μενού. Για το πρόγραμμα εκμάθησης, επιλέξτε **Σφάλματα προγράμματος-πελάτη (StatusCode μεταξύ 400 και 499)**, όπως φαίνεται στην παρακάτω εικόνα.

![Διάταξη προβολής Azure χώρου αποθήκευσης](./media/storage-e2e-troubleshooting-classic-portal/color-rules-menu.png)

Συνδυασμό με τους κανόνες αποθήκευσης Azure χρώμα, μπορείτε επίσης να ορίσετε και να αποθηκεύσετε τους κανόνες δικό σας χρώμα.

### <a name="group-and-filter-log-data-to-find-400-range-errors"></a>Ομαδοποίηση και φιλτράρισμα δεδομένων καταγραφής για να εντοπίσετε σφάλματα 400-περιοχή

Στη συνέχεια, θα σας θα ομαδοποίηση και να φιλτράρετε τα δεδομένα του αρχείου καταγραφής για να βρείτε όλα τα σφάλματα στην περιοχή 400.

1. Εντοπίστε τη στήλη **StatusCode** στο πλέγμα ανάλυσης, κάντε δεξί κλικ στην επικεφαλίδα της στήλης και επιλέξτε **την ομάδα**.
2. Επόμενο, ομάδα στη στήλη **ClientRequestId** . Θα δείτε ότι τα δεδομένα στο πλέγμα ανάλυσης είναι τώρα οργανωμένο κατά κωδικός κατάστασης και κατά αναγνωριστικό πελάτη αίτηση.
1. Εμφάνιση του παραθύρου εργαλείων φίλτρου προβολής, εάν δεν εμφανίζεται ήδη. Στην κορδέλα εργαλείων, επιλέξτε **Εργαλείο Windows**, στη συνέχεια **Φίλτρο προβολής**.
2. Για να φιλτράρετε τα δεδομένα του αρχείου καταγραφής για να εμφανίσετε μόνο τα σφάλματα 400-περιοχή, προσθέστε τα ακόλουθα κριτήρια φίλτρου στο παράθυρο **Φίλτρο προβολής** και κάντε κλικ στην επιλογή **εφαρμογή**:

        (AzureStorageLog.StatusCode >= 400 && AzureStorageLog.StatusCode <=499) || (HTTP.StatusCode >= 400 && HTTP.StatusCode <= 499)

Στην παρακάτω εικόνα εμφανίζει τα αποτελέσματα της παρούσας ομαδοποίησης και φιλτραρίσματος. Για παράδειγμα, ανάπτυξη το πεδίο **ClientRequestID** κάτω από την ομαδοποίηση για κωδικός κατάστασης 409, η εμφανίζει μια πράξη που οδήγησε σε αυτόν τον κώδικα κατάστασης.

![Διάταξη προβολής Azure χώρου αποθήκευσης](./media/storage-e2e-troubleshooting-classic-portal/400-range-errors1.png)

Μετά την εφαρμογή αυτό το φίλτρο, θα δείτε ότι εξαιρούνται γραμμές από το αρχείο καταγραφής του προγράμματος-πελάτη, με το πρόγραμμα-πελάτης καταγραφής δεν περιλαμβάνει μια στήλη **StatusCode** . Για να με αρχήν, θα σας θα Ελέγξτε το διακομιστή και τα αρχεία καταγραφής ανίχνευσης δικτύου για να εντοπίσετε σφάλματα 404 και, στη συνέχεια, θα σας θα επιστρέψετε στο αρχείο καταγραφής του προγράμματος-πελάτη για να εξετάσετε τις λειτουργίες προγράμματος-πελάτη που οδήγησε σε αυτά.

>[AZURE.NOTE] Μπορείτε να φιλτράρετε τη στήλη **StatusCode** και να εξακολουθούν να εμφανίζουν δεδομένα από όλα τα τρία αρχεία καταγραφής, συμπεριλαμβανομένων των αρχείο καταγραφής του προγράμματος-πελάτη, εάν προσθέσετε μια παράσταση στο φίλτρο που περιλαμβάνει καταχωρήσεις του αρχείου καταγραφής όπου ο κωδικός κατάστασης είναι null. Για να δημιουργήσετε αυτή η παράσταση φίλτρου, χρησιμοποιήστε:
>
> <code>&#42;StatusCode >= 400 or !&#42;StatusCode</code> 
>
> Αυτό το φίλτρο επιστρέφει όλες τις γραμμές από τον υπολογιστή-πελάτη καταγραφής και μόνο τις γραμμές από το αρχείο καταγραφής διακομιστή και να συνδεθείτε HTTP όπου ο κωδικός κατάστασης είναι μεγαλύτερη από 400. Εάν εφαρμόσετε στη διάταξη προβολή ομαδοποιημένα κατά Αναγνωριστικό αίτησης προγράμματος-πελάτη και λειτουργικής μονάδας, μπορείτε να πραγματοποιήσετε αναζήτηση ή κάντε κύλιση έως τις εγγραφές για να βρείτε αυτά όπου εμφανίζονται όλα τα τρία αρχεία καταγραφής.   

### <a name="filter-log-data-to-find-404-errors"></a>Φιλτράρισμα δεδομένων καταγραφής για να βρείτε 404 σφάλματα

Τα στοιχεία του χώρου αποθήκευσης περιλαμβάνουν προκαθορισμένες φίλτρα που μπορείτε να χρησιμοποιήσετε για να περιορίσετε τα δεδομένα του αρχείου καταγραφής για να βρείτε τα σφάλματα ή τάσεις που αναζητάτε. Στη συνέχεια, θα σας θα εφαρμόσετε δύο προκαθορισμένες φίλτρα: ένα που φιλτράρει το διακομιστή και τα αρχεία καταγραφής ανίχνευσης δικτύου για 404 σφάλματα και ένα που φιλτράρει τα δεδομένα σε ένα καθορισμένο χρονικό διάστημα.

1. Εμφάνιση του παραθύρου εργαλείων φίλτρου προβολής, εάν δεν εμφανίζεται ήδη. Στην κορδέλα εργαλείων, επιλέξτε **Εργαλείο Windows**, στη συνέχεια **Φίλτρο προβολής**.
2. Στο παράθυρο φίλτρο προβολής, επιλέξτε **βιβλιοθήκη**και αναζήτηση σε `Azure Storage` για να βρείτε το χώρο αποθήκευσης Azure φίλτρα. Επιλέξτε το φίλτρο για **404 μηνύματα (δεν βρέθηκε) σε όλα τα αρχεία καταγραφής**.
3. Εμφάνιση του μενού **βιβλιοθήκη** ξανά, και εντοπίστε και επιλέξτε το **Καθολικό φίλτρο χρόνου**.
4. Επεξεργαστείτε το χρονικές σημάνσεις εμφανίζονται στο φίλτρο στην περιοχή που θέλετε να προβάλετε. Αυτό θα σας βοηθήσει να περιορίσετε την περιοχή των δεδομένων για την ανάλυση.
5. Το φίλτρο πρέπει να είναι παρόμοιο με το παρακάτω παράδειγμα. Κάντε κλικ στο κουμπί **εφαρμογή** για να εφαρμόσετε το φίλτρο στο πλέγμα ανάλυσης.

        ((AzureStorageLog.StatusCode == 404 || HTTP.StatusCode == 404)) And 
        (#Timestamp >= 2014-10-20T16:36:38 and #Timestamp <= 2014-10-20T16:36:39)

![Διάταξη προβολής Azure χώρου αποθήκευσης](./media/storage-e2e-troubleshooting-classic-portal/404-filtered-errors1.png)

### <a name="analyze-your-log-data"></a>Ανάλυση των δεδομένων σας αρχείου καταγραφής

Τώρα που έχετε ομαδοποιημένα και φιλτράρισμα των δεδομένων σας, μπορείτε να εξετάσετε τις λεπτομέρειες των μεμονωμένων αιτήσεων που δημιούργησε 404 σφάλματα. Στην τρέχουσα προβολή διάταξη, τα δεδομένα είναι ομαδοποιημένα κατά Αναγνωριστικό αίτησης προγράμματος-πελάτη, στη συνέχεια, από την προέλευση αρχείου καταγραφής. Δεδομένου ότι σας φιλτράρισμα σε προσκλήσεις όπου το πεδίο StatusCode περιέχει 404, παρουσιάζεται μόνο το διακομιστή και τα δεδομένα ανίχνευσης δικτύου, όχι τα δεδομένα του αρχείου καταγραφής προγράμματος-πελάτη.

Στην παρακάτω εικόνα εμφανίζει μια συγκεκριμένη αίτηση όπου μια λειτουργία γρήγορα Blob παράγονται μια 404 επειδή δεν υπάρχει το αντικείμενο blob. Σημειώστε ότι ορισμένες στήλες έχουν καταργηθεί από την τυπική προβολή για να εμφανίσετε τα σχετικά δεδομένα.

![Φιλτραρισμένες διακομιστή και αρχεία καταγραφής ανίχνευσης δικτύου](./media/storage-e2e-troubleshooting-classic-portal/server-filtered-404-error.png)

Στη συνέχεια, θα σας θα συσχετίζονται αυτό το Αναγνωριστικό αίτηση προγράμματος-πελάτη με τα δεδομένα του αρχείου καταγραφής προγράμματος-πελάτη για να δείτε ποιες ενέργειες του προγράμματος-πελάτη διαρκεί όταν συνέβη το σφάλμα. Μπορείτε να εμφανίσετε μια νέα προβολή πλέγματος ανάλυσης για αυτήν την περίοδο λειτουργίας για να προβάλετε τα δεδομένα καταγραφής προγράμματος-πελάτη, το οποίο ανοίγει σε μια δεύτερη καρτέλα:

1. Πρώτα, αντιγράψτε την τιμή του πεδίου **ClientRequestId** στο Πρόχειρο. Μπορείτε να το κάνετε αυτό, επιλέγοντας είτε γραμμής, τον εντοπισμό στο πεδίο **ClientRequestId** , κάνοντας δεξί κλικ στην τιμή δεδομένων και επιλέξτε **Αντιγραφή 'ClientRequestId'**. 
1. Στην κορδέλα εργαλείων, επιλέξτε **Νέα προβολή**και κατόπιν επιλέξτε **Πλέγμα ανάλυσης** για να ανοίξετε μια νέα καρτέλα. Καρτέλα "Δημιουργία" εμφανίζει όλα τα δεδομένα στα αρχεία καταγραφής, χωρίς ομαδοποίηση, το φιλτράρισμα ή χρώμα κανόνων. 
2. Στην κορδέλα εργαλείων, επιλέξτε **Προβολή διάταξης**και κατόπιν επιλέξτε **Όλες τις στήλες προγράμματος-πελάτη .NET** κάτω από την ενότητα **Αποθήκευσης Azure** . Αυτή η διάταξη προβολή εμφανίζει δεδομένα από το πρόγραμμα-πελάτη καταγραφής, καθώς και τα αρχεία καταγραφής ανίχνευσης δικτύου και διακομιστή. Από προεπιλογή έχει ταξινομηθεί στη στήλη **αριθμού μηνύματος** .
3. Στη συνέχεια, αναζητήστε το αρχείο καταγραφής πελάτη το αναγνωριστικό αίτησης του προγράμματος-πελάτη. Στην κορδέλα εργαλείων, επιλέξτε **Εύρεση μηνυμάτων**και στη συνέχεια καθορίσετε ένα προσαρμοσμένο φίλτρο για το Αναγνωριστικό αίτησης προγράμματος-πελάτη στο πεδίο " **Εύρεση** ". Χρησιμοποιήστε τη σύνταξη για το φίλτρο, καθορίζοντας τη δική σας Αναγνωριστικό αίτησης προγράμματος-πελάτη:

        *ClientRequestId == "398bac41-7725-484b-8a69-2a9e48fc669a"

Μήνυμα "Ανάλυση" εντοπίζει και επιλέγει την πρώτη καταχώρηση όπου τα κριτήρια αναζήτησης ταιριάζει με το αναγνωριστικό αίτησης του προγράμματος-πελάτη. Στο αρχείο καταγραφής του προγράμματος-πελάτη, υπάρχουν περισσότερες από μία εγγραφές για κάθε αίτηση Αναγνωριστικό υπολογιστή-πελάτη, ώστε να μπορεί να θέλετε να ομαδοποιήσετε τους στο πεδίο **ClientRequestId** ώστε να είναι πιο εύκολο να τα δείτε όλες μαζί. Στην παρακάτω εικόνα εμφανίζει όλα τα μηνύματα στο αρχείο καταγραφής του προγράμματος-πελάτη για το συγκεκριμένο πρόγραμμα-πελάτη αναγνωριστικό αίτησης. 

![404 προγράμματος-πελάτη που εμφανίζει αρχείου καταγραφής σφαλμάτων](./media/storage-e2e-troubleshooting-classic-portal/client-log-analysis-grid1.png)

Χρησιμοποιώντας τα δεδομένα που εμφανίζονται σε προβολή διατάξεις σε αυτές τις δύο καρτέλες, μπορείτε να αναλύσετε τα δεδομένα αίτησης για να καθορίσετε τι μπορεί να προκάλεσαν το σφάλμα. Μπορείτε επίσης να ανατρέξετε σε προσκλήσεις που πριν από αυτήν για να δείτε εάν ένα προηγούμενο συμβάν ενδέχεται να οδηγήσει σε το σφάλμα 404. Για παράδειγμα, μπορείτε να δείτε τις εγγραφές πελάτη πριν από αυτό το Αναγνωριστικό αίτηση προγράμματος-πελάτη για να προσδιορίσετε αν το αντικείμενο blob ενδέχεται να έχει διαγραφεί ή εάν το σφάλμα ήταν λόγω την εφαρμογή-πελάτη καλεί μια API CreateIfNotExists σε κοντέινερ ή blob. Στο αρχείο καταγραφής του προγράμματος-πελάτη, μπορείτε να βρείτε το αντικείμενο blob διεύθυνση στο πεδίο **Περιγραφή** . στο διακομιστή και αρχεία καταγραφής ανίχνευσης δικτύου, αυτές οι πληροφορίες εμφανίζονται στο πεδίο " **Σύνοψη** ".

Όταν γνωρίζετε τη διεύθυνση του blob που προκύπτουν το σφάλμα 404, μπορείτε να εξετάσετε περαιτέρω. Εάν πραγματοποιείτε αναζήτηση τις καταχωρήσεις καταγραφής για άλλα μηνύματα που σχετίζονται με λειτουργίες σε το ίδιο αντικείμενο blob, μπορείτε να ελέγξετε εάν το πρόγραμμα-πελάτη διαγραμμένων η οντότητα. 

## <a name="analyze-other-types-of-storage-errors"></a>Ανάλυση άλλους τύπους σφάλματα αποθήκευσης

Τώρα που είστε εξοικειωμένοι με τη χρήση μηνυμάτων ανάλυσης για την ανάλυση δεδομένων αρχείου καταγραφής, μπορείτε να αναλύσετε άλλοι τύποι σφαλμάτων χρησιμοποιώντας την προβολή διατάξεις, κανόνες χρώμα και αναζήτηση/φιλτράρισμα. Οι παρακάτω πίνακες παραθέτει ορισμένα ζητήματα που μπορεί να αντιμετωπίσετε και τα κριτήρια φίλτρου που μπορείτε να χρησιμοποιήσετε για να εντοπίσετε τους. Για περισσότερες πληροφορίες σχετικά με την κατασκευή φίλτρα και την "Ανάλυση" μήνυμα φιλτράρισμα γλώσσας, ανατρέξτε στο θέμα [Φιλτράρισμα δεδομένων μηνυμάτων](http://technet.microsoft.com/library/jj819365.aspx).

|    Για να εξερευνήσετε...                                                                                               |    Χρήση παράστασης φίλτρου...                                                                                                                                                                                                                                        |    Παράσταση ισχύει για το αρχείο καταγραφής (προγράμματος-πελάτη, διακομιστή, δικτύου, όλοι)    |
|------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
|    Μη αναμενόμενο καθυστερήσεις στην παράδοση του μηνύματος σε μια ουρά                                                              |    AzureStorageClientDotNetV4.Description περιέχει "Retrying απέτυχε η λειτουργία".                                                                                                                                                                                |    Πρόγραμμα-πελάτη                                                        |
|    Αύξηση HTTP PercentThrottlingError                                                                       |    HTTP. Response.StatusCode == 500 & #124- & #124- HTTP. Response.StatusCode == 503                                                                                                                                                                                          |    Δικτύου                                                       |
|    Αύξηση στο PercentTimeoutError                                                                               |    HTTP. Response.StatusCode == 500                                                                                                                                                                                                                             |    Δικτύου                                                       |
|    Αύξηση στο PercentTimeoutError (όλα)                                                                         |    * StatusCode == 500                                                                                                                                                                                                                                          |    Όλων                                                           |
|    Αύξηση στο PercentNetworkError                                                                               |    AzureStorageClientDotNetV4.EventLogEntry.Level < 2                                                                                                                                                                                                          |    Πρόγραμμα-πελάτη                                                        |
|    HTTP 403 (Απαγορεύεται) μηνύματα                                                                                 |    HTTP. Response.StatusCode == 403                                                                                                                                                                                                                             |    Δικτύου                                                       |
|    HTTP 404 (δεν βρέθηκε) τα μηνύματα                                                                                 |    HTTP. Response.StatusCode == 404                                                                                                                                                                                                                             |    Δικτύου                                                       |
|    404 (όλα)                                                                                                     |    * StatusCode == 404                                                                                                                                                                                                                                          |    Όλων                                                           |
|    Κοινή χρήση θέμα εξουσιοδότηση πρόσβασης υπογραφή (συσχετισμών Ασφαλείας)                                                             |    AzureStorageLog.RequestStatus == "SASAuthorizationError"                                                                                                                                                                                                     |    Δικτύου                                                       |
|    HTTP 409 (διένεξη) μηνύματα                                                                                  |    HTTP. Response.StatusCode == 409                                                                                                                                                                                                                             |    Δικτύου                                                       |
|    409 (όλα)                                                                                                     |    * StatusCode == 409                                                                                                                                                                                                                                          |    Όλων                                                           |
|    Χαμηλή PercentSuccess ή ανάλυσης εγγραφές καταγραφής έχει λειτουργίες με κατάστασης της κίνησης του ClientOtherErrors    |    AzureStorageLog.RequestStatus == "ClientOtherError"                                                                                                                                                                                                         |    Διακομιστή                                                        |
|    Προειδοποίηση Nagle                                                                                               |    ((AzureStorageLog.EndToEndLatencyMS-AzureStorageLog.ServerLatencyMS) > (AzureStorageLog.ServerLatencyMS * 1,5)) και (AzureStorageLog.RequestPacketSize < 1460) και (AzureStorageLog.EndToEndLatencyMS - AzureStorageLog.ServerLatencyMS > = 200)        |    Διακομιστή                                                        |
|    Εύρος χρόνου στα αρχεία καταγραφής διακομιστή και δικτύου                                                                    |    #Σήμανση χρόνου > = 2014-10-20T16:36:38 και #Timestamp < = 2014-10-20T16:36:39                                                                                                                                                                                     |    Διακομιστής, δικτύου                                               |
|    Περιοχή χρόνου σε αρχεία καταγραφής του διακομιστή                                                                                |    AzureStorageLog.Timestamp > = 2014-10-20T16:36:38 και AzureStorageLog.Timestamp < = 2014-10-20T16:36:39                                                                                                                                                     |    Διακομιστή                                                        |


## <a name="next-steps"></a>Επόμενα βήματα

Για περισσότερες πληροφορίες σχετικά με την αντιμετώπιση προβλημάτων--τελικών σεναρίων στο χώρο αποθήκευσης Azure, ανατρέξτε στους παρακάτω πόρους:

- [Παρακολούθηση, διάγνωση και αντιμετώπιση προβλημάτων χώρος αποθήκευσης Microsoft Azure](storage-monitoring-diagnosing-troubleshooting.md)
- [Ανάλυση χώρου αποθήκευσης](http://msdn.microsoft.com/library/azure/hh343270.aspx)
- [Παρακολούθηση ενός λογαριασμού χώρου αποθήκευσης στην πύλη του Azure](storage-monitor-storage-account.md)
- [Μεταφορά δεδομένων με το βοηθητικό πρόγραμμα γραμμής εντολών AzCopy](storage-use-azcopy.md)
- [Οδηγός λειτουργίας υπηρεσίας ανάλυσης του μηνύματος της Microsoft](http://technet.microsoft.com/library/jj649776.aspx)
 
 

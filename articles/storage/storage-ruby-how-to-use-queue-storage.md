<properties 
    pageTitle="Πώς να χρησιμοποιείτε το χώρο αποθήκευσης ουρά από κείμενο φωνητικής γραφής | Microsoft Azure" 
    description="Μάθετε πώς μπορείτε να χρησιμοποιήσετε την υπηρεσία ουράς Azure για να δημιουργήσετε και να διαγράψετε ουρές, εισαγωγή, λήψη και να διαγράψετε μηνύματα. Δείγματα γραμμένο σε κείμενο φωνητικής γραφής." 
    services="storage" 
    documentationCenter="ruby" 
    authors="robinsh" 
    manager="carmonm" 
    editor=""/>

<tags 
    ms.service="storage" 
    ms.workload="storage" 
    ms.tgt_pltfrm="na" 
    ms.devlang="ruby" 
    ms.topic="article" 
    ms.date="10/18/2016" 
    ms.author="robinsh"/>


# <a name="how-to-use-queue-storage-from-ruby"></a>Πώς να χρησιμοποιείτε το χώρο αποθήκευσης ουρά από κείμενο φωνητικής γραφής

[AZURE.INCLUDE [storage-selector-queue-include](../../includes/storage-selector-queue-include.md)]
<br/>
[AZURE.INCLUDE [storage-try-azure-tools-queues](../../includes/storage-try-azure-tools-queues.md)]

## <a name="overview"></a>Επισκόπηση

Αυτός ο οδηγός δείχνει πώς μπορείτε να εκτελέσετε συνηθισμένα σενάρια με την υπηρεσία ουράς χώρος αποθήκευσης για το Microsoft Azure. Τα δείγματα γράφονται με χρήση του API Azure φωνητικής γραφής.
Τα σενάρια καλύπτεται περιλαμβάνουν **εισαγωγής**, **παρατήρηση**, **λήψη**και **Διαγραφή** ουρά μηνυμάτων, καθώς και **τη δημιουργία και διαγραφή ουρές**.

[AZURE.INCLUDE [storage-queue-concepts-include](../../includes/storage-queue-concepts-include.md)]

[AZURE.INCLUDE [storage-create-account-include](../../includes/storage-create-account-include.md)]

## <a name="create-a-ruby-application"></a>Δημιουργία μιας εφαρμογής φωνητικής γραφής

Δημιουργία μιας εφαρμογής φωνητικής γραφής. Για οδηγίες, ανατρέξτε στο θέμα [φωνητικής γραφής στην εφαρμογή Web ράβδους σε μια Εικονική Azure](../virtual-machines/linux/classic/virtual-machines-linux-classic-ruby-rails-web-app.md).

## <a name="configure-your-application-to-access-storage"></a>Ρύθμιση παραμέτρων την εφαρμογή με το χώρο αποθήκευσης της Access

Για να χρησιμοποιήσετε Azure χώρου αποθήκευσης, πρέπει να κάνετε λήψη και χρήση του φωνητικής γραφής azure πακέτο, η οποία περιλαμβάνει ένα σύνολο βιβλιοθηκών ευκολία που επικοινωνία με τις υπηρεσίες ΥΠΌΛΟΙΠΟ του χώρου αποθήκευσης.

### <a name="use-rubygems-to-obtain-the-package"></a>Χρήση RubyGems λήψης του πακέτου

1. Χρησιμοποιήστε ένα περιβάλλον γραμμής εντολών όπως **PowerShell** (Windows), το **Terminal** (Mac) ή το **πάρτι** (Unix).

2. Πληκτρολογήστε "Περσικό azure εγκατάσταση" στο παράθυρο εντολών για να εγκαταστήσετε το περσικό και τις εξαρτήσεις.

### <a name="import-the-package"></a>Εισαγωγή του πακέτου

Χρησιμοποιήστε το πρόγραμμα επεξεργασίας κειμένου Αγαπημένα, προσθέστε τα ακόλουθα στο επάνω μέρος του αρχείου φωνητικής γραφής όπου σκοπεύετε να χρησιμοποιήσετε αποθήκευσης:

    require "azure"

## <a name="setup-an-azure-storage-connection"></a>Ρυθμίσετε μια σύνδεση Azure χώρου αποθήκευσης

Η λειτουργική μονάδα azure θα διαβάσει τις μεταβλητές περιβάλλοντος **AZURE\_χώρου ΑΠΟΘΉΚΕΥΣΗΣ\_ΛΟΓΑΡΙΑΣΜΟΎ** και **AZURE\_χώρου ΑΠΟΘΉΚΕΥΣΗΣ\_ACCESS_KEY** για τις πληροφορίες που απαιτούνται για να συνδεθείτε στο λογαριασμό σας Azure χώρου αποθήκευσης. Αν δεν έχουν οριστεί αυτές τις μεταβλητές περιβάλλοντος, πρέπει να καθορίσετε τις πληροφορίες λογαριασμού πριν από τη χρήση **Azure::QueueService** με τον ακόλουθο κώδικα:

    Azure.config.storage_account_name = "<your azure storage account>"
    Azure.config.storage_access_key = "<your Azure storage access key>"

 
Για να λάβετε αυτές τις τιμές από μια κλασική ή το λογαριασμό χώρου αποθήκευσης για τη διαχείριση πόρων στην πύλη του Azure:

1. Συνδεθείτε [πύλη του Azure](https://portal.azure.com).
2. Μεταβείτε στο λογαριασμό του χώρου αποθήκευσης που θέλετε να χρησιμοποιήσετε.
3. Στο το blade ρυθμίσεις στα δεξιά, κάντε κλικ στην επιλογή **Πλήκτρα πρόσβασης**.
4. Στο το blade πλήκτρα πρόσβασης που εμφανίζεται, θα δείτε το πλήκτρο πρόσβασης 1 και το κλειδί πρόσβασης 2. Μπορείτε να χρησιμοποιήσετε ένα από τα παραπάνω. 
5. Κάντε κλικ στο εικονίδιο Αντιγραφή για να αντιγράψετε τον αριθμό-κλειδί στο Πρόχειρο. 

Για να λάβετε αυτές τις τιμές από ένα λογαριασμό κλασική χώρου αποθήκευσης στην κλασική Azure πύλη:

1. Συνδεθείτε [πύλη κλασική Azure](https://manage.windowsazure.com).
2. Μεταβείτε στο λογαριασμό του χώρου αποθήκευσης που θέλετε να χρησιμοποιήσετε.
3. Κάντε κλικ στην επιλογή **ΔΙΑΧΕΊΡΙΣΗ ΠΛΉΚΤΡΑ ΠΡΌΣΒΑΣΗΣ** στο κάτω μέρος του παραθύρου περιήγησης.
4. Στο αναδυόμενο παράθυρο διαλόγου, θα δείτε το όνομα λογαριασμού χώρου αποθήκευσης, πρόσβαση πρωτεύον κλειδί και πρόσβασης δευτερεύον κλειδί. Για το πλήκτρο πρόσβασης, μπορείτε να χρησιμοποιήσετε κύρια ή δευτερεύοντα αυτό. 
5. Κάντε κλικ στο εικονίδιο Αντιγραφή για να αντιγράψετε τον αριθμό-κλειδί στο Πρόχειρο.

## <a name="how-to-create-a-queue"></a>Τρόπος: Δημιουργία ουράς

Ο ακόλουθος κώδικας δημιουργεί ένα αντικείμενο **Azure::QueueService** , το οποίο σας επιτρέπει να εργαστείτε με ουρές.

    azure_queue_service = Azure::QueueService.new

Χρησιμοποιήστε τη μέθοδο **create_queue()** για να δημιουργήσετε μια ουρά με το καθορισμένο όνομα.

    begin
      azure_queue_service.create_queue("test-queue")
    rescue
      puts $!
    end

## <a name="how-to-insert-a-message-into-a-queue"></a>Τρόπος: Εισαγάγετε ένα μήνυμα σε μια ουρά

Για να εισαγάγετε ένα μήνυμα σε μια ουρά, χρησιμοποιήστε τη μέθοδο **create_message()** για να δημιουργήσετε ένα νέο μήνυμα και να την προσθέσετε στην ουρά.

    azure_queue_service.create_message("test-queue", "test message")

## <a name="how-to-peek-at-the-next-message"></a>Τρόπος: Ρίξτε μια ματιά σε στο επόμενο μήνυμα

Μπορείτε να Ρίξτε μια ματιά σε το μήνυμα στο μπροστινό μέρος μια ουρά χωρίς να την καταργήσετε από την ουρά καλώντας την **Σύνοψη\_messages()** μέθοδο. Από προεπιλογή, **σύνοψης\_messages()** peeks σε ένα μήνυμα. Μπορείτε επίσης να καθορίσετε τον αριθμό των μηνυμάτων που θέλετε να Ρίξτε μια ματιά.

    result = azure_queue_service.peek_messages("test-queue",
      {:number_of_messages => 10})

## <a name="how-to-dequeue-the-next-message"></a>Τρόπος: Απομάκρυνση από την ουρά του επόμενου μηνύματος

Μπορείτε να καταργήσετε ένα μήνυμα από μια ουρά σε δύο βήματα.

1. Όταν καλείτε **λίστα\_messages()**, μεταβείτε στο επόμενο μήνυμα σε μια ουρά από προεπιλογή. Μπορείτε επίσης να καθορίσετε τον αριθμό των μηνυμάτων που θέλετε να λάβετε. Τα μηνύματα που επιστρέφονται από **λίστα\_messages()** δεν είναι ορατό σε οποιονδήποτε άλλο κωδικό ανάγνωση μηνυμάτων από αυτήν την ουρά. Περάσετε στο χρονικό όριο ορατότητα σε δευτερόλεπτα ως παράμετρο.

2. Για να ολοκληρώσετε την κατάργηση του μηνύματος από την ουρά, μπορείτε, επίσης, πρέπει να καλέσετε **delete_message()**.

Αυτή η διαδικασία δύο βημάτων από την κατάργηση ενός μηνύματος διασφαλίζει ότι όταν αποτύχει η επεξεργασία ενός μηνύματος λόγω αποτυχία υλικού ή λογισμικού σας κώδικα, μια άλλη παρουσία του κωδικού σας μπορεί να λάβετε το ίδιο μήνυμα και να προσπαθήστε ξανά. Οι κλήσεις σας κώδικα **Διαγραφή\_message()** αμέσως μόλις το μήνυμα έχει υποστεί επεξεργασία.

    messages = azure_queue_service.list_messages("test-queue", 30)
    azure_queue_service.delete_message("test-queue", 
      messages[0].id, messages[0].pop_receipt)

## <a name="how-to-change-the-contents-of-a-queued-message"></a>Τρόπος: Αλλαγή των περιεχομένων ένα μήνυμα σε ουρά

Μπορείτε να αλλάξετε τα περιεχόμενα ενός μηνύματος στην ίδια θέση στην ουρά. Ο παρακάτω κώδικας χρησιμοποιεί τη μέθοδο **update_message()** για να ενημερώσετε ένα μήνυμα. Η μέθοδος θα επιστρέψει μιας πλειάδας που περιέχει το pop παραλαβής του μηνύματος ουρά και μια τιμή ώρας ημερομηνίας UTC που αντιπροσωπεύει όταν το μήνυμα θα είναι ορατή στην ουρά.

    message = azure_queue_service.list_messages("test-queue", 30)
    pop_receipt, time_next_visible = azure_queue_service.update_message(
      "test-queue", message.id, message.pop_receipt, "updated test message", 
      30)

## <a name="how-to-additional-options-for-dequeuing-messages"></a>Τρόπος: Πρόσθετες επιλογές για κατάργησης μηνυμάτων

Υπάρχουν δύο τρόποι για να προσαρμόσετε ανάκτηση μηνύματος από μια ουρά.

1. Μπορείτε να λάβετε μια δέσμη του μηνύματος.

2. Μπορείτε να ορίσετε ένα χρονικό όριο invisibility μεγαλύτερη ή μικρότερη, επιτρέποντάς σας κώδικα περισσότερες ή λιγότερο χρόνο για την επεξεργασία πλήρως κάθε μήνυμα.

Τον ακόλουθο κώδικα, το παράδειγμα χρησιμοποιεί τη **λίστα\_messages()** μέθοδο για να λάβετε μηνύματα 15 σε μία κλήση. Στη συνέχεια, εκτυπώνει και διαγράφει κάθε μήνυμα. Επίσης, ορίζει το χρονικό όριο invisibility έως πέντε λεπτά για κάθε μήνυμα.

    azure_queue_service.list_messages("test-queue", 300
      {:number_of_messages => 15}).each do |m|
      puts m.message_text
      azure_queue_service.delete_message("test-queue", m.id, m.pop_receipt)
    end

## <a name="how-to-get-the-queue-length"></a>Τον τρόπο: Το μήκος ουράς γρήγορα

Μπορείτε να λάβετε μια εκτίμηση της τον αριθμό των μηνυμάτων στην ουρά. Το **Λήψη\_ουρά\_metadata()** μέθοδο ζητά από την υπηρεσία ουράς για να λάβετε το μήνυμα κατά προσέγγιση count και μετα-δεδομένα σχετικά με την ουρά.

    message_count, metadata = azure_queue_service.get_queue_metadata(
      "test-queue")

## <a name="how-to-delete-a-queue"></a>Τρόπος: Διαγραφή ουράς

Για να διαγράψετε μια ουρά και όλα τα μηνύματα που περιέχονται σε αυτό, καλέστε την **Διαγραφή\_queue()** τη μέθοδο του αντικειμένου ουράς.

    azure_queue_service.delete_queue("test-queue")

## <a name="next-steps"></a>Επόμενα βήματα

Τώρα που μάθατε τα βασικά στοιχεία του χώρου αποθήκευσης ουρά, ακολουθήστε αυτές τις συνδέσεις για να μάθετε σχετικά με τις πιο σύνθετες εργασίες αποθήκευσης.

- Επισκεφθείτε το [Ιστολόγιο ομάδας Azure χώρου αποθήκευσης](http://blogs.msdn.com/b/windowsazurestorage/)
- Επισκεφθείτε το αποθετήριο [SDK Azure για το κείμενο φωνητικής γραφής](https://github.com/WindowsAzure/azure-sdk-for-ruby) στο GitHub

Για μια σύγκριση μεταξύ της υπηρεσίας ουράς Azure που αναφέρονται σε αυτό το άρθρο και Azure Service Bus ουρές περιγράφεται στο άρθρο [πώς μπορείτε να χρησιμοποιήσετε ουρές Bus υπηρεσίας](/develop/ruby/how-to-guides/service-bus-queues/) , ανατρέξτε στο θέμα [Azure ουρές και ουρές Bus υπηρεσίας - σύγκριση και Contrasted](../service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted.md)
 

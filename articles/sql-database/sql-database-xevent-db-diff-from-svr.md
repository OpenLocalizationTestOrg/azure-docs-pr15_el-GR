<properties
    pageTitle="Εκτεταμένο συμβάντα σε βάση δεδομένων SQL | Microsoft Azure"
    description="Περιγράφει εκτεταμένο συμβάντων (XEvents) σε βάση δεδομένων SQL Azure και πώς περιόδους λειτουργίας συμβάντων διαφέρει λίγο περιόδους λειτουργίας συμβάντων στο Microsoft SQL Server."
    services="sql-database"
    documentationCenter=""
    authors="MightyPen"
    manager="jhubbard"
    editor=""
    tags=""/>


<tags
    ms.service="sql-database"
    ms.workload="data-management"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="08/23/2016"
    ms.author="genemi"/>


# <a name="extended-events-in-sql-database"></a>Εκτεταμένη συμβάντα σε βάση δεδομένων SQL

[AZURE.INCLUDE [sql-database-xevents-selectors-1-include](../../includes/sql-database-xevents-selectors-1-include.md)]

Αυτό το θέμα εξηγεί τον τρόπο την εφαρμογή εκτεταμένο συμβάντα σε βάση δεδομένων SQL Azure είναι λίγο διαφορετικά σε σύγκριση με εκτεταμένο συμβάντα στο Microsoft SQL Server.


- V12 βάση δεδομένων SQL που αποκτήθηκε τη δυνατότητα Εκτεταμένη συμβάντα στο δεύτερο μισό της ημερολόγιο 2015.
- SQL Server είχε εκτεταμένο συμβάντα από 2008.
- Το σύνολο δυνατοτήτων του εκτεταμένου συμβάντων σε βάση δεδομένων SQL είναι ένα υποσύνολο ισχυρές δυνατότητες στον SQL Server.


*XEvents* είναι μια ανεπίσημη ψευδώνυμο που χρησιμοποιείται μερικές φορές για 'εκτεταμένο συμβάντα' σε ιστολόγια και άλλες ανεπίσημη θέσεις.


> [AZURE.NOTE] Το Οκτωβρίου 2015, η δυνατότητα περιόδου λειτουργίας εκτεταμένο συμβάν είναι ενεργοποιημένη σε βάση δεδομένων SQL Azure στο επίπεδο της προεπισκόπησης. Η ημερομηνία γενικής διαθεσιμότητας (GA) δεν έχει οριστεί ακόμη.
>
> Στη σελίδα Azure [Ενημερώσεις υπηρεσίας](https://azure.microsoft.com/updates/?service=sql-database) περιλαμβάνει δημοσιεύσεις όταν γίνονται GA ανακοινώσεις.


Πρόσθετες πληροφορίες σχετικά με εκτεταμένο συμβάντα, για βάση δεδομένων SQL Azure και το Microsoft SQL Server, είναι διαθέσιμη από την:

- [Γρήγορη εκκίνηση: Εκτεταμένη συμβάντα στο SQL Server](http://msdn.microsoft.com/library/mt733217.aspx)
- [Εκτεταμένη συμβάντα](http://msdn.microsoft.com/library/bb630282.aspx)


## <a name="prerequisites"></a>Προαπαιτούμενα στοιχεία


Αυτό το θέμα προϋποθέτει ότι έχετε ήδη ορισμένες γνώσεις:


- [Βάση δεδομένων SQL azure υπηρεσίας](https://azure.microsoft.com/services/sql-database/).


- [Εκτεταμένη συμβάντα](http://msdn.microsoft.com/library/bb630282.aspx) στο Microsoft SQL Server.
 - Μαζικής μας τεκμηρίωσης σχετικά με τα συμβάντα εκτεταμένο ισχύει για το SQL Server και βάση δεδομένων SQL.


Πριν από την έκθεση με τα ακόλουθα στοιχεία είναι χρήσιμη όταν επιλέγετε το αρχείο συμβάν ως [προορισμού](#AzureXEventsTargets):


- [Υπηρεσία αποθήκευσης στο Azure](https://azure.microsoft.com/services/storage/)


- PowerShell
 - [Χρήση του PowerShell Azure με το χώρο αποθήκευσης Azure](../storage/storage-powershell-guide-full.md) - παρέχει πλήρεις πληροφορίες σχετικά με το PowerShell και η υπηρεσία αποθήκευσης Azure.


## <a name="code-samples"></a>Δείγματα κώδικα


Σχετικά θέματα παρέχουν δύο δείγματα κώδικα:


- [Κλήση Buffer προορισμού κώδικα για εκτεταμένο συμβάντα σε βάση δεδομένων SQL](sql-database-xevent-code-ring-buffer.md)
 - Σύντομο απλή δέσμη Transact-SQL.
 - Θα σας δώσει έμφαση στο θέμα δείγματα κώδικα ότι, όταν τελειώσετε με μια κλήση Buffer προορισμού, πρέπει να αφήσετε τους πόρους με την εκτέλεση μια πρόταση alter απόθεση `ALTER EVENT SESSION ... ON DATABASE DROP TARGET ...;` πρόταση. Αργότερα, μπορείτε να προσθέσετε μια άλλη παρουσία του Buffer δακτυλίου με `ALTER EVENT SESSION ... ON DATABASE ADD TARGET ...`.


- [Συμβάν αρχείου προορισμού κώδικα για εκτεταμένο συμβάντα σε βάση δεδομένων SQL](sql-database-xevent-code-event-file.md)
 - Φάση 1 είναι PowerShell για να δημιουργήσετε ένα κοντέινερ χώρου αποθήκευσης Azure.
 - Φάση 2 είναι Transact-SQL που χρησιμοποιεί το χώρο αποθήκευσης Azure κοντέινερ.


## <a name="transact-sql-differences"></a>Διαφορές Transact-SQL


- Όταν εκτελείτε την εντολή [ΔΗΜΙΟΥΡΓΊΑ ΣΥΜΒΆΝΤΟΣ περίοδο ΛΕΙΤΟΥΡΓΊΑΣ](http://msdn.microsoft.com/library/bb677289.aspx) στον SQL Server, μπορείτε να χρησιμοποιήσετε τον όρο **ON SERVER** . Αλλά στη βάση δεδομένων SQL μπορείτε να χρησιμοποιήσετε τον όρο **ON βάσης ΔΕΔΟΜΈΝΩΝ** αντί για αυτό.


- Ο όρος **ON βάσης ΔΕΔΟΜΈΝΩΝ** ισχύει επίσης για τις εντολές Transact-SQL [ΣΥΜΒΆΝ ΑΠΟΘΈΣΤΕ την περίοδο ΛΕΙΤΟΥΡΓΊΑΣ](http://msdn.microsoft.com/library/bb630257.aspx) και [ΤΡΟΠΟΠΟΊΗΣΗ ΣΥΜΒΆΝΤΟΣ περιόδου ΛΕΙΤΟΥΡΓΊΑΣ](http://msdn.microsoft.com/library/bb630368.aspx) .


- Βέλτιστη πρακτική είναι να συμπεριλάβετε την επιλογή περιόδου λειτουργίας συμβάν **STARTUP_STATE = ON** στο τις προτάσεις **ΣΥΜΒΆΝ ΔΗΜΙΟΥΡΓΊΑ περιόδου ΛΕΙΤΟΥΡΓΊΑΣ** ή **ΤΡΟΠΟΠΟΊΗΣΗ ΣΥΜΒΆΝΤΟΣ περιόδου ΛΕΙΤΟΥΡΓΊΑΣ** .
 - Η τιμή **= ON** υποστηρίζει μια αυτόματη επανεκκίνηση μετά από μια αλλαγή των ρυθμίσεων παραμέτρων της βάσης δεδομένων λογική λόγω ανακατεύθυνσης.


## <a name="new-catalog-views"></a>Οι νέες προβολές καταλόγου


Η δυνατότητα Εκτεταμένη συμβάντα υποστηρίζεται από πολλές [προβολές του καταλόγου](http://msdn.microsoft.com/library/ms174365.aspx). Προβολές του καταλόγου σας ενημερώσει για *μετα-δεδομένα ή ορισμών* περιόδους λειτουργίας συμβάντων που δημιουργούνται από το χρήστη στην τρέχουσα βάση δεδομένων. Οι προβολές δεν επιστρέφουν πληροφορίες σχετικά με τις εμφανίσεις της περιόδους λειτουργίας ενεργό συμβάντων.


| Όνομα του<br/>προβολή καταλόγου | Περιγραφή |
| :-- | :-- |
| **sys.database_event_session_actions** | Επιστρέφει μια γραμμή για κάθε ενέργεια σε κάθε συμβάντος μιας περιόδου λειτουργίας του συμβάντος. |
| **sys.database_event_session_events** | Επιστρέφει μια γραμμή για κάθε συμβάντος σε μια περίοδο λειτουργίας του συμβάντος. |
| **sys.database_event_session_fields** | Επιστρέφει μια γραμμή για κάθε στήλη Προσαρμογή-δυνατότητα που έχει καθοριστεί ρητά σε συμβάντα και των προορισμών. |
| **sys.database_event_session_targets** | Επιστρέφει μια γραμμή για κάθε συμβάν προορισμού για μια περίοδο λειτουργίας του συμβάντος. |
| **sys.database_event_sessions** | Επιστρέφει μια γραμμή για κάθε περίοδο συμβάντων στη βάση δεδομένων της βάσης δεδομένων SQL. |


Στο Microsoft SQL Server, παρόμοια προβολές στον κατάλογο έχουν ονόματα που περιλαμβάνουν *.server\_ * αντί για *.database\_*. Το μοτίβο όνομα είναι όπως **sys.server_event_%**.


## <a name="new-dynamic-management-views-dmvshttpmsdnmicrosoftcomlibraryms188754aspx"></a>Νέα Διαχείριση δυναμικών προβολών [(DMVs)](http://msdn.microsoft.com/library/ms188754.aspx)


Βάση δεδομένων SQL του Azure έχει [δυναμική Διαχείριση προβολών (DMVs)](http://msdn.microsoft.com/library/bb677293.aspx) που υποστηρίζουν το εκτεταμένο συμβάντα. DMVs να σας σχετικά με τις *ενεργές* περιόδους λειτουργίας συμβάν.


| Όνομα της DMV | Περιγραφή |
| :-- | :-- |
| **sys.dm_xe_database_session_event_actions** | Επιστρέφει πληροφορίες σχετικά με το συμβάν ενέργειες περιόδου λειτουργίας. |
| **sys.dm_xe_database_session_events** | Επιστρέφει πληροφορίες σχετικά με τα συμβάντα περιόδου λειτουργίας. |
| **sys.dm_xe_database_session_object_columns** | Εμφανίζει τις τιμές παραμέτρων για τα αντικείμενα που είναι συνδεδεμένα σε μια περίοδο λειτουργίας. |
| **sys.dm_xe_database_session_targets** | Επιστρέφει πληροφορίες σχετικά με τους στόχους της περιόδου λειτουργίας. |
| **sys.dm_xe_database_sessions** | Επιστρέφει μια γραμμή για κάθε περίοδο συμβάντων που έχει εύρος στην τρέχουσα βάση δεδομένων. |


Στο Microsoft SQL Server, παρόμοια προβολές καταλόγου ονομάζονται χωρίς το * \_βάσης δεδομένων* τμήμα του ονόματος, όπως:


- **sys.dm_xe_sessions**, αντί για το όνομα<br/>**sys.dm_xe_database_sessions**.


### <a name="dmvs-common-to-both"></a>Κοινές και στους δύο DMVs


Για το εκτεταμένο συμβάντα υπάρχουν επιπλέον DMVs που είναι κοινά και για βάση δεδομένων SQL Azure και Microsoft SQL Server:


- **sys.dm_xe_map_values**
- **sys.dm_xe_object_columns**
- **sys.dm_xe_objects**
- **sys.dm_xe_packages**



 <a name="sqlfindseventsactionstargets" id="sqlfindseventsactionstargets"></a>

## <a name="find-the-available-extended-events-actions-and-targets"></a>Βρείτε το διαθέσιμο εκτεταμένης συμβάντα, ενέργειες και των προορισμών


Μπορείτε να εκτελέσετε μια απλή SQL **ΕΠΙΛΈΞΤΕ** για να αποκτήσετε μια λίστα με τα διαθέσιμα συμβάντα, οι ενέργειες και προορισμού.


```
SELECT
        o.object_type,
        p.name         AS [package_name],
        o.name         AS [db_object_name],
        o.description  AS [db_obj_description]
    FROM
                   sys.dm_xe_objects  AS o
        INNER JOIN sys.dm_xe_packages AS p  ON p.guid = o.package_guid
    WHERE
        o.object_type in
            (
            'action',  'event',  'target'
            )
    ORDER BY
        o.object_type,
        p.name,
        o.name;
```



<a name="AzureXEventsTargets" id="AzureXEventsTargets"></a>

&nbsp;

## <a name="targets-for-your-sql-database-event-sessions"></a>Στόχοι για τις περιόδους λειτουργίας συμβάν βάσης δεδομένων SQL


Εδώ θα βρείτε των προορισμών που μπορεί να καταγράψει αποτελέσματα από το συμβάν περιόδους λειτουργίας στη βάση δεδομένων SQL:


- [Κλήση Buffer προορισμού](http://msdn.microsoft.com/library/ff878182.aspx) - περιέχει συνοπτικά δεδομένα συμβάντος στη μνήμη.
- [Μετρητής συμβάν προορισμού](http://msdn.microsoft.com/library/ff878025.aspx) - καταμετρά όλα τα συμβάντα που προκύπτουν κατά τη διάρκεια μιας περιόδου λειτουργίας εκτεταμένο συμβάντα.
- [Προορισμός αρχείων συμβάν](http://msdn.microsoft.com/library/ff878115.aspx) - ολοκλήρωσης συγκέντρωσης buffer εγγραφές σε ένα κοντέινερ αποθήκευσης Azure.


Το [Συμβάν ανίχνευσης για Windows (ETW)](http://msdn.microsoft.com/library/ms751538.aspx) API δεν είναι διαθέσιμη για το εκτεταμένο συμβάντα σε βάση δεδομένων SQL.


## <a name="restrictions"></a>Περιορισμοί


Υπάρχουν ορισμένες διαφορές που σχετίζονται με την ασφάλεια befitting στο cloud περιβάλλον της βάσης δεδομένων SQL:


- Εκτεταμένη συμβάντα βασίζονται σε μοντέλο απομόνωσης μίας μισθωτή. Μια περίοδο λειτουργίας συμβάντος σε μία βάση δεδομένων δεν είναι δυνατό να αποκτήσετε πρόσβαση δεδομένων ή συμβάντα από μια άλλη βάση δεδομένων.

- Δεν είναι δυνατό να εκδώσετε μια πρόταση **ΣΥΜΒΆΝ ΔΗΜΙΟΥΡΓΊΑ περιόδου ΛΕΙΤΟΥΡΓΊΑΣ** στο περιβάλλον της **κύριας** βάσης δεδομένων.


## <a name="permission-model"></a>Μοντέλο δικαιωμάτων


Πρέπει να έχετε δικαιώματα **ελέγχου** από τη βάση δεδομένων για την έκδοση μιας πρότασης **ΣΥΜΒΆΝ ΔΗΜΙΟΥΡΓΊΑ περιόδου ΛΕΙΤΟΥΡΓΊΑΣ** . Ο κάτοχος της βάσης δεδομένων (dbo) έχει δικαιώματα για **έλεγχο** .


### <a name="storage-container-authorizations"></a>Άδειες κοντέινερ χώρου αποθήκευσης


Το διακριτικό συσχετισμών Ασφαλείας που δημιουργείτε για το χώρο αποθήκευσης Azure κοντέινερ πρέπει να καθορίσετε **rwl** για τα δικαιώματα. Η τιμή **rwl** παρέχει τα ακόλουθα δικαιώματα:


- Ανάγνωση
- Εγγραφή
- Λίστα


## <a name="performance-considerations"></a>Ζητήματα επιδόσεων


Υπάρχουν σενάρια όπου εντατική χρήση εκτεταμένο συμβάντων μπορούν να συγκεντρώσουν τα πιο ενεργό μνήμη από είναι σε καλή κατάσταση για τη συνολική σύστημα. Επομένως, το σύστημα βάσης δεδομένων SQL Azure δυναμικά σύνολα και ρυθμίζει όρια για το ποσό ενεργό μνήμης που μπορεί να υπολογίζονται με μια περίοδο λειτουργίας του συμβάντος. Πολλοί παράγοντες Μετάβαση σε δυναμική υπολογισμού.


Εάν λάβετε ένα μήνυμα σφάλματος που αναφέρει ότι έχει εφαρμοστεί μια μέγιστη μνήμη, ορισμένες διορθωτικές ενέργειες που μπορείτε να κάνετε είναι:


- Εκτέλεση λιγότερων περιόδων λειτουργίας ταυτόχρονες συμβάν.


- Έως τις προτάσεις **ΔΗΜΙΟΥΡΓΊΑ** και **ΤΡΟΠΟΠΟΊΗΣΗ** για περιόδους λειτουργίας συμβάντος, μείωση της ποσότητας μνήμης που καθορίζετε στην το **MAX\_ΜΝΉΜΗΣ** όρος.


### <a name="network-latency"></a>Λανθάνων χρόνος δικτύου


Ο προορισμός **Συμβάν αρχείων** ενδέχεται να συναντήσετε λανθάνων χρόνος δικτύου ή αποτυχίες κατά τη διατήρηση δεδομένων σε Azure χώρο αποθήκευσης αντικειμένων blob. Άλλα συμβάντα σε βάση δεδομένων SQL μπορεί να καθυστερήσει κατά την αναμονή για την επικοινωνία δικτύου για να ολοκληρωθεί. Αυτή η καθυστέρηση μπορεί να επιβραδύνει του φόρτου εργασίας σας.

- Να συμβάλει στην αντιμετώπιση αυτόν τον κίνδυνο επιδόσεων, αποφύγετε να ορίσετε την επιλογή **EVENT_RETENTION_MODE** **NO_EVENT_LOSS** στο συμβάν σας ορισμών περιόδου λειτουργίας.


## <a name="related-links"></a>Σχετικές συνδέσεις


- [Χρήση του PowerShell Azure με Azure αποθήκευσης](../storage/storage-powershell-guide-full.md).
- [Cmdlet του Azure χώρου αποθήκευσης](http://msdn.microsoft.com/library/dn806401.aspx)


- [Χρήση του PowerShell Azure με το χώρο αποθήκευσης Azure](../storage/storage-powershell-guide-full.md) - παρέχει πλήρεις πληροφορίες σχετικά με το PowerShell και η υπηρεσία αποθήκευσης Azure.
- [Πώς να χρησιμοποιείτε το χώρο αποθήκευσης αντικειμένων Blob από το .NET](../storage/storage-dotnet-how-to-use-blobs.md)


- [ΔΗΜΙΟΥΡΓΊΑ ΔΙΑΠΙΣΤΕΥΤΗΡΊΩΝ (Transact-SQL)](http://msdn.microsoft.com/library/ms189522.aspx)
- [ΔΗΜΙΟΥΡΓΊΑ περιόδου ΛΕΙΤΟΥΡΓΊΑΣ ΣΥΜΒΆΝΤΩΝ (Transact-SQL)](http://msdn.microsoft.com/library/bb677289.aspx)


- [Καταχωρήσεις ιστολογίου των Τζόναθαν Kehayias σχετικά με εκτεταμένο συμβάντα στο Microsoft SQL Server](http://www.sqlskills.com/blogs/jonathan/category/extended-events/)


Άλλα θέματα δείγματα κώδικα για εκτεταμένο συμβάντα διατίθενται οι ακόλουθες συνδέσεις. Ωστόσο, πρέπει να αναλάβετε τακτικά κάθε δείγμα για να δείτε εάν το δείγμα ως προορισμό Microsoft SQL Server έναντι της βάσης δεδομένων SQL Azure. Στη συνέχεια, μπορείτε να αποφασίσετε εάν απαιτούνται αλλαγές μικρής σημασίας για να εκτελέσετε το δείγμα.


<!--
('lock_acquired' event.)

- Code sample for SQL Server: [Determine Which Queries Are Holding Locks](http://msdn.microsoft.com/library/bb677357.aspx)
- Code sample for SQL Server: [Find the Objects That Have the Most Locks Taken on Them](http://msdn.microsoft.com/library/bb630355.aspx)
-->

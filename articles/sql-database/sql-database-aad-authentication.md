<properties
   pageTitle="Σύνδεση με βάση δεδομένων SQL ή αποθήκη δεδομένων του SQL με χρήση του ελέγχου ταυτότητας καταλόγου Azure Active Directory | Microsoft Azure"
   description="Μάθετε πώς να συνδεθείτε σε βάση δεδομένων SQL με χρήση του ελέγχου ταυτότητας Azure Active Directory."
   services="sql-database"
   documentationCenter=""
   authors="BYHAM"
   manager="jhubbard"
   editor=""
   tags=""/>

<tags
   ms.service="sql-database"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="data-management"
   ms.date="09/16/2016"
   ms.author="rick.byham@microsoft.com"/>

# <a name="connecting-to-sql-database-or-sql-data-warehouse-by-using-azure-active-directory-authentication"></a>Σύνδεση με βάση δεδομένων SQL ή αποθήκη δεδομένων του SQL χρησιμοποιώντας τον έλεγχο ταυτότητας καταλόγου Azure Active Directory

Έλεγχος ταυτότητας Azure Active Directory είναι ένας μηχανισμός σύνδεσης με βάση δεδομένων SQL Microsoft Azure και [Αποθήκη δεδομένων του SQL](../sql-data-warehouse/sql-data-warehouse-overview-what-is.md) , χρησιμοποιώντας τις ταυτότητες σε Azure Active Directory (Azure AD). Με έλεγχο ταυτότητας Azure Active Directory, μπορείτε να διαχειριστείτε κεντρικά τις ταυτότητες χρηστών βάσεων δεδομένων και άλλες υπηρεσίες της Microsoft σε μια κεντρική θέση. Κεντρική διαχείριση Αναγνωριστικό παρέχει μια ενιαία θέση για να διαχειριστείτε τους χρήστες της βάσης δεδομένων και απλοποιεί τη Διαχείριση δικαιωμάτων. Πλεονεκτήματα είναι τα εξής:

- Παρέχει μια εναλλακτική λύση για έλεγχο ταυτότητας του SQL Server.
- Βοηθά στην διακόψτε τη διάδοση ταυτότητα χρήστη στους διακομιστές της βάσης δεδομένων.
- Επιτρέπει την περιστροφή τον κωδικό πρόσβασης σε ένα μόνο σημείο
- Οι πελάτες να διαχειριστείτε δικαιώματα στη βάση δεδομένων με χρήση εξωτερικών ομάδες (AAD).
- Το να αποκλείσετε την αποθήκευση κωδικών πρόσβασης, ενεργοποιώντας ενσωματωμένο έλεγχο ταυτότητας των Windows και άλλες μορφές του ελέγχου ταυτότητας που υποστηρίζονται από το Azure Active Directory.
- Χρησιμοποιεί έλεγχο ταυτότητας Azure Active Directory που περιέχονται χρήστες βάσεων δεδομένων για τον έλεγχο ταυτότητας ταυτότητες στο επίπεδο της βάσης δεδομένων.
- Azure Active Directory υποστηρίζει έλεγχο ταυτότητας που βασίζεται σε διακριτικό για εφαρμογές τη σύνδεση με βάση δεδομένων SQL.
- Έλεγχος ταυτότητας Azure Active Directory υποστηρίζει ADFS (Ομοσπονδία τομέων) ή έλεγχο ταυτότητας εγγενούς/κωδικού πρόσβασης χρήστη για μια τοπική Azure Active Directory χωρίς συγχρονισμό τομέα.  
- Azure Active Directory υποστηρίζει συνδέσεις από SQL Server Management Studio που χρησιμοποιούν Active Directory καθολικής έλεγχος ταυτότητας, που περιλαμβάνει τον έλεγχο ταυτότητας πολλών παραγόντων (MFA).  MFA περιλαμβάνει ισχυρό έλεγχο ταυτότητας με μια ποικιλία επιλογών εύκολο επαλήθευσης — τηλεφωνικής κλήσης, μήνυμα κειμένου, έξυπνες κάρτες με pin ή ειδοποίηση εφαρμογής για κινητές συσκευές. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [SSMS υποστήριξης για το Azure AD MFA με βάση δεδομένων SQL και αποθήκη δεδομένων του SQL](sql-database-ssms-mfa-authentication.md).

Τα βήματα ρύθμισης παραμέτρων περιλαμβάνουν τις ακόλουθες διαδικασίες για τη ρύθμιση και χρήση του ελέγχου ταυτότητας Azure Active Directory.

1. Δημιουργία και τη συμπλήρωση μιας Azure Active Directory.
2. Βεβαιωθείτε ότι η βάση δεδομένων είναι σε V12 βάση δεδομένων SQL Azure. (Δεν είναι απαραίτητο για την αποθήκη δεδομένων του SQL.)
3. Προαιρετικά: Συσχέτιση ή αλλάξτε την υπηρεσία καταλόγου active directory που σχετίζεται με τη συνδρομή σας Azure.
4. Δημιουργία διαχειριστή Azure Active Directory για Azure SQL Server ή [Αποθήκη δεδομένων του SQL Azure](https://azure.microsoft.com/services/sql-data-warehouse/).
5. Ρύθμιση παραμέτρων σε υπολογιστές-πελάτες σας.
6. Δημιουργία χρηστών περιεχόμενα βάσης δεδομένων στη βάση δεδομένων σας έχει αντιστοιχιστεί σε Azure AD ταυτότητες.
7. Συνδεθείτε στη βάση δεδομένων σας, χρησιμοποιώντας τις ταυτότητες Azure AD.


## <a name="trust-architecture"></a>Αξιόπιστη αρχιτεκτονικής

Το παρακάτω διάγραμμα υψηλού επιπέδου συνοψίζει την αρχιτεκτονική λύσης με τη χρήση ελέγχου ταυτότητας Azure AD με βάση δεδομένων SQL Azure. Οι ίδιες έννοιες εφαρμογή αποθήκη δεδομένων του SQL. Για την υποστήριξη κωδικού πρόσβασης χρήστη εγγενή Azure Active Directory, θεωρείται μόνο το τμήμα Cloud και η βάση δεδομένων SQL Azure AD/Azure. Για να υποστηρίζει έλεγχο ταυτότητας ομόσπονδων (ή χρήστη/τον κωδικό πρόσβασης για τα διαπιστευτήρια των Windows), απαιτείται η επικοινωνία με μπλοκ ADFS. Τα βέλη υποδεικνύουν περιόδων επικοινωνίας.

![διάγραμμα auth aad][1]

Το παρακάτω διάγραμμα υποδεικνύει την Ομοσπονδία αξιοπιστίας και φιλοξενίας σχέσεις που επιτρέπουν ένα πρόγραμμα-πελάτη για να συνδεθείτε με μια βάση δεδομένων με την υποβολή ενός διακριτικού. Το διακριτικό έχει γίνει έλεγχος ταυτότητας από ένα Azure AD και είναι αξιόπιστο από τη βάση δεδομένων. Πελάτη 1 μπορεί να αντιπροσωπεύει μια Azure Active Directory με εγγενή χρήστες ή μια Azure Active Directory με εξωτερικούς χρήστες. Πελάτη 2 αντιπροσωπεύει μια πιθανή λύση, συμπεριλαμβανομένων των χρηστών που έχουν εισαχθεί. σε αυτό το παράδειγμα που προέρχονται από μια εξωτερική Azure Active Directory με ADFS που συγχρονίζονται με το Azure Active Directory. Είναι σημαντικό να κατανοήσετε ότι η πρόσβαση σε μια βάση δεδομένων με χρήση ελέγχου ταυτότητας Azure AD απαιτεί ότι η συνδρομή φιλοξενίας σχετίζεται με το Azure Active Directory. Για να δημιουργήσετε τον SQL Server που φιλοξενεί τη βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL, πρέπει να χρησιμοποιείται την ίδια συνδρομή.

![σχέση συνδρομή][2]

## <a name="administrator-structure"></a>Δομή διαχειριστή

Όταν χρησιμοποιείτε τον έλεγχο ταυτότητας Azure AD, υπάρχουν δύο λογαριασμούς διαχειριστή για το διακομιστή βάσης δεδομένων SQL. το αρχικό διαχειριστής SQL Server και ο διαχειριστής του Azure AD. Οι ίδιες έννοιες εφαρμογή αποθήκη δεδομένων του SQL. Μόνο ο διαχειριστής που βασίζεται σε ένα λογαριασμό Azure AD μπορεί να δημιουργήσει ο πρώτος χρήστης βάσης δεδομένων Azure AD που περιέχονται σε μια βάση δεδομένων του χρήστη. Η σύνδεση διαχειριστή Azure AD μπορεί να είναι ένας χρήστης του Azure AD ή μια ομάδα Azure AD. Όταν ο διαχειριστής είναι ένας λογαριασμός ομάδας, μπορεί να χρησιμοποιηθεί από οποιοδήποτε μέλος της ομάδας, Ενεργοποίηση πολλών Azure AD διαχειριστών για την παρουσία του SQL Server. Χρησιμοποιώντας το λογαριασμό ομάδα ως διαχειριστής βελτιώνει τις δυνατότητες διαχείρισης, επιτρέποντάς σας να κεντρικά προσθέστε και καταργήστε τα μέλη της ομάδας στην Azure AD χωρίς να αλλάξετε τους χρήστες ή δικαιώματα σε βάση δεδομένων SQL. Μόνο ένα διαχειριστή Azure AD (ένα χρήστη ή μια ομάδα) μπορεί να ρυθμιστεί οποιαδήποτε στιγμή.

![δομή διαχείρισης][3]

## <a name="permissions"></a>Δικαιώματα

Για να δημιουργήσετε νέους χρήστες, πρέπει να έχετε το `ALTER ANY USER` δικαιωμάτων στη βάση δεδομένων. Το `ALTER ANY USER` δικαιώματα μπορούν να εκχωρηθούν σε οποιονδήποτε χρήστη βάσης δεδομένων. Το `ALTER ANY USER` δικαιωμάτων είναι επίσης που κατέχει το λογαριασμούς διαχειριστή του διακομιστή, καθώς και οι χρήστες της βάσης δεδομένων με το `CONTROL ON DATABASE` ή `ALTER ON DATABASE` δικαιωμάτων για αυτήν τη βάση δεδομένων, καθώς και από τα μέλη του `db_owner` ρόλου βάσης δεδομένων.

Για να δημιουργήσετε ένα χρήστη που περιέχονται βάσης δεδομένων σε βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL, πρέπει να συνδεθείτε με τη βάση δεδομένων χρησιμοποιώντας μια ταυτότητα Azure AD. Για να δημιουργήσετε τον πρώτο χρήστη περιεχόμενα βάσης δεδομένων, πρέπει να συνδεθείτε με τη βάση δεδομένων με χρήση διαχειριστής Azure Active Directory (που είναι ο κάτοχος της βάσης δεδομένων). Αυτή η περίπτωση περιγράφεται στα βήματα 4 και 5 παρακάτω. Κάθε ελέγχου ταυτότητας Azure Active Directory μόνο είναι δυνατόν αν ο διαχειριστής του Azure Active Directory δημιουργήθηκε για βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL server. Εάν ο διαχειριστής του Azure Active Directory καταργήθηκε από το διακομιστή, υπάρχοντες χρήστες Azure Active Directory που δημιουργήσατε προηγουμένως μέσα σε SQL Server να δεν είναι πλέον συνδεθείτε με τη βάση δεδομένων χρησιμοποιώντας τα διαπιστευτήριά τους Azure Active Directory.

## <a name="azure-ad-features-and-limitations"></a>Azure AD δυνατότητες και περιορισμοί

Τα ακόλουθα μέλη της υπηρεσίας καταλόγου Azure Active Directory μπορεί να καθοριστεί σε Azure SQL Server ή αποθήκη δεδομένων του SQL:

- Τα μέλη της εγγενούς: ένα μέλος που δημιουργήθηκε σε Azure AD στον διαχειριζόμενων τομέα ή σε έναν τομέα ο πελάτης. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Προσθήκη το δικό σας όνομα τομέα για να Azure AD](../active-directory/active-directory-add-domain.md).

- Ομόσπονδο τομέα μέλη: ενός μέλους που έχουν δημιουργηθεί με Azure AD με έναν ομόσπονδο τομέα. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Microsoft Azure τώρα υποστηρίζει Ομοσπονδία με Windows Server υπηρεσίας καταλόγου Active Directory](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/).

- Που έχουν εισαχθεί μέλη από άλλους Azure Active καταλόγους που είναι μέλη εγγενής ή εξωτερική τομέα.

- Active Directory ομάδες δημιουργούνται ως ομάδες ασφαλείας.

Λογαριασμοί Microsoft (για παράδειγμα, outlook.com, hotmail.com, live.com) ή σε άλλους λογαριασμούς επισκέπτη (για παράδειγμα gmail.com, yahoo.com) δεν υποστηρίζονται. Εάν μπορείτε να συνδεθείτε [https://login.live.com](https://login.live.com) χρησιμοποιώντας το λογαριασμό και τον κωδικό πρόσβασης, στη συνέχεια, χρησιμοποιείτε ένα λογαριασμό Microsoft, η οποία δεν υποστηρίζεται για έλεγχο ταυτότητας Azure AD για βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL Azure.

### <a name="additional-considerations"></a>Επιπλέον ζητήματα

- Για να βελτιώσετε διαχειρισιμότητα, συνιστάται η παροχή μια αποκλειστική ομάδα Azure Active Directory ως διαχειριστής.
- Μόνο ένα διαχειριστή Azure AD (ένα χρήστη ή μια ομάδα) μπορεί να ρυθμιστεί για μια Azure SQL Server ή αποθήκη δεδομένων του SQL Azure οποιαδήποτε στιγμή.
- Μόνο ο διαχειριστής Azure Active Directory για τον SQL Server αρχικά να συνδεθείτε με το Azure SQL Server ή αποθήκη δεδομένων του SQL Azure με τη χρήση λογαριασμού Azure Active Directory. Ο διαχειριστής της υπηρεσίας καταλόγου Active Directory να ρυθμίσετε τις παραμέτρους οι επόμενες χρήστες βάσεων δεδομένων Azure Active Directory.
- Συνιστάται να ορίζοντας το χρονικό όριο σύνδεσης σε 30 δευτερόλεπτα.
- SQL Server 2016 Management Studio και SQL Server Data Tools Visual Studio 2015 (έκδοση 14.0.60311.1April 2016 ή νεότερη έκδοση) υποστηρίζει έλεγχο ταυτότητας Azure Active Directory. (Έλεγχος ταυτότητας azure Active Directory υποστηρίζεται από την υπηρεσία **παροχής δεδομένων .NET Framework για της**; στο τουλάχιστον έκδοση .NET Framework 4.6). Επομένως, των νεότερων εκδόσεων αυτά τα εργαλεία και εφαρμογές επιπέδων δεδομένων (DAC και .bacpac) μπορεί να χρησιμοποιεί έλεγχο ταυτότητας Azure Active Directory.
- [Έκδοση ODBC 13.1](https://www.microsoft.com/download/details.aspx?id=53339) υποστηρίζει έλεγχο ταυτότητας Azure Active Directory, ωστόσο `bcp.exe` δεν μπορεί να συνδεθεί με χρήση ελέγχου ταυτότητας Azure Active Directory, επειδή χρησιμοποιεί μια παλαιότερη παροχής ODBC.
- `sqlcmd`υποστηρίζει Azure Active Directory που ξεκινά τον έλεγχο ταυτότητας με έκδοση 13.1 διαθέσιμη από το [Κέντρο λήψης](http://go.microsoft.com/fwlink/?LinkID=825643).  
- SQL Server Data Tools Visual Studio 2015 απαιτεί τουλάχιστον την έκδοση Απριλίου 2016 από τα Εργαλεία δεδομένων (έκδοση 14.0.60311.1). Προς το παρόν Azure Active Directory χρηστών δεν εμφανίζονται στην Εξερεύνηση αντικείμενο SSDT. Ως λύση, προβάλετε τους χρήστες της [sys.database_principals](https://msdn.microsoft.com/library/ms187328.aspx).
- [Microsoft JDBC πρόγραμμα οδήγησης 6.0 για τον SQL Server](https://www.microsoft.com/en-us/download/details.aspx?id=11774) υποστηρίζει έλεγχο ταυτότητας Azure Active Directory. Επίσης, ανατρέξτε στο θέμα [Ορισμός τις ιδιότητες σύνδεσης](https://msdn.microsoft.com/library/ms378988.aspx).
- PolyBase δεν είναι δυνατό να τον έλεγχο ταυτότητας με χρήση του ελέγχου ταυτότητας Azure Active Directory.
- Ορισμένα εργαλεία όπως το BI και το Excel δεν υποστηρίζονται.
- Έλεγχος ταυτότητας Azure Active Directory υποστηρίζεται για βάση δεδομένων SQL του Azure πύλης λεπίδες **Βάσης δεδομένων εισαγωγής** και **Εξαγωγής βάσης δεδομένων** . Εισαγωγή και εξαγωγή με χρήση ελέγχου ταυτότητας Azure Active Directory υποστηρίζεται επίσης από την εντολή PowerShell.


## <a name="1-create-and-populate-an-azure-ad"></a>1. Δημιουργία και τη συμπλήρωση μιας Azure AD

Δημιουργήστε ένα Azure Active Directory και συμπληρώστε τον με χρήστες και ομάδες. Το Azure Active Directory μπορεί να είναι ο τομέας διαχειριζόμενων αρχικό τομέα του Azure AD. Το Azure Active Directory μπορεί να είναι επίσης μια εσωτερική υπηρεσίες τομέα Active Directory που είναι ομόσπονδες με το Azure Active Directory.

Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [ενοποίηση σας ταυτοτήτων εσωτερικής εγκατάστασης με Azure Active Directory](../active-directory/active-directory-aadconnect.md), [προσθέστε το δικό σας όνομα τομέα για να Azure AD](../active-directory/active-directory-add-domain.md), [Microsoft Azure τώρα υποστηρίζει Ομοσπονδία με Windows Server υπηρεσίας καταλόγου Active Directory](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/), [τη διαχείριση του καταλόγου Azure AD](https://msdn.microsoft.com/library/azure/hh967611.aspx)και [Διαχείριση Azure AD χρησιμοποιώντας το Windows PowerShell](https://msdn.microsoft.com/library/azure/jj151815.aspx).

## <a name="2-ensure-your-sql-database-is-version-12"></a>2. Βεβαιωθείτε ότι η βάση δεδομένων SQL είναι έκδοση 12

Έλεγχος ταυτότητας Azure Active Directory υποστηρίζεται στο την πιο πρόσφατη V12 βάσης δεδομένων SQL. Για πληροφορίες σχετικά με το V12 βάσης δεδομένων SQL και για να μάθετε αν είναι διαθέσιμη στην περιοχή σας, ανατρέξτε στο θέμα [Τι είναι το νέο στο την πιο πρόσφατη V12 ενημερωμένη έκδοση βάσης δεδομένων SQL](sql-database-v12-whats-new.md). Αυτό το βήμα δεν είναι απαραίτητο για την αποθήκη δεδομένων του SQL Azure, επειδή αποθήκη δεδομένων του SQL είναι διαθέσιμη μόνο σε V12.

Εάν έχετε μια υπάρχουσα βάση δεδομένων, επιβεβαιώστε ότι φιλοξενείται σε V12 βάση δεδομένων SQL κατά τη σύνδεση με τη βάση δεδομένων (για παράδειγμα, χρησιμοποιώντας SQL Server Management Studio) και την εκτέλεση `SELECT @@VERSION;`. Είναι τουλάχιστον το αναμενόμενο αποτέλεσμα για μια βάση δεδομένων σε V12 βάση δεδομένων SQL **Azure SQL Microsoft (RTM) - 12.0**. Εάν η βάση δεδομένων δεν φιλοξενείται σε V12 βάση δεδομένων SQL, ανατρέξτε στο θέμα [Προγραμματισμός και προετοιμασία για αναβάθμιση σε V12 βάση δεδομένων SQL](sql-database-v12-plan-prepare-upgrade.md), και, στη συνέχεια, επισκεφθείτε την πύλη κλασική Azure για τη μετεγκατάσταση βάσης δεδομένων στο V12 βάσης δεδομένων SQL.

Εναλλακτικά, μπορείτε να δημιουργήσετε μια νέα βάση δεδομένων σε V12 βάση δεδομένων SQL, ακολουθώντας τα βήματα που αναφέρονται στην ενότητα [Δημιουργία του πρώτου βάση δεδομένων Azure SQL](sql-database-get-started.md). **Συμβουλή**: Διαβάστε το επόμενο βήμα, πριν να επιλέξετε μια συνδρομή για τη νέα βάση δεδομένων.

## <a name="3-optional-associate-or-change-the-active-directory-that-is-currently-associated-with-your-azure-subscription"></a>3. Προαιρετικά: Συσχετίσετε ή να αλλάξετε την υπηρεσία καταλόγου active directory που σχετίζεται με τη συνδρομή σας Azure

Για να συσχετίσετε τη βάση δεδομένων με τον κατάλογο Azure AD για την εταιρεία σας, κάντε τον κατάλογο μια αξιόπιστη καταλόγου για τη συνδρομή Azure φιλοξενεί τη βάση δεδομένων. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Πώς Azure συνδρομές συσχετίζονται με Azure AD](https://msdn.microsoft.com/library/azure/dn629581.aspx).

**Πρόσθετες πληροφορίες:** Κάθε Azure συνδρομή έχει μια σχέση αξιοπιστίας με μια παρουσία Azure AD. Αυτό σημαίνει ότι το εμπιστεύεται αυτόν τον κατάλογο για τον έλεγχο ταυτότητας χρηστών, τις υπηρεσίες και τις συσκευές. Πολλές συνδρομές να εμπιστευτείτε το ίδιο κατάλογο, αλλά μια συνδρομή εμπιστεύεται μόνο μία καταλόγου. Μπορείτε να δείτε ποια καταλόγου είναι αξιόπιστο από τη συνδρομή σας κάτω από την καρτέλα **ρυθμίσεων** στο [https://manage.windowsazure.com/](https://manage.windowsazure.com/). Αυτή η σχέση αξιοπιστίας που έχει μια συνδρομή με έναν κατάλογο είναι σε αντίθεση με τη σχέση που έχει μια συνδρομή με όλα τα άλλα μέσα στο Azure (τοποθεσίες Web, βάσεις δεδομένων και ούτω καθεξής), που είναι περισσότερο σαν θυγατρικό πόρους μιας συνδρομής. Αν λήξει η συνδρομή, στη συνέχεια, πρόσβαση σε αυτές τις άλλους πόρους που σχετίζονται με τη συνδρομή σταματά επίσης. Αλλά ο κατάλογος παραμένει στο Azure και μπορείτε να συσχετίσετε μια άλλη συνδρομή με αυτόν τον κατάλογο και να συνεχίσετε να διαχειριστείτε τους χρήστες του καταλόγου. Για περισσότερες πληροφορίες σχετικά με τους πόρους, ανατρέξτε στο θέμα [Κατανόηση των πόρων πρόσβαση στο Azure](https://msdn.microsoft.com/library/azure/dn584083.aspx).

Οι ακόλουθες διαδικασίες παρέχουν οδηγίες βήμα προς βήμα σχετικά με τον τρόπο για να αλλάξετε το σχετικό κατάλογο για μια δεδομένη συνδρομή.

1. Συνδεθείτε με την [Πύλη κλασική Azure](https://manage.windowsazure.com/) χρησιμοποιώντας διαχειριστής Azure συνδρομής.
2. Στο αριστερό πανό, επιλέξτε **ΡΥΘΜΊΣΕΙΣ**.
3. Τις συνδρομές σας εμφανίζονται στην οθόνη ρυθμίσεις. Εάν η συνδρομή που θέλετε δεν εμφανίζεται, κάντε κλικ στην επιλογή " **συνδρομές** " στο επάνω μέρος, αναπτυσσόμενο πλαίσιο **ΦΊΛΤΡΟΥ από ΚΑΤΆΛΟΓΟ** και επιλέξτε τον κατάλογο που περιέχει τις συνδρομές σας και, στη συνέχεια, κάντε κλικ στο κουμπί **ΕΦΑΡΜΟΓΉ**.

    ![Επιλέξτε τη συνδρομή][4]
4. Στην περιοχή **Ρυθμίσεις** , επιλέξτε τη συνδρομή σας και, στη συνέχεια, κάντε κλικ στην επιλογή **ΕΠΕΞΕΡΓΑΣΊΑ ΚΑΤΑΛΌΓΟΥ** στο κάτω μέρος της σελίδας.

    ![AD-ρυθμίσεις-πύλη][5]
5. Στο παράθυρο διαλόγου **ΕΠΕΞΕΡΓΑΣΊΑ ΚΑΤΑΛΌΓΟΥ** , επιλέξτε το Azure Active Directory που σχετίζεται με τον SQL Server ή αποθήκη δεδομένων του SQL και, στη συνέχεια, κάντε κλικ στο βέλος για το επόμενο.

    ![Επιλέξτε Επεξεργασία καταλόγου][6]
6. Στο παράθυρο **ΕΠΙΒΕΒΑΊΩΣΗ** καταλόγου αντιστοίχισης διαλόγου, επιβεβαιώστε ότι "**όλων των διαχειριστών από κοινού θα καταργηθούν.**"

    ![Επεξεργασία-Επιβεβαιώστε καταλόγου][7]
7. Κάντε κλικ στην επιλογή έλεγχος για να φορτώσετε ξανά την πύλη.

> [AZURE.NOTE] Όταν αλλάζετε τον κατάλογο, πρόσβαση σε όλες τις συνδιαχειριστών, Azure AD χρήστες και ομάδες, και καταργούνται χρήστες αντίγραφα καταλόγου πόρων και έχουν πλέον πρόσβαση σε αυτήν τη συνδρομή ή τους πόρους. Μόνο εσείς, ως διαχειριστής υπηρεσιών, να ρυθμίσετε τις παραμέτρους πρόσβασης για αρχές με βάση τον νέο κατάλογο. Αυτή η αλλαγή μπορεί να διαρκέσει ένα σημαντικό χρονικό διάστημα για μεταδοθούν σε όλους τους πόρους. Αλλαγή του καταλόγου, αλλάζει ο διαχειριστής Azure AD για βάση δεδομένων SQL και αποθήκη δεδομένων του SQL και επίσης να μην επιτρέπεται η πρόσβαση στη βάση δεδομένων για οποιαδήποτε τους υπάρχοντες χρήστες Azure AD. Πρέπει να είναι ο διαχειριστής του Azure AD επαναφορά (όπως περιγράφεται παρακάτω) και νέα Azure AD οι χρήστες πρέπει να δημιουργηθεί.

## <a name="4-create-an-azure-ad-administrator-for-azure-sql-server"></a>4. Δημιουργία Azure AD διαχειριστή για τον Azure SQL Server

Κάθε Azure SQL Server (που φιλοξενεί μια βάση δεδομένων SQL ή αποθήκη δεδομένων του SQL) ξεκινά με ένα λογαριασμό διαχειριστή μεμονωμένο διακομιστή που είναι ο διαχειριστής του ολόκληρο Azure SQL Server. Ένα δεύτερο διαχειριστή SQL Server πρέπει να δημιουργηθεί, που είναι ένας λογαριασμός Azure AD. Αυτό το κεφάλαιο δημιουργείται ως χρήστης βάσης δεδομένων που περιέχονται στην κύρια βάση δεδομένων. Ως διαχειριστές, τους λογαριασμούς διαχειριστή διακομιστή είναι τα μέλη του ρόλου **db_owner** σε κάθε βάση δεδομένων χρήστη και εισαγάγετε κάθε βάση δεδομένων χρήστη ως ο χρήστης **dbo** . Για περισσότερες πληροφορίες σχετικά με τους λογαριασμούς διαχειριστή του διακομιστή, ανατρέξτε στο θέμα [Διαχείριση βάσεων δεδομένων και συνδέσεις σε βάση δεδομένων SQL Azure](sql-database-manage-logins.md) και στην ενότητα **συνδέσεις και οι χρήστες** του [οδηγίες ασφαλείας βάσης δεδομένων SQL Azure και τους περιορισμούς](sql-database-security-guidelines.md).

Όταν χρησιμοποιείτε το Azure Active Directory με παν αλληλεπίδραση, ο διαχειριστής της υπηρεσίας καταλόγου Azure Active Directory πρέπει να ρυθμιστεί για την κύρια και δευτερεύουσα διακομιστές της. Εάν ένα διακομιστή δεν διαθέτει διαχειριστής Azure Active Directory, στη συνέχεια, συνδέσεις Azure Active Directory και οι χρήστες λαμβάνουν ένα "δεν μπορεί να συνδεθεί" σφάλμα διακομιστή.

> [AZURE.NOTE] Οι χρήστες που δεν βασίζονται σε ένα λογαριασμό Azure AD (συμπεριλαμβανομένου του λογαριασμού του διαχειριστή Azure SQL Server), δεν είναι δυνατή η δημιουργία Azure AD με βάση τους χρήστες, επειδή δεν έχετε δικαιώματα για την επικύρωση χρήστες προτεινόμενη βάσης δεδομένων με το Azure AD.

### <a name="provision-an-azure-active-directory-administrator-for-your-azure-sql-server-by-using-the-azure-portal"></a>Προμήθεια διαχειριστής Azure Active Directory για τον SQL Server Azure χρησιμοποιώντας την πύλη του Azure

1. Στην [πύλη του Azure](https://portal.azure.com/), στην επάνω δεξιά γωνία, κάντε κλικ στην επιλογή αναπτυσσόμενη λίστα μια λίστα με πιθανές ενεργό σε καταλόγους τη σύνδεσή σας. Επιλέξτε τη σωστή καταλόγου Active Directory ως την προεπιλεγμένη Azure AD. Αυτό το βήμα συνδέσεων η συσχέτιση εγγραφής με την υπηρεσία καταλόγου Active Directory με Azure SQL Server, βεβαιωθείτε ότι χρησιμοποιείται την ίδια συνδρομή για τα δύο Azure AD και του SQL Server. (Το SQL Server Azure να να διατηρείτε βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL Azure.)

    ![Επιλέξτε ad][8]
2. Στο αριστερό διαφημιστικό πλαίσιο επιλέξτε **SQL servers**, επιλέξτε το **SQL server**και, στη συνέχεια, στο blade του **SQL Server** , στο επάνω μέρος κάντε κλικ στην επιλογή **Ρυθμίσεις**.

    ![ρυθμίσεις AD][9]
3. Στο το blade **Ρυθμίσεις** , κάντε κλικ στην επιλογή ** Διαχείριση υπηρεσίας καταλόγου Active Directory.
4. Στο blade το **διαχειριστή της υπηρεσίας καταλόγου Active Directory** , κάντε κλικ στην επιλογή **Διαχείριση της υπηρεσίας καταλόγου Active Directory**και, στη συνέχεια, στο επάνω μέρος, κάντε κλικ στην επιλογή **Ορισμός διαχείρισης**.
5. Στο το blade **Προσθήκη διαχειριστή** , αναζήτηση για ένα χρήστη, επιλέξτε το χρήστη ή την ομάδα να είστε διαχειριστής και, στη συνέχεια, κάντε κλικ στην **επιλογή**. (Η υπηρεσία καταλόγου Active Directory blade διαχείρισης εμφανίζει όλα τα μέλη και ομάδες από την υπηρεσία καταλόγου Active Directory. Είναι δυνατή η επιλογή τους χρήστες ή τις ομάδες που εμφανίζονται με γκρίζο επειδή δεν υποστηρίζονται ως διαχειριστές Azure AD. (Δείτε τη λίστα των διαχειριστών υποστηρίζεται στο **Azure AD δυνατότητες και περιορισμοί της** παραπάνω). Έλεγχος πρόσβασης βάσει ρόλων (RBAC) ισχύει μόνο για την πύλη και δεν μεταβιβάζεται σε SQL Server.
6. Στο επάνω μέρος του blade **διαχείρισης της υπηρεσίας καταλόγου Active Directory** , κάντε κλικ στην επιλογή **ΑΠΟΘΉΚΕΥΣΗ**.
    ![επιλέξτε Διαχείριση][10]

    Η διαδικασία αλλαγής ο διαχειριστής μπορεί να χρειαστούν αρκετά λεπτά. Στη συνέχεια, ο νέος διαχειριστής εμφανίζεται στο πλαίσιο **Διαχείριση υπηρεσίας καταλόγου Active Directory** .

> [AZURE.NOTE] Όταν ρυθμίζετε το διαχειριστή του Azure AD, το νέο όνομα διαχειριστή (χρήστη ή μια ομάδα) ήδη δεν μπορεί να είναι παρόντες σε εικονικό κύρια βάση δεδομένων ως χρήστης τον έλεγχο ταυτότητας του SQL Server. Εάν υπάρχει, το πρόγραμμα εγκατάστασης Azure AD θα αποτύχει; Επαναφορά τη δημιουργία και που υποδεικνύει ότι αυτό όπως διαχειριστής (όνομα) ήδη υπάρχει. Επειδή το όπως ενός χρήστη ελέγχου ταυτότητας του SQL Server δεν είναι μέρος του Azure AD, οποιαδήποτε προσπάθεια για τη σύνδεση με το διακομιστή με χρήση ελέγχου ταυτότητας Azure AD αποτυγχάνει.

Για να καταργήσετε αργότερα διαχειριστής, στο επάνω μέρος του blade **διαχείρισης της υπηρεσίας καταλόγου Active Directory** , κάντε κλικ στην επιλογή **Κατάργηση διαχειριστή**και, στη συνέχεια, κάντε κλικ στην επιλογή **Αποθήκευση**.

### <a name="provision-an-azure-ad-administrator-for-azure-sql-server-by-using-powershell"></a>Προμήθεια διαχειριστής Azure AD για Azure SQL Server με χρήση του PowerShell

Για να εκτελέσετε τα cmdlet του PowerShell, πρέπει να έχετε Azure PowerShell εγκατασταθεί και εκτελείται. Για λεπτομερείς πληροφορίες, ανατρέξτε στο θέμα [Πώς να εγκαταστήσετε και να ρυθμίσετε τις παραμέτρους του PowerShell Azure](../powershell-install-configure.md).

Για να προμηθεύσουν διαχειριστής Azure AD, εκτελέστε τις ακόλουθες εντολές Azure PowerShell:

- Προσθήκη AzureRmAccount
- Επιλέξτε AzureRmSubscription


Cmdlet χρησιμοποιηθούν για την παροχή και διαχείριση διαχείρισης Azure AD:

| Όνομα cmdlet                                       | Περιγραφή                                                                                                     |
|---------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
| [Ορισμός AzureRmSqlServerActiveDirectoryAdministrator](https://msdn.microsoft.com/library/azure/mt603544.aspx)    | Διατάξεις διαχειριστής Azure Active Directory για Azure SQL Server ή αποθήκη δεδομένων του SQL Azure. (Πρέπει να είναι από την τρέχουσα συνδρομή σας). |
| [Κατάργηση AzureRmSqlServerActiveDirectoryAdministrator](https://msdn.microsoft.com/library/azure/mt619340.aspx) | Καταργεί ένα διαχειριστή Azure Active Directory για Azure SQL Server ή αποθήκη δεδομένων του SQL Azure. |
| [Get-AzureRmSqlServerActiveDirectoryAdministrator](https://msdn.microsoft.com/library/azure/mt603737.aspx)    | Επιστρέφει πληροφορίες σχετικά με ένα διαχειριστή Azure Active Directory που έχουν ρυθμιστεί για το Azure SQL Server ή αποθήκη δεδομένων του SQL Azure. |

Χρήση του PowerShell εντολή get-Βοήθεια για να δείτε περισσότερες λεπτομέρειες για κάθε μία από αυτές τις εντολές, για παράδειγμα ``get-help Set-AzureRmSqlServerActiveDirectoryAdministrator``.

Οι ακόλουθες διατάξεις δέσμης ενεργειών μια Azure AD διαχειριστή της ομάδας με το όνομα **DBA_Group** (αναγνωριστικό αντικειμένου `40b79501-b343-44ed-9ce7-da4c8cc7353f`) για το **demo_server** διακομιστή σε μια ομάδα πόρων με το όνομα **ομάδας-23**:

```
Set-AzureRmSqlServerActiveDirectoryAdministrator –ResourceGroupName "Group-23"
–ServerName "demo_server" -DisplayName "DBA_Group"
```

Η παράμετρος εισόδου **DisplayName** αποδέχεται το Azure AD εμφανιζόμενο όνομα ή το κύριο όνομα χρήστη. Για παράδειγμα, ``DisplayName="John Smith"`` και ``DisplayName="johns@contoso.com"``. Για τις ομάδες Azure AD μόνο το Azure AD υποστηρίζεται εμφανιζόμενο όνομα.

> [AZURE.NOTE] Η εντολή Azure PowerShell ```Set-AzureRmSqlServerActiveDirectoryAdministrator``` δεν εμποδίζει την προμήθεια του Azure AD διαχειριστές για τους χρήστες που δεν υποστηρίζονται. Ένας χρήστης που δεν υποστηρίζεται μπορεί να καθοριστεί, αλλά δεν μπορεί να συνδεθεί με μια βάση δεδομένων. (Δείτε τη λίστα των διαχειριστών υποστηρίζεται στο **Azure AD δυνατότητες και περιορισμοί της** παραπάνω).

Το παρακάτω παράδειγμα χρησιμοποιεί προαιρετικό **ObjectID**:

```
Set-AzureRmSqlServerActiveDirectoryAdministrator –ResourceGroupName "Group-23"
–ServerName "demo_server" -DisplayName "DBA_Group" -ObjectId "40b79501-b343-44ed-9ce7-da4c8cc7353f"
```

> [AZURE.NOTE] Azure AD **ObjectID** απαιτείται όταν το **εμφανιζόμενο όνομα** δεν είναι μοναδικό. Για να ανακτήσετε τις τιμές **ObjectID** και **εμφανιζόμενο όνομα** , χρησιμοποιήστε την υπηρεσία καταλόγου Active Directory του Azure κλασική πύλη και προβάλετε τις ιδιότητες ενός χρήστη ή ομάδας.

Το παρακάτω παράδειγμα επιστρέφει πληροφορίες σχετικά με την τρέχουσα Azure AD διαχείρισης για τον Azure SQL Server:

```
Get-AzureRmSqlServerActiveDirectoryAdministrator –ResourceGroupName "Group-23" –ServerName "demo_server" | Format-List
```

Το παρακάτω παράδειγμα καταργεί Azure AD διαχειριστή:
```
Remove-AzureRmSqlServerActiveDirectoryAdministrator -ResourceGroupName "Group-23" –ServerName "demo_server"
```

Μπορείτε επίσης να προμήθεια διαχειριστής Azure Active Directory χρησιμοποιώντας τα REST API. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [υπηρεσία διαχείρισης REST API αναφορά και λειτουργίες για λειτουργίες βάσεις δεδομένων SQL Azure για βάσεις δεδομένων SQL Azure](https://msdn.microsoft.com/library/azure/dn505719.aspx)

## <a name="5-configure-your-client-computers"></a>5. ρύθμιση παραμέτρων υπολογιστές-πελάτες σας

Σε όλους τους υπολογιστές προγράμματος-πελάτη, από την οποία τις εφαρμογές σας ή τους χρήστες σύνδεση με βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL Azure χρησιμοποιώντας τις ταυτότητες Azure AD, πρέπει να εγκαταστήσετε το ακόλουθο λογισμικό:

- .NET framework 4.6 ή νεότερη έκδοση από το [https://msdn.microsoft.com/library/5a4x27ek.aspx](https://msdn.microsoft.com/library/5a4x27ek.aspx).
- Βιβλιοθήκη ελέγχου ταυτότητας καταλόγου Azure Active Directory για τον SQL Server (**ADALSQL. DLL**) είναι διαθέσιμη σε πολλές γλώσσες (x86 και amd64) από το Κέντρο λήψης στο [Microsoft Active Directory βιβλιοθήκη ελέγχου ταυτότητας για το Microsoft SQL Server](http://www.microsoft.com/download/details.aspx?id=48742).

### <a name="tools"></a>Εργαλεία

- Την εγκατάσταση του [SQL Server 2016 Management Studio](https://msdn.microsoft.com/library/mt238290.aspx) ή [SQL Server Data Tools Visual Studio 2015](https://msdn.microsoft.com/library/mt204009.aspx) πληροί τις απαιτήσεις .NET Framework 4.6.
- Έκδοση εγκαταστάσεις του x86 SSMS **ADALSQL. DLL**.
- SSDT εγκαθιστά την έκδοση amd64 του **ADALSQL. DLL**.
- Η πιο πρόσφατη Visual Studio από το [Visual Studio λήψεις](https://www.visualstudio.com/downloads/download-visual-studio-vs) πληροί τις απαιτήσεις .NET Framework 4.6, αλλά δεν εγκαθιστά την έκδοση απαιτείται amd64 του **ADALSQL. DLL**.

## <a name="6-create-contained-database-users-in-your-database-mapped-to-azure-ad-identities"></a>6. Δημιουργία χρηστών περιεχόμενα βάσης δεδομένων στη βάση δεδομένων σας έχει αντιστοιχιστεί σε Azure AD ταυτότητες

### <a name="about-contained-database-users"></a>Σχετικά με τους χρήστες που περιέχονται βάσης δεδομένων

Έλεγχος ταυτότητας Azure Active Directory απαιτείται από τους χρήστες βάσης δεδομένων που θα δημιουργηθεί ως χρήστες περιεχόμενα βάσης δεδομένων. Ένας χρήστης περιεχόμενα βάσης δεδομένων με βάση μια ταυτότητα Azure AD, είναι ένας χρήστης βάσης δεδομένων που δεν διαθέτει μια σύνδεση στην κύρια βάση δεδομένων, και που αντιστοιχεί σε μια ταυτότητα στον κατάλογο Azure AD που σχετίζεται με τη βάση δεδομένων. Η ταυτότητα Azure AD μπορεί να είναι είτε ένα μεμονωμένο λογαριασμό χρήστη ή μια ομάδα. Για περισσότερες πληροφορίες σχετικά με τους χρήστες που περιέχονται βάσης δεδομένων, ανατρέξτε στο θέμα [Πραγματοποίηση που περιέχονται χρήστες βάσεων δεδομένων σας του Portable βάσης δεδομένων](https://msdn.microsoft.com/library/ff929188.aspx).

> [AZURE.NOTE] Χρήστες βάσεων δεδομένων (με εξαίρεση για διαχειριστές) δεν είναι δυνατό να δημιουργηθούν με πύλη. Ρόλοι RBAC δεν μεταφέρονται σε SQL Server, βάση δεδομένων SQL ή αποθήκη δεδομένων του SQL. Azure RBAC τους ρόλους που χρησιμοποιούνται για τη διαχείριση των πόρων Azure και δεν ισχύουν για δικαιώματα στη βάση δεδομένων. Για παράδειγμα, το ρόλο του **SQL Server συμβολής** δεν εκχώρηση πρόσβασης για να συνδεθείτε με τη βάση δεδομένων SQL ή αποθήκη δεδομένων του SQL. Πρέπει να σας εκχωρηθεί το δικαίωμα πρόσβασης απευθείας στη βάση δεδομένων με χρήση προτάσεις Transact-SQL.

### <a name="connect-to-the-user-database-or-data-warehouse-by-using-sql-server-management-studio-or-sql-server-data-tools"></a>Σύνδεση προς την αποθήκη χρήστη βάσης δεδομένων ή δεδομένων με χρήση SQL Server Management Studio ή SQL Server Data Tools

Για να επιβεβαιώσετε ο διαχειριστής Azure AD είναι σωστά ρύθμιση, συνδεθείτε με την **κύρια** βάση δεδομένων χρησιμοποιώντας το λογαριασμό διαχειριστή Azure AD.
Για να προμηθεύσουν ένα Azure AD με βάση που περιέχονται χρήστες της βάσης δεδομένων (εκτός από το διαχειριστή του διακομιστή που είναι ο κάτοχος της βάσης δεδομένων), συνδεθείτε με τη βάση δεδομένων με μια ταυτότητα Azure AD που έχει πρόσβαση στη βάση δεδομένων.

> [AZURE.IMPORTANT] Υποστήριξη για έλεγχο ταυτότητας Azure Active Directory είναι διαθέσιμη με το [SQL Server 2016 Management Studio](https://msdn.microsoft.com/library/mt238290.aspx) και το [SQL Server Data Tools](https://msdn.microsoft.com/library/mt204009.aspx) στο Visual Studio 2015. Την έκδοση Αυγούστου 2016 του SSMS περιλαμβάνει επίσης υποστήριξη για Active Directory καθολικής έλεγχος ταυτότητας, που επιτρέπει στους διαχειριστές να απαιτεί έλεγχο ταυτότητας πολλών παραγόντων χρησιμοποιώντας μια τηλεφωνική κλήση, το μήνυμα κειμένου, έξυπνες κάρτες με pin ή ειδοποίηση εφαρμογής για κινητές συσκευές.

#### <a name="connect-using-active-directory-integrated-authentication"></a>Σύνδεση με χρήση ενσωματωμένου ελέγχου ταυτότητας Active Directory

Χρησιμοποιήστε αυτήν τη μέθοδο, εάν είστε συνδεδεμένοι με το Windows χρησιμοποιώντας τα διαπιστευτήρια Azure Active Directory από έναν ομόσπονδο τομέα.

1. Έναρξη Management Studio ή Εργαλεία δεδομένων και στο παράθυρο διαλόγου **σύνδεση με το διακομιστή** (ή **σύνδεση με το μηχανισμό βάσεων δεδομένων**), στο πλαίσιο **ελέγχου ταυτότητας** , επιλέξτε **Active Directory ενσωματωμένο έλεγχο ταυτότητας**. Δεν υπάρχει κωδικός πρόσβασης είναι απαραίτητη ή μπορεί να εισαχθεί, επειδή θα παρουσιάζονται οι υπάρχουσες τα διαπιστευτήριά σας για τη σύνδεση.
    ![Επιλέξτε ενσωματωμένο έλεγχο ταυτότητας AD][11]

2. Κάντε κλικ στο κουμπί **Επιλογές** και, στη σελίδα **Ιδιότητες σύνδεσης** , στο πλαίσιο **σύνδεση με βάση δεδομένων** , πληκτρολογήστε το όνομα της βάσης δεδομένων χρήστη που θέλετε να συνδεθείτε.
    ![Επιλέξτε το όνομα της βάσης δεδομένων][13]


#### <a name="connect-using-active-directory-password-authentication"></a>Σύνδεση με χρήση ελέγχου ταυτότητας Active Directory τον κωδικό πρόσβασης

Χρησιμοποιήστε αυτήν τη μέθοδο κατά τη σύνδεση με ένα κύριο όνομα Azure AD χρησιμοποιώντας το Azure AD διαχειριζόμενων τομέα. Μπορείτε επίσης να το χρησιμοποιήσετε για το λογαριασμό ομόσπονδη χωρίς πρόσβαση του τομέα, για παράδειγμα, όταν εργάζεται από απόσταση.

Χρησιμοποιήστε αυτήν τη μέθοδο, εάν είστε συνδεδεμένοι με το Windows χρησιμοποιώντας τα διαπιστευτήρια από έναν τομέα που δεν έχει συνενωθεί με Azure ή όταν με χρήση ελέγχου ταυτότητας Azure AD χρησιμοποιώντας Azure AD με βάση την αρχική ή τον τομέα του προγράμματος-πελάτη.

1. Έναρξη Management Studio ή Εργαλεία δεδομένων και στο παράθυρο διαλόγου **σύνδεση με το διακομιστή** (ή **σύνδεση με το μηχανισμό βάσεων δεδομένων**), στο πλαίσιο **ελέγχου ταυτότητας** , επιλέξτε **Τον έλεγχο ταυτότητας τον κωδικό πρόσβασης Active Directory**.
2. Στο πλαίσιο **όνομα χρήστη** , πληκτρολογήστε το όνομα χρήστη Azure Active Directory με τη μορφή **username@domain.com**. Πρέπει να είναι ένα λογαριασμό από το Azure Active Directory ή ένα λογαριασμό από έναν τομέα είναι ομόσπονδη με το Azure Active Directory.
3. Στο πλαίσιο **κωδικός πρόσβασης** , πληκτρολογήστε τον κωδικό πρόσβασης χρήστη για το λογαριασμό Azure Active Directory ή ομόσπονδο τομέα λογαριασμού.
    ![Επιλέξτε έλεγχος ταυτότητας AD τον κωδικό πρόσβασης][12]

4. Κάντε κλικ στο κουμπί **Επιλογές** και, στη σελίδα **Ιδιότητες σύνδεσης** , στο πλαίσιο **σύνδεση με βάση δεδομένων** , πληκτρολογήστε το όνομα της βάσης δεδομένων χρήστη που θέλετε να συνδεθείτε. (Δείτε το γραφικό στο στην προηγούμενη επιλογή).


### <a name="create-an-azure-ad-contained-database-user-in-a-user-database"></a>Δημιουργήστε ένα χρήστη βάσης δεδομένων Azure AD που περιέχονται σε μια βάση δεδομένων χρήστη

Για να δημιουργήσετε μια Azure AD με βάση που περιέχονται χρήστες της βάσης δεδομένων (εκτός από το διαχειριστή του διακομιστή που είναι ο κάτοχος της βάσης δεδομένων), συνδεθείτε με τη βάση δεδομένων με μια ταυτότητα Azure AD, ως χρήστης με τουλάχιστον το δικαίωμα **ΤΡΟΠΟΠΟΙΉΣΟΥΝ ΟΠΟΙΑΔΉΠΟΤΕ ΧΡΉΣΤΗ** . Στη συνέχεια, χρησιμοποιήστε την ακόλουθη σύνταξη Transact-SQL:

    CREATE USER <Azure_AD_principal_name>
    FROM EXTERNAL PROVIDER;


*Azure_AD_principal_name* μπορεί να είναι το κύριο όνομα χρήστη ενός χρήστη Azure AD ή το εμφανιζόμενο όνομα για μια ομάδα του Azure AD.

**Παραδείγματα:** Για να δημιουργήσετε μια βάση δεδομένων που περιέχονται χρήστη που αντιπροσωπεύει ένα Azure AD ομόσπονδες ή διαχειριζόμενων χρήστη τομέα:

    CREATE USER [bob@contoso.com] FROM EXTERNAL PROVIDER;
    CREATE USER [alice@fabrikam.onmicrosoft.com] FROM EXTERNAL PROVIDER;

Για να δημιουργήσετε ένα χρήστη που περιέχονται βάσης δεδομένων που αντιπροσωπεύει ένα Azure AD ή ομόσπονδο τομέα ομάδας, δώστε το εμφανιζόμενο όνομα μιας ομάδας ασφαλείας:

    CREATE USER [ICU Nurses] FROM EXTERNAL PROVIDER;

Για να δημιουργήσετε ένα χρήστη περιεχόμενα βάσης δεδομένων που αντιπροσωπεύει μια εφαρμογή η οποία συνδέεται με τη χρήση ενός διακριτικού Azure AD:

    CREATE USER [appName] FROM EXTERNAL PROVIDER;

Για περισσότερες πληροφορίες σχετικά με τη δημιουργία χρηστών περιεχόμενα βάσεων δεδομένων με βάση τις ταυτότητες Azure Active Directory, ανατρέξτε στο θέμα [ΔΗΜΙΟΥΡΓΊΑ ΧΡΉΣΤΗ (Transact-SQL)](http://msdn.microsoft.com/library/ms173463.aspx).


> [AZURE.NOTE] Κατάργηση ο διαχειριστής Azure Active Directory για τον Azure SQL Server αποτρέπει οποιοσδήποτε χρήστης ελέγχου ταυτότητας Azure AD από το να συνδεθεί στο διακομιστή. Εάν είναι απαραίτητο, χωρίς δυνατότητα χρήσης Azure AD οι χρήστες μπορούν να καταργηθούν με μη αυτόματο τρόπο από το διαχειριστή της βάσης δεδομένων SQL.

Όταν δημιουργείτε μια βάση δεδομένων χρήστη, αυτός ο χρήστης λαμβάνει το δικαίωμα **ΣΎΝΔΕΣΗ** και να συνδεθείτε με αυτήν τη βάση δεδομένων ως μέλος του ρόλου **ΔΗΜΌΣΙΑ** . Αρχικά μόνο τα δικαιώματα διαθέσιμες στο χρήστη είναι οποιαδήποτε δικαιώματα που έχουν εκχωρηθεί στο **ΔΗΜΌΣΙΟ** ρόλο ή οποιαδήποτε δικαιώματα που έχουν εκχωρηθεί στις ομάδες Windows που είναι μέλος. Μετά την προμήθεια μιας Azure AD με βάση που περιέχονται χρήστες της βάσης δεδομένων, μπορείτε να εκχωρήσετε στο χρήστη επιπλέον δικαιώματα, τον ίδιο τρόπο που μπορείτε να εκχωρήσετε δικαιώματα για οποιονδήποτε άλλο τύπο του χρήστη. Συνήθως εκχώρηση δικαιωμάτων σε ρόλους βάσης δεδομένων και να προσθέσετε χρήστες σε ρόλους. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Βασικές αρχές δικαιωμάτων μηχανισμός βάσεων δεδομένων](http://social.technet.microsoft.com/wiki/contents/articles/4433.database-engine-permission-basics.aspx). Για περισσότερες πληροφορίες σχετικά με τους ρόλους ειδική βάση δεδομένων SQL, ανατρέξτε στο θέμα [Διαχείριση βάσεων δεδομένων και συνδέσεις σε βάση δεδομένων SQL Azure](sql-database-manage-logins.md).
Ένας χρήστης ομόσπονδο τομέα που έχει εισαχθεί στο Διαχείριση τομέα, πρέπει να χρησιμοποιήσετε την ταυτότητα διαχειριζόμενων τομέα.

> [AZURE.NOTE] Azure AD χρήστες επισημαίνονται στο τα μετα-δεδομένα βάσης δεδομένων με τον τύπο E (EXTERNAL_USER) και για τις ομάδες με τον τύπο X (EXTERNAL_GROUPS). Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [sys.database_principals](https://msdn.microsoft.com/library/ms187328.aspx).


## <a name="7-connect-by-using-azure-ad-identities"></a>7. συνδεθείτε χρησιμοποιώντας τις ταυτότητες Azure AD

Έλεγχος ταυτότητας Azure Active Directory υποστηρίζει τη σύνδεση σε μια βάση δεδομένων χρησιμοποιώντας τις ταυτότητες Azure AD τις παρακάτω μεθόδους:

- Χρήση ενσωματωμένο έλεγχο ταυτότητας των Windows
- Χρησιμοποιώντας ένα κύριο όνομα Azure AD και έναν κωδικό πρόσβασης
- Χρήση του ελέγχου ταυτότητας διακριτικού εφαρμογής

### <a name="71-connecting-using-integrated-windows-authentication"></a>7.1. Σύνδεση με χρήση ενσωματωμένο έλεγχο ταυτότητας (Windows)

Για να χρησιμοποιήσετε την ενσωματωμένη ελέγχου ταυτότητας των Windows, πρέπει να είναι ομόσπονδες υπηρεσίας καταλόγου Active Directory του τομέα σας με το Azure Active Directory. Πρέπει να εκτελεί την εφαρμογή-πελάτη (ή μια υπηρεσία) τη σύνδεση με τη βάση δεδομένων σε έναν υπολογιστή τομέα, στην περιοχή τα διαπιστευτήριά τομέα ενός χρήστη.

Για να συνδεθείτε με μια βάση δεδομένων με χρήση ενσωματωμένου ελέγχου ταυτότητας και μια ταυτότητα Azure AD, τη λέξη-κλειδί ελέγχου ταυτότητας στη συμβολοσειρά σύνδεσης βάσης δεδομένων πρέπει να οριστεί στην ενσωματωμένη Active Directory. Το παρακάτω δείγμα κώδικα C# χρησιμοποιεί ADO .NET.

    string ConnectionString =
    @"Data Source=n9lxnyuzhv.database.windows.net; Authentication=Active Directory Integrated; Initial Catalog=testdb;";
    SqlConnection conn = new SqlConnection(ConnectionString);
    conn.Open();

Σημειώστε ότι η σύνδεση συμβολοσειράς λέξεων-κλειδιών ``Integrated Security=True`` δεν υποστηρίζεται για τη σύνδεση με βάση δεδομένων SQL Azure.
Σημειώστε ότι, όταν δημιουργείτε μια σύνδεση ODBC θα πρέπει να καταργήσετε τα κενά διαστήματα και να ρυθμίσετε 'ActiveDirectoryIntegrated' του ελέγχου ταυτότητας.

### <a name="72-connecting-with-an-azure-ad-principal-name-and-a-password"></a>7.2. Σύνδεση με ένα κύριο όνομα Azure AD και έναν κωδικό πρόσβασης
Για να συνδεθείτε με μια βάση δεδομένων με χρήση ενσωματωμένου ελέγχου ταυτότητας και μια ταυτότητα Azure AD, πρέπει να οριστεί τη λέξη-κλειδί ελέγχου ταυτότητας με κωδικό πρόσβασης Active Directory. Η συμβολοσειρά σύνδεσης πρέπει να περιέχει Αναγνωριστικό/μοναδικό Αναγνωριστικό χρήστη και τον κωδικό πρόσβασης/PWD λέξεις-κλειδιά και τις τιμές. Το παρακάτω δείγμα κώδικα C# χρησιμοποιεί ADO .NET.

    string ConnectionString =
      @"Data Source=n9lxnyuzhv.database.windows.net; Authentication=Active Directory Password; Initial Catalog=testdb;  UID=bob@contoso.onmicrosoft.com; PWD=MyPassWord!";
    SqlConnection conn = new SqlConnection(ConnectionString);
    conn.Open();

Μάθετε περισσότερα σχετικά με τις μεθόδους ελέγχου ταυτότητας Azure AD χρησιμοποιώντας τα δείγματα κώδικα επίδειξη διαθέσιμες από [Azure AD ελέγχου ταυτότητας GitHub επίδειξη](https://github.com/Microsoft/sql-server-samples/tree/master/samples/features/security/azure-active-directory-auth).


### <a name="73-connecting-with-an-azure-ad-token"></a>7.3 τη σύνδεση με διακριτικό Azure AD
Αυτή η μέθοδος ελέγχου ταυτότητας επιτρέπει τις υπηρεσίες μεσαίου επιπέδου για να συνδεθείτε με βάση δεδομένων SQL Azure ή αποθήκη δεδομένων του SQL Azure με την απόκτηση ενός διακριτικού από το Azure Active Directory (AAD). Επιτρέπει εξελιγμένο σενάρια, όπως τον έλεγχο ταυτότητας βάσει πιστοποιητικού. Πρέπει να ολοκληρώσετε τέσσερα βασικά βήματα για τη χρήση του ελέγχου ταυτότητας διακριτικού Azure AD:

1. Καταχωρήστε την εφαρμογή του Azure Active Directory και να λάβετε το αναγνωριστικό υπολογιστή-πελάτη για τον κωδικό. 
2. Δημιουργία βάσης δεδομένων χρήστη που αντιπροσωπεύει την εφαρμογή. (Ολοκληρωθεί προηγουμένως στο βήμα 6).
3. Δημιουργήσετε ένα πιστοποιητικό στον το εκτελείται προγράμματος-πελάτη υπολογιστή την εφαρμογή.
4. Προσθέστε το πιστοποιητικό ως έναν αριθμό-κλειδί για την εφαρμογή σας.

Δείγμα συμβολοσειρά σύνδεσης:

```
string ConnectionString =@"Data Source=n9lxnyuzhv.database.windows.net; Initial Catalog=testdb;"
SqlConnection conn = new SqlConnection(ConnectionString);
connection.AccessToken = "Your JWT token"
conn.Open();
```

Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Ιστολόγιο ασφαλείας του SQL Server](https://blogs.msdn.microsoft.com/sqlsecurity/2016/02/09/token-based-authentication-support-for-azure-sql-db-using-azure-ad-auth/).

### <a name="connecting-with-sqlcmd"></a>Σύνδεση με sqlcmd  
Οι παρακάτω προτάσεις, συνδεθείτε χρησιμοποιώντας έκδοση 13.1 του sqlcmd, που είναι διαθέσιμη από το [Κέντρο λήψης αρχείων της](http://go.microsoft.com/fwlink/?LinkID=825643).

```
sqlcmd -S Target_DB_or_DW.testsrv.database.windows.net  -G  
sqlcmd -S Target_DB_or_DW.testsrv.database.windows.net -U bob@contoso.com -P MyAADPassword -G -l 30
```

## <a name="see-also"></a>Δείτε επίσης

[Διαχείριση βάσεων δεδομένων και συνδέσεις σε βάση δεδομένων SQL Azure](sql-database-manage-logins.md)

[Οι χρήστες που περιέχονται βάσης δεδομένων](https://msdn.microsoft.com/library/ff929071.aspx)

[ΔΗΜΙΟΥΡΓΊΑ ΧΡΉΣΤΗ (Transact-SQL)](http://msdn.microsoft.com/library/ms173463.aspx)


<!--Image references-->

[1]: ./media/sql-database-aad-authentication/1aad-auth-diagram.png
[2]: ./media/sql-database-aad-authentication/2subscription-relationship.png
[3]: ./media/sql-database-aad-authentication/3admin-structure.png
[4]: ./media/sql-database-aad-authentication/4select-subscription.png
[5]: ./media/sql-database-aad-authentication/5ad-settings-portal.png
[6]: ./media/sql-database-aad-authentication/6edit-directory-select.png
[7]: ./media/sql-database-aad-authentication/7edit-directory-confirm.png
[8]: ./media/sql-database-aad-authentication/8choose-ad.png
[9]: ./media/sql-database-aad-authentication/9ad-settings.png
[10]: ./media/sql-database-aad-authentication/10choose-admin.png
[11]: ./media/sql-database-aad-authentication/11connect-using-int-auth.png
[12]: ./media/sql-database-aad-authentication/12connect-using-pw-auth.png
[13]: ./media/sql-database-aad-authentication/13connect-to-db.png


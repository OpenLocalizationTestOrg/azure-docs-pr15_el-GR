<properties 
    pageTitle="Αντιγράψτε μια βάση δεδομένων Azure SQL χρησιμοποιώντας την Transact-SQL | Microsoft Azure" 
    description="Δημιουργία αντιγράφου μιας βάσης δεδομένων Azure SQL χρησιμοποιώντας την Transact-SQL" 
    services="sql-database"
    documentationCenter=""
    authors="stevestein"
    manager="jhubbard"
    editor=""/>

<tags
    ms.service="sql-database"
    ms.devlang="NA"
    ms.date="09/19/2016"
    ms.author="sstein"
    ms.workload="data-management"
    ms.topic="article"
    ms.tgt_pltfrm="NA"/>


# <a name="copy-an-azure-sql-database-using-transact-sql"></a>Αντιγράψτε μια βάση δεδομένων Azure SQL χρησιμοποιώντας την Transact-SQL


> [AZURE.SELECTOR]
- [Επισκόπηση](sql-database-copy.md)
- [Πύλη του Azure](sql-database-copy-portal.md)
- [PowerShell](sql-database-copy-powershell.md)
- [T-SQL](sql-database-copy-transact-sql.md)


Αυτό παρακάτω βήματα σας δείχνουν πώς μπορείτε να αντιγράψετε μια βάση δεδομένων SQL με Transact-SQL στον ίδιο διακομιστή ή σε διαφορετικό διακομιστή. Λειτουργία αντίγραφο της βάσης δεδομένων χρησιμοποιεί την πρόταση [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) .

Για να ολοκληρώσετε τα βήματα σε αυτό το άρθρο χρειάζεστε τα εξής:

- Μια συνδρομή του Azure. Εάν χρειάζεστε μια συνδρομή του Azure απλώς κάντε κλικ στην επιλογή **ΔΩΡΕΆΝ δοκιμαστική ΈΚΔΟΣΗ** στο επάνω μέρος αυτής της σελίδας και, στη συνέχεια, επιστρέψτε στο τέλος αυτού του άρθρου.
- Μια βάση δεδομένων SQL Azure. Εάν δεν έχετε μια βάση δεδομένων SQL, να δημιουργήσετε μία ακολουθώντας τα βήματα σε αυτό το άρθρο: [Δημιουργία του πρώτου βάση δεδομένων SQL Azure](sql-database-get-started.md).
- [SQL Server Management Studio (SSMS)](https://msdn.microsoft.com/library/ms174173.aspx). Εάν δεν έχετε SSMS ή εάν οι δυνατότητες που περιγράφονται σε αυτό το άρθρο δεν είναι διαθέσιμη, [κάντε λήψη της πιο πρόσφατης έκδοσης](https://msdn.microsoft.com/library/mt238290.aspx).


## <a name="copy-your-sql-database"></a>Αντιγράψτε τη βάση δεδομένων SQL

Συνδεθείτε με την κύρια βάση δεδομένων με τη χρήση κεφαλαίου login επιπέδου διακομιστή ή τη σύνδεση που δημιούργησε τη βάση δεδομένων που θέλετε να αντιγράψετε. Συνδέσεις που δεν είναι ο κύριος επιπέδου διακομιστή πρέπει να είναι μέλη του ρόλου dbmanager για να αντιγράψετε βάσεις δεδομένων. Για περισσότερες πληροφορίες σχετικά με συνδέσεις και τη σύνδεση με το διακομιστή, ανατρέξτε στο θέμα [Διαχείριση συνδέσεις](sql-database-manage-logins.md).

Έναρξη αντιγραφής τη βάση δεδομένων προέλευσης με την εντολή [ΔΗΜΙΟΥΡΓΊΑ βάσης ΔΕΔΟΜΈΝΩΝ](https://msdn.microsoft.com/library/ms176061.aspx) . Εκτέλεση αυτήν τη δήλωση ξεκινά τη βάση δεδομένων, αντιγράφοντας διαδικασία. Επειδή η αντιγραφή μιας βάσης δεδομένων είναι μια ασύγχρονη διεργασία, την πρόταση CREATE DATABASE επιστρέφει πριν ολοκληρωθεί η αντιγραφή της βάσης δεδομένων.


### <a name="copy-a-sql-database-to-the-same-server"></a>Αντιγράψτε μια βάση δεδομένων SQL στον ίδιο διακομιστή

Συνδεθείτε με την κύρια βάση δεδομένων με τη χρήση κεφαλαίου login επιπέδου διακομιστή ή τη σύνδεση που δημιούργησε τη βάση δεδομένων που θέλετε να αντιγράψετε. Συνδέσεις που δεν είναι ο κύριος επιπέδου διακομιστή πρέπει να είναι μέλη του ρόλου dbmanager για να αντιγράψετε βάσεις δεδομένων.

Αυτή η εντολή αντίγραφα Database1 με μια νέα βάση δεδομένων με το όνομα Database2 στον ίδιο διακομιστή. Ανάλογα με το μέγεθος της βάσης δεδομένων λειτουργίας αντιγραφής ενδέχεται να χρειαστεί κάποιος χρόνος για να ολοκληρώσετε.

    -- Execute on the master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-to-a-different-server"></a>Αντιγράψτε μια βάση δεδομένων SQL σε διαφορετικό διακομιστή

Συνδεθείτε με την κύρια βάση δεδομένων του διακομιστή προορισμού, το διακομιστή βάσης δεδομένων SQL Azure όπου πρόκειται να δημιουργηθεί η νέα βάση δεδομένων. Χρησιμοποιήστε μια σύνδεση που έχει το ίδιο όνομα και τον κωδικό πρόσβασης της βάσης δεδομένων προέλευσης στο διακομιστή βάσης δεδομένων SQL Azure προέλευσης ως κάτοχος της βάσης δεδομένων (DBO). Σύνδεση στο διακομιστή προορισμού επίσης πρέπει να είστε μέλος του ρόλου dbmanager ή να login κεφαλαίου επιπέδου διακομιστή.

Αυτή η εντολή αντιγράφει Database1 στην server1 - σε μια νέα βάση δεδομένων με το όνομα Database2 στον server2. Ανάλογα με το μέγεθος της βάσης δεδομένων λειτουργίας αντιγραφής ενδέχεται να χρειαστεί κάποιος χρόνος για να ολοκληρώσετε.


    -- Execute on the master database of the target server (server2)
    -- Start copying from Server1 to Server2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;
    

## <a name="monitor-the-progress-of-the-copy-operation"></a>Παρακολούθηση της προόδου της λειτουργίας αντιγραφής

Παρακολουθείτε τη διαδικασία αντιγραφής κατά την υποβολή ερωτημάτων τις προβολές sys.databases και sys.dm_database_copies. Ενώ η αντιγραφή βρίσκεται σε εξέλιξη, η στήλη state_desc της προβολής sys.databases για τη νέα βάση δεδομένων έχει οριστεί για ΑΝΤΙΓΡΑΦΉ.


- Εάν η αντιγραφή αποτύχει, η στήλη state_desc της προβολής sys.databases για τη νέα βάση δεδομένων έχει οριστεί σε ΎΠΟΠΤΗ. Σε αυτήν την περίπτωση, εκτελέσει την πρόταση DROP στη νέα βάση δεδομένων και προσπαθήστε ξανά αργότερα.
- Εάν η αντιγραφή ολοκληρωθεί με επιτυχία, η στήλη state_desc της προβολής sys.databases για τη νέα βάση δεδομένων έχει οριστεί σε ONLINE. Σε αυτήν την περίπτωση, η αντιγραφή έχει ολοκληρωθεί και τη νέα βάση δεδομένων είναι σε κανονική βάση δεδομένων, μπορούν να αλλάξουν ανεξάρτητα από τη βάση δεδομένων προέλευσης.

> [AZURE.NOTE] -Εάν αποφασίσετε να ακυρώσετε την αντιγραφή ενώ βρίσκεται σε εξέλιξη, εκτελέστε την δήλωση [ΑΠΌΡΡΙΨΗ βάσης ΔΕΔΟΜΈΝΩΝ](https://msdn.microsoft.com/library/ms178613.aspx) σε νέα βάση δεδομένων. Εναλλακτικά, εκτελώντας την εντολή ΑΠΌΡΡΙΨΗ βάσης ΔΕΔΟΜΈΝΩΝ στη βάση δεδομένων προέλευσης ακυρώνει επίσης τη διαδικασία αντιγραφής.


## <a name="resolve-logins-after-the-copy-operation-completes"></a>Επίλυση συνδέσεις μετά την ολοκλήρωση της λειτουργίας αντιγραφής

Μετά τη νέα βάση δεδομένων είναι σε σύνδεση στο διακομιστή προορισμού, χρησιμοποιήστε την πρόταση [ΤΡΟΠΟΠΟΙΉΣΟΥΝ ΧΡΉΣΤΗ](https://msdn.microsoft.com/library/ms176060.aspx) να αντιστοιχίσετε ξανά τους χρήστες από τη νέα βάση δεδομένων στις συνδέσεις στο διακομιστή προορισμού. Για να επιλύσετε ορφανό χρήστες, ανατρέξτε στο θέμα [Αντιμετώπιση προβλημάτων ορφανό χρηστών](https://msdn.microsoft.com/library/ms175475.aspx). Δείτε επίσης [πώς μπορείτε να διαχειριστείτε ασφαλείας βάσης δεδομένων Azure SQL μετά την αποκατάσταση](sql-database-geo-replication-security-config.md).

Όλοι οι χρήστες της νέας βάσης δεδομένων διατηρεί τα δικαιώματα που είχαν στη βάση δεδομένων προέλευσης. Ο χρήστης που ξεκινά το αντίγραφο της βάσης δεδομένων θα είναι ο κάτοχος της βάσης δεδομένων με τη νέα βάση δεδομένων και εκχωρείται ένα νέο αναγνωριστικό ασφαλείας (αναγνωριστικό ΑΣΦΑΛΕΊΑΣ). Όταν ολοκληρωθεί με επιτυχία η αντιγραφή και πριν από άλλους χρήστες είναι αντιστοιχίζονται, μόνο τη σύνδεση που ξεκινά η αντιγραφή, ο κάτοχος της βάσης δεδομένων (DBO), να συνδεθείτε με τη νέα βάση δεδομένων.


## <a name="next-steps"></a>Επόμενα βήματα

- Για μια επισκόπηση του αντιγράφοντας μια βάση δεδομένων SQL Azure, ανατρέξτε στο θέμα [Αντιγραφή μιας βάσης δεδομένων Azure SQL](sql-database-copy.md) .
- Ανατρέξτε στο θέμα [Αντιγραφή μιας βάσης δεδομένων Azure SQL με την πύλη Azure](sql-database-copy-portal.md) για να αντιγράψετε μια βάση δεδομένων με την πύλη Azure.
- Ανατρέξτε στο θέμα [Αντιγραφή μια βάση δεδομένων Azure SQL με χρήση του PowerShell](sql-database-copy-powershell.md) για να αντιγράψετε μια βάση δεδομένων με χρήση του PowerShell.
- Δείτε [πώς μπορείτε να διαχειριστείτε ασφαλείας βάσης δεδομένων Azure SQL μετά την αποκατάσταση](sql-database-geo-replication-security-config.md) για να μάθετε περισσότερα σχετικά με τη Διαχείριση χρηστών και συνδέσεις κατά την αντιγραφή μιας βάσης δεδομένων σε διαφορετικό διακομιστή λογική.



## <a name="additional-resources"></a>Πρόσθετοι πόροι

- [Διαχείριση συνδέσεων](sql-database-manage-logins.md)
- [Σύνδεση με βάση δεδομένων SQL με SQL Server Management Studio και να εκτελέσετε ένα ερώτημα T SQL δείγματος](sql-database-connect-query-ssms.md)
- [Εξαγωγή της βάσης δεδομένων σε ένα BACPAC](sql-database-export.md)
- [Επισκόπηση επιχειρηματικές συνέχειας](sql-database-business-continuity.md)
- [Τεκμηρίωση βάσης δεδομένων SQL](https://azure.microsoft.com/documentation/services/sql-database/)



<properties
   pageTitle="Βάση δεδομένων SQL αποκατάσταση | Microsoft Azure"
   description="Μάθετε πώς μπορείτε να ανακτήσετε μια βάση δεδομένων από μια αποτυχία με Azure SQL αναπαραγωγή βάσης δεδομένων Active παν- και δυνατότητες παν-επαναφορά ή μη διαθεσιμότητα του τοπικού κέντρου δεδομένων."
   services="sql-database"
   documentationCenter=""
   authors="CarlRabeler"
   manager="jhubbard"
   editor="monicar"/>

<tags
   ms.service="sql-database"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="10/13/2016"
   ms.author="carlrab"/>

# <a name="restore-an-azure-sql-database-or-failover-to-a-secondary"></a>Επαναφέρετε μια βάση δεδομένων SQL Azure ή ανακατεύθυνση σε δευτερεύον

Βάση δεδομένων SQL του Azure παρέχει τις ακόλουθες δυνατότητες για την ανάκτηση από μια μη διαθεσιμότητα:

- [Ενεργό παν-αναπαραγωγής](sql-database-geo-replication-overview.md)
- [Επαναφορά παν](sql-database-recovery-using-backups.md#point-in-time-restore)

Για να μάθετε περισσότερα σχετικά με επιχειρηματικά σενάρια συνέχειας και τις δυνατότητες υποστήριξης, αυτά τα σενάρια, ανατρέξτε στο θέμα [αδιάκοπη παροχή υπηρεσιών](sql-database-business-continuity.md).

### <a name="prepare-for-the-event-of-an-outage"></a>Προετοιμασία για το συμβάν μια μη διαθεσιμότητα

Για την επιτυχία με αποκατάστασης σε άλλη περιοχή δεδομένων χρησιμοποιώντας το ενεργό παν-αναπαραγωγής ή παν πλεονάζοντα αντίγραφα ασφαλείας, πρέπει να προετοιμάσετε ένα διακομιστή σε ένα άλλο κέντρο δεδομένων μη διαθεσιμότητα για να γίνετε το νέο κύριο διακομιστή, θα πρέπει να την ανάγκη ανακύπτουν, καθώς και να έχουν οριστεί σωστά τα βήματα που τεκμηριώνονται και ελεγχθεί προκειμένου να εξασφαλιστεί ομαλή αποκατάστασης. Αυτά τα βήματα προετοιμασίας περιλαμβάνουν τα εξής:

- Προσδιορισμός λογική διακομιστή σε μια άλλη περιοχή για να γίνετε νέου κύριου διακομιστή. Με το ενεργό παν-αναπαραγωγής, αυτό θα είναι τουλάχιστον μία και ίσως κάθε έναν από τους διακομιστές δευτερεύοντα. Για επαναφορά παν, θα είναι γενικά ένα διακομιστή στην [περιοχή ζεύγη](../best-practices-availability-paired-regions.md) για την περιοχή στην οποία βρίσκεται η βάση δεδομένων.
- Προσδιορισμός και, προαιρετικά Ορισμός, οι κανόνες τείχους προστασίας επιπέδου διακομιστή που χρειάζεται για τους χρήστες για να αποκτήσετε πρόσβαση σε νέα κύρια βάση δεδομένων.
- Για να καθορίσετε τον τρόπο που πρόκειται να ανακατευθύνετε τους χρήστες στο νέο πρωτεύοντα διακομιστή, όπως αλλάζοντας συμβολοσειρές σύνδεσης ή, αλλάζοντας τις εγγραφές DNS.
- Προσδιορισμός και προαιρετικά να δημιουργήσετε τις συνδέσεις που πρέπει να υπάρχει στην κύρια βάση δεδομένων στο νέο πρωτεύοντα διακομιστή, και βεβαιωθείτε ότι αυτές οι συνδέσεις έχετε τα κατάλληλα δικαιώματα στην κύρια βάση δεδομένων, εάν υπάρχει. Για περισσότερες πληροφορίες, ανατρέξτε στην ενότητα [ασφάλεια βάσης δεδομένων SQL μετά την αποκατάσταση](sql-database-geo-replication-security-config.md)
- Προσδιορισμός ειδοποίησης κανόνες που θα πρέπει να ενημερωθούν ώστε να αντιστοιχίσετε στη νέα κύρια βάση δεδομένων.
- Η ρύθμιση παραμέτρων ελέγχου στην τρέχουσα βάση δεδομένων πρωτεύοντος εγγράφου
- Εκτελέστε μια [λεπτομερής αποκατάσταση](sql-database-disaster-recovery-drills.md). Για να προσομοιώσετε μια μη διαθεσιμότητα για επαναφορά παν, να διαγράψετε ή να μετονομάσετε τη βάση δεδομένων προέλευσης για να προκαλέσουν την αποτυχία συνδεσιμότητας εφαρμογής. Για να προσομοιώσετε μια μη διαθεσιμότητα για ενεργό παν-αναπαραγωγής, μπορείτε να απενεργοποιήσετε την εφαρμογή web ή μια εικονική μηχανή συνδεδεμένοι στη βάση δεδομένων ή την ανακατεύθυνση της βάσης δεδομένων να προκαλέσει αποτυχίες connectity εφαρμογών.

## <a name="when-to-initiate-recovery"></a>Πότε πρέπει να ξεκινήσετε ανάκτησης

Η λειτουργία αποκατάστασης επηρεάζει την εφαρμογή. Απαιτεί την αλλαγή της συμβολοσειράς σύνδεσης SQL ή ανακατεύθυνση με τη χρήση DNS και θα μπορούσε να έχει ως αποτέλεσμα απώλεια δεδομένων μόνιμο. Γι ' αυτό, θα πρέπει να γίνουν μόνο όταν το μη διαθεσιμότητα είναι πιθανό να διαρκεί περισσότερο από το στόχο χρόνου αποκατάστασης της εφαρμογής σας. Όταν η εφαρμογή έχει αναπτυχθεί σε παραγωγής που θα πρέπει να πραγματοποιείτε τακτική παρακολούθηση της την εύρυθμη λειτουργία της εφαρμογής και να χρησιμοποιείτε τα εξής σημεία δεδομένων για την επιβεβαίωση ότι η ανάκτηση είναι απαραίτητος:

1.  Αποτυχία μόνιμο συνδεσιμότητας από το επίπεδο εφαρμογής της βάσης δεδομένων.
2.  Πύλη του Azure εμφανίζει μια ειδοποίηση σχετικά με ένα περιστατικό της περιοχής με γενικά επίδραση.
3.  Το διακομιστή βάσης δεδομένων SQL Azure έχει σημανθεί ως υποβαθμισμένο.

Ανάλογα με το ανοχή εφαρμογής χρόνου εκτός λειτουργίας και δυνατόν ευθύνη επιχειρήσεις μπορείτε να τις παρακάτω επιλογές αποκατάστασης.

Χρησιμοποιήστε τη [Λήψη ανακτήσιμα βάση δεδομένων](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) για να λάβετε την πιο πρόσφατη σημείο αναπαραχθούν παν επαναφοράς.

## <a name="wait-for-service-recovery"></a>Περιμένετε για την ανάκτηση της υπηρεσίας

Η εργασία Azure τις ομάδες ευλαβικά ενημερωμένη για να επαναφέρετε διαθεσιμότητα υπηρεσίας όπως γρήγορα όσο το δυνατόν αλλά ανάλογα με τον ριζικό κατάλογο προκαλέσει μπορεί να διαρκέσει ώρες ή ημέρες.  Εάν η εφαρμογή σας μπορεί να αποδεχτεί τις σημαντική χρόνου εκτός λειτουργίας μπορείτε απλώς να περιμένετε για την ανάκτηση για να ολοκληρώσετε. Σε αυτήν την περίπτωση, απαιτείται καμία ενέργεια εκ μέρους σας. Μπορείτε να δείτε την τρέχουσα κατάσταση υπηρεσίας στην μας [Πίνακας εύρυθμης λειτουργίας υπηρεσιών Azure](https://azure.microsoft.com/status/). Μετά την ανάκτηση της περιοχής θα γίνει επαναφορά της εφαρμογής σας διαθεσιμότητα.

## <a name="failover-to-geo-replicated-secondary-database"></a>Ανακατεύθυνση αναπαραχθούν παν δευτερεύοντα βάση δεδομένων

Εάν χρόνου εκτός λειτουργίας της εφαρμογής σας μπορεί να έχει ως αποτέλεσμα ευθύνη επιχειρήσεις που πρέπει να χρησιμοποιείτε αναπαραχθούν παν βάσεις δεδομένων στην εφαρμογή σας. Αυτό θα επιτρέπουν την εφαρμογή για να επαναφέρετε γρήγορα διαθεσιμότητα σε διαφορετική περιοχή σε περίπτωση μια μη διαθεσιμότητα. Μάθετε πώς μπορείτε να [ρυθμίσετε τις παραμέτρους παν αναπαραγωγής](sql-database-geo-replication-portal.md).

Για να επαναφέρετε διαθεσιμότητα οι βάσεις δεδομένων που χρειάζεστε για να ξεκινήσετε την ανακατεύθυνση στο δευτερεύον αναπαραχθούν παν χρησιμοποιώντας μία από τις υποστηριζόμενες μεθόδους.

Χρησιμοποιήστε έναν από τους παρακάτω οδηγούς για να ανακατεύθυνσης για να αναπαραχθούν παν δευτερεύοντα βάσης δεδομένων:

- [Ανακατεύθυνση στο δευτερεύον αναπαραχθούν παν με πύλη Azure](sql-database-geo-replication-portal.md)
- [Ανακατεύθυνση στο δευτερεύον αναπαραχθούν παν χρήση του PowerShell](sql-database-geo-replication-powershell.md)
- [Ανακατεύθυνση στο δευτερεύον αναπαραχθούν παν χρησιμοποιώντας T-SQL](sql-database-geo-replication-transact-sql.md)

## <a name="recover-using-geo-restore"></a>Ανάκτηση χρήση παν-επαναφορά

Εάν ο χρόνος εκτός λειτουργίας της εφαρμογής σας δεν έχει ως αποτέλεσμα ευθύνη επιχειρήσεις μπορείτε να χρησιμοποιήσετε παν-επαναφορά ως μέθοδο για να ανακτήσετε τις βάσεις δεδομένων της εφαρμογής. Δημιουργεί ένα αντίγραφο της βάσης δεδομένων από τις πιο πρόσφατες παν πλεονάζοντα αντίγραφο ασφαλείας.

Χρησιμοποιήστε έναν από τους παρακάτω οδηγούς για να παν-επαναφοράς μιας βάσης δεδομένων σε μια νέα περιοχή:

- [Παν-επαναφοράς μιας βάσης δεδομένων σε μια νέα περιοχή με πύλη Azure](sql-database-geo-restore-portal.md)
- [Παν-επαναφοράς μιας βάσης δεδομένων σε μια νέα περιοχή με χρήση του PowerShell](sql-database-geo-restore-powershell.md)

## <a name="configure-your-database-after-recovery"></a>Ρύθμιση παραμέτρων βάσης δεδομένων σας μετά την ανάκτηση

Εάν χρησιμοποιείτε ανακατεύθυνσης παν αναπαραγωγής ή επαναφορά παν για την ανάκτηση από μια μη διαθεσιμότητα, πρέπει να βεβαιωθείτε ότι έχει ρυθμιστεί σωστά τη συνδεσιμότητα με τις νέες βάσεις δεδομένων, έτσι ώστε η συνάρτηση κανονική εφαρμογή μπορεί να συνεχιστεί. Αυτή είναι μια λίστα ελέγχου εργασιών για να Ετοιμαστείτε παραγωγής ανακτημένο βάση δεδομένων σας.

### <a name="update-connection-strings"></a>Ενημέρωση συμβολοσειρών σύνδεσης

Επειδή τα ανακτημένα βάσης δεδομένων σας θα βρίσκεται σε διαφορετικό διακομιστή, πρέπει να ενημερώσετε συμβολοσειρά σύνδεσης της εφαρμογής σας ώστε να οδηγούν σε αυτόν το διακομιστή.

Για περισσότερες πληροφορίες σχετικά με την αλλαγή συμβολοσειρές σύνδεσης, ανατρέξτε στο θέμα της γλώσσας κατάλληλο ανάπτυξης για τη [βιβλιοθήκη συνδέσεων](sql-database-libraries.md).

### <a name="configure-firewall-rules"></a>Ρύθμιση παραμέτρων κανόνες τείχους προστασίας

Πρέπει να βεβαιωθείτε ότι οι κανόνες τείχους προστασίας που έχει ρυθμιστεί στο διακομιστή και από τη βάση δεδομένων συμφωνούν με αυτά που έχουν ρυθμιστεί στο διακομιστή κύρια και κύρια βάση δεδομένων. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [ΔΙΑΔΙΚΑΣΙΕΣ: ρύθμιση παραμέτρων ρυθμίσεις του τείχους προστασίας (βάση δεδομένων SQL Azure)](sql-database-configure-firewall-settings.md).


### <a name="configure-logins-and-database-users"></a>Ρύθμιση παραμέτρων συνδέσεων και οι χρήστες της βάσης δεδομένων

Πρέπει να βεβαιωθείτε ότι υπάρχει όλες τις συνδέσεις που χρησιμοποιούνται από την εφαρμογή σας στο διακομιστή που φιλοξενεί τη βάση δεδομένων που έχει ανακτηθεί. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Ρύθμιση παραμέτρων ασφαλείας για παν αναπαραγωγής](sql-database-geo-replication-security-config.md).

>[AZURE.NOTE] Θα πρέπει να ρυθμίσετε και να δοκιμάσετε το κανόνες τείχους προστασίας του διακομιστή και συνδέσεις (και τα δικαιώματά) κατά τη διάρκεια μιας διερεύνησης αποκατάστασης από καταστροφή. Αυτά τα αντικείμενα επιπέδου διακομιστή και των παραμέτρων τους ενδέχεται να μην είναι διαθέσιμη κατά τη διακοπή ρεύματος.

### <a name="setup-telemetry-alerts"></a>Ρύθμιση ειδοποιήσεων Τηλεμετρίας

Πρέπει να βεβαιωθείτε ότι τις υπάρχουσες ρυθμίσεις ειδοποίησης κανόνα ενημερώνονται για να αντιστοιχίσετε το ανακτημένο βάση δεδομένων και σε διαφορετικό διακομιστή.

Για περισσότερες πληροφορίες σχετικά με τους κανόνες ειδοποίησης βάσης δεδομένων, ανατρέξτε στο θέμα [Λήψη ειδοποίησης ειδοποιήσεις](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) και [Παρακολούθηση εύρυθμης λειτουργίας υπηρεσιών](../monitoring-and-diagnostics/insights-service-health.md).

### <a name="enable-auditing"></a>Ενεργοποίηση του ελέγχου

Εάν απαιτείται έλεγχος πρόσβασης βάσης δεδομένων σας, πρέπει να ενεργοποιήσετε έλεγχος μετά από την ανάκτηση της βάσης δεδομένων. Μια καλή ένδειξη ότι απαιτείται έλεγχος είναι ότι εφαρμογές προγράμματος-πελάτη χρήση ασφαλούς σύνδεσης συμβολοσειρών σε ένα μοτίβο *. database.secure.windows.net. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Γρήγορα αποτελέσματα με τον έλεγχο βάσης δεδομένων SQL](sql-database-auditing-get-started.md).


## <a name="next-steps"></a>Επόμενα βήματα

- Για να μάθετε σχετικά με τη βάση δεδομένων SQL Azure αυτόματης δημιουργίας αντιγράφων ασφαλείας, ανατρέξτε στο θέμα [βάση δεδομένων SQL αυτόματης δημιουργίας αντιγράφων ασφαλείας](sql-database-automated-backups.md)
- Για να μάθετε σχετικά με τη σχεδίαση και αποκατάστασης σενάρια συνέχειας επιχειρήσεις, ανατρέξτε στο θέμα [σενάρια συνέχειας](sql-database-business-continuity.md)
- Για να μάθετε πώς να χρησιμοποιείτε την αυτόματη δημιουργία αντιγράφων ασφαλείας για την ανάκτηση, ανατρέξτε στο θέμα [Επαναφορά βάσης δεδομένων από τα αντίγραφα ασφαλείας που ξεκινούν από την υπηρεσία](sql-database-recovery-using-backups.md)

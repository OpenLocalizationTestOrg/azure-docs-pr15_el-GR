<properties
   pageTitle="Μοντέλο εφαρμογών υπηρεσίας ύφασμα | Microsoft Azure"
   description="Πώς μπορείτε να του μοντέλου και περιγράφουν εφαρμογές και υπηρεσίες σε ύφασμα υπηρεσίας."
   services="service-fabric"
   documentationCenter=".net"
   authors="rwike77"
   manager="timlt"
   editor="mani-ramaswamy"/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/10/2016"   
   ms.author="seanmck"/>

# <a name="model-an-application-in-service-fabric"></a>Μια εφαρμογή στην υπηρεσία ύφασμα του μοντέλου

Σε αυτό το άρθρο παρέχει μια επισκόπηση του μοντέλου εφαρμογή ύφασμα υπηρεσίας Azure. Περιγράφει επίσης πώς μπορείτε να ορίσετε μια εφαρμογή και υπηρεσία μέσω δήλωσης αρχεία και να λάβετε την εφαρμογή συσκευασμένη και είστε έτοιμοι για ανάπτυξη.

## <a name="understand-the-application-model"></a>Κατανόηση του μοντέλου εφαρμογής

Μια εφαρμογή είναι μια συλλογή απαρτίζουν των υπηρεσιών που εκτελούν μια συγκεκριμένη συνάρτηση ή συναρτήσεις. Μια υπηρεσία εκτελεί μια λειτουργία ολοκλήρωσης και μεμονωμένη (αυτό μπορεί να εκκινήσετε και να εκτελέσετε ανεξάρτητα από άλλες υπηρεσίες) και αποτελείται από κώδικα, ρύθμιση παραμέτρων και δεδομένων. Για κάθε υπηρεσία, κώδικας αποτελείται από το εκτελέσιμο δυαδικών αρχείων, ρύθμιση παραμέτρων αποτελείται από ρυθμίσεις υπηρεσίας που μπορεί να φορτωθεί κατά το χρόνο εκτέλεσης και δεδομένων αποτελείται από αυθαίρετο στατικά δεδομένα να καταναλωθεί από την υπηρεσία. Κάθε στοιχείο σε αυτό το μοντέλο ιεραρχική εφαρμογή μπορεί να είναι δημιουργία εκδόσεων και αναβαθμισμένη ανεξάρτητα.

![Το μοντέλο εφαρμογών υπηρεσίας ύφασμα][appmodel-diagram]


Ένας τύπος εφαρμογής είναι ένα κατηγοριοποίησης μιας εφαρμογής του και αποτελείται από μια δέσμη τύπους υπηρεσίας. Ένας τύπος υπηρεσίας είναι μια κατηγοριοποίησης μιας υπηρεσίας. Η κατηγοριοποίηση μπορούν να έχουν διαφορετικές ρυθμίσεις και ρυθμίσεις παραμέτρων, αλλά η βασική λειτουργικότητα παραμένει ίδια. Οι εμφανίσεις της υπηρεσίας είναι οι παραλλαγές διαφορετική υπηρεσία ρύθμισης παραμέτρων του ίδιου τύπου υπηρεσίας.  

Κλάσεις (ή "τύποι") εφαρμογών και υπηρεσιών περιγράφονται στα αρχεία XML (δηλώσεων εφαρμογών και υπηρεσιών δηλώσεων) που βρίσκονται τα πρότυπα βάσει των οποίων μπορεί να χρησιμοποιηθεί εφαρμογές από χώρο αποθήκευσης εικόνα του συμπλέγματος. Ο ορισμός σχήματος για το αρχείο ServiceManifest.xml και ApplicationManifest.xml έχει εγκατασταθεί με την υπηρεσία ύφασμα SDK και εργαλεία για να *C:\Program Files\Microsoft SDKs\Service Fabric\schemas\ServiceFabricServiceModel.xsd*.

Ο κώδικας για διαφορετική εφαρμογή παρουσίες θα εκτελεστεί ως ξεχωριστή διεργασίες, ακόμα και όταν φιλοξενείται από το ίδιο κόμβο ύφασμα υπηρεσίας. Επιπλέον, μπορείτε να διαχειριστείτε (δηλαδή τον κύκλο ζωής των κάθε παρουσία της εφαρμογής αναβάθμιση) ανεξάρτητα. Το παρακάτω διάγραμμα παρουσιάζει πώς οι τύποι εφαρμογών αποτελούνται από τύποι υπηρεσίας, η οποία με τη σειρά αποτελούνται από κώδικα, ρύθμιση παραμέτρων και πακέτα. Για να απλοποιήσετε το διάγραμμα, μόνο τα κώδικα/config/δεδομένα πακέτων για `ServiceType4` εμφανίζονται, αν και κάθε τύπος υπηρεσίας συμπεριλαμβάνει ορισμένα ή όλα από αυτά συσκευασία τους τύπους.

![Τύποι εφαρμογών υπηρεσίας ύφασμα και τύπους υπηρεσίας][cluster-imagestore-apptypes]

Δύο διαφορετικά δήλωσης αρχεία που χρησιμοποιούνται για να περιγράψετε εφαρμογών και υπηρεσιών: η υπηρεσία δηλωτικό και η δήλωση εφαρμογής. Καλύπτονται με λεπτομέρειες του επόμενου ενοτήτων.

Μπορεί να υπάρχουν μία ή περισσότερες παρουσίες ενός τύπου υπηρεσιών active στο σύμπλεγμα. Για παράδειγμα, παρουσίες κατάστασης υπηρεσίας ή αντίγραφα, επιτύχετε υψηλή αξιοπιστία κατά την αναπαραγωγή κατάσταση ανάμεσα σε αντίγραφα βρίσκεται σε διαφορετικό κόμβους του συμπλέγματος. Αυτή η αναπαραγωγή παρέχει ουσιαστικά πλεονασμού για την υπηρεσία να είναι διαθέσιμη ακόμα και αν αποτύχει έναν κόμβο σε ένα σύμπλεγμα. [Διαμερίσματα υπηρεσίας](service-fabric-concepts-partitioning.md) περαιτέρω κατανέμει την κατάσταση (και μοτίβα πρόσβαση σε αυτήν την κατάσταση) σε κόμβους του συμπλέγματος.

Το παρακάτω διάγραμμα παρουσιάζει τη σχέση μεταξύ των εφαρμογών και παρουσιών της υπηρεσίας, τα διαμερίσματα και αντίγραφα.

![Τα διαμερίσματα και αντίγραφα μέσα σε μια υπηρεσία][cluster-application-instances]


>[AZURE.TIP] Μπορείτε να προβάλετε τη διάταξη των εφαρμογών σε ένα σύμπλεγμα χρησιμοποιώντας το εργαλείο Explorer ύφασμα υπηρεσία διαθέσιμη στο http://&lt;yourclusteraddress&gt;: 19080/Explorer. Για περισσότερες λεπτομέρειες, ανατρέξτε στο θέμα [απεικόνιση το σύμπλεγμά σας με την υπηρεσία ύφασμα Εξερεύνηση](service-fabric-visualizing-your-cluster.md).

## <a name="describe-a-service"></a>Περιγραφή υπηρεσίας

Το δηλωτικό υπηρεσίας δηλωτικά καθορίζει τον τύπο υπηρεσίας και την έκδοση. Καθορίζει υπηρεσίας μετα-δεδομένων όπως τύπος υπηρεσίας, ιδιότητες εύρυθμης λειτουργίας, μετρικά εξισορρόπησης φόρτου, υπηρεσία δυαδικά δεδομένα και αρχεία ρύθμισης παραμέτρων.  Με άλλα λόγια, περιγράφει τα πακέτα κώδικα, ρύθμιση παραμέτρων και δεδομένων που συνθέτουν ένα πακέτο υπηρεσία για την υποστήριξη έναν ή περισσότερους τύπους υπηρεσίας. Ακολουθεί ένα απλό παράδειγμα δηλωτικό υπηρεσίας:

~~~
<?xml version="1.0" encoding="utf-8" ?>
<ServiceManifest Name="MyServiceManifest" Version="SvcManifestVersion1" xmlns="http://schemas.microsoft.com/2011/01/fabric" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Description>An example service manifest</Description>
  <ServiceTypes>
    <StatelessServiceType ServiceTypeName="MyServiceType" />
  </ServiceTypes>
  <CodePackage Name="MyCode" Version="CodeVersion1">
    <SetupEntryPoint>
      <ExeHost>
        <Program>MySetup.bat</Program>
      </ExeHost>
    </SetupEntryPoint>
    <EntryPoint>
      <ExeHost>
        <Program>MyServiceHost.exe</Program>
      </ExeHost>
    </EntryPoint>
  </CodePackage>
  <ConfigPackage Name="MyConfig" Version="ConfigVersion1" />
  <DataPackage Name="MyData" Version="DataVersion1" />
</ServiceManifest>
~~~

**Έκδοση** συμβολοσειρές μη δομημένα και τα χαρακτηριστικά δεν ανάλυση από το σύστημα. Αυτές είναι χρησιμοποιούνται για αναβαθμίσεις έκδοση κάθε στοιχείο.

**ServiceTypes** δηλώνει τους τύπους υπηρεσίας που υποστηρίζονται από **CodePackages** στη δήλωση. Όταν μια υπηρεσία έχει δημιουργηθεί σε σχέση με έναν από αυτούς τους τύπους υπηρεσίας, όλα τα πακέτα κώδικα που έχουν δηλωθεί στη δήλωση είναι ενεργοποιημένες, εκτελώντας τα σημεία εισόδου. Αναμένεται τις διαδικασίες που προκύπτει για την καταχώρηση των τύπων υποστηριζόμενη υπηρεσία κατά το χρόνο εκτέλεσης. Σημειώστε ότι τύπους υπηρεσίας δηλώνονται στο επίπεδο δήλωσης και όχι το επίπεδο πακέτου κωδικού. Επομένως, όταν υπάρχουν πολλά πακέτα κώδικα, όλα ενεργοποιούνται κάθε φορά που έχει το σύστημα για οποιονδήποτε από τους τύπους δήλωση υπηρεσίας.

**SetupEntryPoint** είναι ένα σημείο εισόδου Προνομιούχους που εκτελείται με τα ίδια διαπιστευτήρια ως υπηρεσία ύφασμα (συνήθως το λογαριασμό του *τοπικού συστήματος* ) πριν από οποιοδήποτε άλλο σημείο εισόδου. Το εκτελέσιμο αρχείο που καθορίζεται από **EntryPoint** συνήθως είναι ο κεντρικός υπολογιστής υπηρεσίας μεγάλη διάρκεια εκτέλεσης. Η παρουσία ενός σημείου καταχώρησης ξεχωριστή εγκατάσταση αποκλείει χρειάζεται να εκτελέσετε τον κεντρικό υπολογιστή υπηρεσίας με υψηλή δικαιώματα για το εκτεταμένο χρονικά διαστήματα. Το εκτελέσιμο αρχείο που καθορίζεται από **EntryPoint** εκτελείται μετά την έξοδο **SetupEntryPoint** με επιτυχία. Η διαδικασία που προκύπτει είναι παρακολουθούνται και επανεκκίνηση του (που αρχίζει ξανά με **SetupEntryPoint**) Εάν ποτέ καταγγελία ή προκαλεί σφάλμα.

**DataPackage** δηλώνει ένα φάκελο, με το όνομα από το χαρακτηριστικό **όνομα** , που περιέχει αυθαίρετο στατική δεδομένα για να χρησιμοποιηθεί από τη διαδικασία κατά το χρόνο εκτέλεσης.

**ConfigPackage** δηλώνει ένα φάκελο, με το όνομα από το χαρακτηριστικό **όνομα** , που περιέχει ένα αρχείο *Settings.xml* . Αυτό το αρχείο περιέχει ενότητες που ορίζονται από το χρήστη, η τιμή του αριθμού-κλειδιού ζεύγος ρυθμίσεις που μπορούν να διαβάσουν τη διαδικασία πίσω κατά το χρόνο εκτέλεσης. Κατά την αναβάθμιση, εάν μόνο την **ConfigPackage** **έκδοση** έχει αλλάξει, στη συνέχεια, η διαδικασία εκτελείται δεν γίνεται επανεκκίνηση. Αντί για αυτό, Επιστροφή κλήσης ειδοποιεί τη διαδικασία που έχουν αλλάξει ρυθμίσεις παραμέτρων, ώστε να τους μπορεί να είναι η νέα φόρτωση δυναμικά. Ακολουθεί ένα παράδειγμα αρχείου *Settings.xml* :

~~~
<Settings xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/2011/01/fabric">
  <Section Name="MyConfigurationSecion">
    <Parameter Name="MySettingA" Value="Example1" />
    <Parameter Name="MySettingB" Value="Example2" />
  </Section>
</Settings>
~~~

> [AZURE.NOTE] Η δήλωση υπηρεσίας μπορεί να περιέχει πολλές κωδικός ρύθμισης παραμέτρων και πακέτα δεδομένων. Κάθε μία από αυτές μπορεί να είναι έκδοση ανεξάρτητα.

<!--
For more information about other features supported by service manifests, refer to the following articles:

*TODO: LoadMetrics, PlacementConstraints, ServicePlacementPolicies
*TODO: Resources
*TODO: Health properties
*TODO: Trace filters
*TODO: Configuration overrides
-->

## <a name="describe-an-application"></a>Περιγράψτε μια εφαρμογή


Η δήλωση εφαρμογής δηλωτικά περιγράφει τον τύπο εφαρμογής και την έκδοση. Καθορίζει υπηρεσίας σύνθεσης μετα-δεδομένων όπως σταθερό ονόματα, διαμερισμάτων συνδυασμού, παραγόντων count/αναπαραγωγής παρουσία, πολιτική ασφαλείας/απομόνωσης, θέση τους περιορισμούς, αυτή αντικαθιστά τη ρύθμιση παραμέτρων και τύπους απαρτίζουν υπηρεσίας. Οι τομείς εξισορρόπησης φόρτου στο οποίο έχει τοποθετηθεί η εφαρμογή περιγράφονται επίσης.

Έτσι, δήλωση εφαρμογής περιγράφει στοιχεία σε επίπεδο εφαρμογής και αναφέρεται σε μία ή περισσότερες δηλώσεων υπηρεσίας για να συντάξετε έναν τύπο εφαρμογής. Ακολουθεί ένα απλό παράδειγμα δήλωση εφαρμογής:

~~~
<?xml version="1.0" encoding="utf-8" ?>
<ApplicationManifest
      ApplicationTypeName="MyApplicationType"
      ApplicationTypeVersion="AppManifestVersion1"
      xmlns="http://schemas.microsoft.com/2011/01/fabric"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Description>An example application manifest</Description>
  <ServiceManifestImport>
    <ServiceManifestRef ServiceManifestName="MyServiceManifest" ServiceManifestVersion="SvcManifestVersion1"/>
  </ServiceManifestImport>
  <DefaultServices>
     <Service Name="MyService">
         <StatelessService ServiceTypeName="MyServiceType" InstanceCount="1">
             <SingletonPartition/>
         </StatelessService>
     </Service>
  </DefaultServices>
</ApplicationManifest>
~~~

Όπως και δηλώσεων υπηρεσίας, **έκδοση** χαρακτηριστικά είναι συμβολοσειρές μη δομημένα και δεν αναλύονται από το σύστημα. Αυτές είναι επίσης χρησιμοποιούνται για αναβαθμίσεις έκδοση κάθε στοιχείο.

**ServiceManifestImport** περιέχει αναφορές σε υπηρεσία δηλώσεων που συνθέτουν αυτόν τον τύπο εφαρμογής. Υπηρεσία που έχει εισαχθεί δηλώσεων καθορίζουν ποιοι τύποι υπηρεσίας είναι έγκυρες μέσα σε αυτόν τον τύπο εφαρμογής.

**DefaultServices** δηλώνει παρουσιών της υπηρεσίας που δημιουργούνται αυτόματα κάθε φορά που έχει δημιουργηθεί μια εφαρμογή του σε σχέση με αυτόν τον τύπο εφαρμογής. Προεπιλεγμένες υπηρεσίες είναι απλώς μια ευκολία και συμπεριφέρεται σαν κανονικό υπηρεσίες κάθε άποψη αφού έχουν δημιουργηθεί. Μπορούν να έχουν αναβαθμιστεί μαζί με άλλες υπηρεσίες σε την παρουσία της εφαρμογής και να μπορεί να καταργηθεί επίσης.

> [AZURE.NOTE] Δήλωση εφαρμογής μπορεί να περιέχει πολλές υπηρεσία δήλωσης εισαγωγές και προεπιλεγμένες υπηρεσίες. Κάθε υπηρεσία δήλωσης εισαγωγής μπορεί να είναι ανεξάρτητα έκδοση.

Για να μάθετε πώς μπορείτε να διατηρήσετε διαφορετική εφαρμογή και για μεμονωμένα περιβάλλοντα των παραμέτρων της υπηρεσίας, ανατρέξτε στο θέμα [Διαχείριση οι παράμετροι της εφαρμογής για πολλά περιβάλλοντα](service-fabric-manage-multiple-environment-app-configuration.md).

<!--
For more information about other features supported by application manifests, refer to the following articles:

*TODO: Application parameters
*TODO: Security, Principals, RunAs, SecurityAccessPolicy
*TODO: Service Templates
-->

## <a name="package-an-application"></a>Πακέτο μιας εφαρμογής

### <a name="package-layout"></a>Διάταξη πακέτου

Η δήλωση εφαρμογής, υπηρεσία manifest(s) και άλλα αρχεία πακέτου είναι απαραίτητο πρέπει να είναι οργανωμένες σε μια συγκεκριμένη διάταξη για ανάπτυξη σε ένα σύμπλεγμα ύφασμα υπηρεσίας. Το παράδειγμα δηλώσεων σε αυτό το άρθρο θα πρέπει να είναι οργανωμένο με την ακόλουθη δομή καταλόγου:

~~~
PS D:\temp> tree /f .\MyApplicationType

D:\TEMP\MYAPPLICATIONTYPE
│   ApplicationManifest.xml
│
└───MyServiceManifest
    │   ServiceManifest.xml
    │
    ├───MyCode
    │       MyServiceHost.exe
    │
    ├───MyConfig
    │       Settings.xml
    │
    └───MyData
            init.dat
~~~

Οι φάκελοι είναι καθορισμένοι ώστε να ταιριάζει με τα χαρακτηριστικά **όνομα** κάθε στοιχείου αντίστοιχα. Για παράδειγμα, εάν το δηλωτικό υπηρεσίας περιείχε δύο πακέτων κώδικα με τα ονόματα **MyCodeA** και **MyCodeB**, στη συνέχεια, δύο φάκελοι με τα ίδια ονόματα θα περιέχουν τα απαραίτητα δυαδικών αρχείων για κάθε πακέτο κώδικα.

### <a name="use-setupentrypoint"></a>Χρήση SetupEntryPoint

Τυπικά σενάρια για τη χρήση **SetupEntryPoint** είναι όταν πρέπει να εκτελέσετε ένα εκτελέσιμο αρχείο για να ξεκινήσει η υπηρεσία ή πρέπει να εκτελέσετε μια λειτουργία με αναβαθμισμένα δικαιώματα. Για παράδειγμα:

- Ρύθμιση και την προετοιμασία μεταβλητές περιβάλλοντος που χρειάζεται το εκτελέσιμο αρχείο υπηρεσίας. Αυτό δεν περιορίζονται μόνο εκτελέσιμα γραμμένο μέσω των μοντέλων προγραμματισμού ύφασμα υπηρεσίας. Για παράδειγμα, npm.exe ανάγκες ορισμένες μεταβλητές περιβάλλοντος που έχει ρυθμιστεί για την ανάπτυξη μιας εφαρμογής node.js.

- Ρύθμιση ελέγχου πρόσβασης μέσω της εγκατάστασης πιστοποιητικών ασφαλείας.

### <a name="build-a-package-by-using-visual-studio"></a>Δημιουργία ενός πακέτου με τη χρήση του Visual Studio

Εάν χρησιμοποιείτε το Visual Studio 2015 για να δημιουργήσετε την εφαρμογή σας, μπορείτε να χρησιμοποιήσετε την εντολή πακέτου για να δημιουργήσετε αυτόματα ένα πακέτο που να ταιριάζει με τη διάταξη που περιγράφονται παραπάνω.

Για να δημιουργήσετε ένα πακέτο, κάντε δεξί κλικ το έργο εφαρμογής στην Εξερεύνηση λύσεων και επιλέξτε την εντολή πακέτου, όπως φαίνεται παρακάτω:

![Συσκευασία μιας εφαρμογής με το Visual Studio][vs-package-command]

Μόλις ολοκληρωθεί η συσκευασία, θα βρείτε τη θέση του πακέτου στο παράθυρο **εξόδου** . Σημειώστε ότι το βήμα συσκευασία γίνεται αυτόματα κατά την ανάπτυξη ή σφαλμάτων την εφαρμογή στο Visual Studio.

### <a name="test-the-package"></a>Ελέγξτε το πακέτο

Μπορείτε να επαληθεύσετε τη δομή του πακέτου τοπικά μέσω του PowerShell, χρησιμοποιώντας την εντολή **ServiceFabricApplicationPackage δοκιμής** . Αυτή η εντολή θα Ελέγξτε για δηλωτικό ανάλυση θέματα και επαληθεύστε όλες τις αναφορές. Σημειώστε ότι αυτή η εντολή επαληθεύει μόνο τα δομικά ακρίβειας των τους καταλόγους και τα αρχεία στο πακέτο. Δεν επαληθεύει οποιοδήποτε από τα περιεχόμενα του πακέτου κώδικα ή δεδομένα πέρα από τον έλεγχο ότι υπάρχουν όλα τα απαραίτητα αρχεία.

~~~
PS D:\temp> Test-ServiceFabricApplicationPackage .\MyApplicationType
False
Test-ServiceFabricApplicationPackage : The EntryPoint MySetup.bat is not found.
FileName: C:\Users\servicefabric\AppData\Local\Temp\TestApplicationPackage_7195781181\nrri205a.e2h\MyApplicationType\MyServiceManifest\ServiceManifest.xml
~~~

Αυτό το σφάλμα δείχνει ότι το αρχείο *MySetup.bat* στα οποία γίνεται αναφορά στο δηλωτικό υπηρεσίας **SetupEntryPoint** λείπει από το πακέτο κώδικα. Μόλις προστεθεί το αρχείο που λείπει, μεταβιβάζει τον έλεγχο της εφαρμογής:

~~~
PS D:\temp> tree /f .\MyApplicationType

D:\TEMP\MYAPPLICATIONTYPE
│   ApplicationManifest.xml
│
└───MyServiceManifest
    │   ServiceManifest.xml
    │
    ├───MyCode
    │       MyServiceHost.exe
    │       MySetup.bat
    │
    ├───MyConfig
    │       Settings.xml
    │
    └───MyData
            init.dat

PS D:\temp> Test-ServiceFabricApplicationPackage .\MyApplicationType
True
PS D:\temp>
~~~

Όταν η εφαρμογή είναι συσκευασμένο σωστά και μεταβιβάζει επαλήθευσης, στη συνέχεια, είναι έτοιμο για ανάπτυξη.

## <a name="next-steps"></a>Επόμενα βήματα

[Ανάπτυξη και κατάργηση εφαρμογών][10]

[Διαχείριση οι παράμετροι της εφαρμογής για πολλά περιβάλλοντα][11]

[RunAs: Εκτέλεση μιας εφαρμογής υπηρεσίας υφάσματος με δικαιώματα διαφορετικό ασφαλείας][12]

<!--Image references-->
[appmodel-diagram]: ./media/service-fabric-application-model/application-model.png
[cluster-imagestore-apptypes]: ./media/service-fabric-application-model/cluster-imagestore-apptypes.png
[cluster-application-instances]: media/service-fabric-application-model/cluster-application-instances.png
[vs-package-command]: ./media/service-fabric-application-model/vs-package-command.png

<!--Link references--In actual articles, you only need a single period before the slash-->
[10]: service-fabric-deploy-remove-applications.md
[11]: service-fabric-manage-multiple-environment-app-configuration.md
[12]: service-fabric-application-runas-security.md

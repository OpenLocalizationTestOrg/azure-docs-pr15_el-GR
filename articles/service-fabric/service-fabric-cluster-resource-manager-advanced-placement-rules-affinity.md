<properties
   pageTitle="Υπηρεσία ύφασμα σύμπλεγμα από διαχειριστή πόρων - συσχέτισης | Microsoft Azure"
   description="Επισκόπηση της ρύθμισης παραμέτρων συσχέτισης για υπηρεσίες δομής υπηρεσίας"
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/19/2016"
   ms.author="masnider"/>

# <a name="configuring-and-using-service-affinity-in-service-fabric"></a>Ρύθμιση παραμέτρων και χρήση υπηρεσίας συσχέτισης σε ύφασμα υπηρεσίας

Συσχέτισης είναι ένα στοιχείο ελέγχου που παρέχεται κυρίως για να διευκολύνουν τη μετάβαση με μεγαλύτερη μονολιθικό εφαρμογές στον κόσμο του cloud και microservices. Με την ευκαιρία μπορεί επίσης να χρησιμοποιηθεί σε ορισμένες περιπτώσεις ως μια νόμιμη βελτιστοποίηση για τη βελτίωση της απόδοσης των υπηρεσιών, αν αυτό μπορεί να έχουν επιπτώσεις.

Ας υποθέσουμε ότι μπορείτε να μεταφέρετε μια εφαρμογή για μεγαλύτερο ή ένα αρχείο που μόλις δεν έχει σχεδιαστεί με microservices υπόψη ύφασμα υπηρεσίας. Αυτό Μετάβαση είναι στην πραγματικότητα κοινές και θα σας είχατε πολλούς πελάτες (εσωτερικές και εξωτερικές) σε αυτήν την περίπτωση. Ξεκινάτε με ανύψωσης προς τα επάνω στην εφαρμογή ολόκληρο στο περιβάλλον, γρήγορα το συσκευαστούν και εκτέλεση. Στη συνέχεια, μπορείτε να ξεκινήσετε διακοπή προς τα κάτω σε διαφορετικές μικρότερο υπηρεσίες ότι όλα επικοινωνούν μεταξύ τους.

Στη συνέχεια, υπάρχει μια "Oops...". Το "Oops" εμπίπτει συνήθως σε μία από αυτές τις κατηγορίες:

1. Κάποιο στοιχείο X στην εφαρμογή μονολιθικό είχατε μια τεκμηριωμένη εξάρτηση στο στοιχείο Y και θα σας μόλις ενεργοποιηθεί αυτές σε ξεχωριστό υπηρεσίες. Εφόσον αυτά τώρα εκτελούνται σε διαφορετικές κόμβους του συμπλέγματος, να είναι κατεστραμμένο.
2.  Αυτές οι ενέργειες που μπορείτε να επικοινωνείτε μέσω (τοπική με το όνομα δίαυλοι | θέσει σε κοινή χρήση μνήμης | αρχεία στο δίσκο) αλλά πραγματικά πρέπει να είναι σε θέση να ενημερώσετε ανεξάρτητη να επιταχύνετε λίγο. Θα μπορώ να καταργήσω τη σκληρή εξάρτηση αργότερα.
3.  Όλα τα στοιχεία είναι εντάξει, αλλά προκύψει ότι αυτά τα δύο στοιχεία είναι πραγματικά πολύ chatty/επιδόσεων διάκριση πεζών-κεφαλαίων. Όταν τότε μεταφερθεί σε ξεχωριστή υπηρεσίες συνολική απόδοση εφαρμογή tanked ή λανθάνων χρόνος αυξάνεται. Ως αποτέλεσμα, η συνολική εφαρμογή είναι δεν πληροί τις προσδοκίες.

Σε αυτές τις περιπτώσεις θα σας δεν θέλετε να χάσετε μας επανασχεδιασμού προγράμματος εργασίας και δεν θέλετε να επιστρέψετε το μονολιθικός όγκος, αλλά χρειαζόμαστε λογικό της τοποθεσίας. Αυτό θα εξακολουθούν να εμφανίζονται είτε μέχρι να μας να σχεδιάσετε εκ νέου τα στοιχεία ώστε να λειτουργεί ομαλά ως υπηρεσίες ή μέχρι θα σας μπορεί να επιλύσει τις προσδοκίες επιδόσεων άλλο τρόπο, εάν είναι δυνατό.

Τι να κάνω; Επίσης και μπορείτε να δοκιμάσετε Ενεργοποίηση συνάφεια.

## <a name="how-to-configure-affinity"></a>Πώς μπορείτε να ρυθμίσετε τις παραμέτρους συσχέτισης
Για να ρυθμίσετε συσχέτισης, μπορείτε να ορίσετε μια σχέση συσχέτισης μεταξύ δύο διαφορετικές υπηρεσίες. Μπορείτε να θεωρήσετε συσχέτισης ως "που δείχνει" υπηρεσία ένα στο άλλο και τι λένε "Αυτή η υπηρεσία μπορεί να εκτελεστεί μόνο όπου ότι εκτελείται η υπηρεσία." Μερικές φορές αναφέρουμε συσχέτισης ως μια σχέση γονικού/θυγατρικού στοιχείου (σημείο όπου τοποθετείτε το δείκτη το θυγατρικό στο γονικό). Συνάφεια εξασφαλίζει ότι τα αντίγραφα ή παρουσίες μιας υπηρεσίας τοποθετούνται σε το ίδιο κόμβους ως αντίγραφα ή παρουσίες μιας άλλης.

``` csharp
ServiceCorrelationDescription affinityDescription = new ServiceCorrelationDescription();
affinityDescription.Scheme = ServiceCorrelationScheme.Affinity;
affinityDescription.ServiceName = new Uri("fabric:/otherApplication/parentService");
serviceDescription.Correlations.Add(affinityDescription);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

## <a name="different-affinity-options"></a>Επιλογές διαφορετικό συσχέτισης
Συνάφεια αντιπροσωπεύεται μέσω μία από διάφορους συνδυασμούς συσχέτισης και έχει δύο διαφορετικές καταστάσεις. Τα πιο συνηθισμένα λειτουργία του συσχέτισης είναι ονομάζουμε NonAlignedAffinity. Στο NonAlignedAffinity τα αντίγραφα ή παρουσίες από τις διαφορετικές υπηρεσίες τοποθετούνται στο ίδιο κόμβους. Η κατάσταση λειτουργίας είναι AlignedAffinity. Στοιχισμένα συσχέτισης είναι χρήσιμο μόνο με τις υπηρεσίες με κατάσταση. Ρύθμιση παραμέτρων δύο υπηρεσίες κατάστασης ώστε να έχουν στοίχιση συσχέτισης εξασφαλίζει ότι τα βασικά χρώματα από αυτές τις υπηρεσίες τοποθετούνται στο ίδιο κόμβους ως μεταξύ τους. Προκαλεί επίσης κάθε ζεύγος secondaries για να τοποθετηθεί στην ίδια κόμβους αυτές τις υπηρεσίες. Είναι επίσης πιθανό (αν και λιγότερο κοινό) για τη ρύθμιση παραμέτρων NonAlignedAffinity για τις υπηρεσίες με κατάσταση. Για NonAlignedAffinity θα είναι collocated τα διαφορετικά αντίγραφα από τις δύο υπηρεσίες κατάστασης στην ίδια κόμβους, αλλά δεν θα γίνει προσπάθεια στοίχιση βασικά χρώματα ή secondaries τους.

![Λειτουργίες συσχέτισης και τα αποτελέσματά τους][Image1]

### <a name="best-effort-desired-state"></a>Βέλτιστη προσπάθειας επιθυμητοί κατάσταση
Υπάρχουν μερικές διαφορές μεταξύ συσχέτισης και αρχιτεκτονικές μονολιθικό. Πολλά από τα οποία είναι επειδή μια σχέση συσχέτισης είναι καλύτερη προσπάθεια. Οι υπηρεσίες σε μια σχέση συσχέτισης είναι διαφέρουν ουσιαστικά οντοτήτων που μπορεί να αποτύχει και να μετακινηθούν ξεχωριστά. Υπάρχουν επίσης αιτίες για γιατί μπορεί να διακόψετε μια σχέση συνάφεια. Για παράδειγμα, χωρητικότητα περιορισμοί όπου μόνο ορισμένα από τα αντικείμενα της υπηρεσίας στη σχέση συσχέτισης μπορεί να χωρέσει σε έναν δεδομένο κόμβο. Σε αυτές τις περιπτώσεις ακόμα και όταν υπάρχει μια σχέση συσχέτισης του, αυτό δεν είναι δυνατό να επιβληθούν λόγω τους άλλους περιορισμούς. Εάν είναι δυνατή η επιβολή όλες τις άλλες τους περιορισμούς και συσχέτισης αργότερα η παραβίαση του περιορισμού συσχέτισης θα διορθωθεί αυτόματα.  

### <a name="chains-vs-stars"></a>Αλυσίδα έναντι αστέρια
Σήμερα που δεν μπορούμε να αλυσίδα μοντέλο συσχέτισης σχέσεων. Τι σημαίνει αυτό που είναι μια υπηρεσία που είναι ένα θυγατρικό σε μία σχέση συσχέτισης δεν μπορεί να είναι ένα γονικό στοιχείο σε μια άλλη σχέση συνάφεια. Εάν θέλετε να του μοντέλου αυτόν τον τύπο της σχέσης, έχετε αποτελεσματικά το μοντέλο ως ένα αστέρι και όχι μια αλυσίδα. Για να το κάνετε αυτό, το παιδί κατώτερου θα είναι γονικό του γονικού του παιδιού "Μεσαίο" αντί για αυτό. Ανάλογα με τη διάταξη των υπηρεσιών σας, αυτό μπορεί να απαιτεί τη δημιουργία μιας υπηρεσίας "σύμβολο κράτησης θέσης" θα χρησιμοποιηθεί ως το γονικό στοιχείο για πολλές θυγατρικά στοιχεία.

![Αλυσίδα έναντι αστέρια στο περιβάλλον της συσχέτισης σχέσεις][Image2]

Κάτι άλλο για να λάβετε υπόψη σχετικά με τις σχέσεις συσχέτισης σήμερα είναι ότι έχουν Οδικός. Αυτό σημαίνει ότι ο κανόνας "Συσχέτιση" μόνο επιβάλλει το παιδί έχει πού βρίσκεται το γονικό στοιχείο. Εάν για παράδειγμα το γονικό στοιχείο ξαφνικά αποτυγχάνει επάνω σε έναν άλλο κόμβο, στη συνέχεια, η διαχείριση πόρων συμπλέγματος δεν στην πραγματικότητα πιστεύετε ότι υπάρχει κάποιο σφάλμα μέχρι το κοινοποιήσεις ότι το παιδί δεν βρίσκονται με ένα γονικό στοιχείο; η σχέση δεν θα εφαρμοστεί αμέσως.

### <a name="partitioning-support"></a>Υποστήριξη του διαμερισμού
Το τελικό που πρέπει να παρατηρήσετε σχετικά με συσχέτισης είναι που συσχέτισης σχέσεις δεν υποστηρίζονται όπου έχει διαμερίσματα το γονικό στοιχείο. Αυτό είναι κάτι που μπορεί να υποστηρίζουμε τελικά, αλλά σήμερα δεν επιτρέπεται.

## <a name="next-steps"></a>Επόμενα βήματα
- Για περισσότερες πληροφορίες σχετικά με τις άλλες διαθέσιμες επιλογές για τη ρύθμιση των παραμέτρων των υπηρεσιών ελέγχου εκτός του θέματος στην τις άλλες ρυθμίσεις παραμέτρων για τη διαχείριση πόρων συμπλέγματος διαθέσιμο, [Μάθετε περισσότερα σχετικά με τη ρύθμιση παραμέτρων υπηρεσιών](service-fabric-cluster-resource-manager-configure-services.md)
- Πολλοί λόγοι για τους οποίους χρησιμοποιείται συσχέτισης, όπως τον περιορισμό υπηρεσίες σε μια μικρή συνόλου μηχανές και προσπαθείτε να συγκεντρώσετε η φόρτωση από μια συλλογή από υπηρεσίες, υποστηρίζονται καλύτερα στις ομάδες εφαρμογών. Ανατρέξτε στο θέμα [Ομάδες εφαρμογών](service-fabric-cluster-resource-manager-application-groups.md)

[Image1]:./media/service-fabric-cluster-resource-manager-advanced-placement-rules-affinity/cluster-resrouce-manager-affinity-modes.png
[Image2]:./media/service-fabric-cluster-resource-manager-advanced-placement-rules-affinity/cluster-resource-manager-chains-vs-stars.png

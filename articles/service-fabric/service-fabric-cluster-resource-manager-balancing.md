<properties
   pageTitle="Εξισορρόπηση το σύμπλεγμά σας με το Azure Service ύφασμα σύμπλεγμα διαχείριση πόρων | Microsoft Azure"
   description="Εισαγωγή στη εξισορρόπηση το σύμπλεγμά σας με την υπηρεσία ύφασμα σύμπλεγμα διαχείριση πόρων."
   services="service-fabric"
   documentationCenter=".net"
   authors="masnider"
   manager="timlt"
   editor=""/>

<tags
   ms.service="Service-Fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="08/19/2016"
   ms.author="masnider"/>

# <a name="balancing-your-service-fabric-cluster"></a>Εξισορρόπηση συμπλέγματος ύφασμα υπηρεσίας
Διαχείριση πόρων της υπηρεσίας ύφασμα σύμπλεγμα επιτρέπει αναφοράς δυναμικό φορτίο, αντιδρούν αλλαγές στο σύμπλεγμα, κατά τη διόρθωση παραβιάσεις των περιορισμών και εξισορρόπηση του συμπλέγματος, εάν είναι απαραίτητο. Αλλά πόσο συχνά κάνει αυτών των στοιχείων και τι ενεργοποιεί; Υπάρχουν πολλά στοιχεία ελέγχου που σχετίζονται με αυτό.

Το πρώτο σύνολο των στοιχείων ελέγχου γύρω από εξισορρόπηση είναι ένα σύνολο χρονιστές. Αυτές οι χρονιστές διέπουν τη συχνότητα της διαχείρισης πόρων συμπλέγματος εξετάζει την κατάσταση του συμπλέγματος για πράγματα που πρέπει να εκτελούνται. Υπάρχουν τρεις διαφορετικές κατηγορίες εργασίας, κάθε μία με τις δικές τους αντίστοιχο χρονόμετρο. Είναι οι εξής:

1.  Τοποθέτηση – αυτό το στάδιο ασχολείται με τοποθετώντας οποιαδήποτε κατάστασης αντίγραφα ή χωρίς κατάσταση παρουσίες που λείπουν. Αυτό καλύπτει νέων υπηρεσιών και χειρισμός κατάστασης αντίγραφα ή χωρίς κατάσταση παρουσίες που έχουν αποτύχει και πρέπει να τις δημιουργήσετε ξανά. Διαγραφή και απόθεση αντίγραφα ή παρουσίες γίνεται επίσης εδώ.
2.  Περιορισμός ελέγχει – αυτό το στάδιο ελέγχει για και διορθώνουν παραβιάσεις τους περιορισμούς διαφορετική θέση (κανόνες) εντός του συστήματος. Παραδείγματα κανόνων είναι στοιχεία, όπως εξασφαλίζει ότι δεν είναι κόμβοι μέσω χωρητικότητα και ότι πληρούνται περιορισμούς θέση μιας υπηρεσίας (περισσότερες πληροφορίες σχετικά με αυτές τις νεότερες εκδόσεις).
3.  Εξισορρόπηση – αυτό το στάδιο ελέγχει για να δείτε εάν το έγκαιρη εξισορρόπηση είναι απαραίτητο βάσει ρυθμισμένο επιθυμητό επίπεδο υπολοίπου για διαφορετικά μεγέθη μέτρησης και, συνεπώς θα επιχειρήσει να βρει τακτοποίησης στο σύμπλεγμα που είναι πιο εξισορρόπηση.

## <a name="configuring-cluster-resource-manager-steps-and-timers"></a>Ρύθμιση παραμέτρων διαχείρισης πόρων συμπλέγματος βήματα και χρονιστές
Κάθε μία από αυτές τις διαφορετικούς τύπους διορθώσεις μπορεί να κάνει η διαχείριση πόρων συμπλέγματος ελέγχεται από ένα διαφορετικό χρονόμετρο που καθορίζει τη συχνότητα. Επομένως, για παράδειγμα, εάν θέλετε μόνο να ασχοληθείτε με τοποθετώντας νέα υπηρεσία φόρτους εργασίας του συμπλέγματος κάθε ώρα (για μαζική τους προς τα επάνω), αλλά θέλετε κανονική εξισορρόπηση ελέγχει κάθε μερικά δευτερόλεπτα, μπορείτε να ρυθμίσετε αυτή τη συμπεριφορά. Όταν ενεργοποιείται κάθε χρονομέτρησης, η εργασία είναι προγραμματισμένη. Από προεπιλογή, η διαχείριση πόρων σαρώνει στην κατάσταση και εφαρμόζει ενημερώσεις (δέσμης για όλες τις αλλαγές που έγιναν μετά την τελευταία σάρωση, όπως παρατηρώντας που είναι ένας κόμβος προς τα κάτω) κάθε 1/δέκατο του δευτερολέπτου, σύνολα την τοποθέτηση και περιορισμού Ελέγξτε σημαίες ανά δευτερόλεπτο και την εξισορρόπηση σημαία κάθε 5 δευτερόλεπτα.

ClusterManifest.xml:

``` xml
        <Section Name="PlacementAndLoadBalancing">
            <Parameter Name="PLBRefreshGap" Value="0.1" />
            <Parameter Name="MinPlacementInterval" Value="1.0" />
            <Parameter Name="MinConstraintCheckInterval" Value="1.0" />
            <Parameter Name="MinLoadBalancingInterval" Value="5.0" />
        </Section>
```

Σήμερα μόνο πραγματοποιούμε μία από αυτές τις ενέργειες κάθε φορά, διαδοχικά (λόγο αναφέρονται αυτές τις ρυθμίσεις παραμέτρων ως "ελάχιστη χρονικά διαστήματα")). Αυτό είναι έτσι ώστε, για παράδειγμα, θα σας έχετε απαντήσει ήδη σε οποιαδήποτε αιτήσεις σε εκκρεμότητα για να δημιουργήσετε νέα αντίγραφα πριν μας μετακίνηση εξισορρόπηση του συμπλέγματος. Όπως μπορείτε να δείτε, η προεπιλεγμένη χρονικά διαστήματα που καθορίζονται, θα σας μπορεί να ανιχνεύσει και έλεγχος για όλα τα στοιχεία πρέπει να κάνετε πολύ συχνά, γεγονός που σημαίνει ότι το σύνολο των αλλαγών που κάνουμε στο τέλος της κάθε βήμα είναι συνήθως μικρότερη: θα σας δεν σάρωση μέσω ώρες των αλλαγών στο σύμπλεγμα και προσπαθείτε να τα διορθώσετε όλα ταυτόχρονα, θα σας προσπαθείτε να χειριστείτε πράγματα περισσότερο ή λιγότερο που πραγματοποιούνται, αλλά με ορισμένες δέσμης όταν συμβεί πολλά πράγματα στο το ίδια ώρα. Έτσι ο πόρος ύφασμα Service manager πολύ αποκρίνεται σε πράγματα που πραγματοποιούνται στο σύμπλεγμα.

Κατά την περισσότερες από αυτές τις εργασίες να είναι απλή (εάν υπάρχουν παραβιάσεις των περιορισμών, η επιδιόρθωση, εάν υπάρχουν υπηρεσίες που θα δημιουργηθεί, τα δημιουργήσετε), η διαχείριση πόρων συμπλέγματος πρέπει επίσης ορισμένες πρόσθετες πληροφορίες για να προσδιορίσετε αν το σύμπλεγμα imbalanced. Για που έχουμε δύο άλλα στοιχεία ρύθμισης παραμέτρων: *Εξισορρόπηση όρια* και οι *Οριακές τιμές δραστηριότητας*.

## <a name="balancing-thresholds"></a>Εξισορρόπηση ορίων
Ένα όριο εξισορρόπηση είναι το κύριο στοιχείο ελέγχου για την ενεργοποίηση έγκαιρη εξισορρόπηση (μην ξεχνάτε ότι το χρονόμετρο είναι μόνο για πόσο συχνά η διαχείριση πόρων συμπλέγματος πρέπει να ελέγξετε - αυτό δεν σημαίνει ότι θα συμβεί τίποτα). Το όριο εξισορρόπηση καθορίζει τον τρόπο imbalanced του συμπλέγματος πρέπει να είναι για ένα συγκεκριμένο μετρικό με τη σειρά για τη διαχείριση πόρων συμπλέγματος πρέπει να λάβετε υπόψη το imbalanced και εξισορρόπηση έναυσμα.

Εξισορρόπησης όρια ορίζονται με βάση ανά μετρικό σύστημα ως τμήμα του ορισμού σύμπλεγμα. Για περισσότερες πληροφορίες σχετικά με μετρικά Παρακολουθήστε [αυτό το άρθρο](service-fabric-cluster-resource-manager-metrics.md).

ClusterManifest.xml

``` xml
    <Section Name="MetricBalancingThresholds">
      <Parameter Name="MetricName1" Value="2"/>
      <Parameter Name="MetricName2" Value="3.5"/>
    </Section>
```

Το όριο εξισορρόπηση για ένα μετρικό είναι μια αναλογία. Εάν το ποσό της φόρτωσης στον κόμβο πιο φορτωμένου διαιρείται με το ποσό της φόρτωσης στον κόμβο τουλάχιστον φορτωμένου υπερβαίνει αυτόν τον αριθμό, στη συνέχεια, το σύμπλεγμα θεωρείται imbalanced και εξισορρόπηση θα ενεργοποιηθεί την επόμενη φορά που η διαχείριση πόρων συμπλέγματος ελέγχει (από προεπιλογή, ποτέ 5 δευτερόλεπτα, ως διέπονται από το MinLoadBalancingInterval, φαίνεται παραπάνω).

![Εξισορρόπηση παράδειγμα όριο][Image1]

Σε αυτό το απλό παράδειγμα κάθε υπηρεσία καταναλώνει μία μονάδα μέτρησης ορισμένες. Στο παράδειγμα επάνω, 5 είναι η μέγιστη φόρτωση σε έναν κόμβο και η ελάχιστη τιμή είναι 2. Ας υποθέσουμε ότι το όριο εξισορρόπησης για αυτό το μετρικό είναι 3. Επομένως, στο παράδειγμα επάνω, θεωρείται το σύμπλεγμα εξισορρόπηση και χωρίς εξισορρόπηση θα ενεργοποιηθεί κατά τη διαχείριση πόρων συμπλέγματος ελέγχει (εφόσον ο λόγος του συμπλέγματος είναι 5/2 = 2,5 και που είναι μικρότερος από το καθορισμένο όριο εξισορρόπησης 3).

Στο παράδειγμα κάτω, ο μέγιστος αριθμός φόρτος έναν κόμβο είναι 10, ενώ η ελάχιστη τιμή είναι 2, με αποτέλεσμα μια αναλογία του 5. Αυτό μεταφέρει το σύμπλεγμα πάνω από το όριο σχεδιασμένο εξισορρόπησης 3 για συγκεκριμένο μετρικό. Ως αποτέλεσμα, μια καθολική rebalancing εκτέλεση θα είναι προγραμματισμένη επόμενη φορά που το χρονόμετρο της εξισορρόπησης ενεργοποιείται. Σημειώστε ότι απλώς και μόνο επειδή διακοπή εξισορρόπησης αναζήτηση δεν σημαίνει οτιδήποτε θα μετακινηθεί - ορισμένες φορές το σύμπλεγμα είναι imbalanced, αλλά δεν είναι δυνατό να βελτιωθεί η κατάσταση - αλλά σε κατάσταση όπως αυτή (τουλάχιστον από προεπιλογή) ορισμένα η φόρτωση σχεδόν σίγουρα θα διανεμηθεί σε Node3. Σημειώστε ότι επειδή δεν χρησιμοποιούμε μια κροταλίας προσέγγιση ορισμένες φόρτωσης θα μπορούσε να επίσης να διανεμηθούν να Node2 εφόσον που θα οδηγήσει στη ελαχιστοποίηση του τη συνολική διαφορές μεταξύ τους κόμβους, αλλά θα σας θα περιμένατε ότι το μεγαλύτερο μέρος των η φόρτωση θα ροής για να Node3.

![Εξισορρόπηση όριο παράδειγμα ενέργειες][Image2]

Σημειώστε ότι γρήγορα κάτω από το όριο εξισορρόπησης δεν είναι μια ρητή στόχος – εξισορρόπηση όρια είναι απλώς ένα *έναυσμα* που σας ενημερώνει για τη διαχείριση πόρων συμπλέγματος που είναι σε σύμπλεγμα για να προσδιορίσετε ποιες βελτιώσεις μπορεί να κάνει, εάν υπάρχει.

## <a name="activity-thresholds"></a>Όρια δραστηριότητας
Ορισμένες φορές, αν και οι κόμβοι σχετικά imbalanced, το *συνολικό* ποσό της φόρτωσης του συμπλέγματος είναι χαμηλή. Αυτό θα μπορούσε να είναι απλώς λόγω την ώρα της ημέρας ή επειδή το σύμπλεγμα είναι νέα και μόνο λήψη γίνεται εκκίνηση. Σε κάθε περίπτωση, που μπορεί να θέλετε να ξοδέψετε χρόνο εξισορρόπηση του συμπλέγματος, επειδή υπάρχει πραγματικά πολύ μικρό για να είναι που αποκτήθηκε – που θα απλώς να καταναλώνει πόρους δικτύου και υπολογισμού για να μετακινήσετε στοιχεία γύρω από, χωρίς να κάνετε οποιαδήποτε απόλυτη διαφορά. Επειδή θέλουμε να αποφύγετε την ενέργεια αυτή, υπάρχει ένα άλλο στοιχείο ελέγχου μέσα σε η διαχείριση πόρων, γνωστό ως δραστηριότητα ορίων, η οποία σας επιτρέπει να καθορίσετε ορισμένες απόλυτη κατώτατο όριο για δραστηριότητα – Εάν δεν υπάρχει κόμβος έχει τουλάχιστον αυτό όγκο φόρτωσης, στη συνέχεια, εξισορρόπηση θα δεν ενεργοποιηθεί ακόμα και αν ικανοποιείται το όριο εξισορρόπηση.

Ως παράδειγμα ας υποθέσουμε ότι έχουμε αναφορές με τα ακόλουθα σύνολα για κατανάλωση σε αυτές τις κόμβους. Ας επίσης υποθέσουμε ότι που θα σας κρατήσει μας όριο εξισορρόπηση του 3 για αυτό το μετρικό, αλλά τώρα έχουμε επίσης ένα όριο δραστηριότητας του 1536. Στην πρώτη περίπτωση, ενώ το σύμπλεγμα είναι imbalanced ανά το όριο εξισορρόπηση χωρίς κόμβος πληροί εν λόγω ελάχιστο όριο δραστηριότητας, ώστε να μας αφήστε πράγματα όπως. Στο παράδειγμα κάτω, Node1 είναι Τρόπος πάνω από το όριο δραστηριότητας, ώστε να εξισορρόπηση θα εκτελεστεί (εφόσον υπερβεί το όριο εξισορρόπηση και το όριο δραστηριότητας για τη μέτρηση)

![Παράδειγμα όριο δραστηριότητας][Image3]

Όπως ακριβώς ορίων εξισορρόπηση, όρια δραστηριότητας είναι καθορισμένο ανά μετρική μέσω τον ορισμό συμπλέγματος:

ClusterManifest.xml

``` xml
    <Section Name="MetricActivityThresholds">
      <Parameter Name="Memory" Value="1536"/>
    </Section>
```

Σημειώστε ότι όρια εξισορρόπηση και δραστηριότητα και τα δύο συνδεδεμένη με τη μέτρηση - εξισορρόπηση θα μόνο να ενεργοποιείται εάν είναι υπέρβαση εξισορρόπηση και δραστηριότητα ορίων για το ίδιο μετρικό. Έτσι, εάν θα σας υπερβαίνουν το όριο εξισορρόπηση για μνήμη και το όριο δραστηριότητας για CPU, εξισορρόπηση δεν θα ενεργοποιήσουν με την προϋπόθεση ότι δεν είναι υπέρβαση το υπόλοιπο ορίων (εξισορρόπηση όριο για CPU) και όριο δραστηριότητας για μνήμης.

## <a name="balancing-services-together"></a>Εξισορρόπηση υπηρεσιών μαζί
Κάτι που είναι ενδιαφέρον να σημειωθεί είναι ότι εάν το σύμπλεγμα είναι imbalanced ή δεν είναι απόφαση όλο το σύμπλεγμα, αλλά ο τρόπος προχωράμε σχετικά με τη διόρθωση του μεταφορά αντίγραφα μεμονωμένα υπηρεσίας και τις παρουσίες γύρω από. Αυτό έχει νόημα, σωστά; Εάν είναι σωρευμένων μνήμης προς τα επάνω σε έναν κόμβο, πολλά αντίγραφα ή παρουσίες θα μπορούσε να προκαλούν αυτό, αυτό θα μπορούσε να απαιτούν μετακίνηση οποιαδήποτε κατάστασης αντίγραφα ή χωρίς κατάσταση παρουσίες που χρησιμοποιούν τη μέτρηση που επηρεάζεται, imbalanced.

Κάποιες φορές αν ένας πελάτης θα καλούν μας προς τα επάνω ή το αρχείο μετακινήθηκε δελτίου τι λένε ότι μια υπηρεσία που δεν ήταν imbalanced. Πώς αυτό μπορεί να συμβαίνει ότι λαμβάνει μετακινηθεί μια υπηρεσία γύρω από, ακόμα και αν έχουν εξισορρόπηση όλων των μετρήσεων αυτήν την υπηρεσία, ακόμα και τέλεια Ναι, τη στιγμή της τη άλλες δυσαναλογία; Ας δούμε!

Για παράδειγμα χρειαστούν τέσσερις υπηρεσίες, Υπηρεσία1, Υπηρεσία2, Service3 και Service4. Υπηρεσία1 αναφορές κατά μετρικά Metric1 και Metric2, Υπηρεσία2 σε σχέση με Metric2 και Mmetric3, Service3 σε σχέση με Metric3 και Metric4 και Service4 σε σχέση με ορισμένες μετρικό Metric99. Σίγουρα μπορείτε να δείτε πού θα κάνουμε εδώ. Έχουμε μια αλυσίδα! Από την προοπτική της διαχείρισης πόρων συμπλέγματος, δεν έχουμε πραγματικά τέσσερις ανεξάρτητων υπηρεσίες, έχουμε μια ομάδα των υπηρεσιών που είναι σχετική (Υπηρεσία1, Υπηρεσία2 και Service3) και αυτό που είναι απενεργοποιημένη στο δικό του.

![Εξισορρόπηση υπηρεσιών μαζί][Image4]

Επομένως, είναι πιθανό ότι ένα δυσαναλογία στο Metric1 μπορεί να προκαλέσει αντίγραφα ή παρουσίες που ανήκουν σε Service3 για να μετακινήσετε. Συνήθως αυτές τις μετακινήσεις περιορίζονται αρκετά, αλλά μπορεί να είναι μεγαλύτερο ανάλογα με τον τρόπο imbalanced Metric1 ακριβώς στη διάθεσή σας και ποιες αλλαγές θα ήταν απαραίτητες στο σύμπλεγμα για να διορθώσετε. Επίσης, θα σας να πείτε με βεβαιότητα ότι ένα δυσαναλογία στο μετρικά 1, 2 ή 3 ποτέ θα προκαλέσει κινήσεων σε Service4 – θα ήταν κανένα σημείο από μετακίνηση τα αντίγραφα ή παρουσίες που ανήκουν σε Service4 γύρω από μπορούν να κάνετε οπωσδήποτε τίποτα, προκειμένου να επηρεάσουν το υπόλοιπο της μετρικά 1, 2 ή 3.

Η διαχείριση πόρων συμπλέγματος στοιχεία αυτόματα ανάληψη ποιες υπηρεσίες σχετίζονται, επειδή το υπηρεσίες ενδέχεται να έχουν προστεθεί, καταργηθεί, ή είχαν τους αλλαγή μετρικό ρύθμισης παραμέτρων – για παράδειγμα, μεταξύ των δύο σειρές εξισορρόπηση Υπηρεσία2 ενδέχεται να έχει δηλώσετε το για να καταργήσετε Metric2. Αυτό καταργεί την αλυσίδα μεταξύ Υπηρεσία1 και Υπηρεσία2. Τώρα αντί για δύο ομάδες των υπηρεσιών, υπάρχουν τρία:

![Εξισορρόπηση υπηρεσιών μαζί][Image5]

## <a name="next-steps"></a>Επόμενα βήματα
- Μετρικά είναι Τρόπος διαχείρισης των της διαχείρισης πόρων συμπλέγματος την υπηρεσία ύφασμα κατανάλωση και χωρητικότητας στο σύμπλεγμα. Για να μάθετε περισσότερα σχετικά με τους και πώς μπορείτε να ρυθμίσετε τις παραμέτρους τους ανάληψη ελέγχου [σε αυτό το άρθρο](service-fabric-cluster-resource-manager-metrics.md)
- Κίνηση κόστος είναι ένας τρόπος για σηματοδότηση για τη διαχείριση πόρων συμπλέγματος ότι ορισμένες υπηρεσίες είναι πιο ακριβό για να μετακινηθείτε από άλλους χρήστες. Για να μάθετε περισσότερα σχετικά με την κίνηση κόστος, που αναφέρονται σε [αυτό το άρθρο](service-fabric-cluster-resource-manager-movement-cost.md)
- Η διαχείριση πόρων συμπλέγματος έχει πολλές περιορισμοί που μπορείτε να ρυθμίσετε για να επιβραδύνετε churn στο σύμπλεγμα. Δεν είστε κανονικά είναι απαραίτητο, αλλά εάν χρειάζεστε τους, μπορείτε να μάθετε σχετικά με τους [εδώ](service-fabric-cluster-resource-manager-advanced-throttling.md)


[Image1]:./media/service-fabric-cluster-resource-manager-balancing/cluster-resrouce-manager-balancing-thresholds.png
[Image2]:./media/service-fabric-cluster-resource-manager-balancing/cluster-resource-manager-balancing-threshold-triggered-results.png
[Image3]:./media/service-fabric-cluster-resource-manager-balancing/cluster-resource-manager-activity-thresholds.png
[Image4]:./media/service-fabric-cluster-resource-manager-balancing/cluster-resource-manager-balancing-services-together1.png
[Image5]:./media/service-fabric-cluster-resource-manager-balancing/cluster-resource-manager-balancing-services-together2.png

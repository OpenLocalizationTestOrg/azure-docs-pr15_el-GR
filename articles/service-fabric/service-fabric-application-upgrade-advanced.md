<properties
   pageTitle="Αναβάθμιση εφαρμογής: θέματα για προχωρημένους | Microsoft Azure"
   description="Σε αυτό το άρθρο περιγράφει ορισμένα θέματα για προχωρημένους που αφορούν την αναβάθμιση μιας εφαρμογής υπηρεσίας ύφασμα."
   services="service-fabric"
   documentationCenter=".net"
   authors="mani-ramaswamy"
   manager="timlt"
   editor=""/>

<tags
   ms.service="service-fabric"
   ms.devlang="dotnet"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="NA"
   ms.date="09/14/2016"
   ms.author="subramar"/>

# <a name="service-fabric-application-upgrade-advanced-topics"></a>Αναβάθμιση εφαρμογής υπηρεσίας ύφασμα: θέματα για προχωρημένους

## <a name="adding-or-removing-services-during-an-application-upgrade"></a>Προσθήκη ή κατάργηση υπηρεσιών κατά την αναβάθμιση μιας εφαρμογής

Εάν μια νέα υπηρεσία προστίθεται σε μια εφαρμογή που είναι ήδη αναπτύξει το, και δημοσιεύεται ως αναβάθμιση, η νέα υπηρεσία προστίθεται εφαρμογής.  Η αναβάθμιση δεν επηρεάζει οποιαδήποτε από τις υπηρεσίες που έχουν ήδη μέρος της εφαρμογής. Ωστόσο, πρέπει να ξεκινήσει μια παρουσία της υπηρεσίας που προστέθηκε για τη νέα υπηρεσία να είναι ενεργό (χρησιμοποιώντας το `New-ServiceFabricService` cmdlet).

Υπηρεσίες μπορούν επίσης να καταργηθούν από μια εφαρμογή ως μέρος της αναβάθμισης. Ωστόσο, όλες τις εμφανίσεις τρέχουσα της υπηρεσίας διαγραφεί σε be πρέπει να διακοπεί πριν να συνεχίσετε με την αναβάθμιση (χρησιμοποιώντας το `Remove-ServiceFabricService` cmdlet). 

## <a name="manual-upgrade-mode"></a>Μη αυτόματη λειτουργία αναβάθμισης

> [AZURE.NOTE]  Πρέπει να θεωρείται μη αυτόματης λειτουργίας στην οποία δεν παρακολουθείται μόνο για μια αναβάθμιση απέτυχε ή σε αναστολή. Η λειτουργία εποπτευόμενη είναι η προτεινόμενη λειτουργία αναβάθμισης για εφαρμογές υπηρεσίας ύφασμα.

Azure ύφασμα υπηρεσία παρέχει πολλές λειτουργίες αναβάθμισης για την υποστήριξη συμπλεγμάτων ανάπτυξης και παραγωγής. Επιλογές ανάπτυξης επιλέξει μπορεί να διαφέρει για διαφορετικά περιβάλλοντα.

Εποπτευόμενη συνάθροισης αναβάθμισης εφαρμογής είναι το πιο τυπική αναβάθμιση για να χρησιμοποιήσετε στο παραγωγής. Όταν η πολιτική αναβάθμισης καθορίζεται, υπηρεσία ύφασμα εξασφαλίζει ότι η εφαρμογή είναι σε καλή κατάσταση πριν από την αναβάθμιση εξελίσσεται.

 Ο διαχειριστής της εφαρμογής να χρησιμοποιήσετε τη μη αυτόματη συνάθροισης αναβάθμισης λειτουργία εφαρμογής για να έχουν συνολικό έλεγχο της αναβάθμισης προόδου μέσω των διαφόρων αναβάθμισης τομέων. Αυτή η λειτουργία είναι χρήσιμη όταν απαιτείται μια πολιτική αξιολόγησης εύρυθμης λειτουργίας προσαρμοσμένων ή σύνθετη ή συμβαίνει ένα μη συμβατικός αναβάθμισης (για παράδειγμα, η εφαρμογή είναι ήδη απώλεια δεδομένων).

Τέλος, την αυτοματοποιημένη εφαρμογή αναβάθμιση είναι χρήσιμο για την ανάπτυξη ή δοκιμών περιβάλλοντα για την παροχή ενός κύκλου fast διαδοχικών προσεγγίσεων κατά την ανάπτυξη της υπηρεσίας.

## <a name="change-to-manual-upgrade-mode"></a>Αλλαγή σε κατάσταση λειτουργίας μη αυτόματης αναβάθμισης
**Μη αυτόματη**--διακοπή της αναβάθμισης εφαρμογής κατά την τρέχουσα UD και αλλάξτε τη λειτουργία αναβάθμισης σε δεν παρακολουθείται μη αυτόματα. Ο διαχειριστής πρέπει να καλέσετε με μη αυτόματο τρόπο **MoveNextApplicationUpgradeDomainAsync** για να προχωρήσετε στην αναβάθμιση ή να ενεργοποιήσετε μια επαναφορά κατά την έναρξη μιας νέας αναβάθμισης. Μετά την αναβάθμιση εισάγει στο τη μη αυτόματη λειτουργία, αυτή παραμένει σε λειτουργία μη αυτόματου μέχρι να ξεκινά μια νέα αναβάθμιση. Η εντολή **GetApplicationUpgradeProgressAsync** επιστρέφει ΎΦΑΣΜΑ\_ΕΦΑΡΜΟΓΉ\_ΑΝΑΒΆΘΜΙΣΗ\_ΚΑΤΆΣΤΑΣΗ\_ΤΡΟΧΑΊΟΥ\_προς τα ΕΜΠΡΌΣ\_σε ΕΚΚΡΕΜΌΤΗΤΑ.

## <a name="upgrade-with-a-diff-package"></a>Αναβάθμιση με ένα πακέτο εντοπισμού διαφορών

Μια εφαρμογή υπηρεσίας ύφασμα μπορεί να αναβαθμιστεί κατά την προμήθεια του με ένα πακέτο εφαρμογών πλήρους και ανεξάρτητο. Μια εφαρμογή μπορεί να αναβαθμιστεί επίσης με το πακέτο εντοπισμού διαφορών που περιέχει μόνο τα αρχεία της ενημερωμένης εφαρμογής, η δήλωση ενημερωμένης εφαρμογής και τα αρχεία δήλωσης της υπηρεσίας.

Ένα πακέτο πλήρους εφαρμογής περιέχει όλα τα αρχεία που είναι απαραίτητα για να ξεκινήσετε και να εκτελέσετε μια εφαρμογή υπηρεσίας ύφασμα. Ένα πακέτο εντοπισμού διαφορών περιέχει μόνο τα αρχεία που έχουν αλλάξει από την τελευταία παροχή και η αναβάθμιση, καθώς και τη δήλωση πλήρους εφαρμογής και η υπηρεσία δήλωσης αρχεία. Κάθε αναφορά στη δήλωση εφαρμογής ή δήλωση υπηρεσίας που δεν είναι δυνατό να βρεθεί στη διάταξη Δόμηση πραγματοποιείται αναζήτηση στο χώρο αποθήκευσης της εικόνας.

Πλήρης εφαρμογή πακέτων απαιτούνται για την πρώτη εγκατάσταση μιας εφαρμογής στο σύμπλεγμα. Οι επόμενες ενημερώσεις μπορεί να είναι είτε ένα πακέτο πλήρους εφαρμογής ή ένα πακέτο εντοπισμού διαφορών.

Περιστάσεις όταν ένα πακέτο εντοπισμού διαφορών θα είναι μια καλή επιλογή:

* Ένα πακέτο εντοπισμού διαφορών είναι προτιμότερη όταν έχετε ένα πακέτο μεγάλης εφαρμογής που αναφέρεται σε διάφορα αρχεία δήλωσης υπηρεσίας ή/και διάφορες πακέτων κώδικα, πακέτα config ή πακέτα δεδομένων.

* Ένα πακέτο εντοπισμού διαφορών είναι προτιμότερη όταν έχετε ένα σύστημα ανάπτυξης που δημιουργεί τη διάταξη Δόμηση απευθείας από τη διαδικασία Δόμηση εφαρμογών. Σε αυτήν την περίπτωση, παρόλο που δεν έχει αλλάξει τον κωδικό, που μόλις δομημένες συγκροτήσεις λάβετε ένα διαφορετικό άθροισμα ελέγχου. Χρησιμοποιώντας ένα πακέτο πλήρη εφαρμογή θα απαιτούν να ενημερώσετε την έκδοση σε όλα τα πακέτα κώδικα. Χρησιμοποιώντας ένα πακέτο εντοπισμού διαφορών, που παρέχουν μόνο τα αρχεία που άλλαξαν και τα αρχεία δήλωσης όπου έχει αλλάξει η έκδοση.

Κατά την αναβάθμιση μιας εφαρμογής της χρήση του Visual Studio, το πακέτο εντοπισμού διαφορών δημοσιεύεται αυτόματα. Για να δημιουργήσετε ένα πακέτο εντοπισμού διαφορών με μη αυτόματο τρόπο, τη δήλωση της εφαρμογής και η υπηρεσία δηλώσεων πρέπει να ενημερωθούν, αλλά μόνο το τροποποιημένο πακέτων θα πρέπει να συμπεριλαμβάνεται στο πακέτο τελικό εφαρμογής. 

Για παράδειγμα, ας ξεκινήσουμε με την παρακάτω εφαρμογή (οι αριθμοί έκδοσης που παρέχονται για διευκόλυνση της Κατανόηση):

```text
app1        1.0.0
  service1  1.0.0
    code    1.0.0
    config  1.0.0
  service2  1.0.0
    code    1.0.0
    config  1.0.0
```

Τώρα, ας υποθέσουμε ότι θέλετε να ενημερώσετε μόνο κώδικα πακέτο της Υπηρεσία1 χρησιμοποιώντας ένα πακέτο εντοπισμού διαφορών μέσω του PowerShell. Τώρα, ενημερωμένη την εφαρμογή σας περιλαμβάνει τα παρακάτω δομής των φακέλων:

```text
app1        2.0.0      <-- new version
  service1  2.0.0      <-- new version
    code    2.0.0      <-- new version
    config  1.0.0
  service2  1.0.0
    code    1.0.0
    config  1.0.0
```

Σε αυτήν την περίπτωση, μπορείτε να ενημερώσετε τη δήλωση της εφαρμογής για να 2.0.0 και τη δήλωση υπηρεσίας για το Υπηρεσία1 ώστε να αντικατοπτρίζει την ενημέρωση κώδικα του πακέτου. Στο φάκελο για το πακέτο εφαρμογών θα έχει την εξής δομή:

```text
app1/
  service1/
    code/
```

## <a name="next-steps"></a>Επόμενα βήματα

[Αναβάθμιση σας εφαρμογή χρησιμοποιώντας Visual Studio](service-fabric-application-upgrade-tutorial.md) σάς καθοδηγεί σε μια εφαρμογή αναβάθμιση χρήση του Visual Studio.

[Αναβάθμιση του Powershell χρήση εφαρμογής](service-fabric-application-upgrade-tutorial-powershell.md) σάς καθοδηγεί σε μια αναβάθμιση εφαρμογών με χρήση του PowerShell.

Να ελέγχετε τον τρόπο αναβαθμίζει την εφαρμογή σας, χρησιμοποιώντας [Παραμέτρους αναβάθμιση](service-fabric-application-upgrade-parameters.md).

Κάνει σας αναβαθμίσεις εφαρμογή συμβατά μαθαίνοντας πώς μπορείτε να χρησιμοποιήσετε [Δεδομένα σειριοποίησης](service-fabric-application-upgrade-data-serialization.md).

Διορθώστε συνήθη προβλήματα στην εφαρμογή αναβαθμίσεις με αναφορά σε τα βήματα στο θέμα [Αντιμετώπιση προβλημάτων εφαρμογής αναβαθμίσεις του στοιχείου](service-fabric-application-upgrade-troubleshooting.md).
 

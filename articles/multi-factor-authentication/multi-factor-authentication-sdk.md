<properties 
    pageTitle="Ενοποίηση του ταυτοτήτων εσωτερικής εγκατάστασης με το Azure Active Directory."
    description="Αυτό είναι το Azure AD Connect που περιγράφει τι είναι και γιατί μπορείτε να το χρησιμοποιήσετε."
    services="multi-factor-authentication"
    documentationCenter=""
    authors="kgremban"
    manager="femila"
    editor="curtand"/>

<tags
    ms.service="multi-factor-authentication"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="08/04/2016"
    ms.author="kgremban"/>

# <a name="building-multi-factor-authentication-into-custom-apps-sdk"></a>Έλεγχος ταυτότητας πολλών παραγόντων δόμησης σε προσαρμοσμένες εφαρμογές (SDK)

> [AZURE.IMPORTANT]  Εάν θέλετε να κάνετε λήψη του SDK, θα πρέπει να δημιουργήσετε μια υπηρεσία παροχής ελέγχου ταυτότητας πολλαπλών παραγόντων Azure, ακόμα και εάν έχετε Azure MFA, AAD Premium ή EMS άδειες χρήσης.  Εάν δημιουργείτε μια υπηρεσία παροχής ελέγχου ταυτότητας πολλαπλών παραγόντων Azure για το σκοπό και αδειών χρήσης που έχετε ήδη, απαιτείται να δημιουργήσετε την υπηρεσία παροχής με το μοντέλο **Ανά χρήστη με δυνατότητα** και να συνδέσετε την υπηρεσία παροχής του καταλόγου που περιέχει τις άδειες χρήσης Azure MFA, Azure AD Premium ή EMS.  Αυτό θα εξασφαλίσει ότι δεν έχουν χρεωθεί εκτός αν έχετε περισσότερες Μοναδικοί χρήστες χρησιμοποιώντας το SDK από τον αριθμό των αδειών χρήσης που διαθέτετε.

Το Azure πολλαπλών παραγόντων ελέγχου ταυτότητας ανάπτυξης λογισμικού Kit (SDK) σάς επιτρέπει να δημιουργήσετε τηλεφωνική κλήση και κείμενο επαλήθευσης μήνυμα απευθείας στο τις διεργασίες εισόδου ή συναλλαγή με τις εφαρμογές στο μισθωτή του Azure AD.

Το SDK έλεγχο ταυτότητας πολλών παραγόντων είναι διαθέσιμη για C#, Visual Basic (.NET), Java, Perl, PHP και φωνητικής γραφής. Το SDK παρέχει ένα λεπτό περιτυλίγματος γύρω από τον έλεγχο ταυτότητας πολλών παραγόντων. Περιλαμβάνει όλα όσα χρειάζεστε για να γράψετε τον κωδικό, συμπεριλαμβανομένων των αρχείων σχόλια πηγαίου κώδικα, αρχεία παράδειγμα και ένα αρχείο ReadMe λεπτομερείς. Κάθε SDK περιλαμβάνει επίσης ένα πιστοποιητικό και ιδιωτικό κλειδί για την κρυπτογράφηση συναλλαγές που είναι μοναδικός για την υπηρεσία παροχής ελέγχου ταυτότητας πολλαπλών παραγόντων. Με την προϋπόθεση ότι έχετε εγκαταστήσει μια υπηρεσία παροχής, μπορείτε να κάνετε λήψη του SDK σε όσο το δυνατόν περισσότερες γλώσσες και μορφές χρειάζεστε.

Η δομή των API στο SDK έλεγχο ταυτότητας πολλών παραγόντων είναι αρκετά απλή. Μπορείτε να κάνετε μια μεμονωμένη συνάρτηση κλήση API με τις παραμέτρους της επιλογής πολλών παραγόντων, όπως η λειτουργία επαλήθευσης και δεδομένα χρήστη, όπως τον αριθμό τηλεφώνου για να καλέσετε ή τον αριθμό PIN για την επικύρωση. Τα API μετάφραση την κλήση λειτουργίας σε αιτήσεις υπηρεσιών web στην βασίζεται στο cloud πολλαπλών παραγόντων Azure υπηρεσία ελέγχου ταυτότητας. Όλες οι κλήσεις πρέπει να συμπεριλάβετε μια αναφορά στο ιδιωτικό πιστοποιητικό που περιλαμβάνεται στο κάθε SDK.

Επειδή τα API δεν έχουν πρόσβαση σε χρήστες που έχουν καταχωρηθεί στο Azure Active Directory, πρέπει να δώσετε πληροφορίες χρήστη, όπως οι αριθμοί τηλεφώνου και κωδικούς PIN, σε ένα αρχείο ή μια βάση δεδομένων. Επίσης, τα API δεν παρέχει δυνατότητες διαχείρισης χρηστών ή εγγραφής, ώστε να πρέπει να δημιουργήσετε αυτές τις διαδικασίες στην εφαρμογή σας.






## <a name="download-the-azure-multi-factor-authentication-sdk"></a>Κάντε λήψη του Azure έλεγχο ταυτότητας πολλών παραγόντων SDK

Λήψη του SDK πολλαπλών παραγόντων Azure απαιτεί υπηρεσία [Παροχής ελέγχου ταυτότητας πολλαπλών παραγόντων Azure](multi-factor-authentication-get-started-auth-provider.md).  Αυτό απαιτεί μια πλήρη Azure συνδρομή, ακόμα και αν ανήκουν Azure MFA, Azure AD Premium ή οικογένεια προγραμμάτων για μεγάλες επιχειρήσεις φορητότητα άδειες χρήσης.  Για να κάνετε λήψη του SDK, που πρέπει να μεταβείτε στην πύλη διαχείρισης του πολλαπλών παραγόντων είτε με τη διαχείριση της υπηρεσίας παροχής ελέγχου ταυτότητας πολλαπλών παραγόντων απευθείας ή κάνοντας κλικ στη σύνδεση **"Μεταβείτε στην πύλη του"** στη σελίδα Ρυθμίσεις υπηρεσίας MFA.


### <a name="to-download-the-azure-multi-factor-authentication-sdk-from-the-azure-portal"></a>Για να κάνετε λήψη του SDK έλεγχο ταυτότητας πολλών παραγόντων Azure από την πύλη του Azure


1. Είσοδος στην πύλη του Azure ως διαχειριστής.
2. Στα αριστερά, επιλέξτε την υπηρεσία καταλόγου Active Directory.
3. Στη σελίδα της υπηρεσίας καταλόγου Active Directory, στο επάνω μέρος, κάντε κλικ στην επιλογή **Υπηρεσίες παροχής ελέγχου ταυτότητας πολλαπλών παραγόντων**
4. Στο κάτω μέρος, κάντε κλικ στην επιλογή **Διαχείριση**
5. Αυτό θα ανοίξει μια νέα σελίδα.  Στα αριστερά, στο κάτω μέρος, κάντε κλικ στην επιλογή SDK.
<center>![Λήψη](./media/multi-factor-authentication-sdk/download.png)</center>
6. Επιλέξτε τη γλώσσα που θέλετε και κάντε κλικ σε μία τις συνδέσεις συσχετισμένες λήψης.
7. Αποθηκεύστε τη λήψη.



### <a name="to-download-the-azure-multi-factor-authentication-sdk-via-the-service-settings"></a>Για να κάνετε λήψη του SDK έλεγχο ταυτότητας πολλών παραγόντων Azure μέσω των ρυθμίσεων υπηρεσίας


1. Είσοδος στην πύλη του Azure ως διαχειριστής.
2. Στα αριστερά, επιλέξτε την υπηρεσία καταλόγου Active Directory.
3. Κάντε διπλό κλικ στην παρουσία του Azure AD.
4. Στο επάνω μέρος, κάντε κλικ στην επιλογή **Ρύθμιση παραμέτρων**
5. Στην περιοχή έλεγχος ταυτότητας πολλών παραγόντων, επιλέξτε **Διαχείριση ρυθμίσεων υπηρεσίας**
![λήψη](./media/multi-factor-authentication-sdk/download2.png)
6. Στη σελίδα ρυθμίσεις services, στο κάτω μέρος της οθόνης, κάντε κλικ στην επιλογή **μεταβείτε στην πύλη του**.
![Λήψη](./media/multi-factor-authentication-sdk/download3a.png)
7. Αυτό θα ανοίξει μια νέα σελίδα.  Στα αριστερά, στο κάτω μέρος, κάντε κλικ στην επιλογή SDK.
8. Επιλέξτε τη γλώσσα που θέλετε και κάντε κλικ σε μία τις συνδέσεις σχετίζονται λήψης.
9. Αποθηκεύστε τη λήψη.

## <a name="contents-of-the-azure-multi-factor-authentication-sdk"></a>Περιεχόμενα του Azure έλεγχο ταυτότητας πολλών παραγόντων SDK
Μέσα στο SDK θα βρείτε τα ακόλουθα στοιχεία:

- **Αρχείο README**. Εξηγεί πώς μπορείτε να χρησιμοποιήσετε τα API ελέγχου ταυτότητας πολλαπλών παραγόντων σε μια νέα ή υπάρχουσα εφαρμογή.
- **Αρχεία προέλευσης** για έλεγχο ταυτότητας πολλών παραγόντων
- **Πιστοποιητικό προγράμματος-πελάτη** που χρησιμοποιείτε για να επικοινωνήσετε με την υπηρεσία ελέγχου ταυτότητας πολλαπλών παραγόντων
- **Ιδιωτικό κλειδί** για το πιστοποιητικό
- **Κλήση αποτελέσματα.** Μια λίστα με τους κωδικούς κλήσης αποτέλεσμα. Για να ανοίξετε αυτό το αρχείο, χρησιμοποιήστε μια εφαρμογή με μορφοποίηση κειμένου, όπως το WordPad. Χρησιμοποιήστε τους κωδικούς αποτέλεσμα κλήσης για τη δοκιμή και αντιμετώπιση προβλημάτων με την εκτέλεση του ελέγχου ταυτότητας πολλαπλών παραγόντων στην εφαρμογή σας. Δεν είναι κωδικοί κατάστασης ελέγχου ταυτότητας.
- **Παραδείγματα.** Δείγμα κώδικα για μια βασική εφαρμογή εργασία του ελέγχου ταυτότητας πολλαπλών παραγόντων.


>[AZURE.WARNING]Το πιστοποιητικό προγράμματος-πελάτη είναι ένα μοναδικό ιδιωτικό πιστοποιητικό που δημιουργήθηκε ειδικά για εσάς. Μην κάνετε κοινή χρήση ή χάσετε αυτού του αρχείου. Πρόκειται για τον αριθμό-κλειδί να διασφαλίσει την ασφάλεια των επικοινωνιών σας με την υπηρεσία ελέγχου ταυτότητας πολλαπλών παραγόντων.

## <a name="code-sample-standard-mode-phone-verification"></a>Δείγμα κώδικα: Επαλήθευση τηλεφώνου τυπική λειτουργία

Αυτό το δείγμα κώδικα δείχνει πώς μπορείτε να χρησιμοποιήσετε τα API στο SDK έλεγχο ταυτότητας πολλών παραγόντων Azure για να προσθέσετε τυπική λειτουργία φωνητική κλήση επαλήθευσης στην εφαρμογή σας. Τυπική λειτουργία είναι μια τηλεφωνική κλήση που απαντά ο χρήστης πατώντας το πλήκτρο #.

Αυτό το παράδειγμα χρησιμοποιεί το C# .NET 2.0 πολλαπλών παραγόντων ελέγχου ταυτότητας SDK σε μια βασική εφαρμογή ASP.NET με λογική διακομιστή C#, αλλά η διαδικασία είναι παρόμοια για απλές υλοποιήσεις σε άλλες γλώσσες. Επειδή το SDK περιλαμβάνει αρχεία προέλευσης, δεν εκτελέσιμο αρχεία, μπορείτε να δημιουργήσετε τα αρχεία και αναφορά τους ή να τις συμπεριλάβετε απευθείας στην εφαρμογή σας.

>[AZURE.NOTE]Κατά την εφαρμογή έλεγχο ταυτότητας πολλών παραγόντων, χρησιμοποιήστε τα επιπλέον στοιχεία ως δευτερεύουσα ή τριτεύοντα επαλήθευσης για τη συμπλήρωση της μεθόδου ελέγχου ταυτότητας πρωτεύοντος. Αυτές οι μέθοδοι δεν έχουν σχεδιαστεί για να χρησιμοποιηθεί ως μεθόδους ελέγχου ταυτότητας πρωτεύοντος.

### <a name="code-sample-overview"></a>Επισκόπηση δείγματα κώδικα
Αυτός ο κωδικός δείγματος για μια εφαρμογή επίδειξη πολύ απλής web χρησιμοποιεί μια τηλεφωνική κλήση με μια απάντηση κλειδιού # για να ολοκληρώσετε τον έλεγχο ταυτότητας του χρήστη. Ο παράγοντας τηλεφωνική κλήση είναι γνωστό στον έλεγχο ταυτότητας πολλών παραγόντων ως τυπική λειτουργία.

Ο κωδικός πλευρά του προγράμματος-πελάτη δεν περιλαμβάνει τα στοιχεία που αφορούν συγκεκριμένα τον έλεγχο ταυτότητας πολλών παραγόντων. Επειδή οι τους παράγοντες πρόσθετου ελέγχου ταυτότητας είναι ανεξάρτητα από το κύριο ελέγχου ταυτότητας, μπορείτε να τις προσθέσετε χωρίς να αλλάξετε την υπάρχουσα σύνδεση περιβάλλοντος εργασίας. Τα API στο SDK πολλαπλών παραγόντων σάς επιτρέπουν να προσαρμόσετε την εμπειρία χρήστη, αλλά δεν μπορεί να χρειάζεται να αλλάξετε όλα τα στοιχεία σε όλα.

Ο κωδικός διακομιστή προσθέτει τυπική λειτουργία ελέγχου ταυτότητας στο βήμα 2. Δημιουργεί ένα αντικείμενο PfAuthParams με τις παραμέτρους που απαιτούνται για την επαλήθευση τυπική λειτουργία: το όνομα χρήστη, τηλεφώνου για αριθμό, και λειτουργία και τη διαδρομή προς το πιστοποιητικό προγράμματος-πελάτη (CertFilePath), το οποίο απαιτείται σε κάθε κλήση. Για μια επίδειξη σχετικά με όλες τις παραμέτρους στο PfAuthParams, ανατρέξτε στο θέμα το παράδειγμα αρχείου στο SDK.

Στη συνέχεια, τον κωδικό μεταφέρει το αντικείμενο PfAuthParams στη συνάρτηση pf_authenticate(). Η τιμή που επιστρέφεται υποδεικνύει την επιτυχία ή την αποτυχία του ελέγχου ταυτότητας. Οι παράμετροι out, callStatus και errorID, περιέχουν πληροφορίες αποτέλεσμα επιπλέον κλήσης. Οι κωδικοί αποτέλεσμα κλήση τεκμηριώνονται στο αρχείο αποτελέσματα κλήσης στο SDK.

Αυτή η ελάχιστη υλοποίηση μπορούν να εγγραφούν σε μερικά μόνο γραμμές. Ωστόσο, στον κώδικα παραγωγής, πρέπει να συμπεριλάβετε πιο εξελιγμένη χειρισμού σφαλμάτων κώδικα επιπλέον βάσης δεδομένων και μια βελτιωμένη εμπειρία χρήστη.

### <a name="web-client-code"></a>Κωδικός προγράμματος-πελάτη Web

Ακολουθεί κώδικα προγράμματος-πελάτη web για μια επίδειξη σελίδα.


    <%@ Page Language="C#" AutoEventWireup="true" CodeFile="Default.aspx.cs" Inherits="_Default" %>

    <!DOCTYPE html>

    <html xmlns="http://www.w3.org/1999/xhtml">
    <head runat="server">
    <title>Multi-Factor Authentication Demo</title>
    </head>
    <body>
    <h1>Azure Multi-Factor Authentication Demo</h1>
    <form id="form1" runat="server">

    <div style="width:auto; float:left">
    Username:&nbsp;<br />
    Password:&nbsp;<br />
    </div>

    <div">
    <asp:TextBox id="username" runat="server" width="100px"/><br />
    <asp:Textbox id="password" runat="server" width="100px" TextMode="password" /><br />
    </div>

    <asp:Button id="btnSubmit" runat="server" Text="Log in" onClick="btnSubmit_Click"/>

    <p><asp:Label ID="lblResult" runat="server"></asp:Label></p>

    </form>
    </body>
    </html>


### <a name="server-side-code"></a>Κωδικός πλευρά του διακομιστή

Τον παρακάτω κώδικα διακομιστή, έλεγχο ταυτότητας πολλών παραγόντων είναι έχει ρυθμιστεί και να εκτελέσετε στο βήμα 2. Τυπική λειτουργία (MODE_STANDARD) είναι μια τηλεφωνική κλήση στις οποίες απαντά ο χρήστης πατώντας το πλήκτρο #.

    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Web;
    using System.Web.UI;
    using System.Web.UI.WebControls;

    public partial class _Default : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
        }

        protected void btnSubmit_Click(object sender, EventArgs e)
        {
            // Step 1: Validate the username and password
            if (username.Text != "Contoso" || password.Text != "password")
            {
                lblResult.ForeColor = System.Drawing.Color.Red;
                lblResult.Text = "Username or password incorrect.";
            }
            else
            {
                // Step 2: Perform multi-factor authentication

                // Add call details from the user database.
                PfAuthParams pfAuthParams = new PfAuthParams();
                pfAuthParams.Username = username.Text;
                pfAuthParams.Phone = "9134884271";
                pfAuthParams.Mode = pf_auth.MODE_STANDARD;

                // Specify a client certificate
                // NOTE: This file contains the private key for the client
                // certificate. It must be stored with appropriate file
                // permissions.
                pfAuthParams.CertFilePath = "c:\\cert_key.p12";

                // Perform phone-based authentication
                int callStatus;
                int errorId;

                if(pf_auth.pf_authenticate(pfAuthParams, out callStatus, out errorId))
                {
                    lblResult.ForeColor = System.Drawing.Color.Green;
                    lblResult.Text = "Multi-Factor Authentication succeeded.";
                }
                else
                {
                    lblResult.ForeColor = System.Drawing.Color.Red;
                    lblResult.Text = " Multi-Factor Authentication failed.";
                }
            }

        }
    }

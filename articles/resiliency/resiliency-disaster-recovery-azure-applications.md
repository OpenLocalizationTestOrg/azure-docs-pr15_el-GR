<properties
   pageTitle="Αποκατάσταση για τις εφαρμογές του Azure | Microsoft Azure"
   description="Τεχνική επισκόπηση και λεπτομερείς πληροφορίες σχετικά με τη σχεδίαση εφαρμογών για αποκατάσταση στο Windows Azure."
   services=""
   documentationCenter="na"
   authors="adamglick"
   manager="saladki"
   editor=""/>

<tags
   ms.service="resiliency"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="08/18/2016"
   ms.author="aglick"/>

#<a name="disaster-recovery-for-applications-built-on-microsoft-azure"></a>Αποκατάσταση για εφαρμογές που δημιουργήθηκαν στο Microsoft Azure

Ότι υψηλή διαθεσιμότητα σχετικά με τη Διαχείριση προσωρινό σφάλμα, αποκατάσταση (DR) είναι σχετικά με το καταστροφική απώλεια λειτουργικότητας εφαρμογής. Για παράδειγμα, εξετάστε το σενάριο όπου μεταβαίνει σε περιοχή προς τα κάτω. Σε αυτήν την περίπτωση, πρέπει να έχετε ένα σχέδιο για να εκτελέσετε την εφαρμογή σας ή πρόσβαση στα δεδομένα σας έξω από την περιοχή Azure. Εκτέλεση των αυτό το πρόγραμμα περιλαμβάνει άτομα, διαδικασιών και υποστήριξης εφαρμογές που επιτρέπουν του συστήματος να λειτουργεί. Οι κάτοχοι επιχειρήσεις και τεχνολογία που ορίζουν κατάσταση λειτουργίας του συστήματος για μια καταστροφή επίσης καθορίζουν το επίπεδο λειτουργικότητας για την υπηρεσία κατά τη διάρκεια μιας καταστροφής. Το επίπεδο λειτουργικότητας μπορεί να διαρκέσει μερικές φόρμες: διαθέσιμο πλήρως, μερικώς διαθέσιμη (υποβαθμισμένο λειτουργίες ή καθυστερήσει επεξεργασίας), ή πλήρως διαθέσιμο.

##<a name="azure-disaster-recovery-features"></a>Δυνατότητες αποκατάστασης από καταστροφή Azure

Όπως διαθεσιμότητα ζητήματα, Azure έχει [ανοχή τεχνική καθοδήγηση](./resiliency-technical-guidance.md) που έχει σχεδιαστεί για την υποστήριξη αποκατάσταση. Υπάρχει επίσης μια σχέση μεταξύ ορισμένες από τις δυνατότητες διαθεσιμότητα του Azure και καταστροφή αποκατάστασης. Για παράδειγμα, η διαχείριση των ρόλων σε όλους τους τομείς σφαλμάτων αυξάνει τη διαθεσιμότητα μιας εφαρμογής του. Χωρίς αυτή η διαχείριση, μια αποτυχία ανεπίλυτη υλικού θα μετατραπεί σε ένα σενάριο "καταστροφή". Ώστε η σωστή εφαρμογή διαθεσιμότητα των δυνατοτήτων και στρατηγικές είναι ένα σημαντικό τμήμα γλωσσικού ελέγχου την καταστροφή την εφαρμογή σας. Ωστόσο, αυτό το άρθρο υπερβαίνει γενικής διαθεσιμότητας θέματα σε συμβάντα από καταστροφή πιο σοβαρά (και πιο σπάνιες).

##<a name="multiple-datacenter-regions"></a>Πολλές περιοχές κέντρο δεδομένων

Azure διατηρεί κέντρα δεδομένων σε πολλές περιοχές του κόσμου. Αυτήν την υποδομή υποστηρίζει διάφορα σενάρια αποκατάστασης από καταστροφή, όπως το σύστημα δόθηκε παν-αναπαραγωγής Azure χώρου αποθήκευσης σε δευτερεύοντα περιοχές. Σημαίνει επίσης ότι μπορείτε να εύκολα και οικονομική αναπτύξετε μια υπηρεσία cloud σε πολλές θέσεις όλο τον κόσμο. Συγκρίνετε αυτή με το κόστος και είναι δύσκολο να εκτελεί τη δική σας κέντρα δεδομένων σε πολλές περιοχές. Για την ανάπτυξη δεδομένα και υπηρεσίες σε πολλές περιοχές συμβάλλει στην προστασία την εφαρμογή σας από κύρια ΡΕΥΜΑΤΟΣ σε μία μόνο περιοχή.

##<a name="azure-traffic-manager"></a>Διαχείριση Azure κίνηση

Όταν προκύπτει σφάλμα συγκεκριμένης περιοχής, που πρέπει να ανακατευθύνετε την κίνηση σε υπηρεσίες ή αναπτύξεις σε μια άλλη περιοχή. Μπορείτε να το κάνετε αυτό δρομολόγηση με μη αυτόματο τρόπο, αλλά είναι πιο αποτελεσματικό να χρησιμοποιήσετε μια αυτοματοποιημένη διαδικασία. Azure κίνηση Manager έχει σχεδιαστεί για αυτήν την εργασία. Μπορείτε να το χρησιμοποιήσετε για να διαχειριστείτε την ανακατεύθυνση της κυκλοφορίας χρήστη σε άλλη περιοχή αυτόματα σε περίπτωση που η κύρια περιοχή αποτυγχάνει. Επειδή η διαχείριση της κυκλοφορίας είναι ένα σημαντικό τμήμα της συνολικής στρατηγικής, είναι σημαντικό να κατανοήσετε τις βασικές δυνατότητες της διαχείρισης κίνηση.

Στο παρακάτω διάγραμμα, οι χρήστες συνδέονται με μια διεύθυνση URL που έχει καθοριστεί για την κυκλοφορία Manager (__http://myATMURL.trafficmanager.net__) και αποσπάσματα που τις διευθύνσεις URL των τοποθεσιών πραγματική (__http://app1URL.cloudapp.net__ και __http://app2URL.cloudapp.net__). Ανάλογα με το πώς μπορείτε να ρυθμίσετε τα κριτήρια για όταν στους χρήστες δρομολόγηση, οι χρήστες θα σταλεί για τη σωστή τοποθεσία πραγματική όταν καθορίζει την πολιτική. Οι επιλογές πολιτικής είναι round robin, επιδόσεις ή ανακατεύθυνσης. Για αυτό το άρθρο, θα σας θα ενημερώνουν μόνο η επιλογή ανακατεύθυνσης.

![Δρομολόγηση μέσω Azure κίνηση Manager](./media/resiliency-disaster-recovery-azure-applications/routing-using-azure-traffic-manager.png)

Όταν τη ρύθμιση των παραμέτρων Manager κίνηση, μπορείτε να παράσχετε ένα νέο πρόθεμα DNS Manager κίνηση. Αυτό είναι το πρόθεμα URL που θα παρέχετε στους χρήστες σας για πρόσβαση στην υπηρεσία. Διαχείριση κίνηση συνοψίζει τώρα ένα επίπεδο προς τα επάνω και όχι στο επίπεδο της περιοχής εξισορρόπησης φόρτου. Το DNS Manager κίνηση αντιστοιχεί σε μια εγγραφή CNAME για όλα τα αναπτύξεις που διαχειρίζεται.

Μέσα σε Manager κίνηση, μπορείτε να καθορίσετε την προτεραιότητα της το αναπτύξεις που οι χρήστες θα δρομολογούνται όταν προκύπτει σφάλμα. Κίνηση Manager παρακολουθεί τα τελικά σημεία της αναπτύξεις και σημειώσεις όταν αποτύχει η κύρια ανάπτυξης. Στο αποτυχίας, Διαχείριση κίνηση αναλύει τη λίστα προτεραιότητας των αναπτύξεις και δρομολογεί τους χρήστες για την επόμενη μία στη λίστα.

Παρόλο που η κυκλοφορία Manager αποφασίσει να μεταβείτε στο ανακατεύθυνσης, μπορείτε να αποφασίσετε εάν τον τομέα σας ανακατεύθυνσης είναι αδρανείς ή ενεργός ενώ δεν βρίσκεστε σε λειτουργία ανακατεύθυνσης. Αυτή η λειτουργία έχει τίποτα, προκειμένου να κάνετε με το Azure κίνηση Manager. Διαχείριση κίνηση εντοπίσει μια αποτυχία στην κύρια τοποθεσία και βρίσκεται πάνω από την τοποθεσία ανακατεύθυνσης. Διαχείριση κίνηση συγκεντρώνει ανεξάρτητα από το εάν αυτής της τοποθεσίας είναι αυτήν τη στιγμή που εξυπηρετούν τους χρήστες ή όχι.

Για περισσότερες πληροφορίες σχετικά με πώς λειτουργεί η διαχείριση κίνηση Azure, ανατρέξτε:

 * [Επισκόπηση της διαχείρισης κίνηση](../traffic-manager/traffic-manager-overview.md)
 * [Ρύθμιση παραμέτρων μέθοδο δρομολόγησης ανακατεύθυνσης](../traffic-manager/traffic-manager-configure-failover-routing-method.md)

##<a name="azure-disaster-scenarios"></a>Σενάρια Azure καταστροφής

Οι παρακάτω ενότητες καλύπτει πολλούς διαφορετικούς τύπους από καταστροφή σενάρια. Διακοπές ολόκληρη την περιοχή υπηρεσίας δεν είναι η αιτία μόνο αποτυχιών όλη την εφαρμογή. Κακή σχεδίασης ή διαχείρισης σφάλματα επίσης μπορεί να οδηγήσει σε διακοπές. Είναι σημαντικό να λάβετε υπόψη τις πιθανές αιτίες των αποτυχία κατά τη σχεδίαση και το δοκιμών φάσεις του προγράμματός σας αποκατάστασης. Ένα καλό σχέδιο λαμβάνει εκμεταλλευτείτε τις δυνατότητες του Azure και αυξάνει τους με συγκεκριμένη εφαρμογή στρατηγικές. Η επιλεγμένη απόκριση είναι υπαγορεύεται από τη σπουδαιότητα της εφαρμογής, ο στόχος σημείου αποκατάστασης (RPO), και το χρόνο στόχο ανάκτησης (RTO).

###<a name="application-failure"></a>Αποτυχία εφαρμογής

Azure κίνηση Manager χειρίζεται αυτόματα αποτυχίες που προκύπτουν από το υποκείμενο λογισμικό υλικού ή λειτουργικό σύστημα τον κεντρικό υπολογιστή εικονική. Azure δημιουργεί μια νέα παρουσία του ρόλου σε ένα λειτουργικό διακομιστή και το προσθέτει στο την περιστροφή μονάδα εξισορρόπησης φόρτου. Εάν ο αριθμός των παρουσιών ρόλο είναι μεγαλύτερο από μία, Azure μετατοπίζει επεξεργασίας για τις άλλες ρόλο παρουσίες που εκτελούνται ενώ αντικαθιστά τον κόμβο απέτυχε.

Υπάρχουν σφάλματα σοβαρές εφαρμογών που πραγματοποιούνται ανεξάρτητα από τα τυχόν αποτυχίες υλικού ή λειτουργικό σύστημα. Η εφαρμογή μπορεί να αποτύχει λόγω καταστροφικού εξαιρέσεις που προκαλούνται από την εσφαλμένη λογική ή προβλημάτων ακεραιότητας δεδομένων. Πρέπει να μπορείτε να ενσωματώσετε αρκετό τηλεμετρίας στον κώδικα, έτσι ώστε να εντοπίσει αποτυχία συνθήκες και να σας ειδοποιεί ο διαχειριστής της εφαρμογής ενός συστήματος παρακολούθησης. Διαχειριστής που έχει πλήρη γνώση των διεργασιών αποκατάστασης από καταστροφή να κάνετε μια δική σας απόφαση για να καλέσετε μια διαδικασία ανακατεύθυνσης. Εναλλακτικά, ο διαχειριστής μπορεί να αποδεχτεί απλώς μια μη διαθεσιμότητα διαθεσιμότητας για να επιλύσετε τα σφάλματα κρίσιμη.

###<a name="data-corruption"></a>Καταστροφή δεδομένων

Azure αποθηκεύει αυτόματα τα δεδομένα σας βάση δεδομένων SQL Azure και αποθήκευσης Azure τρεις φορές περιττή μέσα σε διαφορετικές σφαλμάτων τομείς στην ίδια περιοχή. Εάν χρησιμοποιείτε το παν αναπαραγωγής, τα δεδομένα αποθηκεύονται τρεις φορές επιπλέον σε διαφορετική περιοχή. Ωστόσο, εάν οι χρήστες σας ή την εφαρμογή σας καταστρέψει τα δεδομένα στο κύριο αντίγραφο, τα δεδομένα αναπαράγει γρήγορα σε τα άλλα αντίγραφα. Δυστυχώς, το αποτέλεσμα είναι τρεις αντίγραφα των κατεστραμμένα δεδομένα.

Για να διαχειριστείτε πιθανή καταστροφή των δεδομένων σας, έχετε δύο επιλογές. Πρώτα, μπορείτε να διαχειριστείτε ένα προσαρμοσμένο στρατηγική αντιγράφων ασφαλείας. Μπορείτε να αποθηκεύσετε τα αντίγραφα ασφαλείας σε Azure ή εσωτερικής εγκατάστασης, ανάλογα με τις επιχειρηματικές απαιτήσεις ή κανονισμών διακυβέρνησης. Μια άλλη επιλογή είναι να χρησιμοποιήσετε τη νέα επιλογή Επαναφορά σε δεδομένη χρονική στιγμή για να ανακτήσετε μια βάση δεδομένων SQL. Για περισσότερες πληροφορίες, ανατρέξτε στην ενότητα σε [δεδομένα στρατηγικές για την αποκατάσταση](#data-strategies-for-disaster-recovery).

###<a name="network-outage"></a>Μη διαθεσιμότητα δικτύου

Όταν τα τμήματα του Azure δικτύου είναι προσβάσιμα, ενδέχεται να μην μπορούν να μεταβούν στην εφαρμογή σας ή των δεδομένων. Εάν μία ή περισσότερες παρουσίες ρόλο είναι διαθέσιμες λόγω ζητημάτων δικτύου, Azure χρησιμοποιεί τις υπόλοιπες διαθέσιμες παρουσίες της εφαρμογής σας. Εάν η εφαρμογή σας δεν είναι δυνατό να πρόσβαση τα δεδομένα εξαιτίας ενός μη διαθεσιμότητα Azure δικτύου, μπορείτε να εκτελέσετε πιθανώς σε λειτουργία υποβαθμίζονται τοπικά, χρησιμοποιώντας δεδομένα στο cache. Πρέπει να αρχιτεκτονική τη στρατηγική αποκατάστασης από καταστροφή για την εκτέλεση της λειτουργίας υποβαθμίζονται στην εφαρμογή σας. Για ορισμένες εφαρμογές, αυτό ίσως να μην πρακτικές.

Μια άλλη επιλογή είναι να αποθηκεύσετε δεδομένα σε μια εναλλακτική θέση μέχρι να επανέλθει η σύνδεση. Εάν υποβαθμίζονται λειτουργία δεν είναι μια επιλογή, τις υπόλοιπες επιλογές είναι εφαρμογή χρόνου εκτός λειτουργίας ή ανακατεύθυνση σε μια εναλλακτική περιοχής. Η σχεδίαση του μια εφαρμογή που εκτελείται σε λειτουργία υποβαθμίζονται είναι όσο μιας επιχειρηματικής απόφασης ως ένα τεχνική. Αυτό αναλύεται περαιτέρω στην ενότητα [υποβαθμισμένο λειτουργία της εφαρμογής](#degraded-application-functionality).

###<a name="failure-of-a-dependent-service"></a>Αποτυχία εξαρτώμενα υπηρεσίας

Azure παρέχει πολλές υπηρεσίες που μπορεί να αντιμετωπίσετε περιοδικό χρόνου εκτός λειτουργίας. Εξετάστε το ενδεχόμενο [Azure Redis Cache](https://azure.microsoft.com/services/cache/) ως παράδειγμα. Αυτή η υπηρεσία πολλών μισθωτών παρέχει σε cache δυνατότητες στην εφαρμογή σας. Είναι σημαντικό να λάβετε υπόψη σας τι συμβαίνει στην εφαρμογή σας, εάν η εξαρτώμενη υπηρεσία δεν είναι διαθέσιμη. Με πολλούς τρόπους, αυτό το σενάριο είναι παρόμοιο με το σενάριο μη διαθεσιμότητα δικτύου. Ωστόσο, εξετάζετε κάθε υπηρεσία έχει ως αποτέλεσμα ανεξάρτητη πιθανές βελτιώσεις στο συνολικό το πρόγραμμά σας.

Azure Redis Cache παρέχει σε cache για την εφαρμογή σας από μέσα του ανάπτυξη υπηρεσία cloud, που παρέχει τα πλεονεκτήματα αποκατάστασης από καταστροφή. Πρώτα, η υπηρεσία εκτελείται τώρα τους ρόλους που είναι τοπικά για την ανάπτυξη. Γι ' αυτό, είστε καλύτερα μπορούν να παρακολουθούν και να διαχειριστείτε την κατάσταση της μνήμης cache ως τμήμα του συνολικού διαδικασίες διαχείρισης για την υπηρεσία cloud. Αυτός ο τύπος της εγγραφής στο cache εκθέτει επίσης νέες δυνατότητες. Μία από τις νέες δυνατότητες είναι υψηλή διαθεσιμότητα για τα δεδομένα στο cache. Αυτό σας βοηθά να διατηρήσετε δεδομένα στο cache εάν αποτύχει η έναν μεμονωμένο κόμβο διατηρώντας διπλότυπα αντίγραφα σε άλλους κόμβους.

Σημειώστε ότι υψηλή διαθεσιμότητα μειώνει μετάδοσης και αυξάνεται λανθάνων χρόνος λόγω της ενημέρωσης των στο δευτερεύον αντίγραφο σε εγγραφές. Εκτελεί επίσης το μέγεθος της μνήμης που χρησιμοποιείται για κάθε στοιχείο, επομένως, Σχεδιασμός για αυτό. Αυτό το συγκεκριμένο παράδειγμα δείχνει ότι κάθε εξαρτώμενη υπηρεσία μπορεί να έχει δυνατότητες που βελτιώνουν τη συνολική διαθεσιμότητα και την αντίσταση στην καταστροφική αποτυχίες.

Σε κάθε υπηρεσία εξαρτώμενα, θα πρέπει να κατανοήσετε τις επιπτώσεις όταν διαταραχή υπηρεσίας. Στο παράδειγμα σε cache, ίσως είναι δυνατή η πρόσβαση στα δεδομένα απευθείας από μια βάση δεδομένων, μέχρι να επαναφέρετε το cache. Αυτό θα ήταν μια λειτουργία υποβαθμίζονται όσον αφορά την απόδοση αλλά θα παρέχει πλήρη λειτουργικότητα όσον αφορά τα δεδομένα.

###<a name="region-wide-service-disruption"></a>Διακοπή υπηρεσίας ολόκληρη την περιοχή

Η προηγούμενη αποτυχίες έχουν κυρίως σφάλματα που μπορεί να γίνει διαχείριση μέσα στην ίδια περιοχή Azure. Ωστόσο, πρέπει επίσης να ετοιμάσετε για την πιθανότητα ότι υπάρχει διαταραχή υπηρεσίας από ολόκληρη την περιοχή. Εάν παρουσιαστεί διαταραχή υπηρεσίας ολόκληρη την περιοχή, τα πλεονάζοντα τοπικά αντίγραφα των δεδομένων σας δεν είναι διαθέσιμες. Εάν έχετε ενεργοποιήσει το παν αναπαραγωγής, υπάρχουν τρία πρόσθετα αντίγραφα των αντικειμένων blob και πίνακες σε διαφορετική περιοχή. Εάν Microsoft δηλώνει την περιοχή χαθεί, Azure αντιστοιχίζει ξανά τις όλες τις εγγραφές DNS στην περιοχή αναπαραχθούν παν.

>[AZURE.NOTE] Πρέπει να γνωρίζετε ότι δεν έχετε κανένα στοιχείο ελέγχου πάνω από αυτήν τη διαδικασία και αυτό θα συμβεί μόνο για διακοπή υπηρεσίας ολόκληρη την περιοχή. Αυτόν το λόγο, θα πρέπει να βασίζεστε στη άλλες στρατηγικές δημιουργίας αντιγράφων ασφαλείας συγκεκριμένη εφαρμογή για να επιτύχετε το υψηλότερο επίπεδο διαθεσιμότητας. Για περισσότερες πληροφορίες, ανατρέξτε στην ενότητα σε [δεδομένα στρατηγικές για την αποκατάσταση](#data-strategies-for-disaster-recovery).

###<a name="azure-wide-service-disruption"></a>Διακοπή υπηρεσίας όλο το Azure

Στον προγραμματισμό από καταστροφή, πρέπει να σκεφτείτε ολόκληρη την περιοχή των πιθανών καταστροφές. Ένα από τα πιο σοβαρά διακοπές υπηρεσίας συνεπάγεται όλες τις περιοχές Azure ταυτόχρονα. Όπως και με άλλες διακοπές υπηρεσίας, μπορείτε να αποφασίσετε ότι θα διαρκέσει στην περίπτωση τον κίνδυνο προσωρινό χρόνου εκτός λειτουργίας. Διακοπές ευρεία υπηρεσίας που εκτείνονται σε περιοχές, πρέπει να είναι πολύ πιο σπάνιες από διακοπές απομόνωσης υπηρεσίας που αφορούν εξαρτώμενες υπηρεσίες ή μόνο τις περιοχές.

Ωστόσο, για ορισμένες εφαρμογές κρίσιμης σημασίας, μπορεί να αποφασίσετε ότι πρέπει να υπάρχει ένα σχέδιο δημιουργίας αντιγράφων ασφαλείας για αυτό το σενάριο. Ενδέχεται να περιλαμβάνουν το πρόγραμμα για αυτό το συμβάν αποτυγχάνει μέσω με τις υπηρεσίες σε μια [εναλλακτική cloud](#alternative-cloud) ή μια [υβριδική εσωτερικής εγκατάστασης και cloud λύση](#hybrid-on-premises-and-cloud-solution).

###<a name="degraded-application-functionality"></a>Λειτουργίες υποβαθμίζονται εφαρμογής

Ένα καλά σχεδιασμένο εφαρμογής συνήθως χρησιμοποιεί μια συλλογή από λειτουργικές μονάδες που επικοινωνούν μεταξύ τους μέσω την εφαρμογή μοτίβων ευελιξία τα συνδεδεμένα ανταλλαγή πληροφοριών. Μια εφαρμογή φιλικούς προς DR απαιτεί διαχωρισμό των εργασιών στο επίπεδο της λειτουργικής μονάδας. Πρόκειται για να αποτρέψετε τη διακοπή της υπηρεσίας εξαρτάται από μεταφέρετε προς τα κάτω ολόκληρη την εφαρμογή. Για παράδειγμα, εξετάστε το ενδεχόμενο commerce εφαρμογής web για την εταιρεία Y. Οι παρακάτω λειτουργικές μονάδες μπορεί να αποτελούν την εφαρμογή:

 * __Κατάλογο προϊόντων__ επιτρέπει στους χρήστες για να αναζητήσετε προϊόντα.
 * __Καλάθι αγορών__ επιτρέπει στους χρήστες να Προσθαφαίρεση προϊόντα στο καλάθι αγορών τους.
 * __Κατάσταση σειρά__ εμφανίζει την κατάσταση αποστολής παραγγελιών χρήστη.
 * __Υποβολή παραγγελίας__ finalizes την περίοδο λειτουργίας αγορών με την υποβολή της σειράς με πληρωμή.
 * __Επεξεργασία εντολής__ επαληθεύει τη σειρά για ακεραιότητας δεδομένων και εκτελεί έναν έλεγχο διαθεσιμότητα ποσότητας.

Όταν μια εξαρτάται από μια λειτουργική μονάδα σε αυτήν την εφαρμογή μεταβαίνει προς τα κάτω, τον τρόπο τη λειτουργική μονάδα λειτουργίας μέχρι να ανακτά αυτό το τμήμα; Ένα καλά αναθεωρημένη αρχιτεκτονική σύστημα υλοποιεί όρια απομόνωσης μέσω διαχωρισμού εργασίες τόσο κατά τη σχεδίαση και κατά το χρόνο εκτέλεσης. Μπορείτε να κατηγοριοποιήσετε κάθε αποτυχία ως ανακτήσιμα και μη ανακτήσιμων. Μη ανακτήσιμα σφάλματα θα διαρκέσει προς τα κάτω τη λειτουργική μονάδα, αλλά μπορείτε να μετριασμός μια επανορθώσιμο σφάλμα μέσω εναλλακτικές λύσεις. Όπως περιγράφεται στην ενότητα υψηλής διαθεσιμότητας, μπορείτε να αποκρύψετε ορισμένα ζητήματα από χρήστες, χειρισμού σφαλμάτων και κρατώντας εναλλακτική ενέργειες. Κατά τη διάρκεια πιο σοβαρά διαταραχή υπηρεσίας, η εφαρμογή μπορεί να είναι πλήρως διαθέσιμες. Ωστόσο, μια τρίτη επιλογή είναι να συνεχίσετε τη συντήρηση χρήστες σε κατάσταση λειτουργίας υποβαθμίζονται.

Για παράδειγμα, εάν η βάση δεδομένων για τη φιλοξενία παραγγελίες μεταβαίνει προς τα κάτω, τη λειτουργική μονάδα επεξεργασία εντολής χάνει τη δυνατότητα να επεξεργαστεί συναλλαγές πωλήσεων. Ανάλογα με την αρχιτεκτονική, μπορεί να είναι δύσκολο ή αδύνατη για την υποβολή παραγγελίας και επεξεργασία εντολής τμήματα της εφαρμογής για να συνεχίσετε. Εάν η εφαρμογή δεν έχει σχεδιαστεί για το χειρισμό αυτό το σενάριο, ολόκληρη την εφαρμογή μπορεί να εργαστείτε χωρίς σύνδεση.

Ωστόσο, σε αυτό το σενάριο ίδια, είναι δυνατό ότι τα δεδομένα του προϊόντος είναι αποθηκευμένη σε διαφορετική θέση. Σε αυτή την περίπτωση, τη λειτουργική μονάδα κατάλογο προϊόντων εξακολουθεί να μπορεί να χρησιμοποιηθεί για την προβολή προϊόντα. Στη λειτουργία υποβαθμίζονται, η εφαρμογή εξακολουθεί να είναι διαθέσιμες σε χρήστες για τις διαθέσιμες λειτουργίες όπως προβολή του καταλόγου προϊόντων. Άλλα τμήματα της εφαρμογής, ωστόσο, δεν είναι διαθέσιμες, όπως η ταξινόμηση ή απόθεμα ερωτήματα.

Μια άλλη παραλλαγή των κέντρων υποβαθμίζονται λειτουργία σε επιδόσεων και όχι δυνατότητες. Για παράδειγμα, εξετάστε το ενδεχόμενο να ένα σενάριο όπου θα αποθηκευτεί προσωρινά τον κατάλογο προϊόντων μέσω του Azure Redis Cache. Εάν δεν είναι διαθέσιμη σε cache, η εφαρμογή ενδέχεται να μεταβείτε απευθείας το χώρο αποθήκευσης στο διακομιστή για να ανακτήσετε πληροφορίες προϊόντος στον κατάλογο. Αλλά αυτή η access ενδέχεται να είναι μικρότερη από την έκδοση στο cache. Αυτόν το λόγο, οι επιδόσεις εφαρμογής υποβιβάζεται μέχρι να ολοκληρωθεί η επαναφορά της υπηρεσίας σε cache.

Αποφασίζετε πόσα μιας εφαρμογής θα συνεχίσουν να συνάρτηση στη λειτουργία υποβαθμίζονται είναι μιας επιχειρηματικής απόφασης και τεχνικές απόφαση. Η εφαρμογή πρέπει επίσης να καθορίσετε τον τρόπο για να ενημερώσετε τους χρήστες από το προσωρινά προβλήματα. Σε αυτό το παράδειγμα, η εφαρμογή ενδέχεται να επιτρέπει την προβολή προϊόντα και ακόμα και προσθέτοντάς τα στο καλάθι αγορών. Ωστόσο, όταν ο χρήστης επιχειρεί να πραγματοποιήσει αγορά, η εφαρμογή ειδοποιεί το χρήστη ότι η λειτουργική μονάδα πωλήσεων είναι προσωρινά μη προσβάσιμο. Δεν είναι ιδανική για τον πελάτη, αλλά αποτρέψει μη Διακοπή υπηρεσίας όλη την εφαρμογή.

##<a name="data-strategies-for-disaster-recovery"></a>Στρατηγικές δεδομένων για την αποκατάσταση

Χειρισμός σωστά δεδομένων είναι η πιο δύσκολες περιοχή για να λάβετε δεξιά σε οποιοδήποτε πρόγραμμα αποκατάστασης καταστροφής. Επαναφορά δεδομένων είναι επίσης το τμήμα της διαδικασίας αποκατάστασης που συνήθως διαρκεί περισσότερο χρόνο. Διαφορετικές επιλογές σε λειτουργίες υποβάθμιση έχει ως αποτέλεσμα δύσκολη προκλήσεις για την ανάκτηση δεδομένων από αποτυχία και τη συνέπεια μετά από αποτυχία.

Ένας από τους παράγοντες είναι χρειάζεστε για να επαναφέρετε ή να διατηρείτε ένα αντίγραφο των δεδομένων της εφαρμογής. Θα μπορείτε να χρησιμοποιήσετε αυτά τα δεδομένα για την αναφορά και σκοπούς συναλλαγών σε μια δευτερεύουσα τοποθεσία. Μια εσωτερική ρύθμιση απαιτεί μια διαδικασία ακριβό και μακροσκελείς προγραμματισμού για να εφαρμόσω στρατηγική αποκατάστασης από καταστροφή πολλών τοπικών. Εύκολη, οι περισσότερες υπηρεσίες παροχής cloud, συμπεριλαμβανομένων των Azure, εύκολα επιτρέπουν την ανάπτυξη εφαρμογών σε πολλές περιοχές. Αυτές οι περιοχές διανέμονται γεωγραφικά έτσι ότι Διακοπή υπηρεσίας πολλών τοπικών πρέπει να είναι πολύ σπάνια. Η στρατηγική για τη διαχείριση δεδομένων σε περιοχές είναι ένας από τους παράγοντες που συνεισφέρουν για την επιτυχία της οποιοδήποτε πρόγραμμα αποκατάστασης καταστροφής.

Οι παρακάτω ενότητες περιγράφουν τεχνικών αποκατάστασης από καταστροφή που σχετίζονται με αντίγραφα ασφαλείας δεδομένων, τα δεδομένα αναφοράς και συναλλαγών δεδομένων.

###<a name="backup-and-restore"></a>Δημιουργία αντιγράφων ασφαλείας και επαναφοράς

Τακτικής δημιουργίας αντιγράφων ασφαλείας των δεδομένων εφαρμογής μπορεί να υποστηρίζει ορισμένα σενάρια αποκατάστασης από καταστροφή. Διαφορετικό χώρο αποθήκευσης πόροι απαιτούν διαφορετικές τεχνικές.

Για τα επίπεδα Basic, τυπική και βάση δεδομένων SQL Premium, μπορείτε να επωφεληθείτε από επαναφορά σε δεδομένη χρονική στιγμή για να ανακτήσετε τη βάση δεδομένων. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Επισκόπηση: Cloud επιχειρήσεις συνέχειας και βάσεων δεδομένων αποκατάσταση με βάση δεδομένων SQL](../sql-database/sql-database-business-continuity.md). Μια άλλη επιλογή είναι να χρησιμοποιήσετε ενεργό παν-αναπαραγωγής για βάση δεδομένων SQL. Αυτό αυτόματα αναπαράγει αλλαγές της βάσης δεδομένων σε δευτερεύοντα βάσεις δεδομένων στην ίδια περιοχή Azure ή ακόμη και σε διαφορετική περιοχή Azure. Παρέχει μια πιθανή εναλλακτική λύση ορισμένες από τις πιο μη αυτόματη τεχνικές συγχρονισμού δεδομένων που παρουσιάζονται σε αυτό το άρθρο. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Επισκόπηση: SQL αναπαραγωγή βάσης δεδομένων Active παν-](../sql-database/sql-database-geo-replication-overview.md).

Επίσης, μπορείτε να χρησιμοποιήσετε μια πιο μη αυτόματη προσέγγιση για δημιουργία αντιγράφων ασφαλείας και να επαναφέρετε. Χρησιμοποιήστε την εντολή ΑΝΤΙΓΡΑΦΉ βάσης ΔΕΔΟΜΈΝΩΝ για να δημιουργήσετε ένα αντίγραφο της βάσης δεδομένων. Πρέπει να χρησιμοποιήσετε αυτήν την εντολή για να λάβετε ένα αντίγραφο ασφαλείας με συνέπεια συναλλαγών. Μπορείτε επίσης να χρησιμοποιήσετε την υπηρεσία εισαγωγή/εξαγωγή της βάσης δεδομένων SQL Azure. Αυτό υποστηρίζει εξαγωγής βάσεις δεδομένων σε BACPAC αρχεία που είναι αποθηκευμένα στο χώρο αποθήκευσης αντικειμένων Blob του Azure.

Η ενσωματωμένη πλεονασμού χώρου αποθήκευσης Azure δημιουργεί δύο αντίγραφα του αρχείου αντιγράφου ασφαλείας στην ίδια περιοχή. Ωστόσο, της συχνότητας των εκτελεί τη διαδικασία δημιουργίας αντιγράφων ασφαλείας καθορίζει το RPO, ποιο είναι το πλήθος των δεδομένων που ενδέχεται να χαθούν σε σενάρια καταστροφής. Για παράδειγμα, φανταστείτε ότι μπορείτε να δημιουργήσετε ένα αντίγραφο ασφαλείας στο επάνω μέρος της ώρας και μια καταστροφή πραγματοποιείται δύο λεπτά πριν από την αρχή της ώρας. Θα χάσετε 58 λεπτά των δεδομένων που έγινε μετά την εκτέλεση της τελευταίας δημιουργίας αντιγράφων ασφαλείας. Επίσης, να προστατευτώ από μια διακοπή υπηρεσίας ολόκληρη την περιοχή, θα πρέπει να αντιγράψετε τα αρχεία BACPAC μια εναλλακτική περιοχή. Στη συνέχεια, έχετε τη δυνατότητα να επαναφέρετε αυτά τα αντίγραφα ασφαλείας σε περιοχή εναλλακτική. Για περισσότερες λεπτομέρειες, ανατρέξτε στο θέμα [Επισκόπηση: Cloud επιχειρήσεις συνέχειας και βάσεων δεδομένων αποκατάσταση με βάση δεδομένων SQL](../sql-database/sql-database-business-continuity.md).

Για το χώρο αποθήκευσης Azure, μπορείτε να αναπτύξω το δικό σας προσαρμοσμένο διαδικασία δημιουργίας αντιγράφων ασφαλείας ή να χρησιμοποιήσετε ένα από τα πολλά εργαλεία δημιουργίας αντιγράφων ασφαλείας τρίτων κατασκευαστών. Σημειώστε ότι οι περισσότερες σχέδια εφαρμογής έχουν επιπλέον τις πολυπλοκότητες όπου πόρων αποθήκευσης αναφορά μεταξύ τους. Για παράδειγμα, εξετάστε το ενδεχόμενο μια βάση δεδομένων SQL που περιέχει μια στήλη που συνδέεται με ένα blob στο χώρο αποθήκευσης Azure. Εάν δεν συμβεί ταυτόχρονα τη δημιουργία αντιγράφων ασφαλείας, η βάση δεδομένων ενδέχεται να χρειαστεί το δείκτη του ποντικιού σε ένα blob που δεν δημιουργήθηκε αντίγραφο ασφαλείας πριν από την αποτυχία. Η εφαρμογή ή το πρόγραμμα αποκατάστασης καταστροφής πρέπει να υλοποιήσετε διαδικασίες για το χειρισμό αυτήν την ασυνέπεια μετά αποκατάστασης.

###<a name="reference-data-pattern-for-disaster-recovery"></a>Μοτίβο δεδομένων αναφοράς για αποκατάσταση

Τα δεδομένα αναφοράς είναι μόνο για ανάγνωση δεδομένων που υποστηρίζει λειτουργία της εφαρμογής. Αυτό συνήθως δεν αλλάζουν συχνά. Αν και δημιουργία αντιγράφων ασφαλείας και επαναφοράς είναι μία μέθοδος για να χειριστείτε διακοπές υπηρεσίας ολόκληρη την περιοχή, το RTO είναι σχετικά μεγάλων. Κατά την ανάπτυξη της εφαρμογής σε μια δευτερεύουσα περιοχή, ορισμένες στρατηγικές μπορεί να βελτιώσει την RTO για τα δεδομένα αναφοράς.

Επειδή η αναφορά τα δεδομένα αλλάζουν συχνά, μπορείτε να βελτιώσετε την RTO, διατηρώντας ένα μόνιμο αντίγραφο των δεδομένων αναφοράς στη δευτερεύουσα περιοχή. Αυτό καταργεί το χρόνο που απαιτείται για να επαναφέρετε αντίγραφα ασφαλείας σε περίπτωση μιας καταστροφής. Για να πληροί τις απαιτήσεις αποκατάστασης από καταστροφή πολλών τοπικών, πρέπει να αναπτύξετε την εφαρμογή και τα δεδομένα αναφοράς μαζί σε πολλές περιοχές. Όπως αναφέρεται στην [αναφορά μοτίβο δεδομένων για υψηλή διαθεσιμότητα](./resiliency-high-availability-azure-applications.md#reference-data-pattern-for-high-availability), μπορείτε να αναπτύξετε δεδομένων αναφοράς με το ρόλο μόνη της, σε εξωτερικό χώρο αποθήκευσης ή ένας συνδυασμός των δύο.

Το μοντέλο ανάπτυξης δεδομένων αναφοράς μέσα σε κόμβους υπολογιστικών ρητά ικανοποιεί τις απαιτήσεις αποκατάστασης από καταστροφή. Ανάπτυξη δεδομένων αναφοράς με βάση δεδομένων SQL απαιτεί αναπτύξετε ένα αντίγραφο των δεδομένων αναφοράς για κάθε περιοχή. Η ίδια στρατηγική ισχύει για το χώρο αποθήκευσης Azure. Πρέπει να αναπτύξετε ένα αντίγραφο της αναφοράς δεδομένα που είναι αποθηκευμένα στο χώρο αποθήκευσης Azure στις περιοχές κύριας και δευτερεύουσας.

![Δημοσίευση δεδομένων αναφοράς σε κύριες και δευτερεύουσες περιοχές](./media/resiliency-disaster-recovery-azure-applications/reference-data-publication-to-both-primary-and-secondary-regions.png)

Πρέπει να μπορείτε να εφαρμόσετε τις δικές σας διαδικασίες δημιουργίας αντιγράφων ασφαλείας συγκεκριμένη εφαρμογή για όλα τα δεδομένα, συμπεριλαμβανομένων των δεδομένων αναφοράς. Αναπαραγωγή παν αντίγραφα σε περιοχές που χρησιμοποιούνται μόνο σε μια διακοπή υπηρεσίας ολόκληρη την περιοχή. Για να αποτρέψετε παρατεταμένο χρόνο εκτός λειτουργίας, αναπτύξτε τα κρίσιμης σημασίας τμήματα των δεδομένων της εφαρμογής στην περιοχή δευτερεύουσα. Για ένα παράδειγμα της τοπολογίας αυτό, ανατρέξτε στο θέμα το [μοντέλο παθητικές ενεργό](#active-passive).

###<a name="transactional-data-pattern-for-disaster-recovery"></a>Μοτίβο συναλλαγών δεδομένων για αποκατάσταση

Εφαρμογή της στρατηγικής λειτουργία πλήρως λειτουργικό καταστροφής απαιτεί ασύγχρονης αναπαραγωγή των συναλλαγών δεδομένων στην περιοχή δευτερεύουσα. Τα πρακτικά των windows μέσα στην οποία μπορεί να προκύψουν η αναπαραγωγή θα καθορίσει τα χαρακτηριστικά RPO της εφαρμογής. Ενδέχεται να μπορείτε να ανακτήσετε τα δεδομένα που έχει χαθεί από την κύρια περιοχή κατά τη διάρκεια του παραθύρου αναπαραγωγής εξακολουθεί να. Μπορείτε επίσης ίσως να συγχωνεύσετε με τη δευτερεύουσα περιοχή αργότερα.

Τα παρακάτω παραδείγματα αρχιτεκτονική παρέχουν ορισμένες ιδέες σχετικά με διαφορετικούς τρόπους χειρισμού συναλλαγών δεδομένων σε ένα σενάριο ανακατεύθυνσης. Είναι σημαντικό να θυμάστε ότι αυτά τα παραδείγματα δεν είναι εκτεταμένη. Για παράδειγμα, θέσεις αποθήκευσης ενδιάμεσου όπως ουρές μπορεί να αντικατασταθεί με βάση δεδομένων SQL Azure. Οι ουρές τον εαυτό τους μπορεί να είναι αποθήκευσης Azure ή Azure Service Bus ουρές (ανατρέξτε στο θέμα [Azure ουρές και και υπηρεσία Bus--σε σύγκριση και υπενθύμισης και χρωματικές](../service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted.md)). Προορισμούς χώρο αποθήκευσης στο διακομιστή μπορεί να επίσης διαφέρουν, όπως οι πίνακες αντί για βάση δεδομένων SQL Azure. Επιπλέον, οι ρόλοι εργαζόμενου μπορεί να εισαχθεί ως διαμεσολάβησης στο διάφορα βήματα. Σημαντικό είναι όχι, για να προσομοιώσετε αυτές τις αρχιτεκτονικές ακριβώς, αλλά πρέπει να λάβετε υπόψη διάφορες εναλλακτικές λύσεις αποκατάστασης συναλλαγών δεδομένων και σχετικές λειτουργικές μονάδες.

####<a name="replication-of-transactional-data-in-preparation-for-disaster-recovery"></a>Αναπαραγωγή δεδομένων συναλλαγών σε προετοιμασίας για αποκατάσταση

Εξετάστε το ενδεχόμενο μια εφαρμογή που χρησιμοποιούν ουρές Azure χώρου αποθήκευσης για τη διατήρηση δεδομένων συναλλαγών. Αυτό σας επιτρέπει εργαζόμενου ρόλους για την επεξεργασία των συναλλαγών δεδομένων στη βάση δεδομένων του διακομιστή σε οι αποσυνδεδεμένοι αρχιτεκτονική. Αυτό απαιτεί οι συναλλαγές για να χρησιμοποιήσετε κάποια μορφή προσωρινό σε cache εάν οι ρόλοι προσκηνίου απαιτούν το ερώτημα άμεση αυτών των δεδομένων. Ανάλογα με το επίπεδο της ανοχή απώλεια δεδομένων, μπορείτε να επιλέξετε να αναπαραγάγετε το ουρές, τη βάση δεδομένων ή όλους τους πόρους του χώρου αποθήκευσης. Με μόνο αναπαραγωγή βάσης δεδομένων, εάν η κύρια περιοχή μεταβαίνει προς τα κάτω, μπορείτε να το επαναφέρετε τα δεδομένα στις ουρές όταν η κύρια περιοχή ξανά.

Το παρακάτω διάγραμμα παρουσιάζει μια αρχιτεκτονική όπου η βάση δεδομένων διακομιστή συγχρονίζεται σε περιοχές.

![Αναπαραγωγή δεδομένων συναλλαγών σε προετοιμασίας για αποκατάσταση](./media/resiliency-disaster-recovery-azure-applications/replicate-transactional-data-in-preparation-for-disaster-recovery.png)

Το δύσκολο μεγαλύτερων την υλοποίηση αυτήν την αρχιτεκτονική είναι η στρατηγική αλληλεπίδραση μεταξύ περιοχών. Η υπηρεσία συγχρονισμού δεδομένων SQL Azure επιτρέπει αυτόν τον τύπο της αναπαραγωγής. Ωστόσο, η υπηρεσία εξακολουθεί να βρίσκεται σε προεπισκόπηση και δεν συνιστάται για περιβάλλοντα παραγωγής. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Επισκόπηση: Cloud επιχειρήσεις συνέχειας και βάσεων δεδομένων αποκατάσταση με βάση δεδομένων SQL](../sql-database/sql-database-business-continuity.md). Για εφαρμογές παραγωγής, πρέπει να αφιερώσει σε μια λύση άλλου κατασκευαστή ή να δημιουργήσετε το δικό σας λογική αναπαραγωγής στον κώδικα. Ανάλογα με την αρχιτεκτονική, η αναπαραγωγή μπορεί να είναι διπλής κατεύθυνσης, που είναι επίσης πιο σύνθετες.

Ένας πιθανά εφαρμογή μπορεί να χρησιμοποιήσει της ενδιάμεσου ουράς στο προηγούμενο παράδειγμα. Το ρόλο εργαζόμενου που επεξεργάζεται τα δεδομένα στον προορισμό τελική αποθήκευση μπορεί να κάνετε την αλλαγή τόσο στην κύρια περιοχή και τη δευτερεύουσα περιοχή. Δεν υπάρχουν trivial εργασίες και ολοκλήρωσης καθοδήγηση για αναπαραγωγή κωδικό είναι πέρα από το πεδίο αυτού του άρθρου. Το σημαντικό σημείο που είναι πολύ χρόνο σας και δοκιμές θα πρέπει να εστιάσετε σε πώς μπορείτε να αναπαραγάγετε τα δεδομένα σας στην περιοχή δευτερεύουσα. Επιπλέον επεξεργασίας και έλεγχος μπορεί να σας βοηθήσει να εξασφαλίσετε ότι οι διαδικασίες ανακατεύθυνσης και αποκατάστασης χειρίζεται σωστά τυχόν ασυνέπειες πιθανές δεδομένων ή διπλότυπων συναλλαγές.

>[AZURE.NOTE] Πιο αυτού του εγγράφου εστιάζει σε πλατφόρμα ως υπηρεσία (PaaS). Ωστόσο, πρόσθετες επιλογές αναπαραγωγής και τη διαθεσιμότητα για τις εφαρμογές του υβριδικού χρησιμοποιεί εικονικές μηχανές Windows Azure. Αυτές οι εφαρμογές υβριδική Χρησιμοποιήστε υποδομής ως υπηρεσία (IaaS) για τη φιλοξενία του SQL Server σε εικονικές μηχανές στο Azure. Αυτό σας επιτρέπει προσεγγίσεις παραδοσιακή διαθεσιμότητα στον SQL Server, όπως ομάδες διαθεσιμότητας AlwaysOn ή αποστολή αρχείου καταγραφής. Ορισμένες τεχνικές, όπως AlwaysOn, λειτουργούν μόνο μεταξύ παρουσιών SQL Server εσωτερικής εγκατάστασης και του Azure εικονικές μηχανές. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Υψηλή διαθεσιμότητα και την αποκατάσταση για τον SQL Server σε εικονικές μηχανές Windows Azure](../virtual-machines/virtual-machines-windows-sql-high-availability-dr.md).

####<a name="degraded-application-mode-for-transaction-capture"></a>Λειτουργία υποβαθμίζονται εφαρμογής για καταγραφής συναλλαγών

Εξετάστε το ενδεχόμενο μια δεύτερη αρχιτεκτονική που λειτουργεί σε κατάσταση λειτουργίας υποβαθμίζονται. Η εφαρμογή τη δευτερεύουσα περιοχή απενεργοποιεί όλες τις λειτουργίες του, όπως η δημιουργία αναφορών, επιχειρηματικής ευφυΐας (BI), ή αποστράγγιση ουρές. Να δέχεται μόνο οι πιο σημαντικές τύποι συναλλαγών ροές εργασίας, όπως ορίζεται από επιχειρησιακές απαιτήσεις. Το σύστημα καταγράφει τις συναλλαγές και τις γράφει ουρές. Το σύστημα να αναβάλετε την επεξεργασία των δεδομένων κατά το αρχικό στάδιο του τη διακοπή της υπηρεσίας. Εάν ενεργοποιηθεί ξανά το σύστημα στην κύρια περιοχή μέσα στο παράθυρο αναμενόμενο χρονικό διάστημα, οι ρόλοι εργαζόμενου στην κύρια περιοχή εξαντλούνται τις ουρές. Η διαδικασία αυτή καταργεί την ανάγκη για τη συγχώνευση βάσης δεδομένων. Εάν τη διακοπή της υπηρεσίας κύρια περιοχή μεταβαίνει πέρα από το παράθυρο ανεκτός, η εφαρμογή να ξεκινήσετε επεξεργασίας τις ουρές.

Σε αυτό το σενάριο, τη βάση δεδομένων σε τη δευτερεύουσα περιέχει αυξάνονται συναλλαγών δεδομένα που πρέπει να συγχωνευτούν Αφού ενεργοποιηθεί ξανά την κύρια. Το παρακάτω διάγραμμα παρουσιάζει αυτήν τη στρατηγική για προσωρινά την αποθήκευση δεδομένων συναλλαγών, μέχρι να είναι δυνατή η επαναφορά στην κύρια περιοχή.

![Λειτουργία υποβαθμίζονται εφαρμογής για καταγραφής συναλλαγών](./media/resiliency-disaster-recovery-azure-applications/degraded-application-mode-for-transaction-capture.png)

Για περαιτέρω ανάλυση των τεχνικών διαχείρισης δεδομένων για εφαρμογές που είναι ανθεκτικά Azure, ανατρέξτε στο θέμα [συστοιχίας: καθοδήγηση για είναι ανθεκτικά αρχιτεκτονικές Cloud](https://channel9.msdn.com/Series/FailSafe).

##<a name="deployment-topologies-for-disaster-recovery"></a>Ανάπτυξη τοπολογίες για αποκατάσταση

Πρέπει να προετοιμάσετε κρίσιμης σημασίας εφαρμογές για την πιθανότητα των διαταραχή υπηρεσίας ολόκληρη την περιοχή. Μπορείτε να το κάνετε αυτό ενσωματώνοντας μια στρατηγική ανάπτυξης πολλών τοπικών στη λειτουργικές προγραμματισμού.

Αναπτύξεις πολλών τοπικών ενδέχεται να περιλαμβάνουν IT pro διαδικασίες για να δημοσιεύσετε την εφαρμογή και αναφοράς δεδομένων στην περιοχή δευτερεύουσα μετά από μια καταστροφή. Εάν η εφαρμογή απαιτεί άμεση ανακατεύθυνσης, η διαδικασία ανάπτυξης μπορεί να περιλαμβάνει μια ρύθμιση ενεργό/παθητικές ή μια εγκατάσταση ενεργή/ενεργή. Αυτός ο τύπος της ανάπτυξης έχει υπάρχουσες εμφανίσεις της εφαρμογής που εκτελούνται στην εναλλακτική περιοχή. Δρομολόγηση εργαλείου όπως Azure κίνηση Manager παρέχει υπηρεσίες εξισορρόπησης φόρτου στο επίπεδο DNS. Να εντοπίσει διακοπές υπηρεσίας και δρομολόγηση τους χρήστες σε διαφορετικές περιοχές, όταν χρειάζεται.

Τμήμα του επιτυχής Azure Αποκατάσταση Εξειδικευμένος που αποκατάστασης σε της λύσης από την αρχή. Στο cloud παρέχει πρόσθετες επιλογές για την ανάκτηση από αποτυχίες κατά τη διάρκεια μιας καταστροφής που δεν είναι διαθέσιμες σε μια παραδοσιακή υπηρεσία παροχής φιλοξενίας. Συγκεκριμένα, μπορεί να γρήγορα και δυναμικά ανάθεση πόρων σε διαφορετική περιοχή. Επομένως, δεν θα πληρώνετε πολύ για τους πόρους που είναι σε αδράνεια ενώ περιμένετε για μια αποτυχία προκύψει.

Οι παρακάτω ενότητες καλύπτει τοπολογίες διαφορετικό ανάπτυξης για αποκατάσταση. Συνήθως, υπάρχει ανταλλαγή σε αυξημένο κόστος ή πολυπλοκότητα για επιπλέον διαθεσιμότητα.

###<a name="single-region-deployment"></a>Ανάπτυξη μίας περιοχής

Μια ανάπτυξη μίας περιοχής δεν είναι πραγματικά μια τοπολογία αποκατάστασης από καταστροφή, αλλά προορίζεται σε αντίθεση με το άλλες αρχιτεκτονικές. Αναπτύξεις μίας περιοχής είναι κοινά για τις εφαρμογές στο Azure. Ωστόσο, αυτός ο τύπος ανάπτυξης δεν είναι μια σοβαρές contender για ένα πρόγραμμα αποκατάστασης καταστροφής.

Το παρακάτω διάγραμμα απεικονίζει μια εφαρμογή που εκτελείται σε μία μόνο περιοχή Azure. Azure Manager την κυκλοφορία και τη χρήση των σφαλμάτων και αναβάθμιση τομείς αύξηση διαθεσιμότητα της εφαρμογής στο εσωτερικό της περιοχής.

![Ανάπτυξη μίας περιοχής](./media/resiliency-disaster-recovery-azure-applications/single-region-deployment.png)

Εδώ, είναι σαφές ότι η βάση δεδομένων είναι ένα μοναδικό σημείο αποτυχίας. Παρόλο που τα Azure αναπαράγει τα δεδομένα σε διαφορετικές σφαλμάτων τομείς στο εσωτερικό αντίγραφα, όλα αυτά παρουσιάζεται στην ίδια περιοχή. Η εφαρμογή είναι δυνατό να μεταδοθούν καταστροφική αστοχία. Εάν η περιοχή μεταβαίνει προς τα κάτω, όλους τους τομείς σφαλμάτων μεταβείτε προς τα κάτω--συμπεριλαμβανομένων όλων των παρουσιών της υπηρεσίας και τους πόρους αποθήκευσης.

Για όλα εκτός από τις εφαρμογές λιγότερο κρίσιμο, πρέπει να έχει σχεδιάσει ένα σχέδιο για να αναπτύξετε τις εφαρμογές σας σε πολλές περιοχές. Θα πρέπει επίσης, εξετάστε το ενδεχόμενο να RTO και κόστος τους περιορισμούς κατά την εξέταση των τοπολογία ανάπτυξης για να χρησιμοποιήσετε.

Ας ρίξουμε μια ματιά τώρα συγκεκριμένα μοτίβα για την υποστήριξη ανακατεύθυνσης σε διαφορετικές περιοχές. Όλα αυτά τα παραδείγματα χρησιμοποιούν δύο περιοχές για την περιγραφή της διαδικασίας.

###<a name="redeployment-to-a-secondary-azure-region"></a>Επανάληψη ανάπτυξης σε δευτερεύουσα περιοχή Azure

Ακολουθώντας το μοτίβο επανάληψη ανάπτυξης σε μια δευτερεύουσα περιοχή, μόνο η κύρια περιοχή έχει εφαρμογές και βάσεις δεδομένων που εκτελείται. Η δευτερεύουσα περιοχή δεν έχει ρυθμιστεί για αυτόματη ανακατεύθυνση. Επομένως, όταν παρουσιάζεται μια καταστροφή, που πρέπει να περιστραφεί όλα τα τμήματα της υπηρεσίας με τη νέα περιοχή. Αυτό περιλαμβάνει αποστολή μια υπηρεσία cloud Azure, την ανάπτυξη την υπηρεσία cloud, η επαναφορά των δεδομένων και αλλαγή DNS για να κάνετε αναδρομολόγηση την κυκλοφορία.

Παρόλο που αυτή είναι η πιο οικονομική από τις επιλογές πολλών τοπικών, που έχει τα χαρακτηριστικά RTO χειρότερες. Σε αυτό το μοντέλο, αποθηκεύονται τα αντίγραφα ασφαλείας πακέτου και βάσης δεδομένων υπηρεσιών είτε στην εσωτερική εγκατάσταση ή στην παρουσία χώρο αποθήκευσης αντικειμένων Blob του Azure από τη δευτερεύουσα περιοχή. Ωστόσο, πρέπει να αναπτύξετε μια νέα υπηρεσία και να επαναφέρετε τα δεδομένα, πριν να ισχύει η λειτουργία. Ακόμα και αν πλήρως αυτοματοποιήσετε τη μεταφορά δεδομένων από το χώρο αποθήκευσης αντιγράφων ασφαλείας, περιστροφή του περιβάλλοντος του νέα βάση δεδομένων καταναλώνει πολύ χρόνο. Η μετακίνηση δεδομένων από το χώρο αποθήκευσης στο δίσκο αντιγράφου ασφαλείας στην κενή βάση δεδομένων τη δευτερεύουσα περιοχή είναι η πιο ακριβό μέρος της διαδικασίας επαναφοράς. Πρέπει να κάνετε αυτό, ωστόσο, για να εμφανίσετε τη νέα βάση δεδομένων σε κατάσταση λειτουργίας, επειδή δεν έχει γίνει αναπαραγωγή.

Ο καλύτερος τρόπος είναι να αποθηκεύει τα πακέτα υπηρεσιών στο χώρο αποθήκευσης αντικειμένων Blob στη δευτερεύουσα περιοχή. Αυτό καταργεί την ανάγκη για να αποστείλετε το πακέτο στο Azure, η οποία είναι τι συμβαίνει όταν αναπτύσσετε από έναν υπολογιστή ανάπτυξης εσωτερικής εγκατάστασης. Μπορείτε γρήγορα να αναπτύξετε τα πακέτα υπηρεσιών σε μια νέα υπηρεσία cloud από το χώρο αποθήκευσης αντικειμένων Blob με τη χρήση δεσμών ενεργειών του PowerShell.

Αυτή η επιλογή είναι πρακτικό μόνο για μη κρίσιμα εφαρμογές που μπορεί να αποδεχτεί τις μια υψηλή RTO. Για παράδειγμα, αυτό μπορεί να λειτουργεί για μια εφαρμογή που μπορεί να είναι προς τα κάτω για μερικές ώρες, αλλά θα πρέπει να εκτελεί ξανά μέσα σε 24 ώρες.

![Επανάληψη ανάπτυξης σε δευτερεύουσα περιοχή Azure](./media/resiliency-disaster-recovery-azure-applications/redeploy-to-a-secondary-azure-region.png)

###<a name="active-passive"></a>Ενεργό παθητικές

Το μοτίβο ενεργό παθητικές είναι η επιλογή που προτιμήσει πολλές εταιρείες. Αυτό το μοτίβο παρέχει βελτιώσεις για την RTO με σχετικά μικρό αύξηση στο κόστος πάνω από το μοτίβο επανάληψη ανάπτυξης.
Σε αυτό το σενάριο, υπάρχει ξανά μια κύρια και μια δευτερεύουσα περιοχή Azure. Όλη την κυκλοφορία Μετάβαση ενεργό ανάπτυξης στην κύρια περιοχή. Τη δευτερεύουσα περιοχή καλύτερα είναι έτοιμη για αποκατάσταση, επειδή η βάση δεδομένων εκτελείται σε δύο περιοχές. Επιπλέον, ένας μηχανισμός συγχρονισμού είναι στη θέση μεταξύ τους. Αυτή η προσέγγιση αναμονής μπορούν να περιλαμβάνουν δύο παραλλαγές: μια προσέγγιση μόνο για βάση δεδομένων ή μια πλήρη ανάπτυξη στη δευτερεύουσα περιοχή.

####<a name="database-only"></a>Μόνο σε βάσεις δεδομένων

Στο την πρώτη παραλλαγή του μοτίβου ενεργό παθητικές, μόνο την κύρια περιοχή έχει μιας εφαρμογής υπηρεσίας ανεπτυγμένος cloud. Ωστόσο, σε αντίθεση με το μοτίβο επανάληψη ανάπτυξης, δύο περιοχές συγχρονίζονται με το περιεχόμενο της βάσης δεδομένων. (Για περισσότερες πληροφορίες, ανατρέξτε στην ενότητα σε [μοτίβο συναλλαγών δεδομένων για αποκατάσταση](#transactional-data-pattern-for-disaster-recovery).) Όταν προκύπτει μια καταστροφή, υπάρχουν λιγότερες απαιτήσεις ενεργοποίησης. Εκκινήστε την εφαρμογή στη δευτερεύουσα περιοχή, αλλαγή συμβολοσειρές σύνδεσης στη νέα βάση δεδομένων και να αλλάξετε τις εγγραφές DNS για να κάνετε αναδρομολόγηση κίνηση.

Όπως το μοτίβο επανάληψη ανάπτυξης, θα πρέπει να έχετε ήδη αποθηκεύσει τα πακέτα υπηρεσιών στο χώρο αποθήκευσης αντικειμένων Blob του Azure στη δευτερεύουσα περιοχή για ταχύτερη ανάπτυξη. Σε αντίθεση με το μοτίβο επανάληψη ανάπτυξης, δεν λαμβάνετε το μεγαλύτερο μέρος των το επιβάρυνσης που απαιτεί η λειτουργία Επαναφορά βάσης δεδομένων. Η βάση δεδομένων είναι έτοιμο και εκτελείται. Αυτό αποθηκεύει μια σημαντική χρονικό διάστημα, καθιστώντας αυτό ένα μοτίβο οικονομική DR. Επίσης, είναι τα πιο δημοφιλή μοτίβο DR.

![Μόνο σε βάσεις δεδομένων ενεργό-παθητικές,](./media/resiliency-disaster-recovery-azure-applications/active-passive-database-only.png)

####<a name="full-replica"></a>Πλήρη ρεπλίκα

Στο δεύτερο παραλλαγή του μοτίβου παθητικές ενεργό, στην περιοχή κύρια και τη δευτερεύουσα περιοχή έχουν μια πλήρη ανάπτυξη. Αυτή η ανάπτυξη περιλαμβάνει τις υπηρεσίες cloud και συγχρονισμένη βάσης δεδομένων. Ωστόσο, μόνο τα κύρια περιοχή είναι ενεργά χειρισμού αιτήσεων δικτύου από τους χρήστες. Η δευτερεύουσα περιοχή γίνεται ενεργό μόνο όταν η κύρια περιοχή έχει μια διακοπή υπηρεσίας. Σε αυτή την περίπτωση, όλες οι νέες αιτήσεις δικτύου δρομολόγησης για τη δευτερεύουσα περιοχή. Azure Manager κίνηση για να διαχειριστείτε αυτόματα αυτό ανακατεύθυνσης.

Ανακατεύθυνση προκύπτει ταχύτερα από την παραλλαγή μόνο για βάση δεδομένων, επειδή είναι ήδη αναπτύξει τις υπηρεσίες. Αυτό το μοτίβο παρέχει ένα πολύ χαμηλή RTO. Στην περιοχή δευτερεύουσα ανακατεύθυνσης πρέπει να είστε έτοιμοι να ξεκινήσετε αμέσως μετά την αποτυχία της στην κύρια περιοχή.

Μαζί με μια ταχύτερη χρόνο απόκρισης, αυτό το μοτίβο έχει το πλεονέκτημα της προ-εκχώρηση και ανάπτυξη υπηρεσίες δημιουργίας αντιγράφων ασφαλείας. Δεν χρειάζεται να ανησυχείτε για μια περιοχή που δεν έχουν το χώρο που θα εκχωρηθεί νέες παρουσίες σε μια καταστροφή. Αυτό είναι σημαντικό εάν τη δευτερεύουσα περιοχή Azure είναι nearing χωρητικότητα. Δεν υπάρχει εγγύηση (συμφωνία σε επίπεδο εξυπηρέτησης) που θα αμέσως μπορέσετε να αναπτύξετε ένα πλήθος νέων υπηρεσιών cloud σε κάθε περιοχή.

Για τον ταχύτερο χρόνο απόκρισης με αυτό το μοντέλο, πρέπει να έχετε παρόμοια κλίμακα (αριθμός των παρουσιών ρόλο) στις περιοχές κύριας και δευτερεύουσας. Παρά τα πλεονεκτήματα, πληρώνετε για παρουσίες που δεν χρησιμοποιούνται υπολογισμού είναι κοστίζουν και αυτό ενδέχεται να μην είναι η πιο συνετή οικονομικών επιλογή. Αυτόν το λόγο, είναι πιο συνηθισμένο να χρησιμοποιήσετε μια έκδοση ελαφρώς κλιμάκωση προς τα κάτω από τις υπηρεσίες cloud τη δευτερεύουσα περιοχή. Στη συνέχεια, να γρήγορα ανακατευθύνει και διαβάθμιση δευτερεύοντα ανάπτυξη της εάν είναι απαραίτητο. Θα πρέπει να μπορείτε να αυτοματοποιήσετε τη διαδικασία ανακατεύθυνσης, ώστε να μετά την κύρια περιοχή δεν είναι προσβάσιμη, μπορείτε να ενεργοποιήσετε τις πρόσθετες εμφανίσεις, ανάλογα με τη φόρτωση. Αυτό μπορεί να περιλαμβάνει τη χρήση ενός μηχανισμού autoscaling όπως [σύνολα εικονική μηχανή κλίμακα](../virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md).

Το παρακάτω διάγραμμα παρουσιάζει το μοντέλο όπου τις περιοχές κύριας και δευτερεύουσας περιέχουν μια υπηρεσία cloud πλήρως ανεπτυγμένος σε ένα μοτίβο παθητικές ενεργό.

![Ενεργό παθητικές, πλήρους αντιγράφου](./media/resiliency-disaster-recovery-azure-applications/active-passive-full-replica.png)

###<a name="active-active"></a>Ενεργούς

Από τώρα, που πιθανώς Κατανόηση την εξέλιξη των τα μοτίβα: μείωση του RTO αυξάνεται κόστους και της πολυπλοκότητάς τους. Η λύση ενεργούς αλλαγές στην πραγματικότητα αυτό τάση όσον αφορά να κόστους.

Σε ένα μοτίβο ενεργούς, τις υπηρεσίες cloud και η βάση δεδομένων είναι πλήρως αναπτυχθεί σε δύο περιοχές. Σε αντίθεση με το μοντέλο ενεργό παθητικές, δύο περιοχές λαμβάνει την κυκλοφορία του χρήστη. Αυτή η επιλογή αποδόσεις τον πιο γρήγορος χρόνο αποκατάστασης. Οι υπηρεσίες είναι ήδη προσαρμοσμένα χειρισμού ένα τμήμα του η φόρτωση σε κάθε περιοχή. DNS έχει ήδη ενεργοποιηθεί για να χρησιμοποιήσετε τη δευτερεύουσα περιοχή. Υπάρχει επιπλέον πολυπλοκότητα στη τον καθορισμό του τρόπου για τη δρομολόγηση τους χρήστες στην κατάλληλη περιοχή. Προγραμματισμός ROUND robin μπορεί να είναι δυνατό. Είναι πιο πιθανό ότι σε συγκεκριμένους χρήστες χρησιμοποιούσατε μια συγκεκριμένη περιοχή όπου βρίσκεται το πρωτεύον αντίγραφο της στα δεδομένα τους.

Σε περίπτωση ανακατεύθυνσης, απλώς απενεργοποίηση DNS στην κύρια περιοχή. Αυτό δρομολογεί όλη την κυκλοφορία προς τη δευτερεύουσα περιοχή.

Ακόμη και σε αυτό το μοντέλο, υπάρχουν ορισμένες παραλλαγές. Για παράδειγμα, το παρακάτω διάγραμμα παρουσιάζει ένα μοντέλο όπου η κύρια περιοχή κατέχει το κύριο αντίγραφο της βάσης δεδομένων. Τις υπηρεσίες cloud σε δύο περιοχές εγγραφή σε αυτήν την κύρια βάση δεδομένων. Διαβάστε τα δευτερεύοντα ανάπτυξης από το κύριο ή από αναπαραγωγή βάσης δεδομένων. Αναπαραγωγή σε αυτό το παράδειγμα συμβαίνει ένας τρόπος.

![Ενεργούς](./media/resiliency-disaster-recovery-azure-applications/active-active.png)

Υπάρχει ένα μειονέκτημα στην αρχιτεκτονική ενεργούς στο παραπάνω διάγραμμα. Η δεύτερη περιοχή πρέπει να πρόσβαση στη βάση δεδομένων στην πρώτη περιοχή, επειδή το κύριο αντίγραφο βρίσκεται εκεί. Απόδοση μειώνεται σημαντικά απενεργοποίηση κατά την πρόσβαση σε δεδομένα από εκτός μιας περιοχής. Στην περιοχή κλήσεις μεταξύ περιοχή της βάσης δεδομένων, πρέπει να λάβετε υπόψη κάποιου τύπου δέσμης στρατηγικής για να βελτιώσετε την απόδοση της αυτές τις κλήσεις. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [πώς μπορείτε να χρησιμοποιήσετε δέσμης για βελτίωση της απόδοσης εφαρμογής βάσης δεδομένων SQL](../sql-database/sql-database-use-batching-to-improve-performance.md).

Μια εναλλακτική αρχιτεκτονική ενδέχεται να περιλαμβάνουν κάθε περιοχή απευθείας πρόσβαση σε ξεχωριστή βάση δεδομένων. Σε αυτό το μοντέλο, ορισμένες τύπος αντιγραφής διπλής κατεύθυνσης είναι απαραίτητη για το συγχρονισμό των βάσεων δεδομένων σε κάθε περιοχή.

Στο μοτίβο ενεργούς, ίσως χρειαστεί δεν όσες φορές στην κύρια περιοχή όπως θα κάνατε στο ενεργό παθητικές μοτίβο. Εάν έχετε 10 εμφανίσεις στην κύρια περιοχή σε ένα ενεργό παθητικές αρχιτεκτονική, ίσως χρειαστεί μόνο 5 σε κάθε περιοχή σε μια αρχιτεκτονική ενεργούς. Δύο περιοχές μοιραστείτε τώρα η φόρτωση. Αυτό μπορεί να ένα κόστος εξοικονόμησης επάνω από το ενεργό παθητικές μοτίβο εάν μπορείτε να διατηρήσετε ένα ενδιαφέρων αναμονής στη περιοχή παθητικές 10 εμφανίσεις αναμονή για ανακατεύθυνση.

Συνειδητοποιήσετε ότι μέχρι να επαναφέρετε την κύρια περιοχή, τη δευτερεύουσα περιοχή ενδέχεται να λάβετε μια απότομη αύξησης των νέων χρηστών. Εάν υπάρχουν 10.000 χρήστες σε κάθε διακομιστή όταν η κύρια περιοχή έχει μια διακοπή υπηρεσίας, τη δευτερεύουσα περιοχή έχει ξαφνικά χειρισμού 20.000 χρήστες. Παρακολούθηση κανόνες σχετικά με τη δευτερεύουσα περιοχή πρέπει να εντοπίσει αυτή η αύξηση και διπλή τις παρουσίες στη δευτερεύουσα περιοχή. Για περισσότερες πληροφορίες σχετικά με αυτό, ανατρέξτε στην ενότητα σε [Εντοπισμός αποτυχίας](#failure-detection).

##<a name="hybrid-on-premises-and-cloud-solution"></a>Υβριδική εσωτερικής εγκατάστασης και cloud λύσης

Μία επιπλέον στρατηγική για αποκατάσταση είναι η αρχιτεκτονική μιας εφαρμογής υβριδική που εκτελείται εσωτερικής εγκατάστασης και στο cloud. Ανάλογα με την εφαρμογή, η κύρια περιοχή μπορεί να είναι οποιαδήποτε θέση. Εξετάστε το ενδεχόμενο να την προηγούμενη αρχιτεκτονικές και φανταστείτε την περιοχή πρωτεύον ή δευτερεύον ως μια θέση εσωτερικής εγκατάστασης.

Υπάρχουν ορισμένες προκλήσεις σε αυτές τις αρχιτεκτονικές υβριδική. Πρώτα, περισσότερες από αυτό το άρθρο έχει απαντήσει PaaS αρχιτεκτονική μοτίβα. Τυπικές εφαρμογές PaaS στο Azure βασίζονται στο Azure συγκεκριμένο δομές, όπως ρόλους, τις υπηρεσίες cloud και διαχείριση κίνηση. Για να δημιουργήσετε μια λύση εσωτερικής εγκατάστασης για αυτόν τον τύπο της εφαρμογής PaaS απαιτείται μια αρχιτεκτονική σημαντικά διαφορετικό. Αυτό ίσως να μην είναι εφικτό από διαχείρισης ή άποψη κόστους.

Ωστόσο, μια λύση υβριδική για αποκατάσταση έχει λιγότερες προκλήσεις για παραδοσιακή αρχιτεκτονικές που έχουν μετακινηθεί απλώς στο cloud. Αυτό ισχύει της αρχιτεκτονικές που χρησιμοποιούν IaaS. Οι εφαρμογές IaaS χρησιμοποιούν εικονικές μηχανές στο cloud που μπορούν να έχουν ισοδύναμα απευθείας εσωτερικής εγκατάστασης. Μπορείτε επίσης να χρησιμοποιήσετε εικονικών δικτύων για σύνδεση μηχανές στο cloud με πόρους δικτύου εσωτερικής εγκατάστασης. Έτσι ανοίγει πολλές δυνατότητες που δεν είναι διαθέσιμες με τις εφαρμογές μόνο PaaS. Για παράδειγμα, SQL Server να επωφεληθείτε από λύσεων αποκατάστασης από καταστροφή όπως ομάδες διαθεσιμότητας AlwaysOn και δημιουργία ειδώλου βάσης δεδομένων. Για λεπτομέρειες, ανατρέξτε στο θέμα [Υψηλή διαθεσιμότητα και την αποκατάσταση για τον SQL Server σε εικονικές μηχανές Windows Azure](../virtual-machines/virtual-machines-windows-sql-high-availability-dr.md).

IaaS λύσεων παρέχουν επίσης μια πιο εύκολη διαδρομή για εφαρμογές στην εσωτερική εγκατάσταση για να χρησιμοποιήσετε Azure ως την επιλογή ανακατεύθυνσης. Ενδέχεται να έχετε μια εφαρμογή πλήρως λειτουργικό σε μια υπάρχουσα περιοχή εσωτερικής εγκατάστασης. Ωστόσο, τι γίνεται εάν έλλειψης τους πόρους για να διατηρήσετε μια περιοχή γεωγραφικά ξεχωριστή για ανακατεύθυνση; Ενδέχεται να αποφασίσετε να χρησιμοποιήσετε εικονικές μηχανές και εικονικού δικτύων για να λάβετε την εφαρμογή που εκτελείται στο Azure. Σε αυτή την περίπτωση, ορίστε τις διαδικασίες που θέλετε να συγχρονίσετε δεδομένων στο cloud. Azure ανάπτυξης, στη συνέχεια, γίνεται τη δευτερεύουσα περιοχή για να χρησιμοποιήσετε για ανακατεύθυνση. Η κύρια περιοχή παραμένει η εφαρμογή εσωτερικής εγκατάστασης. Για περισσότερες πληροφορίες σχετικά με τις δυνατότητες και αρχιτεκτονικές IaaS, ανατρέξτε στην [τεκμηρίωση εικονικές μηχανές](https://azure.microsoft.com/documentation/services/virtual-machines/).

##<a name="alternative-cloud"></a>Εναλλακτικές cloud

Υπάρχουν περιπτώσεις όπου, ακόμα και την ισχύ του Microsoft Cloud μπορεί να μην πληροί κανόνες εσωτερικής συμμόρφωσης ή πολιτικές που απαιτεί την εταιρεία σας. Ακόμα και την καλύτερη προετοιμασίας και σχεδίαση για να υλοποιήσετε συστήματα δημιουργίας αντιγράφων ασφαλείας στη διάρκεια μιας καταστροφής κυμαίνεται σύντομο εάν υπάρχει διαταραχή καθολικής υπηρεσίας από μια υπηρεσία παροχής cloud.

Θα θέλετε να συγκρίνετε απαιτήσεις διαθεσιμότητας με το κόστος και την πολυπλοκότητα του αυξημένη διαθεσιμότητα. Εκτελέστε μια ανάλυση κινδύνου, και τον ορισμό του RTO και RPO για τη λύση. Εάν η εφαρμογή σας δεν θέλετε να γίνει οποιαδήποτε χρόνου εκτός λειτουργίας, μπορεί να έχει νόημα για να μπορείτε να χρησιμοποιήσετε μια άλλη λύση cloud. Εκτός εάν ολόκληρο το Internet μεταβαίνει προς τα κάτω, μια άλλη λύση cloud ενδέχεται να εξακολουθεί να είναι διαθέσιμη εάν Azure γίνεται καθολική πρόσβαση.

Όπως και με το σενάριο υβριδικό, την ανάπτυξη ανακατεύθυνσης σε την προηγούμενη αρχιτεκτονικές αποκατάστασης από καταστροφή μπορούν επίσης να υπάρχουν μέσα σε μια άλλη λύση cloud. Εναλλακτικές cloud DR τοποθεσίες πρέπει να χρησιμοποιείται μόνο για λύσεις του οποίου RTO επιτρέπει πολύ μικρό, αν υπάρχουν, χρόνος εκτός λειτουργίας. Σημειώστε ότι μια λύση που χρησιμοποιεί μια τοποθεσία DR έξω από το Azure θα απαιτούν περισσότερη εργασία για να ρυθμίσετε τις παραμέτρους, την ανάπτυξη, ανάπτυξη και διατήρηση. Είναι επίσης δυσκολότερο να υλοποιήσετε βέλτιστες πρακτικές σε σταυρό cloud αρχιτεκτονική. Παρόλο που πλατφόρμες cloud έχουν παρόμοια έννοιες υψηλού επιπέδου, το API και αρχιτεκτονικές διαφέρουν.

Εάν αποφασίσετε να διαιρέσετε το DR ανάμεσα σε διαφορετικές πλατφόρμες, θα μπορεί να έχει νόημα να αρχιτεκτονική επίπεδα αφαίρεσης κατά το σχεδιασμό της λύσης. Εάν το κάνετε αυτό, δεν θα χρειαστεί να αναπτύξετε και να διατηρήσετε δύο διαφορετικές εκδόσεις της ίδιας εφαρμογής για διαφορετικές cloud πλατφόρμες σε περίπτωση καταστροφής. Ως με το σενάριο υβριδική, τη χρήση εικονικές μηχανές Windows Azure ή η υπηρεσία κοντέινερ Azure ίσως είναι ευκολότερο σε αυτές τις περιπτώσεις η χρήση της συγκεκριμένης cloud PaaS σχέδια.

##<a name="automation"></a>Αυτοματοποίηση

Ορισμένα από τα μοτίβα που αναφέρθηκε απλώς απαιτούν γρήγορη ενεργοποίησης του χωρίς σύνδεση αναπτύξεις καθώς και επαναφορά της συγκεκριμένα τμήματα ενός συστήματος. Αυτοματοποίηση ή δέσμες ενεργειών, υποστηρίζει τη δυνατότητα για να ενεργοποιήσετε τους πόρους ζήτηση και ανάπτυξη λύσεων γρήγορα. Σε αυτό το άρθρο, που σχετίζονται με το DR Αυτοματισμός είναι ίσες με το [Azure PowerShell](https://msdn.microsoft.com/library/azure/jj156055.aspx), αλλά η [Υπηρεσία διαχείρισης REST API](https://msdn.microsoft.com/library/azure/ee460799.aspx) είναι επίσης μια επιλογή.

Ανάπτυξη δεσμών ενεργειών σάς βοηθά να διαχειριστείτε τα τμήματα του DR που Azure δεν χειρίζεται με διαφάνεια. Αυτό περιλαμβάνει το όφελος παράγουν συνεπή αποτελέσματα κάθε φορά, το οποίο ελαχιστοποιεί τις πιθανότητες human σφάλματος. Αντιμετωπίζετε προκαθορισμένα δέσμες ενεργειών DR μειώνει επίσης την ώρα για να δημιουργήσετε ξανά ένα σύστημα καθώς και τα επιμέρους στοιχεία στη μέση του μιας καταστροφής. Δεν θέλετε να προσπαθήστε να κατανοήσετε τον τρόπο για να επαναφέρετε την τοποθεσία σας ενώ βρίσκεται κάτω και επικρατεί χρήματα κάθε λεπτό με μη αυτόματο τρόπο.

Αφού δημιουργήσετε τις δέσμες ενεργειών, τις δοκιμάσετε επανειλημμένα από την αρχή μέχρι το τέλος. Αφού επαληθεύσετε τις βασικές λειτουργίες, βεβαιωθείτε ότι η δοκιμή στην [καταστροφή προσομοίωσης](#disaster-simulation). Αυτό σας βοηθά να αποκαλύψετε ελαττώματα σε τις δέσμες ενεργειών ή διεργασίες.

Βέλτιστη πρακτική με αυτοματοποίηση είναι να δημιουργήσετε ένα αρχείο φύλαξης δεσμών ενεργειών του PowerShell ή δέσμες ενεργειών περιβάλλον γραμμής εντολών (CLI) για το Azure αποκατάσταση. Με σαφήνεια επισημαίνετε και να κατηγοριοποιήσετε για εύκολη την αναζήτηση. Καθορίστε ένα άτομο για να διαχειριστείτε το αποθετήριο και διαχείρισης εκδόσεων από τις δέσμες ενεργειών. Έγγραφο τους καλά με επεξηγήσεις παράμετροι και παραδείγματα χρήσης δέσμης ενεργειών. Επίσης, βεβαιωθείτε ότι μπορείτε να διατηρήσετε παρούσα τεκμηρίωση συγχρονισμένη Azure αναπτύξεις σας. Αυτό underscores το σκοπό της αντιμετωπίζετε ένα άτομο υπεύθυνο για όλα τα τμήματα του αποθετηρίου.

##<a name="failure-detection"></a>Εντοπισμός αποτυχίας

Για να χειριστείτε σωστά προβλήματα με τη διαθεσιμότητα και την αποκατάσταση, πρέπει να μπορούν να εντοπίσουν και διάγνωση αποτυχιών. Θα πρέπει να κάνετε σύνθετες διακομιστή και ανάπτυξη παρακολούθηση, ώστε να μπορείτε να γνωρίζετε γρήγορα όταν ένα σύστημα ή τα τμήματα είναι ξαφνικά προς τα κάτω. Παρακολούθηση εργαλεία που εξετάσουμε της συνολικής εύρυθμης λειτουργίας της υπηρεσίας cloud και τις εξαρτήσεις, μπορεί να εκτελέσει τμήμα αυτής της εργασίας. Ένα εργαλείο Microsoft είναι [2016 κέντρο συστήματος](https://www.microsoft.com/en-us/server-cloud/products/system-center-2016/). Εργαλεία τρίτων κατασκευαστών μπορούν επίσης να παρέχουν δυνατότητες παρακολούθησης. Οι περισσότερες λύσεις παρακολούθησης παρακολούθηση μετρητές κλειδιού επιδόσεων και τη διαθεσιμότητα υπηρεσιών.

Παρόλο που αυτά τα εργαλεία είναι σημαντική, δεν τις αντικαθιστούν την ανάγκη για το σχεδιασμό της αναφοράς μέσα σε μια υπηρεσία στο cloud και εντοπισμός σφαλμάτων. Πρέπει να σχεδιάζετε να χρησιμοποιήσετε σωστά Διαγνωστικά Azure. Προσαρμοσμένο μετρητών ή καταχωρήσεις καταγραφής συμβάντων μπορεί επίσης να τμήμα της συνολικής στρατηγικής. Αυτό παρέχει περισσότερων δεδομένων κατά τη διάρκεια αποτυχίες για να εντοπίσετε το πρόβλημα γρήγορα και να επαναφέρετε πλήρεις δυνατότητες. Παρέχει επίσης πρόσθετων μετρήσεων που να χρησιμοποιήσετε τα εργαλεία παρακολούθησης για να προσδιορίσετε την εύρυθμη λειτουργία της εφαρμογής. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Ενεργοποίηση Διαγνωστικά Azure στις υπηρεσίες Cloud Azure](../cloud-services/cloud-services-dotnet-diagnostics.md). Για πληροφορίες σχετικά με τον τρόπο για το σχεδιασμό του συνολικού "μοντέλο εύρυθμης λειτουργίας", ανατρέξτε στο θέμα [συστοιχίας: καθοδήγηση για είναι ανθεκτικά αρχιτεκτονικές Cloud](https://channel9.msdn.com/Series/FailSafe).

##<a name="disaster-simulation"></a>Καταστροφή προσομοίωσης

Δοκιμές προσομοίωσης περιλαμβάνει τη δημιουργία μικρές περιπτώσεις πραγματικό κύκλου ζωής στο δάπεδο εργασίας για να παρακολουθήσετε τον τρόπο με τα μέλη της ομάδας το αντικείμενο. Προσομοιώσεις εμφανίζουν επίσης πόσο αποτελεσματικές είναι τις λύσεις στο σχέδιο αποκατάστασης. Εκτέλεση προσομοιώσεις έτσι ώστε τα σενάρια που έχουν δημιουργηθεί δεν διακόψουν επαγγελματική ενώ εξακολουθείτε να αίσθηση όπως πραγματικό περιπτώσεις.

Εξετάστε το ενδεχόμενο Εξειδικευμένος ενός τύπου "Πίνακας επιλογών" στην εφαρμογή για να προσομοιώσετε με μη αυτόματο τρόπο θεμάτων διαθεσιμότητας. Για παράδειγμα, μέσω ενός διακόπτη απαλές, ενεργοποιείτε εξαιρέσεις πρόσβασης βάσης δεδομένων για μια λειτουργική μονάδα παραγγελίας, προκαλώντας να δυσλειτουργία. Μπορείτε να κρατήσετε παρόμοια ελαφριά προσεγγίσεις για άλλες λειτουργικές μονάδες στο επίπεδο περιβάλλοντος εργασίας δικτύου.

Προσομοίωση επισημαίνει τυχόν ζητήματα που έχουν inadequately απαντήσει. Τα σενάρια προσομοιωμένη πρέπει να είναι πλήρως μπορεί να ελεγχθεί. Αυτό σημαίνει ότι, ακόμα και αν το πρόγραμμα αποκατάστασης φαίνεται να παρουσιάζει σφάλμα, μπορείτε να επαναφέρετε την κατάσταση Επιστροφή στην κανονική χωρίς να προκαλέσει οποιαδήποτε σημαντική ζημιά. Είναι σημαντικό να ενημερώσετε υψηλότερου επιπέδου διαχείρισης σχετικά με το πότε και πώς θα εκτελεστεί των ασκήσεων προσομοίωσης. Αυτό το πρόγραμμα πρέπει να περιλαμβάνει πληροφορίες σχετικά με το χρόνο ή πόρους που ενδέχεται να unproductive ενώ εκτελείται η δοκιμή προσομοίωσης. Όταν μπορείτε να υποβάλουν το πρόγραμμά σας από καταστροφή αποκατάστασης σε δοκιμή, είναι επίσης σημαντικό για να ορίσετε πώς θα μετρηθεί επιτυχίας.

Υπάρχουν διάφορες άλλες τεχνικές που μπορείτε να χρησιμοποιήσετε για να ελέγξετε σχέδια ανάκτησης από καταστροφή. Ωστόσο, οι περισσότερες από αυτές είναι απλώς τροποποιημένα εκδόσεις αυτές τις βασικές τεχνικές. Είναι το κύριο κινητήριας πίσω από αυτής της δοκιμής προς αξιολόγηση πώς είναι εφικτό και πώς εφικτή είναι το πρόγραμμα αποκατάστασης. Αποκατάσταση δοκιμές εστιάζει σε τις λεπτομέρειες για να ανακαλύψετε οπών στο σχέδιο βασικές αποκατάστασης.

##<a name="next-steps"></a>Επόμενα βήματα

Σε αυτό το άρθρο αποτελεί μέρος μιας σειράς από άρθρα εστιασμένη σε [Αποκατάσταση και υψηλής διαθεσιμότητας για εφαρμογές που δημιουργήθηκαν στο Microsoft Azure](./resiliency-disaster-recovery-high-availability-azure-applications.md). Το προηγούμενο άρθρο σε αυτήν τη σειρά είναι [υψηλής διαθεσιμότητας για εφαρμογές που δημιουργήθηκαν στο Microsoft Azure](./resiliency-high-availability-azure-applications.md).

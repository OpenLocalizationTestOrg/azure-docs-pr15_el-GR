<properties
    pageTitle="Άποψη ανάλυσης με τη χρήση Azure ροή ανάλυση και Azure μηχανικής εκμάθησης | Microsoft Azure"
    description="Πώς μπορείτε να χρησιμοποιήσετε μια συνάρτηση που ορίζεται από το χρήστη και μηχανικής εκμάθησης στην ανάλυση ροής εργασίας"
    keywords=""
    documentationCenter=""
    services="stream-analytics"
    authors="jeffstokes72"
    manager="jhubbard"
    editor="cgronlun"
/>


<tags 
    ms.service="stream-analytics" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.tgt_pltfrm="na" 
    ms.workload="data-services" 
    ms.date="10/04/2016" 
    ms.author="jeffstok"
/>

# <a name="sentiment-analysis-by-using-azure-stream-analytics-and-azure-machine-learning"></a>Άποψη ανάλυσης με τη χρήση Azure ροή ανάλυση και Azure μηχανικής εκμάθησης #

Σε αυτό το άρθρο έχει σχεδιαστεί για να σας βοηθήσει να δημιουργήσετε ένα απλό έργο Azure ροή ανάλυση, με ενσωμάτωση του Azure μηχανικής εκμάθησης. Θα χρησιμοποιήσετε ένα μοντέλο άποψη ανάλυσης μηχανικής εκμάθησης από τη συλλογή πληροφοριών Cortana για την ανάλυση δεδομένων ροής κειμένου και, καθορίζουν τη βαθμολογία άποψη σε πραγματικό χρόνο. Οι πληροφορίες σε αυτό το άρθρο μπορεί να σας βοηθήσει να κατανοήσετε σενάρια όπως ανάλυση άποψη σε πραγματικό χρόνο στο Twitter δεδομένων ροής, ανάλυση εγγραφές των πελατών συνομιλίες με το προσωπικό υποστήριξης και αξιολόγηση των σχολίων στο φόρουμ, ιστολόγια και βίντεο, εκτός από πολλά άλλα σε πραγματικό χρόνο, πρόβλεψης βαθμολογίας σενάρια.

Σε αυτό το άρθρο παρέχει ένα δείγμα αρχείου CSV με κείμενο ως είσοδο στο χώρο αποθήκευσης αντικειμένων Blob του Azure, φαίνεται στην παρακάτω εικόνα. Η εργασία ισχύει το μοντέλο ανάλυσης άποψη ως μια συνάρτηση που ορίζονται από το χρήστη (UDF) το δείγμα δεδομένων κειμένου από το χώρο αποθήκευσης αντικειμένων blob. Το τελικό αποτέλεσμα τοποθετείται στο ίδιο χώρο αποθήκευσης αντικειμένων blob σε ένα άλλο αρχείο CSV. 

![Ανάλυση ροή υπολογιστή εκμάθησης](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-figure-2.png)  

Η παρακάτω εικόνα δείχνει αυτήν τη ρύθμιση παραμέτρων. Για μια πιο ρεαλιστική το σενάριο, μπορείτε να αντικαταστήσετε χώρος αποθήκευσης αντικειμένων Blob με ροή Twitter δεδομένα από μια εισαγωγής Azure συμβάν διανομείς. Επιπλέον, ενδέχεται να μπορείτε να δημιουργήσετε μια απεικόνιση σε πραγματικό χρόνο [Το Microsoft Power BI](https://powerbi.microsoft.com/) από τη συγκέντρωση άποψη.    

![Ανάλυση ροή υπολογιστή εκμάθησης](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-figure-1.png)  

## <a name="prerequisites"></a>Προαπαιτούμενα στοιχεία

Τις προϋποθέσεις για την ολοκλήρωση των εργασιών που εκδηλώνονται σε αυτό το άρθρο είναι οι εξής:

-   Μια ενεργή συνδρομή Azure.
-   Ένα αρχείο CSV με ορισμένα δεδομένα σε αυτό. Μπορείτε να κάνετε λήψη του αρχείου που εμφανίζεται στο σχήμα 1 από [GitHub](https://github.com/Azure/azure-stream-analytics/blob/master/Sample Data/sampleinput.csv)ή μπορείτε να δημιουργήσετε το δικό σας αρχείο. Για αυτό το άρθρο, θα σας λαμβάνεται ως δεδομένο ότι χρησιμοποιείτε αυτήν που παρέχεται για λήψη σε GitHub.

Σε υψηλό επίπεδο, για να ολοκληρώσετε τις εργασίες που παρουσιάζεται σε αυτό το άρθρο, θα κάνετε τα εξής:

1.  Αποστείλετε το αρχείο εισαγωγής CSV στο χώρο αποθήκευσης αντικειμένων Blob του Azure.
2.  Προσθέστε ένα μοντέλο ανάλυσης άποψη από τη συλλογή πληροφοριών Cortana στο χώρο εργασίας σας Azure μηχανικής εκμάθησης.
3.  Ανάπτυξη αυτό το μοντέλο ως μια υπηρεσία web στο χώρο εργασίας μηχανικής εκμάθησης.
4.  Δημιουργία μιας εργασίας ροής ανάλυσης που καλεί αυτήν την υπηρεσία web ως μια συνάρτηση, για να προσδιορίσετε άποψη για την εισαγωγή κειμένου.
5.  Εκκίνηση της ανάλυσης ροή εργασίας και να παρακολουθήσετε το αποτέλεσμα.

## <a name="upload-the-csv-input-file-to-blob-storage"></a>Αποστείλετε το αρχείο εισαγωγής CSV στο χώρο αποθήκευσης αντικειμένων Blob

Για αυτό το βήμα, μπορείτε να χρησιμοποιήσετε οποιοδήποτε αρχείο CSV, όπως ένα ήδη που έχουν καθοριστεί ως διαθέσιμο για λήψη στην GitHub. Μπορείτε να χρησιμοποιήσετε την [Εξερεύνηση χώρου αποθήκευσης Azure](http://storageexplorer.com/) ή Visual Studio για να αποστείλετε το αρχείο ή μπορείτε να χρησιμοποιήσετε προσαρμοσμένου κώδικα. Χρησιμοποιούμε παραδείγματα που βασίζονται σε Visual Studio.

1.  Στο Visual Studio, κάντε κλικ στην επιλογή **Azure** > **χώρου αποθήκευσης** > **Επισύναψη εξωτερικού χώρου αποθήκευσης**. Πληκτρολογήστε ένα **όνομα λογαριασμού** και το **κλειδί λογαριασμού**.  

    ![Ανάλυση ροή υπολογιστή εκμάθησης, Εξερεύνηση Server](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-server-explorer.png)  

2.  Αναπτύξτε το χώρο αποθήκευσης έχετε επισυνάψει στο βήμα 1, κάντε κλικ στην επιλογή **Δημιουργία Blob κοντέινερ**και, στη συνέχεια, εισαγάγετε ένα λογικό όνομα. Αφού δημιουργήσετε το κοντέινερ, ανοίξτε το για να προβάλετε τα περιεχόμενά της. (Θα είναι κενή αυτήν τη στιγμή).  

    ![Ροή εκμάθησης μηχανική ανάλυση, δημιουργία blob](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-create-blob.png)  

3.  Για να αποστείλετε το αρχείο CSV, κάντε κλικ στην επιλογή **Αποστολή Blob**και, στη συνέχεια, κάντε κλικ στο **αρχείο από τον τοπικό δίσκο**.  

## <a name="add-the-sentiment-analytics-model-from-the-cortana-intelligence-gallery"></a>Προσθήκη στο μοντέλο ανάλυσης άποψη από τη συλλογή πληροφοριών Cortana

1.  Κάντε λήψη του [μοντέλου ανάλυσης πρόβλεψης άποψη](https://gallery.cortanaintelligence.com/Experiment/Predictive-Mini-Twitter-sentiment-analysis-Experiment-1) από τη συλλογή πληροφοριών Cortana.  
2.  Στο μηχανικής εκμάθησης Studio, κάντε κλικ στην επιλογή **Άνοιγμα στο Studio**.  

    ![Ροή εκμάθησης μηχανική ανάλυση, Άνοιγμα μηχανικής εκμάθησης Studio](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-open-ml-studio.png)  

3.  Πραγματοποιήστε είσοδο στο για να μεταβείτε στο χώρο εργασίας. Επιλέξτε τη θέση που ταιριάζει καλύτερα με τη δική σας θέση.
4.  Κάντε κλικ στην επιλογή " **Εκτέλεση** " στο κάτω μέρος της σελίδας.  
5.  Μετά τη διαδικασία εκτελείται με επιτυχία, κάντε κλικ στην επιλογή **Ανάπτυξη υπηρεσία Web**.
6.  Το μοντέλο ανάλυσης άποψη είναι έτοιμη για χρήση. Για να επικυρώσετε, κάντε κλικ στο κουμπί **Έλεγχος** και δώστε εισαγωγή κειμένου, όπως "Μου αρέσει Microsoft." Η δοκιμή πρέπει να επιστρέψει παρόμοιο με το εξής αποτέλεσμα:

`'Predictive Mini Twitter sentiment analysis Experiment' test returned ["4","0.715057671070099"]...`  

![Ροή ανάλυση μηχανικής εκμάθησης, ανάλυση δεδομένων](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-analysis-data.png)  

Στη στήλη " **εφαρμογές** ", κάντε κλικ στη σύνδεση για το **Excel 2010 ή παλαιότερες βιβλίου εργασίας** για να λάβετε τον αριθμό-κλειδί API και τη διεύθυνση URL που θα χρειαστείτε αργότερα για να ρυθμίσετε τη ροή ανάλυση εργασία. (Αυτό το βήμα απαιτείται μόνο για να χρησιμοποιήσετε ένα μοντέλο μηχανικής εκμάθησης από μια άλλη λογαριασμός Azure χώρου εργασίας. Σε αυτό το άρθρο προϋποθέτει αυτό συμβαίνει, για να αντιμετωπίσετε αυτό το σενάριο.)  

Σημειώστε το κλειδί υπηρεσίας web διεύθυνσης URL και της πρόσβασης από το αρχείο που έχετε λάβει Excel, όπως φαίνεται παρακάτω:  

![Εκμάθηση μηχανική ανάλυση ροής, γρήγορη ματιά](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-quick-glance.png)  

## <a name="create-a-stream-analytics-job-that-uses-the-machine-learning-model"></a>Δημιουργία μιας εργασίας ροής ανάλυσης που χρησιμοποιεί το μοντέλο μηχανικής εκμάθησης

1.  Μεταβείτε στην [πύλη του Azure](https://manage.windowsazure.com).  
2.  Κάντε κλικ στην επιλογή **νέα** > **υπηρεσίες δεδομένων** > **ροή ανάλυση** > **γρήγορης δημιουργίας**. Πληκτρολογήστε ένα όνομα για την εργασία σας στο **Όνομα της εργασίας**, εισαγάγετε στην κατάλληλη περιοχή για το έργο στην **περιοχή**και, στη συνέχεια, επιλέξτε το λογαριασμό στο **Λογαριασμό χώρου αποθήκευσης παρακολούθηση τοπικές ρυθμίσεις**.    
3.  Αφού δημιουργηθεί η εργασία, στην καρτέλα **δεδομένα εισόδου** , κάντε κλικ στην επιλογή **Προσθήκη είσοδο**.  

    ![Ροή εκμάθησης μηχανική ανάλυση, προσθέστε μηχανικής εκμάθησης εισαγωγής](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-add-input-screen.png)  

4.  Στην πρώτη σελίδα του οδηγού **Προσθήκη εισαγωγής** , κάντε κλικ στην επιλογή **ροής δεδομένων**και, στη συνέχεια, κάντε κλικ στο κουμπί **Επόμενο**. Στην επόμενη σελίδα, κάντε κλικ στην επιλογή **Χώρος αποθήκευσης αντικειμένων Blob** ως δεδομένα εισόδου και, στη συνέχεια, κάντε κλικ στο κουμπί **Επόμενο**.  
5.  Στη σελίδα **Ρυθμίσεις αποθήκευσης αντικειμένων Blob** του οδηγού, δώστε στο χώρο αποθήκευσης αντικειμένων blob κοντέινερ όνομα του λογαριασμού που ορίσατε προηγουμένως κατά την αποστολή των δεδομένων. Κάντε κλικ στο κουμπί **Επόμενο**. Για τη **Μορφή σειριοποίησης συμβάντος**, κάντε κλικ στην επιλογή **CSV**. Αποδεχτείτε τις προεπιλεγμένες τιμές για τα υπόλοιπα της σελίδας **Ρυθμίσεις σειριοποίησης** . Κάντε κλικ στο **κουμπί OK**.  
6.  Στην καρτέλα **εξόδους** , κάντε κλικ στην επιλογή **Προσθήκη το αποτέλεσμα**.  

    ![Ροή εκμάθησης μηχανική ανάλυση, προσθέστε εξόδου](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-add-output-screen.png)  

7.  Κάντε κλικ στην επιλογή **Χώρος αποθήκευσης αντικειμένων Blob**και, στη συνέχεια, εισαγάγετε τις ίδιες παραμέτρους, εκτός από το κοντέινερ. Η τιμή για **Εισαγωγή δεδομένων** έχει ρυθμιστεί για την ανάγνωση από το κοντέινερ με όνομα "δοκιμή" όπου έχει αποσταλεί το αρχείο **CSV** . Για **έξοδο**, πληκτρολογήστε "testoutput". Τα ονόματα κοντέινερ πρέπει να είναι διαφορετικά. Βεβαιωθείτε ότι υπάρχει αυτό το κοντέινερ.     
8.  Κάντε κλικ στο κουμπί **Επόμενο** για να ρυθμίσετε το αποτέλεσμα **σειριοποίησης ρυθμίσεις**. Όπως με την **Εισαγωγή δεδομένων**, κάντε κλικ στην επιλογή **CSV**και, στη συνέχεια, κάντε κλικ στο κουμπί **OK** .
9.  Στην καρτέλα **συναρτήσεις** , κάντε κλικ στην επιλογή **Προσθήκη μιας συνάρτησης μηχανικής εκμάθησης**.  

    ![Ροή εκμάθησης μηχανική ανάλυση, προσθέστε συνάρτηση μηχανικής εκμάθησης](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-add-ml-function.png)  

10. Στη σελίδα **Ρυθμίσεις υπηρεσίας μηχανικής εκμάθησης Web** , εντοπίστε του χώρου εργασίας, την υπηρεσία web και προεπιλεγμένο τελικό σημείο μηχανικής εκμάθησης. Για αυτό το άρθρο, εφαρμόστε τις ρυθμίσεις με μη αυτόματο τρόπο για να αποκτήσετε εξοικείωση με τη ρύθμιση των παραμέτρων μιας υπηρεσίας web για οποιονδήποτε χώρο εργασίας, με την προϋπόθεση ότι γνωρίζετε τη διεύθυνση URL και έχετε τον αριθμό-κλειδί API. Εισαγάγετε το τελικό σημείο **διεύθυνση URL** και το **κλειδί API**. Κάντε κλικ στο **κουμπί OK**.    

    ![Ροή ανάλυση μηχανικής εκμάθησης, υπηρεσία web μηχανικής εκμάθησης](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-ml-web-service.png)    

11. Στην καρτέλα **ερώτημα** , τροποποιήστε το ερώτημα ως εξής:    

 ```
    WITH subquery AS (  
        SELECT text, sentiment(text) as result from input  
    )  
 
    Select text, result.[Scored Labels]  
    Into output  
    From subquery  
 ```    
12. Κάντε κλικ στο κουμπί **Αποθήκευση** για να αποθηκεύσετε το ερώτημα.

## <a name="start-the-stream-analytics-job-and-observe-the-output"></a>Εκκίνηση της ανάλυσης ροή εργασίας και να παρακολουθήσετε την έξοδο

1.  Κάντε κλικ στην επιλογή **Έναρξη** στο κάτω μέρος της σελίδας του έργου.
2.  Στο παράθυρο **Διαλόγου Έναρξη ερωτήματος**, κάντε κλικ στην επιλογή **Προσαρμοσμένη ώρα**και, στη συνέχεια, επιλέξτε ένα χρονικό διάστημα πριν κατά την αποστολή του CSV με το χώρο αποθήκευσης αντικειμένων Blob. Κάντε κλικ στο **κουμπί OK**.  

    ![Ροή ανάλυση μηχανικής εκμάθησης, προσαρμοσμένη ώρα](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-custom-time.png)  

3.  Μεταβείτε στο χώρο αποθήκευσης αντικειμένων Blob, χρησιμοποιώντας το εργαλείο που χρησιμοποιήσατε για να αποστείλετε το αρχείο CSV, για παράδειγμα, Visual Studio.
4.  Λίγα λεπτά αφού ξεκινήσει η εργασία, το αποτέλεσμα του κοντέινερ δημιουργείται και αποστολή ενός αρχείου CSV σε αυτήν.  
5.  Ανοίξτε το αρχείο στο προεπιλεγμένο πρόγραμμα επεξεργασίας CSV. Θα πρέπει να εμφανίζεται κάτι παρόμοιο με το εξής:  

    ![Ροή ανάλυση μηχανικής εκμάθησης, προβολή CSV](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-csv-view.png)  

## <a name="conclusion"></a>Ολοκλήρωση

Σε αυτό το άρθρο παρουσιάζει τον τρόπο για να δημιουργήσετε μια εργασία ροής ανάλυσης που διαβάζει ροής δεδομένων κειμένου και ισχύει άποψη analytics για τα δεδομένα σε πραγματικό χρόνο. Μπορείτε να πραγματοποιήσετε όλα αυτά χωρίς να χρειάζεται να ανησυχείτε για την intricacies της δόμησης μοντέλου ανάλυσης άποψη. Αυτό είναι ένα από τα πλεονεκτήματα της οικογένειας προγραμμάτων του Cortana πληροφοριών.

Μπορείτε επίσης να προβάλετε μετρικά που σχετίζονται με τη συνάρτηση Azure μηχανικής εκμάθησης. Για να το κάνετε αυτό, κάντε κλικ στην καρτέλα **οθόνη** . Εμφανίζονται τρεις μετρικά που σχετίζονται με τη συνάρτηση.  

- **Συνάρτηση αιτήσεις** υποδεικνύει τον αριθμό των αιτήσεων που αποστέλλονται σε μια υπηρεσία web μηχανικής εκμάθησης.  
- **Συνάρτηση συμβάντα** υποδεικνύει τον αριθμό των συμβάντων στην αίτηση. Από προεπιλογή, κάθε αίτηση σε μια υπηρεσία web μηχανικής εκμάθησης περιέχει έως 1.000 συμβάντα.  
- **Απέτυχε η συνάρτηση αιτήσεις** υποδεικνύει τον αριθμό των αποτυχημένων αιτήσεων για την υπηρεσία web μηχανικής εκμάθησης.  

    ![Ροή ανάλυση μηχανικής εκμάθησης, προβολή εποπτείας μηχανικής εκμάθησης](./media/stream-analytics-machine-learning-integration-tutorial/stream-analytics-machine-learning-integration-tutorial-ml-monitor-view.png)  

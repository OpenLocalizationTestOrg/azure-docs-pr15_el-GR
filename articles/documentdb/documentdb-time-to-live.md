<properties
   pageTitle="Λήγει δεδομένων σε DocumentDB με διάρκεια ζωής | Microsoft Azure"
   description="Με το TTL, Microsoft Azure DocumentDB παρέχει τη δυνατότητα να έχετε έγγραφα εκκαθάριση αυτόματα από το σύστημα μετά από μια χρονική περίοδο."
   services="documentdb"
   documentationCenter=""
   keywords="διάρκεια ζωής"
   authors="kiratp"
   manager="jhubbard"
   editor=""/>

<tags
   ms.service="documentdb"
   ms.devlang="multiple"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="04/28/2016"
   ms.author="kipandya"/>

# <a name="expire-data-in-documentdb-collections-automatically-with-time-to-live"></a>Λήγει δεδομένων σε συλλογές DocumentDB αυτόματα με διάρκεια ζωής

Εφαρμογές μπορούν να δημιουργήσουν και να αποθηκεύσετε τεράστιες ποσότητες δεδομένων. Ορισμένα από αυτά τα δεδομένα, όπως υπολογιστή που δημιουργούνται από το συμβάν δεδομένων, των αρχείων καταγραφής και χρήστη περιόδου λειτουργίας πληροφορίες είναι χρήσιμο μόνο για ένα ορισμένο χρονικό διάστημα. Όταν τα δεδομένα αυτά αποτελούν πλεονάζουσας στις ανάγκες της εφαρμογής είναι ασφαλείς για να κάνετε εκκαθάριση αυτά τα δεδομένα και να μειώσετε τις ανάγκες αποθήκευσης μιας εφαρμογής του.

Με "διάρκεια ζωής" ή το TTL, Microsoft Azure DocumentDB παρέχει τη δυνατότητα να έχετε έγγραφα εκκαθάριση αυτόματα από τη βάση δεδομένων μετά από μια χρονική περίοδο. Στην προεπιλεγμένη διάρκεια ζωής μπορεί να οριστεί στο επίπεδο της συλλογής, και παρακαμφθούν σε βάση ανά έγγραφο. Αφού ορίσετε TTL, είτε ως προεπιλογή συλλογής είτε σε επίπεδο εγγράφου, DocumentDB θα καταργήσει αυτόματα τα έγγραφα που υπάρχει μετά από συγκεκριμένο χρονικό διάστημα, σε δευτερόλεπτα, εφόσον αυτά τελευταίας τροποποίησης.

Διάρκεια ζωής σε DocumentDB χρησιμοποιεί μια μετατόπιση έναντι όταν το έγγραφο τροποποιήθηκε για τελευταία. Για να το κάνετε αυτό που χρησιμοποιεί το πεδίο _ts που υπάρχει σε κάθε έγγραφο. Το πεδίο _ts είναι μια χρονική σήμανση χρονικής σήμανσης τύπου unix που αντιπροσωπεύει την ημερομηνία και ώρα. Το πεδίο _ts ενημερώνεται κάθε φορά που ένα έγγραφο έχει τροποποιηθεί. 

## <a name="ttl-behavior"></a>TTL συμπεριφορά

Η δυνατότητα TTL ελέγχεται από ιδιότητες TTL σε δύο επίπεδα - επίπεδο της συλλογής και το επίπεδο του εγγράφου. Οι τιμές έχουν οριστεί σε δευτερόλεπτα και θεωρούνται delta ένα από τα _ts που το έγγραφο τροποποιήθηκε για τελευταία φορά στο.

 1.  DefaultTTL για τη συλλογή
  * Εάν υπάρχει (ή οριστεί σε null), δεν διαγράφονται αυτόματα τα έγγραφα.
  
  * Όταν η παρουσίαση και η τιμή είναι "-1" = άπειρο – έγγραφα να μην λήγουν από προεπιλογή
  
  * Εάν η παρουσίαση και την τιμή που είναι κάποιος αριθμός ("n")-λήξης των εγγράφων "n" δευτερόλεπτα μετά την τελευταία τροποποίηση

 2.  TTL για τα έγγραφα: 
  * Ιδιότητα εφαρμόζεται μόνο εάν υπάρχει DefaultTTL για τη συλλογή γονικό στοιχείο.
  
  * Αντικαθιστά την τιμή DefaultTTL για τη συλλογή γονικό στοιχείο.

Μόλις το έγγραφο έχει λήξει (ttl + _ts > = τρέχουσα ώρα διακομιστή), το έγγραφο έχει επισημανθεί ως "έχει λήξει". Η λειτουργία δεν θα επιτρέπεται σε αυτά τα έγγραφα μετά από αυτήν τη φορά και θα εξαιρούνται από τα αποτελέσματα της τυχόν ερωτήματα που εκτελούνται. Τα έγγραφα διαγράφονται φυσικά στο σύστημα και διαγράφονται στο παρασκήνιο ευκαιριακά αργότερα. Αυτό δεν εκμετάλλευση οποιαδήποτε [Αίτηση μονάδες (RUs)](documentdb-request-units.md) από τον προϋπολογισμό συλλογής.

Η παραπάνω λογική μπορεί να εμφανίζεται σε τον παρακάτω πίνακα:

|       | DefaultTTL λείπουν/δεν οριστεί στη συλλογή | DefaultTTL = -1 στη συλλογή | DefaultTTL = "n" στη συλλογή|
| ------------- |:-------------|:-------------|:-------------|
| TTL λείπουν σε έγγραφο| Δεν υπάρχει τίποτα για να παρακάμψετε σε επίπεδο εγγράφου, καθώς και το έγγραφο και συλλογή έχουν καμία έννοια της TTL. | Δεν υπάρχουν έγγραφα σε αυτήν τη συλλογή θα λήξει. | Τα έγγραφα σε αυτήν τη συλλογή θα λήξει όταν περάσει n χρονικό διάστημα. |
| TTL = -1 σε έγγραφο | Τίποτα, προκειμένου να παρακάμψετε σε επίπεδο εγγράφου από τη συλλογή δεν ορίσετε την ιδιότητα DefaultTTL που να παρακάμψετε ένα έγγραφο. TTL σε ένα έγγραφο είναι κατάργησης ερμηνευθεί από το σύστημα. | Δεν υπάρχουν έγγραφα σε αυτήν τη συλλογή θα λήξει. | Το έγγραφο με TTL =-1 σε αυτήν τη συλλογή δεν λήγει ποτέ. Όλα τα άλλα έγγραφα θα λήξει μετά από το διάστημα "n". |
|  TTL = n σε έγγραφο | Δεν υπάρχει τίποτα για να παρακάμψετε σε επίπεδο εγγράφου. TTL σε έγγραφο στο κατάργησης ερμηνευθεί από το σύστημα. | Το έγγραφο με TTL = n θα λήξει μετά από n χρονικό διάστημα, σε δευτερόλεπτα. Άλλα έγγραφα θα μεταβιβάζεται διάστημα του -1 και να μην λήγει ποτέ. | Το έγγραφο με TTL = n θα λήξει μετά από n χρονικό διάστημα, σε δευτερόλεπτα. Άλλα έγγραφα θα μεταβιβάζονται διάστημα "n" από τη συλλογή. |


## <a name="configuring-ttl"></a>Ρύθμιση παραμέτρων TTL

Από προεπιλογή, η διάρκεια ζωής είναι απενεργοποιημένη από προεπιλογή σε όλες τις συλλογές DocumentDB και σε όλα τα έγγραφα.

## <a name="enabling-ttl"></a>Ενεργοποίηση TTL

Για να ενεργοποιήσετε την τιμή TTL σε μια συλλογή ή τα έγγραφα μέσα σε μια συλλογή, πρέπει να ορίσετε την ιδιότητα DefaultTTL μιας συλλογής του -1 ή ένας θετικός αριθμός δεν είναι μηδέν. Ρύθμιση του DefaultTTL σε-1 σημαίνει που από προεπιλογή, όλα τα έγγραφα στη συλλογή θα live για πάντα, αλλά το DocumentDB υπηρεσίας, θα πρέπει να παρακολουθούν αυτήν τη συλλογή για τα έγγραφα που έχετε παρακαμφθούν αυτή την προεπιλογή.

## <a name="configuring-default-ttl-on-a-collection"></a>Ρύθμιση παραμέτρων προεπιλεγμένου TTL σε μια συλλογή

Θα μπορείτε να ρυθμίσετε τις παραμέτρους μιας προεπιλεγμένης διάρκεια ζωής σε επίπεδο συλλογής. 

Για να ορίσετε την τιμή TTL σε μια συλλογή, πρέπει να δώσετε μια μη μηδενική θετικός αριθμός που υποδεικνύει την περίοδο, σε δευτερόλεπτα, ώστε να μην λήγει όλα τα έγγραφα στη συλλογή μετά τη χρονική σήμανση τελευταίας τροποποίησης του εγγράφου (_ts).

Εναλλακτικά, μπορείτε να ορίσετε την προεπιλεγμένη σε -1, το οποίο σημαίνει ότι όλα τα έγγραφα που έχουν εισαχθεί στη συλλογή θα live απεριόριστο χρονικό διάστημα από προεπιλογή.

## <a name="setting-ttl-on-a-document"></a>Ρύθμιση TTL σε ένα έγγραφο

Εκτός από τον ορισμό έναν προεπιλεγμένο TTL σε μια συλλογή μπορείτε να ορίσετε συγκεκριμένες TTL σε επίπεδο εγγράφου. Αυτή η ενέργεια θα αντικαταστήσει το προεπιλεγμένο της συλλογής.

Για να ορίσετε την τιμή TTL σε ένα έγγραφο, πρέπει να δώσετε έναν θετικό αριθμό μη μηδενική που υποδηλώνει την περίοδο, σε δευτερόλεπτα, ώστε να μην λήγει το έγγραφο μετά τη χρονική σήμανση τελευταίας τροποποίησης του εγγράφου (_ts).

Για να ορίσετε αυτήν τη λήξη offset, ορίστε το πεδίο TTL στο έγγραφο.

Εάν ένα έγγραφο έχει κανένα πεδίο TTL, στη συνέχεια, θα εφαρμοστούν την προεπιλεγμένη της συλλογής.

Εάν TTL είναι απενεργοποιημένη στο επίπεδο της συλλογής, το πεδίο TTL στο έγγραφο θα αγνοούνται μέχρι να TTL ενεργοποιείται ξανά στη συλλογή.


## <a name="extending-ttl-on-an-existing-document"></a>Επέκταση TTL σε ένα υπάρχον έγγραφο

Μπορείτε να επαναφέρετε την τιμή TTL σε ένα έγγραφο, κάνοντας οποιαδήποτε λειτουργία εγγραφής στο έγγραφο. Αυτή η ενέργεια θα οριστεί η _ts την τρέχουσα ώρα και την αντίστροφη μέτρηση μέχρι τη λήξη του εγγράφου, όπως έχει οριστεί από την τιμή ttl, θα αρχίσει ξανά.

Εάν θέλετε να αλλάξετε την τιμή ttl ενός εγγράφου, μπορείτε να ενημερώσετε το πεδίο, όπως μπορείτε να κάνετε με οποιοδήποτε άλλο πεδίο μπορεί να οριστεί.


## <a name="removing-ttl-from-a-document"></a>Κατάργηση TTL από ένα έγγραφο

Εάν μια τιμή TTL έχει οριστεί σε ένα έγγραφο και δεν θέλετε πλέον αυτό το έγγραφο να λήξει, στη συνέχεια, για να ανακτήσετε το έγγραφο, καταργήστε το πεδίο TTL και αντικαθιστά το έγγραφο στο διακομιστή.

Όταν το πεδίο TTL καταργείται από το έγγραφο, θα εφαρμοστεί η προεπιλογή της συλλογής.

Για να διακόψετε εγγράφου από λήξη και δεν μεταβιβάζονται από τη συλλογή, στη συνέχεια, πρέπει να ορίσετε την τιμή TTL σε -1.


## <a name="disabling-ttl"></a>Απενεργοποίηση TTL

Για να απενεργοποιήσετε TTL εντελώς σε μια συλλογή και να διακόψετε τη διαδικασία φόντου από αναζητάτε έγγραφα που έχουν λήξει η ιδιότητα DefaultTTL στη συλλογή θα πρέπει να διαγραφεί.

Διαγραφή αυτής της ιδιότητας είναι διαφορετική από τη ρύθμιση του-1. Ρύθμιση για να προστεθεί στη συλλογή νέα έγγραφα-1 σημαίνει ότι θα live για πάντα, αλλά μπορείτε να παρακάμψετε αυτό σε συγκεκριμένα έγγραφα στη συλλογή.

Κατάργηση αυτής της ιδιότητας εντελώς από τη συλλογή σημαίνει ότι ότι δεν υπάρχουν έγγραφα θα λήξει, ακόμα και αν υπάρχουν έγγραφα που έχουν ρητά παρακαμφθούν προηγούμενη προεπιλογή.


## <a name="faq"></a>ΣΥΝΉΘΕΙΣ ΕΡΩΤΉΣΕΙΣ

**Τι θα TTL κόστους μου;**

Δεν υπάρχει χωρίς πρόσθετο κόστος για τη ρύθμιση ενός TTL σε ένα έγγραφο.

**Πόσος χρόνος θα χρειαστεί για να διαγράψετε το έγγραφό μου όταν η τιμή TTL του;**

Τα έγγραφα που έχουν επισημανθεί ως μη διαθέσιμες μόλις το έγγραφο έχει λήξει (ttl + _ts > = τρέχουσα ώρα διακομιστή). Η λειτουργία δεν θα επιτρέπεται σε αυτά τα έγγραφα μετά από αυτήν τη φορά και θα εξαιρούνται από τα αποτελέσματα της τυχόν ερωτήματα που εκτελούνται. Τα έγγραφα φυσικά διαγράφονται από το σύστημα στο παρασκήνιο. Αυτό δεν θα εκμετάλλευση οποιαδήποτε RUs από τη συλλογή προϋπολογισμού.

**Εάν χρειάζονται ένα χρονικό διάστημα για να διαγράψετε τα έγγραφα, θα τους μετρούν μου ορίου (και χρέωσης) μέχρι να έχουν γρήγορα διαγράψει;**

Όχι, όταν το έγγραφο έχει λήξει δεν θα χρεώνεστε για την αποθήκευση των αυτά τα έγγραφα και το μέγεθος των εγγράφων που δεν θα μετρούν του ορίου χώρου αποθήκευσης για μια συλλογή.

**TTL σε ένα έγγραφο που θα έχουν οποιαδήποτε επίδραση στην RU χρεώσεων;**

Όχι, θα υπάρξει καμία επίδραση στην RU χρεώσεις για λειτουργίες που εκτελούνται σε οποιοδήποτε έγγραφο μέσα σε DocumentDB.

**Θα η διαγραφή της έγγραφα επίδραση στο τη μετάδοση που έχουν παρασχεθεί στη συλλογή μου;**

Όχι, η λειτουργία προσκλήσεις σε σχέση με τη συλλογή θα λαμβάνετε προτεραιότητα μέσω εκτελεί τη διαδικασία για να διαγράψετε τα έγγραφά σας στο παρασκήνιο. Προσθήκη TTL σε οποιοδήποτε έγγραφο δεν θα επηρεάσει αυτό.

**Όταν ένα έγγραφο λήξει, πόσος χρόνος θα το παραμένουν μου συλλογής ώσπου να διαγραφεί;**

Μόλις τη λήξη του εγγράφου δεν θα είναι πλέον προσβάσιμα. Την ακριβή ώρα ένα έγγραφο θα παραμείνει στη συλλογή σας, πριν από τη διαγραφή στην πραγματικότητα είναι μη ντετερμινιστική και θα βασιστεί κατά τη διαδικασία φόντου είναι σε θέση να διαγράψετε το έγγραφο.

**Διαγράφονται έγγραφα που έχουν λήξει σε όλους τους κόμβους ή είναι η "τελικά consistent?"**

Το έγγραφο θα είναι πλέον διαθέσιμες ταυτόχρονα σε όλους τους κόμβους και σε όλες τις περιοχές.

**Υπάρχει ένα κόστος RU για παρακολούθηση TTL εργασίες στο παρασκήνιο;**

Όχι, δεν υπάρχει καμία RU κόστος για αυτό.

**Πόσο συχνά είναι επιλεγμένα λήξεων TTL;**

Έλεγχος λήξεων TTL δεν συμβαίνει ως διαδικασία στο παρασκήνιο. Κατά την απάντηση σε πρόσκληση σε την υπηρεσία υποστήριξης θα κάνετε τα ενσωματωμένα ελέγχων και να αποκλείσετε όλα τα έγγραφα που έχουν λήξει. Τη διαγραφή του φυσικού εγγράφου είναι μόνο τη διαδικασία που ασύγχρονα εκτελείται στο παρασκήνιο. Τη συχνότητα αυτής της διαδικασίας προσδιορίζεται από τη διαθέσιμη RUs στη συλλογή.

**Η δυνατότητα TTL εφαρμόζονται μόνο σε ολόκληρο έγγραφα ή να μπορούν να λήξουν τιμές ιδιοτήτων μεμονωμένο έγγραφο;**

TTL ισχύει για ολόκληρο το έγγραφο. Εάν θέλετε να λήξει μόνο ένα τμήμα του εγγράφου, στη συνέχεια, συνιστάται να που εξαγάγετε το τμήμα από το κύριο έγγραφο στο σε χωριστό έγγραφο "συνδεδεμένες" και στη συνέχεια, χρησιμοποιήστε την τιμή TTL σε αυτό το έγγραφο που έχει εξαχθεί.

**Η δυνατότητα TTL διαθέτει οποιαδήποτε συγκεκριμένες απαιτήσεις δημιουργίας ευρετηρίου;**

Ναι. Η συλλογή πρέπει να έχετε [τη δημιουργία ευρετηρίου πολιτική οριστεί](documentdb-indexing-policies.md) αργό ή συνεπής. Προσπαθείτε να ορίσετε DefaultTTL σε μια συλλογή με τη δημιουργία ευρετηρίου σύνολο καμία θα καταλήξει σε σφάλμα, όπως θα προσπαθεί να απενεργοποιήσετε τη δημιουργία ευρετηρίου σε μια συλλογή που έχει μια DefaultTTL ήδη ορίσει.


## <a name="next-steps"></a>Επόμενα βήματα

Για να μάθετε περισσότερα σχετικά με το Azure DocumentDB, ανατρέξτε στη σελίδα [*τεκμηρίωση*](https://azure.microsoft.com/documentation/services/documentdb/) υπηρεσιών.





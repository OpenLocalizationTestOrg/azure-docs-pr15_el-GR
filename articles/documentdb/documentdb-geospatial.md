<properties 
    pageTitle="Εργασία με σε Γεωχωρικά δεδομένα σε Azure DocumentDB | Microsoft Azure" 
    description="Κατανόηση πώς μπορείτε να δημιουργήσετε, να δημιουργήσετε ευρετήριο και ερωτήματος χώρου αντικείμενα με Azure DocumentDB." 
    services="documentdb" 
    documentationCenter="" 
    authors="arramac" 
    manager="jhubbard" 
    editor="monicar"/>

<tags 
    ms.service="documentdb" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.tgt_pltfrm="na" 
    ms.workload="data-services" 
    ms.date="10/25/2016" 
    ms.author="arramac"/>
    
# <a name="working-with-geospatial-data-in-azure-documentdb"></a>Εργασία με σε Γεωχωρικά δεδομένα σε Azure DocumentDB

Σε αυτό το άρθρο είναι μια εισαγωγή σχετικά με τη λειτουργικότητα σε γεωχωρικά στο [Azure DocumentDB](https://azure.microsoft.com/services/documentdb/). Μετά την ανάγνωση αυτό, θα μπορούν να απαντούν στα παρακάτω ερωτήματα:

- Πώς να να αποθηκεύσετε δεδομένα χώρου στο Azure DocumentDB;
- Πώς μπορώ να ερωτήματος σε γεωχωρικά δεδομένα σε DocumentDB Azure στο SQL και LINQ;
- Πώς Ενεργοποίηση ή απενεργοποίηση της δημιουργίας ευρετηρίου χώρου στο DocumentDB;

Ανατρέξτε σε αυτό [το έργο Github](https://github.com/Azure/azure-documentdb-dotnet/blob/master/samples/code-samples/Geospatial/Program.cs) για δείγματα κώδικα.

## <a name="introduction-to-spatial-data"></a>Εισαγωγή στα δεδομένα χώρου

Δεδομένα χώρου περιγράφει τη θέση και το σχήμα των αντικειμένων σε χώρο. Στις περισσότερες εφαρμογές, αυτές αντιστοιχούν σε αντικείμενα σε γης, δηλαδή σε γεωχωρικά δεδομένα. Χώρου δεδομένων μπορεί να χρησιμοποιηθεί για να αντιπροσωπεύει τη θέση του ατόμου, ένα σημείο ενδιαφέροντος ή το όριο της πόλης ή λίμνης. Συνήθεις περιπτώσεις χρήσης αφορούν συχνά ερωτήματα εγγύτητα, π.χ., "βρείτε όλα τα καταστήματα καφέ κοντά τρέχουσα τοποθεσία μου". 

### <a name="geojson"></a>GeoJSON
DocumentDB υποστηρίζει τη δημιουργία ευρετηρίου και υποβολή ερωτημάτων σε γεωχωρικά σημείο δεδομένων που αναπαριστάται με χρήση της [GeoJSON προδιαγραφή](http://geojson.org/geojson-spec.html). GeoJSON δομές δεδομένων είναι πάντα έγκυρη JSON αντικείμενα, ώστε να μπορούν να αποθηκευτούν και ερωτήματα χρησιμοποιώντας DocumentDB χωρίς εξειδικευμένες εργαλεία ή βιβλιοθήκες. Το SDK DocumentDB παρέχουν κλάσεις βοηθών και μεθόδους που διευκολύνουν την εργασία με δεδομένα του χώρου. 

### <a name="points-linestrings-and-polygons"></a>Σημεία, linestrings και πολύγωνα
Ένα **σημείο** υποδηλώνει σε μία μόνο θέση σε χώρο. Στο σε γεωχωρικά δεδομένα, ένα σημείο αντιπροσωπεύει την ακριβή θέση, η οποία θα μπορούσε να είναι μια διεύθυνση του χώρου αποθήκευσης ψώνια, κέντρο πληροφοριών, ένα αυτοκίνητο ή πόλης.  Ένα σημείο αντιπροσωπεύεται στο GeoJSON (και DocumentDB) χρησιμοποιώντας το συντεταγμένων ζεύγος ή γεωγραφικού πλάτους και μήκους. Ακολουθεί ένα παράδειγμα JSON για ένα σημείο.

**Σημεία στο DocumentDB**

    {
       "type":"Point",
       "coordinates":[ 31.9, -4.8 ]
    }

>[AZURE.NOTE] Η προδιαγραφή GeoJSON καθορίζει γεωγραφικού πλάτους και πρώτης δεύτερο. Όπως σε άλλες εφαρμογές αντιστοίχισης, γεωγραφικού πλάτους και μήκους είναι γωνίες και αναπαριστώνται όσον αφορά μοίρες. Τιμές γεωγραφικού υπολογίζονται από το μεσημβρινό και βρίσκονται μεταξύ -180 και 180.0 μοίρες και γεωγραφικό πλάτος τιμές υπολογίζονται από το Ισημερινός και βρίσκονται μεταξύ-90.0 και 90.0 υπηρεσίες μοίρες. 
>
> DocumentDB ερμηνεύει συντεταγμένες όπως αντιπροσωπεύονται ανά σύστημα αναφοράς WGS 84. Δείτε παρακάτω για περισσότερες λεπτομέρειες σχετικά με τα συστήματα συντεταγμένων αναφοράς.

Αυτό μπορεί να ενσωματωθεί σε ένα έγγραφο DocumentDB όπως φαίνεται σε αυτό το παράδειγμα ενός προφίλ χρήστη που περιέχει δεδομένα τοποθεσίας:

**Χρησιμοποιήστε το προφίλ με θέση που είναι αποθηκευμένα σε DocumentDB**

    {
       "id":"documentdb-profile",
       "screen_name":"@DocumentDB",
       "city":"Redmond",
       "topics":[ "NoSQL", "Javascript" ],
       "location":{
          "type":"Point",
          "coordinates":[ 31.9, -4.8 ]
       }
    }

Εκτός από τα σημεία, GeoJSON υποστηρίζει επίσης LineStrings και πολύγωνα. **LineStrings** αντιπροσωπεύει μια σειρά από δύο ή περισσότερα σημεία στο χώρο και τα τμήματα γραμμών που συνδέουν μεταξύ τους. Στο πλαίσιο σε γεωχωρικά δεδομένα linestrings χρησιμοποιούνται συχνά για να αναπαραστήσετε αυτοκινητόδρομους ή ποταμούς. **Πολύγωνο** είναι ένα όριο συνδεδεμένοι σημείων που αποτελεί ένα κλειστό LineString. Πολύγωνα χρησιμοποιούνται ευρέως για την αναπαράσταση φυσική σχηματισμούς όπως λίμνες ή πολιτικές αρμοδιότητες όπως πόλεις και μέλη. Ακολουθεί ένα παράδειγμα του πολύγωνου στο DocumentDB. 

**Πολύγωνα σε DocumentDB**

    {
       "type":"Polygon",
       "coordinates":[
           [ 31.8, -5 ],
           [ 31.8, -4.7 ],
           [ 32, -4.7 ],
           [ 32, -5 ],
           [ 31.8, -5 ]
       ]
    }

>[AZURE.NOTE] Η προδιαγραφή GeoJSON απαιτεί ότι για έγκυρη πολύγωνα, το τελευταίο συντεταγμένων ζεύγος που παρέχεται πρέπει να είναι ίδια με την πρώτη, για να δημιουργήσετε ένα κλειστό σχήμα.
>
>Σημεία μέσα σε ένα πολύγωνο πρέπει να έχει καθοριστεί σε αριστερόστροφα σειρά. Πολύγωνου που καθορίζεται στη σειρά δεξιόστροφα αντιπροσωπεύει το αντίστροφο της περιοχής μέσα σε αυτό.

Εκτός από το σημείο, LineString και πολύγωνου, GeoJSON καθορίζει επίσης η αναπαράσταση για το πώς μπορείτε να ομαδοποιήσετε πολλές θέσεις σε γεωχωρικά, καθώς και πώς μπορείτε να συσχετίσετε αυθαίρετο ιδιότητες με γεωεντοπισμός ως **δυνατότητα**. Εφόσον αυτά τα αντικείμενα έχουν έγκυρες JSON, αυτές μπορούν να όλα είναι αποθηκευμένο και υποβάλλονται σε επεξεργασία σε DocumentDB. Ωστόσο DocumentDB υποστηρίζει μόνο την αυτόματη δημιουργία ευρετηρίου των σημείων.

### <a name="coordinate-reference-systems"></a>Συστήματα συντεταγμένων αναφοράς

Επειδή το σχήμα της γης είναι ακανόνιστο, αντιπροσωπεύεται συντεταγμένες σε γεωχωρικά δεδομένα σε πολλά συντεταγμένων αναφοράς συστήματα (ΗΣΚ), κάθε μία με τις δικές τους πλαισίων αναφοράς και τις μονάδες μέτρησης. Για παράδειγμα, το "National πλέγμα της Βρετανίας" είναι ένα σύστημα αναφορά είναι πολύ ακριβείς για το Ηνωμένο Βασίλειο, αλλά δεν έξω από αυτό. 

Τα πιο δημοφιλή ΗΣΚ χρησιμοποιείται σήμερα είναι η παγκόσμια γεωδαιτικό σύστημα [WGS 84](http://earth-info.nga.mil/GandG/wgs84/). Συσκευές GPS και πολλές αντιστοίχισης υπηρεσίες όπως χάρτες Google και API της έκδοσης του Bing, ο Yammer της χάρτες Χρησιμοποιήστε WGS 84. DocumentDB υποστηρίζει τη δημιουργία ευρετηρίου και υποβολή ερωτημάτων σε γεωχωρικά δεδομένα χρησιμοποιώντας μόνο το ΗΣΚ WGS 84. 

## <a name="creating-documents-with-spatial-data"></a>Δημιουργία εγγράφων με δεδομένα του χώρου
Όταν δημιουργείτε έγγραφα που περιέχουν τιμές GeoJSON, αυτοί είναι αυτόματα στο ευρετήριο με ευρετήριο χώρου σύμφωνα με την πολιτική δημιουργίας ευρετηρίου της συλλογής. Εάν εργάζεστε με ένα SDK DocumentDB σε δυναμικό πληκτρολογημένες γλώσσα όπως Python ή Node.js, πρέπει να δημιουργήσετε έγκυρη GeoJSON.

**Δημιουργία εγγράφου με σε Γεωχωρικά δεδομένα σε Node.js**

    var userProfileDocument = {
       "name":"documentdb",
       "location":{
          "type":"Point",
          "coordinates":[ -122.12, 47.66 ]
       }
    };

    client.createDocument(`dbs/${databaseName}/colls/${collectionName}`, userProfileDocument, (err, created) => {
        // additional code within the callback
    });

Εάν εργάζεστε με το .NET (ή Java) SDK, μπορείτε να χρησιμοποιήσετε τη νέα κλάσεις σημείο και πολύγωνου μέσα στο χώρο ονομάτων Microsoft.Azure.Documents.Spatial για ενσωμάτωση των πληροφοριών θέσης μέσα σε τα αντικείμενα της εφαρμογής. Αυτές οι κλάσεις Απλοποιήστε τα σειριοποίησης και αποσειριοποίησης χώρου δεδομένων σε GeoJSON.

**Δημιουργία εγγράφου με σε Γεωχωρικά δεδομένα σε .NET**

    using Microsoft.Azure.Documents.Spatial;
    
    public class UserProfile
    {
        [JsonProperty("name")]
        public string Name { get; set; }

        [JsonProperty("location")]
        public Point Location { get; set; }
        
        // More properties
    }
    
    await client.CreateDocumentAsync(
        UriFactory.CreateDocumentCollectionUri("db", "profiles"), 
        new UserProfile 
        { 
            Name = "documentdb", 
            Location = new Point (-122.12, 47.66) 
        });

Εάν δεν έχετε τις πληροφορίες γεωγραφικού πλάτους και μήκους, αλλά έχετε το φυσικό διευθύνσεις ή όνομα θέσης όπως πόλη ή χώρα, μπορείτε να αναζητήσετε την πραγματική συντεταγμένων, χρησιμοποιώντας μια υπηρεσία γεωγραφική κωδικοποίηση όπως υπηρεσίες ΥΠΌΛΟΙΠΑ χάρτες Bing. Μάθετε περισσότερα σχετικά με τους χάρτες Bing γεωγραφική κωδικοποίηση [εδώ](https://msdn.microsoft.com/library/ff701713.aspx).

## <a name="querying-spatial-types"></a>Υποβολή ερωτημάτων χώρου τύπων

Τώρα που θα σας τραβήξατε δείτε πώς μπορείτε να εισαγάγετε σε γεωχωρικά δεδομένα, ας ρίξουμε μια ματιά Τρόπος υποβολής ερωτημάτων αυτών των δεδομένων με χρήση SQL και LINQ DocumentDB.

### <a name="spatial-sql-built-in-functions"></a>Χώρου ενσωματωμένες συναρτήσεις SQL
DocumentDB υποστηρίζει τις παρακάτω ενσωματωμένες συναρτήσεις Άνοιγμα σε Γεωχωρικά Consortium (OGC) για την υποβολή ερωτημάτων σε γεωχωρικά. Για περισσότερες λεπτομέρειες σχετικά με το πλήρες σύνολο των ενσωματωμένες συναρτήσεις στη γλώσσα SQL, ανατρέξτε στην [DocumentDB ερωτήματος](documentdb-sql-query.md).

<table>
<tr>
  <td><strong>Χρήση</strong></td>
  <td><strong>Περιγραφή</strong></td>
</tr>
<tr>
  <td>ST_DISTANCE (point_expr, point_expr)</td>
  <td>Επιστρέφει την απόσταση μεταξύ τις δύο παραστάσεις σημείο GeoJSON.</td>
</tr>
<tr>
  <td>ST_WITHIN (point_expr, polygon_expr)</td>
  <td>Επιστρέφει μια δυαδική παράσταση που υποδεικνύει εάν το σημείο GeoJSON που καθορίζεται στο πρώτο όρισμα είναι εντός του πολυγώνου GeoJSON στο δεύτερο όρισμα.</td>
</tr>
<tr>
  <td>ST_ISVALID</td>
  <td>Επιστρέφει μια τιμή Boolean που υποδεικνύει αν το καθορισμένο GeoJSON σημείο ή πολύγωνου παράσταση είναι έγκυρα.</td>
</tr>
<tr>
  <td>ST_ISVALIDDETAILED</td>
  <td>Επιστρέφει την τιμή μια τιμή JSON που περιέχει μια τιμή Boolean εάν η καθορισμένη παράσταση σημείο ή πολύγωνου GeoJSON είναι έγκυρη και δεν είναι έγκυρο, επιπλέον το λόγο για τον ως μια τιμή συμβολοσειράς.</td>
</tr>
</table>

Συναρτήσεις χώρου μπορούν να χρησιμοποιηθούν για την εκτέλεση ερωτημάτων εγγύτητα έναντι χώρου δεδομένων. Για παράδειγμα, ακολουθεί ένα ερώτημα που επιστρέφει όλα τα έγγραφα οικογένειας που βρίσκονται εντός 30 χιλιόμετρα του στη θέση που καθορίζεται με χρήση της συνάρτησης ενσωματωμένη ST_DISTANCE. 

**Ερώτημα**

    SELECT f.id 
    FROM Families f 
    WHERE ST_DISTANCE(f.location, {'type': 'Point', 'coordinates':[31.9, -4.8]}) < 30000

**Αποτελέσματα**

    [{
      "id": "WakefieldFamily"
    }]

Εάν συμπεριλάβετε χώρου δημιουργίας ευρετηρίου στην πολιτική δημιουργίας ευρετηρίου σας, στη συνέχεια, "απόσταση ερωτήματα" θα είναι που σερβιρίστηκε αποτελεσματικά έως το ευρετήριο. Για περισσότερες λεπτομέρειες σχετικά με τη δημιουργία ευρετηρίου χώρου, ανατρέξτε στην ενότητα παρακάτω. Εάν δεν έχετε ένα ευρετήριο χώρου για την καθορισμένη διαδρομές, μπορείτε να εκτελέσετε εξακολουθεί να χώρου ερωτημάτων, καθορίζοντας `x-ms-documentdb-query-enable-scan` κεφαλίδα αίτησης με την τιμή ρυθμισμένη στην τιμή "true". Στο .NET, αυτό μπορεί να γίνει, μεταφέροντας το προαιρετικό όρισμα **FeedOptions** στα ερωτήματα με [EnableScanInQuery](https://msdn.microsoft.com/library/microsoft.azure.documents.client.feedoptions.enablescaninquery.aspx#P:Microsoft.Azure.Documents.Client.FeedOptions.EnableScanInQuery) οριστεί στην τιμή true. 

ST_WITHIN μπορεί να χρησιμοποιηθεί για να ελέγξετε εάν ένα σημείο βρίσκεται μέσα σε ένα πολύγωνο. Συνήθως πολύγωνα που χρησιμοποιούνται για την αναπαράσταση όρια, όπως ταχυδρομικοί κώδικες, όρια κατάστασης ή φυσική σχηματισμούς. Ξανά Εάν συμπεριλάβετε χώρου δημιουργίας ευρετηρίου στην πολιτική δημιουργίας ευρετηρίου σας, στη συνέχεια, "μέσα" ερωτήματα θα είναι που σερβιρίστηκε αποτελεσματικά έως το ευρετήριο. 

Ορίσματα πολύγωνου στο ST_WITHIN μπορεί να περιέχει μόνο ένα κουδούνισμα, δηλαδή τα πολύγωνα δεν πρέπει να περιέχουν κενά σε αυτές. 

**Ερώτημα**

    SELECT * 
    FROM Families f 
    WHERE ST_WITHIN(f.location, {
        'type':'Polygon', 
        'coordinates': [[[31.8, -5], [32, -5], [32, -4.7], [31.8, -4.7], [31.8, -5]]]
    })

**Αποτελέσματα**

    [{
      "id": "WakefieldFamily",
    }]
    
>[AZURE.NOTE] Παρόμοια με τον τρόπο που δεν συμφωνούν τύποι λειτουργεί στο ερώτημα DocumentDB, εάν η τιμή θέση που καθορίζεται στο είτε όρισμα είναι ακατάλληλη ή δεν είναι έγκυρη και, στη συνέχεια, να **απροσδιόριστη** και αξιολογηθεί έγγραφο για να γίνει παράκαμψη από τα αποτελέσματα του ερωτήματος θα είναι το. Εάν το ερώτημα επιστρέφει κανένα αποτέλεσμα, εκτελέστε ST_ISVALIDDETAILED σε ο εντοπισμός σφαλμάτων γιατί ο τύπος spatail δεν είναι έγκυρη.     

DocumentDB υποστηρίζει επίσης εκτέλεση αντίστροφη ερωτημάτων, π.χ. Μπορείτε να δημιουργήσετε ευρετήριο πολύγωνα ή γραμμές σε DocumentDB και έπειτα ερώτημα για τις περιοχές που περιέχουν ένα συγκεκριμένο σημείο. Αυτό το μοτίβο χρησιμοποιείται συνήθως σε εφοδιαστική για τον προσδιορισμό π.χ. Όταν ένα μηχάνημα για την είσοδο ή αφήνει μια καθορισμένη περιοχή. 

**Ερώτημα**

    SELECT * 
    FROM Areas a 
    WHERE ST_WITHIN({'type': 'Point', 'coordinates':[31.9, -4.8]}, a.location)


**Αποτελέσματα**

    [{
      "id": "MyDesignatedLocation",
      "location": {
        "type":"Polygon", 
        "coordinates": [[[31.8, -5], [32, -5], [32, -4.7], [31.8, -4.7], [31.8, -5]]]
      }
    }]

ST_ISVALID και ST_ISVALIDDETAILED μπορεί να χρησιμοποιηθεί για να ελέγξετε εάν ένα αντικείμενο χώρου είναι έγκυρη. Για παράδειγμα, το ακόλουθο ερώτημα ελέγχει την εγκυρότητα ενός σημείου με μια εκτός της περιοχής γεωγραφικό πλάτος τιμή (-132.8). ST_ISVALID επιστρέφει απλώς μια τιμή Boolean και ST_ISVALIDDETAILED επιστρέφει την τιμή Boolean και μια συμβολοσειρά που περιέχει το λόγο για τον γιατί θεωρείται μη έγκυροι.

**Ερώτημα**

    SELECT ST_ISVALID({ "type": "Point", "coordinates": [31.9, -132.8] })

**Αποτελέσματα**

    [{
      "$1": false
    }]

Αυτές οι συναρτήσεις επίσης μπορεί να χρησιμοποιηθεί για την επικύρωση πολύγωνα. Για παράδειγμα, δείτε εδώ χρησιμοποιούμε ST_ISVALIDDETAILED για την επικύρωση πολύγωνου που δεν είναι κλειστό. 

**Ερώτημα**

    SELECT ST_ISVALIDDETAILED({ "type": "Polygon", "coordinates": [[ 
        [ 31.8, -5 ], [ 31.8, -4.7 ], [ 32, -4.7 ], [ 32, -5 ] 
        ]]})

**Αποτελέσματα**

    [{
       "$1": { 
          "valid": false, 
          "reason": "The Polygon input is not valid because the start and end points of the ring number 1 are not the same. Each ring of a polygon must have the same start and end points." 
        }
    }]
    
### <a name="linq-querying-in-the-net-sdk"></a>Την άντληση πληροφοριών με το .NET SDK LINQ

Το .NET SDK DocumentDB επίσης υπηρεσίες παροχής στέλεχος μεθόδους `Distance()` και `Within()` για χρήση σε παραστάσεις LINQ. Η υπηρεσία παροχής DocumentDB LINQ μεταφράζεται αυτές τις κλήσεις μέθοδο για την ισοδύναμη κλήσεων ενσωματωμένη συνάρτηση SQL (ST_DISTANCE και ST_WITHIN αντίστοιχα). 

Ακολουθεί ένα παράδειγμα ενός ερωτήματος LINQ που εντοπίζει όλα τα έγγραφα στη συλλογή DocumentDB του οποίου την τιμή "θέση" είναι σε ακτίνα 30 χιλιόμετρα του καθορισμένου τοποθετήστε το δείκτη με χρήση LINQ.

**Ερώτημα LINQ για απόσταση**

    foreach (UserProfile user in client.CreateDocumentQuery<UserProfile>(UriFactory.CreateDocumentCollectionUri("db", "profiles"))
        .Where(u => u.ProfileType == "Public" && a.Location.Distance(new Point(32.33, -4.66)) < 30000))
    {
        Console.WriteLine("\t" + user);
    }

Ομοίως, θα δείτε ένα ερώτημα για την εύρεση όλα τα έγγραφα των οποίων "θέση" είναι μέσα σε καθορισμένο πλαίσιο/πολύγωνο. 

**LINQ ερωτήματος για μέσα σε**

    Polygon rectangularArea = new Polygon(
        new[]
        {
            new LinearRing(new [] {
                new Position(31.8, -5),
                new Position(32, -5),
                new Position(32, -4.7),
                new Position(31.8, -4.7),
                new Position(31.8, -5)
            })
        });

    foreach (UserProfile user in client.CreateDocumentQuery<UserProfile>(UriFactory.CreateDocumentCollectionUri("db", "profiles"))
        .Where(a => a.Location.Within(rectangularArea)))
    {
        Console.WriteLine("\t" + user);
    }


Τώρα που θα σας τραβήξατε δείτε πώς μπορείτε να απευθύνετε το ερώτημα εγγράφων χρησιμοποιώντας LINQ και SQL, ας ρίξουμε μια ματιά πώς μπορείτε να ρυθμίσετε τις παραμέτρους DocumentDB για τη δημιουργία ευρετηρίου χώρου.

## <a name="indexing"></a>Δημιουργία ευρετηρίου

Που θα σας περιγράφεται στο χαρτί [Σχήματος Agnostic δημιουργίας ευρετηρίου με Azure DocumentDB](http://www.vldb.org/pvldb/vol8/p1668-shukla.pdf) , θα σας έχει σχεδιαστεί DocumentDB του μηχανισμού βάσεων δεδομένων να είναι πραγματικά agnostic σχήματος και παρέχει πρώτης κλάσης υποστήριξη για JSON. Το μηχανισμό βάσεων δεδομένων εγγραφής βελτιστοποίηση της DocumentDB αναγνωρίζει εγγενώς αντιπροσωπεύει την τυπική GeoJSON χώρου δεδομένων (σημεία, πολύγωνα και γραμμές).

Με λίγα λόγια, τη γεωμετρική είναι προβλεπόμενου από γεωδαιτικό συντεταγμένες σε ένα επίπεδο 2-δ, στη συνέχεια, διαιρείται σταδιακά σε κελιά χρησιμοποιώντας έναν **quadtree**. Αυτά τα κελιά έχουν αντιστοιχιστεί 1D με βάση τη θέση του κελιού μέσα σε μια **καμπύλη συμπλήρωση χώρο Hilbert**, που διατηρεί τοποθεσία των σημείων. Επιπλέον όταν δεδομένα τοποθεσίας σε ευρετήριο, διέρχεται από μια διαδικασία γνωστή ως **ψηφιδοποίηση**, δηλαδή όλα τα κελιά που τέμνονται μια θέση αναγνωρίζονται και έχουν αποθηκευτεί ως πλήκτρα στο ευρετήριο DocumentDB. Στιγμή ερωτήματος, ορίσματα, όπως τα σημεία και πολύγωνα είναι επίσης tessellated για να εξαγάγετε τις περιοχές Αναγνωριστικό σχετικό κελί και στη συνέχεια χρησιμοποιείται για την ανάκτηση δεδομένων από το ευρετήριο.

Αν καθορίζετε μια πολιτική δημιουργίας ευρετηρίου που περιλαμβάνει χώρου ευρετηρίου για / * (όλες οι διαδρομές), στη συνέχεια, όλα τα σημεία που βρίσκονται εντός της συλλογής έχουν συμπεριληφθεί για αποτελεσματική χώρου ερωτήματα (ST_WITHIN και ST_DISTANCE). Ευρετήρια χώρου δεν έχει μια τιμή ακρίβεια, και να χρησιμοποιείται πάντα μια προεπιλεγμένη τιμή ακρίβεια.

>[AZURE.NOTE] DocumentDB υποστηρίζει αυτόματη δημιουργία ευρετηρίου των σημείων, πολύγωνα και LineStrings

Το παρακάτω τμήμα κώδικα JSON εμφανίζει μια πολιτική δημιουργίας ευρετηρίου με χώρου δημιουργίας ευρετηρίου ενεργοποιημένη, δηλαδή δημιουργήσετε ευρετήριο σε οποιοδήποτε σημείο GeoJSON βρίσκονται στα έγγραφα για την υποβολή ερωτημάτων χώρου. Εάν θέλετε να τροποποιήσετε την πολιτική δημιουργίας ευρετηρίου με την πύλη Azure, μπορείτε να καθορίσετε την εξής JSON για την πολιτική δημιουργίας ευρετηρίου για να ενεργοποιήσετε την χώρου δημιουργίας ευρετηρίου στη συλλογή σας.

**Συλλογή δημιουργίας ευρετηρίου πολιτικής JSON με ενεργοποιημένη για σημεία και πολύγωνα Spatial**

    {
       "automatic":true,
       "indexingMode":"Consistent",
       "includedPaths":[
          {
             "path":"/*",
             "indexes":[
                {
                   "kind":"Range",
                   "dataType":"String",
                   "precision":-1
                },
                {
                   "kind":"Range",
                   "dataType":"Number",
                   "precision":-1
                },
                {
                   "kind":"Spatial",
                   "dataType":"Point"
                },
                {
                   "kind":"Spatial",
                   "dataType":"Polygon"
                }                
             ]
          }
       ],
       "excludedPaths":[
       ]
    }

Ακολουθεί ένα τμήμα κώδικα στο .NET που δείχνει πώς μπορείτε να δημιουργήσετε μια συλλογή με χώρου δημιουργίας ευρετηρίου ενεργοποιημένη για όλες οι διαδρομές που περιέχει σημεία. 

**Δημιουργία συλλογής με χώρου δημιουργίας ευρετηρίου**

    DocumentCollection spatialData = new DocumentCollection()
    spatialData.IndexingPolicy = new IndexingPolicy(new SpatialIndex(DataType.Point)); //override to turn spatial on by default
    collection = await client.CreateDocumentCollectionAsync(UriFactory.CreateDatabaseUri("db"), spatialData);

Και εδώ πώς μπορείτε να τροποποιήσετε μια υπάρχουσα συλλογή για να επωφεληθείτε από χώρου δημιουργίας ευρετηρίου πάνω από οποιαδήποτε σημεία που είναι αποθηκευμένα μέσα σε έγγραφα.

**Τροποποίηση μιας υπάρχουσας συλλογής με χώρου δημιουργίας ευρετηρίου**

    Console.WriteLine("Updating collection with spatial indexing enabled in indexing policy...");
    collection.IndexingPolicy = new IndexingPolicy(new SpatialIndex(DataType.Point));
    await client.ReplaceDocumentCollectionAsync(collection);

    Console.WriteLine("Waiting for indexing to complete...");
    long indexTransformationProgress = 0;
    while (indexTransformationProgress < 100)
    {
        ResourceResponse<DocumentCollection> response = await client.ReadDocumentCollectionAsync(UriFactory.CreateDocumentCollectionUri("db", "coll"));
        indexTransformationProgress = response.IndexTransformationProgress;

        await Task.Delay(TimeSpan.FromSeconds(1));
    }

> [AZURE.NOTE] Εάν η θέση τιμή GeoJSON μέσα στο έγγραφο είναι ακατάλληλη ή δεν είναι έγκυρο, στη συνέχεια, το δεν θα λάβετε στο ευρετήριο για χώρου υποβολή ερωτημάτων. Μπορείτε να επικυρώσετε θέση τιμών με τη χρήση ST_ISVALID και ST_ISVALIDDETAILED.
>
> Εάν σας ορισμού συλλογής περιλαμβάνει έναν αριθμό-κλειδί διαμερίσματα, δεν αναφέρεται η δημιουργίας ευρετηρίου για την πρόοδο μετασχηματισμό. 

## <a name="next-steps"></a>Επόμενα βήματα
Τώρα που έχετε learnt σχετικά με το πώς μπορείτε να ξεκινήσετε με την υποστήριξη σε γεωχωρικά στο DocumentDB, μπορείτε να:

- Έναρξη κωδικοποίησης με τα [δείγματα κώδικα .NET σε Γεωχωρικά σε Github](https://github.com/Azure/azure-documentdb-dotnet/blob/fcf23d134fc5019397dcf7ab97d8d6456cd94820/samples/code-samples/Geospatial/Program.cs)
- Λήψη χέρια με την υποβολή ερωτημάτων σε γεωχωρικά στο το [DocumentDB Αναδειχτείτε ερωτήματος](http://www.documentdb.com/sql/demo#geospatial)
- Μάθετε περισσότερα σχετικά με [Το ερώτημα DocumentDB](documentdb-sql-query.md)
- Μάθετε περισσότερα σχετικά με τις [Πολιτικές δημιουργίας ευρετηρίου DocumentDB](documentdb-indexing-policies.md)

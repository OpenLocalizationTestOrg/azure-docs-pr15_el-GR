<properties 
    pageTitle="DocumentDB μοντέλο ιεραρχική πόρων και έννοιες | Microsoft Azure" 
    description="Μάθετε περισσότερα σχετικά με ιεραρχική μοντέλο του DocumentDB βάσεις δεδομένων, συλλογές, συνάρτηση ορίζονται από το χρήστη (UDF), έγγραφα, δικαιωμάτων για τη διαχείριση πόρων και πολλά άλλα."
    keywords="Ιεραρχικό μοντέλο, documentdb, azure, Microsoft azure"   
    services="documentdb" 
    documentationCenter="" 
    authors="AndrewHoh" 
    manager="jhubbard" 
    editor="monicar"/>

<tags 
    ms.service="documentdb" 
    ms.workload="data-services" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="10/28/2016" 
    ms.author="anhoh"/>

# <a name="documentdb-hierarchical-resource-model-and-concepts"></a>Μοντέλο DocumentDB ιεραρχική πόρων και τα θέματα

Το οντοτήτων βάσης δεδομένων που διαχειρίζεται το DocumentDB αναφέρονται ως **πόρους**. Κάθε πόρο με μοναδικό τρόπο προσδιορίζεται από ένα λογικό URI. Μπορείτε να αλληλεπιδράτε με τους πόρους χρησιμοποιώντας τυπικά ρήματα HTTP, κεφαλίδες/απόκριση αίτησης και κωδικοί κατάστασης. 

Κατά την ανάγνωση αυτό το άρθρο, θα έχετε τη δυνατότητα να απαντούν στα παρακάτω ερωτήματα:

- Τι είναι το μοντέλο πόρων του DocumentDB;
- Τι είναι οι συστήματος που ορίζονται από τους πόρους αντί για τους πόρους που ορίζονται από το χρήστη;
- Πώς μπορώ να προσθέσω διεύθυνση πόρου;
- Πώς μπορώ να εργαστώ με συλλογές;
- Πώς μπορώ να εργαστώ με αποθηκευμένες διαδικασίες, εναύσματα και συναρτήσεις που ορίζονται από το χρήστη (UDF);

## <a name="hierarchical-resource-model"></a>Μοντέλο ιεραρχική πόρων
Όπως το παρακάτω διάγραμμα παρουσιάζει, DocumentDB ιεραρχική **μοντέλο πόρων** αποτελείται από τα σύνολα των πόρων στην περιοχή λογαριασμός βάσης δεδομένων, κάθε μπορούν να χρησιμοποιηθούν μέσω ενός URI λογική και είναι σταθερό. Ένα σύνολο πόρων θα αναφέρεται ως μια **τροφοδοσία** σε αυτό το άρθρο. 

>[AZURE.NOTE] DocumentDB προσφέρει μια ιδιαίτερα αποτελεσματική πρωτόκολλο TCP που είναι επίσης RESTful του μοντέλου επικοινωνίας, μέσω του [προγράμματος-πελάτη .NET SDK](https://msdn.microsoft.com/library/azure/dn781482.aspx).

![Μοντέλο DocumentDB ιεραρχική πόρων][1]  
**Μοντέλο ιεραρχική πόρων**   

Για να ξεκινήσετε να εργάζεστε με τους πόρους, θα πρέπει να [δημιουργήσετε ένα λογαριασμό DocumentDB βάσης δεδομένων](documentdb-create-account.md) χρησιμοποιώντας τη συνδρομή σας στο Azure. Ένα λογαριασμό της βάσης δεδομένων μπορεί να αποτελείται από ένα σύνολο **βάσεις δεδομένων**, πολλές **συλλογές**, τα οποία περιέχουν με τη σειρά που περιέχουν **αποθηκευμένες διαδικασίες, ενεργοποιεί, UDF, έγγραφα** και τα σχετικά **συνημμένα** (preview δυνατότητα). Επίσης, μια βάση δεδομένων είναι συσχετισμένη **χρήστες**, κάθε μία με ένα σύνολο **δικαιωμάτων** για να αποκτήσετε πρόσβαση συλλογών, αποθηκευμένες διαδικασίες, εναύσματα, UDF, έγγραφα ή τα συνημμένα. Ενώ βάσεων δεδομένων, οι χρήστες, δικαιώματα και συλλογές είναι οι πόροι που ορίζονται από το σύστημα με τις γνωστές σχήματα, έγγραφα και τα συνημμένα περιέχουν αυθαίρετο, JSON περιεχομένου ορίζονται από το χρήστη.  

|Πόρων   |Περιγραφή
|-----------|-----------
|Λογαριασμός βάσης δεδομένων   |Ένα λογαριασμό της βάσης δεδομένων είναι συσχετισμένη με ένα σύνολο των βάσεων δεδομένων και μια σταθερή ποσότητα χώρου αποθήκευσης αντικειμένων blob για συνημμένα (δυνατότητα προεπισκόπησης). Μπορείτε να δημιουργήσετε έναν ή περισσότερους λογαριασμούς βάσης δεδομένων με χρήση Azure τη συνδρομή σας. Για περισσότερες πληροφορίες, επισκεφθείτε μας [τις τιμές σελίδας](https://azure.microsoft.com/pricing/details/documentdb/).
|Βάση δεδομένων   |Μια βάση δεδομένων είναι ένα λογικό κοντέινερ χώρου αποθήκευσης εγγράφων διαμερίσματα σε συλλογές. Επίσης, είναι ένα κοντέινερ χρηστών.
|Χρήστη   |Η λογική χώρος ονομάτων για την εμβέλεια δικαιώματα. 
|Δικαιωμάτων |Ένα διακριτικό εξουσιοδότησης που σχετίζονται με ένα χρήστη για πρόσβαση σε έναν συγκεκριμένο πόρο.
|Συλλογή |Μια συλλογή είναι ένα κοντέινερ JSON εγγράφων και τη συσχετισμένη λογική εφαρμογής JavaScript. Μια συλλογή είναι χρεώσιμων οντότητα, όπου το [κόστος](documentdb-performance-levels.md) προσδιορίζεται από το επίπεδο απόδοσης που σχετίζεται με τη συλλογή. Συλλογές μπορεί να εκτείνεται σε έναν ή περισσότερους διαμερίσματα/διακομιστές και μπορεί να περιορίσετε το μέγεθος για το χειρισμό όγκους σχεδόν απεριόριστο χώρο αποθήκευσης ή μετάδοσης.
|Αποθηκευμένη διαδικασία   |Εφαρμογή λογικής που έχει συνταχθεί σε JavaScript που έχει εγγραφεί σε μια συλλογή και να ενημερώσετε εκτελεστεί εντός το μηχανισμό βάσεων δεδομένων.
|Έναυσμα    |Εφαρμογή λογικής που έχει συνταχθεί σε JavaScript που εκτελείται πριν ή μετά από μια εισαγωγή, αντικατάσταση ή η λειτουργία διαγραφής.
|UDF    |Εφαρμογή λογικής που έχει συνταχθεί σε JavaScript. UDF σάς επιτρέπουν να μοντέλου έναν τελεστή προσαρμοσμένο ερώτημα και συνεπώς επέκταση βασικού DocumentDB γλώσσα ερωτημάτων.
|Έγγραφο   |(Αυθαίρετο) περιεχόμενο JSON ορίζονται από το χρήστη. Από προεπιλογή, δεν υπάρχει σχήμα πρέπει να οριστεί ούτε χρειάζονται δευτερεύοντα οι δείκτες που διατίθενται για όλα τα έγγραφα που προστίθενται σε μια συλλογή.
|(Έκδοση preview) Συνημμένο   |Ένα συνημμένο είναι ένα ειδικό έγγραφο που περιέχει αναφορές και τα συσχετισμένα μετα-δεδομένα για εξωτερική blob/πολυμέσων. Ο προγραμματιστής να επιλέξετε να έχετε το αντικείμενο blob ελέγχονται από DocumentDB ή να το αποθηκεύσετε με μια υπηρεσία παροχής εξωτερικών blob όπως το OneDrive, Dropbox, κ.λπ. 


## <a name="system-vs-user-defined-resources"></a>Σύστημα έναντι πόρους που ορίζονται από το χρήστη
Πόροι όπως λογαριασμούς της βάσης δεδομένων, βάσεις δεδομένων, συλλογές, οι χρήστες, δικαιώματα, αποθηκευμένες διαδικασίες, εναύσματα και UDF - όλα έχουν ένα σταθερό σχήμα και ονομάζονται πόρους του συστήματος. Αντίθετα, τους πόρους, όπως έγγραφα και τα συνημμένα έχουν χωρίς περιορισμούς στη διάταξη και είναι παραδείγματα των πόρων που ορίζονται από το χρήστη. Στο DocumentDB, σύστημα και ορίζονται από το χρήστη αναπαρίστανται και διαχείριση ως συμβατή με τυπική JSON πόρους. Όλους τους πόρους, σύστημα ή χρήστης που ορίζονται από το, έχετε τις ακόλουθες κοινές ιδιότητες.

> [AZURE.NOTE] Σημειώστε ότι όλα δημιουργούνται από το σύστημα ιδιότητες σε έναν πόρο είναι το πρόθεμα χαρακτήρας υπογράμμισης (_) σε τους αναπαράσταση JSON.

<table>
    <tbody>
        <tr>
            <td valign="top"><p><strong>Ιδιότητα</strong></p></td>
            <td valign="top"><p><strong>Χρήστης μπορεί να οριστεί ή δημιουργείται από το σύστημα;</strong></p></td>
            <td valign="top"><p><strong>Σκοπός</strong></p></td>
        </tr>
        <tr>
            <td valign="top"><p>_rid</p></td>
            <td valign="top"><p>Δημιουργείται από το σύστημα</p></td>
            <td valign="top"><p>Δημιουργούνται από το σύστημα, μοναδικό και ιεραρχική αναγνωριστικό του πόρου</p></td>
        </tr>
        <tr>
            <td valign="top"><p>_etag</p></td>
            <td valign="top"><p>Δημιουργείται από το σύστημα</p></td>
            <td valign="top"><p>ETag του πόρου που απαιτείται για τον έλεγχο του βέλτιστου</p></td>
        </tr>
        <tr>
            <td valign="top"><p>_ts</p></td>
            <td valign="top"><p>Δημιουργείται από το σύστημα</p></td>
            <td valign="top"><p>Τελευταία ενημερωμένη χρονικής σήμανσης του πόρου</p></td>
        </tr>
        <tr>
            <td valign="top"><p>_self:</p></td>
            <td valign="top"><p>Δημιουργείται από το σύστημα</p></td>
            <td valign="top"><p>Μοναδικό μπορούν να χρησιμοποιηθούν URI του πόρου</p></td>
        </tr>
        <tr>
            <td valign="top"><p>αναγνωριστικό</p></td>
            <td valign="top"><p>Δημιουργείται από το σύστημα</p></td>
            <td valign="top"><p>Μοναδικό όνομα του πόρου (με την ίδια partition τιμή κλειδιού) ορίζονται από το χρήστη. Εάν ο χρήστης δεν έχει καθοριστεί αναγνωριστικό, ένα αναγνωριστικό θα δημιουργείται από το σύστημα</p></td>
        </tr>
    </tbody>
</table>

### <a name="wire-representation-of-resources"></a>Γραμμικό αναπαράσταση των πόρων
DocumentDB δεν υποχρεώνει οποιαδήποτε ΚΥΡΙΟΤΗΤΑΣ επεκτάσεις για το JSON τυπική ή ειδική κωδικοποιήσεις; λειτουργεί με τυπική συμβατή JSON έγγραφα.  
 
### <a name="addressing-a-resource"></a>Προσθήκη διεύθυνσης σε έναν πόρο
Όλοι οι πόροι είναι URI μπορούν να χρησιμοποιηθούν. Η τιμή της ιδιότητας **_self:** ενός πόρου που αντιπροσωπεύει το σχετικό URI του πόρου. Η μορφή του URI αποτελείται από το /\<τροφοδοσίας\>/ τμήματα της διαδρομής {_rid}:  

|Τιμή της το _self: |Περιγραφή
|-------------------|-----------
|/DBS   |Τροφοδοσία βάσεις δεδομένων στην περιοχή ο λογαριασμός μια βάση δεδομένων
|/DBS/ {όνομα βάσης δεδομένων}  |Βάση δεδομένων με ένα αναγνωριστικό που ταιριάζουν με την τιμή {όνομα βάσης δεδομένων}
|/colls/ /DBS/ {όνομα βάσης δεδομένων}   |Τροφοδοσία συλλογών κάτω από μια βάση δεδομένων
|/colls/ /DBS/ {όνομα βάσης δεδομένων} {collName} |Συλλογή με το αναγνωριστικό που ταιριάζουν με την τιμή {collName}
|/colls/ /DBS/ {όνομα βάσης δεδομένων} {collName} / έγγραφα    |Τροφοδοσία εγγράφων κάτω από μια συλλογή
|/docs/ /colls/ {collName} /DBS/ {όνομα βάσης δεδομένων} {αναγνωριστικό εγγράφου}    |Έγγραφο με ένα αναγνωριστικό που ταιριάζουν με την τιμή {doc}
|/users/ /DBS/ {όνομα βάσης δεδομένων}   |Τροφοδοσία χρήστες, κάτω από μια βάση δεδομένων
|/users/ /DBS/ {όνομα βάσης δεδομένων} {αναγνωριστικό χρήστη}   |Χρήστης με ένα αναγνωριστικό που ταιριάζουν με την τιμή {χρήστη}
|/users/ /DBS/ {όνομα βάσης δεδομένων} {αναγνωριστικό χρήστη} / δικαιώματα   |Τροφοδοσία δικαιωμάτων στην περιοχή ενός χρήστη
|/permissions/ /users/ {αναγνωριστικό χρήστη} /DBS/ {όνομα βάσης δεδομένων} {permissionId}    |Δικαιώματα με το αναγνωριστικό που ταιριάζουν με την τιμή {δικαιωμάτων}
  
Κάθε πόρο έχει ένα μοναδικό που ορίζονται από το όνομα χρήστη που εκτίθεται μέσω την ιδιότητα "αναγνωριστικό". Σημείωση: για έγγραφα, εάν ο χρήστης δεν έχει καθοριστεί αναγνωριστικό, μας υποστηριζόμενες SDK δημιουργεί αυτόματα ένα μοναδικό αναγνωριστικό για το έγγραφο. Το αναγνωριστικό είναι μια συμβολοσειρά που ορίζονται από το χρήστη, έως 256 χαρακτήρες που είναι μοναδικά στο περιβάλλον του πόρου συγκεκριμένες γονικού. 

Κάθε πόρο έχει επίσης ένα αναγνωριστικό δημιουργείται από το σύστημα ιεραρχική πόρων (γνωστή και ως ένα RID), που είναι διαθέσιμες μέσω της ιδιότητας _rid. Το RID κωδικοποιεί ολόκληρη την ιεραρχία ενός πόρου που δίνεται και είναι μια εύκολη εσωτερική αναπαράσταση χρησιμοποιείται για να ενεργοποιήσετε την ακεραιότητα αναφορών σε κατανέμεται. Το RID είναι μοναδικό μέσα σε ένα λογαριασμό της βάσης δεδομένων και εσωτερικά χρησιμοποιείται από DocumentDB για αποτελεσματική δρομολόγηση χωρίς να απαιτείται διασταύρωσης partition αναζητήσεις. Οι τιμές του _self: και τις ιδιότητες _rid είναι τόσο εναλλακτική και κανονικής αναπαραστάσεις του πόρου. 

Τα API ΥΠΌΛΟΙΠΟ DocumentDB υποστηρίζει διευθύνσεων πόρων και τη δρομολόγηση των αιτήσεων με το αναγνωριστικό και τις ιδιότητες _rid.

## <a name="database-accounts"></a>Λογαριασμοί βάσης δεδομένων
Μπορούν να προμηθεύσουν λογαριασμούς βάση δεδομένων μία ή περισσότερες DocumentDB, χρησιμοποιώντας τη συνδρομή σας στο Azure.

Μπορείτε να [δημιουργήσετε και να διαχειριστείτε τους λογαριασμούς DocumentDB βάση δεδομένων](documentdb-create-account.md) μέσω της πύλης Azure στο [http://portal.azure.com/](https://portal.azure.com/). Δημιουργία και τη διαχείριση ενός λογαριασμού βάσης δεδομένων απαιτεί δικαιώματα διαχειριστή και μπορεί να εκτελεστεί μόνο στην περιοχή Azure τη συνδρομή σας. 

### <a name="database-account-properties"></a>Ιδιότητες λογαριασμού βάσης δεδομένων
Ως μέρος της προμήθειας και τη διαχείριση ενός λογαριασμού βάσης δεδομένων μπορείτε να ρυθμίσετε τις παραμέτρους και διαβάστε τις ακόλουθες ιδιότητες:  

<table border="0" cellspacing="0" cellpadding="0">
    <tbody>
        <tr>
            <td valign="top"><p><strong>Όνομα ιδιότητας</strong></p></td>
            <td valign="top"><p><strong>Περιγραφή</strong></p></td>
        </tr>
        <tr>
            <td valign="top"><p>Πολιτική συνέπειας</p></td>
            <td valign="top"><p>Ορίστε αυτήν την ιδιότητα για να ρυθμίσετε το προεπιλεγμένο επίπεδο συνέπειας για όλες τις συλλογές στην περιοχή ο λογαριασμός σας βάση δεδομένων. Μπορείτε να παρακάμψετε το επίπεδο συνέπειας σε βάση ανά αίτηση χρησιμοποιώντας την κεφαλίδα αίτησης [x-ms-συνέπειας-επίπεδο]. <p><p>Σημειώστε ότι αυτή η ιδιότητα ισχύει μόνο για το <i>πόρους ορίζονται από το χρήστη</i>. Όλα συστήματος καθορισμένο πόροι έχουν ρυθμιστεί για την υποστήριξη διαβάζει/ερωτήματα με συνέπεια ισχυρό.</p></td>
        </tr>
        <tr>
            <td valign="top"><p>Πλήκτρα εξουσιοδότησης</p></td>
            <td valign="top"><p>Αυτά είναι τα κύριας και δευτερεύουσας υπόδειγμα και μόνο για ανάγνωση κλειδιά που παρέχουν δικαιώματα πρόσβασης διαχειριστή για όλους τους πόρους στην περιοχή ο λογαριασμός βάσης δεδομένων.</p></td>
        </tr>
    </tbody>
</table>

Λάβετε υπόψη ότι εκτός από την προμήθεια, τη ρύθμιση των παραμέτρων και διαχείριση του λογαριασμού σας βάσης δεδομένων από την πύλη του Azure, να δημιουργήσετε και να διαχειριστείτε τους λογαριασμούς DocumentDB βάσης δεδομένων με χρήση του [Azure DocumentDB ΥΠΌΛΟΙΠΟ APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx) , καθώς και [προγράμματος-πελάτη SDK](https://msdn.microsoft.com/library/azure/dn781482.aspx)επίσης μέσω προγραμματισμού.  

## <a name="databases"></a>Βάσεις δεδομένων
Μια βάση δεδομένων DocumentDB είναι ένα λογικό κοντέινερ μία ή περισσότερες συλλογές και τους χρήστες, όπως φαίνεται στο ακόλουθο διάγραμμα. Μπορείτε να δημιουργήσετε οποιονδήποτε αριθμό βάσεις δεδομένων στην περιοχή ο λογαριασμός μια βάση δεδομένων DocumentDB υπόκεινται σε όρια την προσφορά.  

![Μοντέλο βάσης δεδομένων λογαριασμού και συλλογών ιεραρχική][2]  
**Μια βάση δεδομένων είναι ένα λογικό κοντέινερ των χρηστών και των συλλογών**

Μια βάση δεδομένων μπορεί να περιέχει σχεδόν απεριόριστες εγγράφου αποθήκευσης διαμερίσματα με συλλογές, που σχηματίζουν τους τομείς συναλλαγής για τα έγγραφα που περιέχονται μέσα σε αυτά. 

### <a name="elastic-scale-of-a-documentdb-database"></a>Ελαστικά κλίμακα μιας βάσης δεδομένων DocumentDB
DocumentDB είναι μια βάση δεδομένων ελαστικότητας από προεπιλογή – μεταξύ του μερικά GB petabytes SSD αντίγραφα αποθήκευση εγγράφων και μετάδοσης προμήθεια του φακέλου. 

Σε αντίθεση με μια βάση δεδομένων σε παραδοσιακά RDBMS, μια βάση δεδομένων σε DocumentDB είναι δεν έχει ρυθμιστεί για έναν υπολογιστή. Με DocumentDB, όπως την κλίμακα της εφαρμογής σας πρέπει να αυξάνονται, μπορείτε να δημιουργήσετε περισσότερες συλλογές, βάσεις δεδομένων ή και τα δύο. Στην πραγματικότητα, διάφορες πρώτη εφαρμογές άλλων κατασκευαστών στο Microsoft χρησιμοποιούσαν DocumentDB με μια κλίμακα καταναλωτή δημιουργώντας κάθε περιέχει χιλιάδες συλλογές πολύ μεγάλο DocumentDB βάσεις δεδομένων με terabytes χώρου αποθήκευσης εγγράφων. Μπορείτε να μεγέθυνση ή σμίκρυνση μιας βάσης δεδομένων, προσθέτοντας ή καταργώντας συλλογές ώστε να πληρούνται οι απαιτήσεις της εφαρμογής σας κλίμακα. 

Μπορείτε να δημιουργήσετε πολλές συλλογές μέσα σε μια βάση δεδομένων υπόκεινται την προσφορά. Κάθε συλλογή έχει SSD αντίγραφα χώρου αποθήκευσης και μετάδοσης παρέχεται για εσάς, ανάλογα με τη σειρά του επιλεγμένου επιδόσεων.

Μια βάση δεδομένων DocumentDB είναι επίσης ένα κοντέινερ από τους χρήστες. Ένα χρήστη, στο-ενεργοποίηση, είναι μια λογική χώρος ονομάτων για ένα σύνολο δικαιωμάτων που παρέχει λεπτομερή εξουσιοδότησης και πρόσβασης σε συλλογές, εγγράφων και συνημμένα.  
 
Όπως με άλλους πόρους στο μοντέλο πόρων DocumentDB, βάσεις δεδομένων μπορεί να δημιουργηθεί, αντικατασταθεί, διαγραφεί, διαβάστε ή απαρίθμηση εύκολα χρησιμοποιώντας είτε [Azure DocumentDB REST API](https://msdn.microsoft.com/library/azure/dn781481.aspx) ή οποιοδήποτε από τα [SDK προγράμματος-πελάτη](https://msdn.microsoft.com/library/azure/dn781482.aspx). DocumentDB εγγυάται ισχυρό συνέπεια για ανάγνωση ή την υποβολή ερωτημάτων τα μετα-δεδομένα ενός πόρου βάσης δεδομένων. Διαγραφή μιας βάσης δεδομένων αυτόματα εξασφαλίζει ότι δεν έχετε πρόσβαση σε οποιαδήποτε από τις συλλογές ή τους χρήστες που περιέχονται σε αυτό.   

## <a name="collections"></a>Συλλογές
Μια συλλογή DocumentDB είναι ένα κοντέινερ για τα έγγραφα JSON. Μια συλλογή είναι επίσης μια μονάδα κλίμακα για συναλλαγές και ερωτήματα. 

### <a name="elastic-ssd-backed-document-storage"></a>Αποθήκευση εγγράφων ελαστικότητας SSD αντίγραφα
Μια συλλογή είναι εγγενώς ελαστικότητας - αυτόματα αναπτύσσεται και συρρικνώνεται καθώς την προσθέτετε ή καταργείτε έγγραφα. Συλλογές λογική πόρους και μπορούν να εκτείνονται σε μία ή περισσότερες φυσικής διαμερίσματα ή των διακομιστών. Ο αριθμός των διαμερισμάτων μέσα σε μια συλλογή προσδιορίζεται από DocumentDB με βάση το μέγεθος του χώρου αποθήκευσης και την προμήθεια του φακέλου απόδοση της συλλογής. Κάθε διαμερίσματα στο DocumentDB έχει ένα σταθερό μέγεθος του χώρου αποθήκευσης αντίγραφα SSD που σχετίζεται με το και αναπαράγεται για υψηλή διαθεσιμότητα. Διαμερίσματα διαχείρισης γίνεται πλήρως από Azure DocumentDB και δεν χρειάζεται να σύνθετες κώδικας σύνταξης ή να διαχειριστείτε διαμερισμάτων σας. Συλλογές DocumentDB είναι **σχεδόν απεριόριστες** όσον αφορά χώρου αποθήκευσης και απόδοση. 

### <a name="automatic-indexing-of-collections"></a>Αυτόματη δημιουργία ευρετηρίου των συλλογών
DocumentDB είναι ένα σύστημα true χωρίς σχήματος βάσης δεδομένων. Να μην θεωρείται ότι ή απαιτείται οποιαδήποτε διάταξη για τα έγγραφα JSON. Καθώς προσθέτετε έγγραφα σε μια συλλογή, DocumentDB δημιουργεί αυτόματα ένα ευρετήριο τους και είναι διαθέσιμα για την υποβολή ερωτήματος. Αυτόματη δημιουργία ευρετηρίου για έγγραφα χωρίς να απαιτείται σχήματος ή δευτερεύων ευρετήρια είναι μια βασικών δυνατοτήτων των DocumentDB και είναι ενεργοποιημένη από τεχνικές συντήρηση ευρετηρίου βελτιστοποίηση εγγραφής, χωρίς lock και δομή αρχείου καταγραφής. DocumentDB υποστηρίζει σταθερή ένταση εξαιρετικά γρήγορη εγγραφών ενώ εξακολουθείτε να εξυπηρετούν συνεπή ερωτήματα. Χώρος αποθήκευσης και το έγγραφο και το ευρετήριο που χρησιμοποιούνται για τον υπολογισμό του χώρου αποθήκευσης που καταναλώνεται από κάθε συλλογή. Μπορείτε να ελέγξετε το χώρο αποθήκευσης και επιδόσεων τα ανταλλάγματα που σχετίζονται με τη δημιουργία ευρετηρίου, ρυθμίζοντας τις παραμέτρους της πολιτικής δημιουργίας ευρετηρίου για μια συλλογή. 

### <a name="configuring-the-indexing-policy-of-a-collection"></a>Ρύθμιση παραμέτρων της πολιτικής δημιουργίας ευρετηρίου μιας συλλογής
Η πολιτική δημιουργίας ευρετηρίου κάθε συλλογής σας επιτρέπει να κάνετε επιδόσεις και αποθήκευσης τα ανταλλάγματα που σχετίζονται με τη δημιουργία ευρετηρίου. Τις ακόλουθες επιλογές είναι διαθέσιμες σε εσάς ως μέρος της ρύθμισης παραμέτρων δημιουργίας ευρετηρίου:  

-   Επιλέξτε αν η συλλογή δημιουργεί αυτόματα ένα ευρετήριο όλα τα έγγραφα ή όχι. Από προεπιλογή, όλα τα έγγραφα που είναι αυτόματα στο ευρετήριο. Μπορείτε να επιλέξετε για να απενεργοποιήσετε την αυτόματη δημιουργία ευρετηρίου και επιλεκτική προσθέσετε μόνο συγκεκριμένα έγγραφα στο ευρετήριο. Αντίθετα, να επιλέξετε επιλεκτική για να αποκλείσετε μόνο συγκεκριμένα έγγραφα. Μπορείτε να επιτύχετε αυτή η ρύθμιση της ιδιότητας αυτόματη να είναι αληθής ή ψευδής στην το indexingPolicy μιας συλλογής και χρησιμοποιώντας την κεφαλίδα αίτησης [x-ms-indexingdirective] κατά την εισαγωγή, αντικαθιστώντας ή τη διαγραφή ενός εγγράφου.  
-   Επιλέξτε εάν θέλετε να συμπεριλάβετε ή να εξαιρέσετε συγκεκριμένες διαδρομές ή μοτίβα στα έγγραφά σας από το ευρετήριο. Μπορείτε να επιτύχετε αυτήν τη ρύθμιση includedPaths και excludedPaths στην το indexingPolicy μιας συλλογής αντίστοιχα. Μπορείτε επίσης να ρυθμίσετε το χώρο αποθήκευσης και επιδόσεων τα ανταλλάγματα για περιοχή και κατακερματισμός ερωτήματα για συγκεκριμένη διαδρομή μοτίβα. 
-   Επιλέξτε μεταξύ σύγχρονη (συνεπή) και ενημερώσεις ασύγχρονης ευρετηρίου (τεμπέλη). Από προεπιλογή, το ευρετήριο ενημερώνεται σύγχρονη σε κάθε εισαγωγή, αντικατάσταση ή διαγραφή ενός εγγράφου στη συλλογή. Αυτή η δυνατότητα επιτρέπει τα ερωτήματα να εκτελέσει το ίδιο επίπεδο συνέπειας της διαβάζει το έγγραφο. Ενώ DocumentDB είναι βελτιστοποιημένη εγγραφής και υποστηρίζει σταθερή όγκους εγγραφών στο έγγραφο μαζί με ευρετήριο σύγχρονη συντήρησης και σερβίρισμα συνεπή ερωτημάτων, μπορείτε να ρυθμίσετε συγκεκριμένες συλλογές για να ενημερώσετε το ευρετήριο αμέριμνα. Τεμπέλη ευρετηρίου ενισχύει την απόδοση εγγραφής περαιτέρω και είναι ιδανική για μαζική κατάποσης σενάρια για κυρίως ανάγνωση χοντρό συλλογές.

Η πολιτική δημιουργίας ευρετηρίου μπορεί να αλλάξει με την εκτέλεση μιας ΤΟΠΟΘΈΤΗΣΗ στη συλλογή. Αυτό μπορεί να είναι δυνατό είτε μέσω του [προγράμματος-πελάτη SDK](https://msdn.microsoft.com/library/azure/dn781482.aspx), την [Πύλη Azure](https://portal.azure.com) ή τα [APIs ΥΠΌΛΟΙΠΟ DocumentDB Azure](https://msdn.microsoft.com/library/azure/dn781481.aspx).

### <a name="querying-a-collection"></a>Υποβολή ερωτημάτων σε μια συλλογή
Τα έγγραφα μέσα σε μια συλλογή μπορεί να έχει αυθαίρετο σχήματα και μπορείτε να υποβάλετε ερώτημα εγγράφων μέσα σε μια συλλογή χωρίς να παραχωρήσετε οποιαδήποτε διάταξη ή δευτερεύοντα δεικτών προκαταβολικά. Μπορείτε να υποβάλετε ερώτημα τη συλλογή χρησιμοποιώντας τη [σύνταξη DocumentDB SQL](https://msdn.microsoft.com/library/azure/dn782250.aspx), που παρέχει εμπλουτισμένου ιεραρχική, σχεσιακές, και χώρου τελεστές και επεκτασιμότητα του μέσω βάσει JavaScript UDF. Γραμματικός έλεγχος JSON επιτρέπει μοντελοποίησης JSON εγγράφων ως δέντρα με ετικέτες ως τους κόμβους του δέντρου. Αυτό είναι εκμετάλλευση τόσο από DocumentDB της αυτόματης δημιουργίας ευρετηρίου τεχνικές, καθώς και του DocumentDB διάλεκτος SQL. Η γλώσσα ερωτημάτων DocumentDB αποτελείται από τρεις πλευρές κύριο:   

1.  Ένα μικρό σύνολο των λειτουργιών ερωτημάτων που ομαλά αντιστοίχιση με τη δομή δέντρου όπως ιεραρχικά ερωτήματα και προβλέψεις. 
2.  Ένα υποσύνολο των σχεσιακών εργασίες, συμπεριλαμβανομένων των σύνθεσης, φιλτράρισμα, προεξοχές, συγκεντρώσεις και αυτόματης σύνδεσμοι. 
3.  Αμιγώς JavaScript που βασίζεται σε UDF που λειτουργούν με (1) και (2).  

Το μοντέλο ερωτήματος DocumentDB προσπαθεί να μια ισορροπία μεταξύ των λειτουργιών, της αποτελεσματικότητας και απλότητα. Το μηχανισμό βάσεων δεδομένων DocumentDB εγγενώς δημιουργεί και εκτελεί τις προτάσεις ερωτημάτων SQL. Μπορείτε να υποβάλετε ερώτημα σε μια συλλογή χρησιμοποιώντας τα [APIs ΥΠΌΛΟΙΠΟ DocumentDB Azure](https://msdn.microsoft.com/library/azure/dn781481.aspx) ή σε οποιαδήποτε από τον [υπολογιστή-πελάτη SDK](https://msdn.microsoft.com/library/azure/dn781482.aspx). Το .NET SDK συνοδεύεται από μια υπηρεσία παροχής LINQ.

> [AZURE.TIP] Μπορείτε να δοκιμάσετε DocumentDB και να εκτελέσετε ερωτήματα SQL σε σχέση με το σύνολο δεδομένων σε του [Ερωτήματος Αναδειχτείτε](https://www.documentdb.com/sql/demo).

### <a name="multi-document-transactions"></a>Συναλλαγές πολλά έγγραφα
Συναλλαγές της βάσης δεδομένων παρέχουν ένα μοντέλο προγραμματισμού ασφαλείς και προβλέψιμα για την αντιμετώπιση ταυτόχρονες αλλαγές στα δεδομένα. Στο RDBMS, ο παραδοσιακός τρόπος για να γράψετε επιχειρηματικής λογικής είναι να γράψετε **αποθηκευμένες διαδικασίες** ή/και **εναύσματα** και αποστολή τους στο διακομιστή βάσης δεδομένων για εκτέλεση συναλλαγών. Στο RDBMS, τον προγραμματιστή της εφαρμογής απαιτείται να ασχοληθείτε με δύο διαφορετικές γλώσσες προγραμματισμού: 

- Η εφαρμογή (μη συναλλαγών) προγραμματισμού γλώσσας (π.χ. JavaScript, Python, C#, Java, κ.λπ.)
- T-SQL, το συναλλαγών γλώσσα προγραμματισμού που εκτελείται εγγενώς από τη βάση δεδομένων

Σύμφωνα με τις βαθύ δέσμευσης να JavaScript και JSON απευθείας μέσα από το μηχανισμό βάσεων δεδομένων, DocumentDB παρέχει ένα διαισθητικό μοντέλο προγραμματισμού για την εκτέλεση JavaScript βάσει λογική εφαρμογής απευθείας σε των συλλογών όσον αφορά τις αποθηκευμένες διαδικασίες και εναύσματα. Αυτό σας επιτρέπει για τα δύο από τα εξής:

- Αποτελεσματική εφαρμογή της ταυτόχρονης εκτέλεσης ελέγξετε, ανάκτησης, αυτόματη δημιουργία ευρετηρίου των γραφημάτων αντικειμένων JSON απευθείας από το μηχανισμό βάσεων δεδομένων
- Ομαλά εκφράζει στοιχείο ελέγχου ροής, μεταβλητής εμβέλεια, ανάθεσης και ενοποίησης του χειρισμού στοιχειώδεις τύπους με συναλλαγές της βάσης δεδομένων απευθείας όσον αφορά την JavaScript γλώσσα προγραμματισμού εξαίρεσης

Η λογική JavaScript που έχουν καταχωρηθεί σε επίπεδο συλλογής, στη συνέχεια, να εκδώσετε λειτουργίες της βάσης δεδομένων στα έγγραφα της δεδομένης συλλογής. DocumentDB αναδιπλώνεται μη ρητά το JavaScript βάσει αποθηκευμένες διαδικασίες και εναύσματα μέσα σε ένα του περιβάλλοντος ΟΞΈΟΣ συναλλαγές με στιγμιότυπο απομόνωσης μεταξύ των εγγράφων μέσα σε μια συλλογή. Κατά τη διάρκεια της εκτέλεσης του, εάν το JavaScript δημιουργεί μια εξαίρεση, στη συνέχεια, ολόκληρη η συναλλαγή είναι ματαιώθηκε. Το μοντέλο προγραμματισμού που προκύπτει είναι πολύ απλής ακόμη ισχυρή. Προγραμματιστές JavaScript λάβετε ένα "διαρκή" μοντέλο προγραμματισμού κατά τη χρήση εξακολουθεί να τους δομές οικείες γλώσσας και στοιχειώδεις τύπους βιβλιοθήκης.   

Τη δυνατότητα να εκτελέσει JavaScript απευθείας μέσα από το μηχανισμό βάσεων δεδομένων στον ίδιο χώρο διευθύνσεων με το χώρο συγκέντρωσης buffer ενεργοποιεί performant και συναλλαγών εκτέλεσης λειτουργιών της βάσης δεδομένων σε σχέση με τα έγγραφα μιας συλλογής. Επιπλέον, DocumentDB του μηχανισμού βάσεων δεδομένων κάνει βαθύ δέσμευση για το JSON και JavaScript αποκλείει οποιαδήποτε αντίσταση ασυμφωνία μεταξύ τα συστήματα τον τύπο της εφαρμογής και τη βάση δεδομένων.   

Αφού δημιουργήσετε μια συλλογή, μπορείτε να καταχωρήσετε αποθηκευμένες διαδικασίες, εναύσματα και UDF με μια συλλογή χρησιμοποιώντας τα [APIs ΥΠΌΛΟΙΠΟ DocumentDB Azure](https://msdn.microsoft.com/library/azure/dn781481.aspx) ή σε οποιαδήποτε από τον [υπολογιστή-πελάτη SDK](https://msdn.microsoft.com/library/azure/dn781482.aspx). Μετά την καταχώρηση, μπορείτε να αναφορά και να εκτελέσει τους. Λάβετε υπόψη τα παρακάτω αποθηκευμένη διαδικασία συνταχθεί εντελώς σε JavaScript, τον παρακάτω κώδικα δέχεται δύο ορίσματα (όνομα βιβλίου και όνομα συντάκτη) και δημιουργεί ένα νέο έγγραφο, ερωτήματα για ένα έγγραφο και, στη συνέχεια, ενημερώνει την-όλα μέσα σε μια μη ρητή ΟΞΈΟΣ συναλλαγή. Σε οποιοδήποτε σημείο κατά την εκτέλεση, εάν μια JavaScript εξαίρεση, ματαίωση ολόκληρη η συναλλαγή.

    function businessLogic(name, author) {
        var context = getContext();
        var collectionManager = context.getCollection();        
        var collectionLink = collectionManager.getSelfLink()
            
        // create a new document.
        collectionManager.createDocument(collectionLink,
            {id: name, author: author},
            function(err, documentCreated) {
                if(err) throw new Error(err.message);
                
                // filter documents by author
                var filterQuery = "SELECT * from root r WHERE r.author = 'George R.'";
                collectionManager.queryDocuments(collectionLink,
                    filterQuery,
                    function(err, matchingDocuments) {
                        if(err) throw new Error(err.message);
                        
                        context.getResponse().setBody(matchingDocuments.length);
                       
                        // Replace the author name for all documents that satisfied the query.
                        for (var i = 0; i < matchingDocuments.length; i++) {
                            matchingDocuments[i].author = "George R. R. Martin";
                            // we don’t need to execute a callback because they are in parallel
                            collectionManager.replaceDocument(matchingDocuments[i]._self,
                                matchingDocuments[i]);   
                        }
                    })
            })
    };

Το πρόγραμμα-πελάτη μπορούν να "Αποστολή" η παραπάνω λογική JavaScript στη βάση δεδομένων για συναλλαγών εκτέλεσης μέσω HTTP POST. Για περισσότερες πληροφορίες σχετικά με τη χρήση μεθόδους HTTP, ανατρέξτε στο θέμα [RESTful αλληλεπιδράσεις με DocumentDB πόρους](https://msdn.microsoft.com/library/azure/mt622086.aspx). 

    client.createStoredProcedureAsync(collection._self, {id: "CRUDProc", body: businessLogic})
       .then(function(createdStoredProcedure) {
            return client.executeStoredProcedureAsync(createdStoredProcedure.resource._self,
                "NoSQL Distilled",
                "Martin Fowler");
        })
        .then(function(result) {
            console.log(result);
        },
        function(error) {
            console.log(error);
        });


Παρατηρήστε ότι επειδή η βάση δεδομένων αναγνωρίζει εγγενώς JSON και JavaScript, δεν υπάρχει καμία ασυμφωνία τύπου συστήματος, "OR αντιστοίχισης" ή μαγικός γενιάς κώδικα που απαιτείται.   

Αποθηκευμένες διαδικασίες και εναύσματα αλληλεπίδραση με μια συλλογή και τα έγγραφα σε μια συλλογή μέσα από ένα μοντέλο αντικειμένου ευδιάκριτο, το οποίο εκθέτει το τρέχον περιβάλλον συλλογής.  

Συλλογές στο DocumentDB μπορούν να δημιουργηθούν, διαγραφή, διαβάστε ή απαρίθμηση εύκολα χρησιμοποιεί ένα από τα [APIs ΥΠΌΛΟΙΠΟ DocumentDB Azure](https://msdn.microsoft.com/library/azure/dn781481.aspx) ή σε οποιαδήποτε από τον [υπολογιστή-πελάτη SDK](https://msdn.microsoft.com/library/azure/dn781482.aspx). DocumentDB παρέχει πάντα ισχυρό συνέπειας για ανάγνωση ή την υποβολή ερωτημάτων τα μετα-δεδομένα από μια συλλογή. Εάν διαγράψετε μια συλλογή αυτόματα εξασφαλίζει ότι δεν έχετε πρόσβαση σε οποιαδήποτε από τα έγγραφα, τα συνημμένα, αποθηκευμένες διαδικασίες, εναύσματα και UDF που περιέχονται σε αυτό.   

## <a name="stored-procedures-triggers-and-user-defined-functions-udf"></a>Αποθηκευμένες διαδικασίες, εναύσματα και συναρτήσεων που ορίζονται από το χρήστη (UDF)
Όπως περιγράφεται στην προηγούμενη ενότητα, μπορείτε να συντάξετε λογική της εφαρμογής για να εκτελέσετε απευθείας μέσα σε μια συναλλαγή μέσα σε το μηχανισμό βάσεων δεδομένων. Η λογική εφαρμογής μπορούν να εγγραφούν αποκλειστικά στη JavaScript και μπορεί να διαμορφωθεί ως μια αποθηκευμένη διαδικασία, έναυσμα ή ένα αρχείο UDF. Τον κώδικα JavaScript μέσα σε μια αποθηκευμένη διαδικασία ή ένα έναυσμα εισαγωγή, αντικατάσταση, διαγραφή, την ανάγνωση ή το ερώτημα εγγράφων μέσα σε μια συλλογή. Από την άλλη πλευρά, το JavaScript μέσα σε ένα αρχείο UDF δεν είναι δυνατό να εισαγάγετε, αντικατάσταση, ή διαγραφή εγγράφων. UDF απαρίθμηση των εγγράφων από το σύνολο των αποτελεσμάτων ενός ερωτήματος και να παράγει ένα άλλο σύνολο αποτελεσμάτων. Για πολλαπλή μίσθωση, DocumentDB επιβάλλει ένα διακυβέρνησης πόρων αυστηρών δέσμευσης με βάση. Κάθε αποθηκευμένη διαδικασία, έναυσμα ή ένα αρχείο UDF λαμβάνει ένα σταθερό quantum πόρων λειτουργικό σύστημα για να εκτελέσετε τις εργασίες της. Επιπλέον, αποθηκευμένες διαδικασίες, εναύσματα ή UDF είναι δυνατή η σύνδεση σε σχέση με εξωτερική βιβλιοθήκες JavaScript και τηλεφώνου χωρίς αξιοπιστία εφόσον υπερβαίνουν τους προϋπολογισμούς πόρου που έχει εκχωρηθεί σε αυτά. Μπορείτε να καταχωρήσετε, καταργήστε αποθηκευμένες διαδικασίες, εναύσματα ή UDF με συλλογή, χρησιμοποιώντας τα ΥΠΌΛΟΙΠΑ API.  Κατά την καταχώρηση μια αποθηκευμένη διαδικασία, έναυσμα ή ένα αρχείο UDF είναι προ-μεταγλωττιστεί και να αποθηκευτεί ως κώδικας byte που λαμβάνει εκτελεστεί αργότερα. Στην παρακάτω ενότητα εξηγούν πώς μπορείτε να χρησιμοποιήσετε το SDK JavaScript DocumentDB για να καταχωρήσετε και εκτέλεση unregister μια αποθηκευμένη διαδικασία ενεργοποίησης και ένα αρχείο UDF. Το SDK JavaScript είναι μια απλή περιτυλίγματος επάνω από τα [DocumentDB ΥΠΌΛΟΙΠΟ APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx). 

### <a name="registering-a-stored-procedure"></a>Καταχώρηση μια αποθηκευμένη διαδικασία
Καταχώρηση μιας αποθηκευμένης διαδικασίας δημιουργεί ένα νέο πόρο αποθηκευμένη διαδικασία σε μια συλλογή μέσω HTTP POST.  

    var storedProc = {
        id: "validateAndCreate",
        body: function (documentToCreate) {
            documentToCreate.id = documentToCreate.id.toUpperCase();
            
            var collectionManager = getContext().getCollection();
            collectionManager.createDocument(collectionManager.getSelfLink(),
                documentToCreate,
                function(err, documentCreated) {
                    if(err) throw new Error('Error while creating document: ' + err.message;
                    getContext().getResponse().setBody('success - created ' + 
                            documentCreated.name);
                });
        }
    };
    
    client.createStoredProcedureAsync(collection._self, storedProc)
        .then(function (createdStoredProcedure) {
            console.log("Successfully created stored procedure");
        }, function(error) {
            console.log("Error");
        });

### <a name="executing-a-stored-procedure"></a>Εκτέλεση μιας αποθηκευμένης διαδικασίας
Εκτέλεση μιας αποθηκευμένης διαδικασίας γίνεται με την έκδοση μια ΔΗΜΟΣΊΕΥΣΗ HTTP σε σχέση με έναν υπάρχοντα πόρο αποθηκευμένη διαδικασία, μεταφέροντας τις παραμέτρους για τη διαδικασία στο σώμα της αίτησης.

    var inputDocument = {id : "document1", author: "G. G. Marquez"};
    client.executeStoredProcedureAsync(createdStoredProcedure.resource._self, inputDocument)
        .then(function(executionResult) {
            assert.equal(executionResult, "success - created DOCUMENT1");
        }, function(error) {
            console.log("Error");
        });

### <a name="unregistering-a-stored-procedure"></a>Κατάργηση καταχώρησης μια αποθηκευμένη διαδικασία
Κατάργηση καταχώρησης μια αποθηκευμένη διαδικασία γίνεται απλώς με την έκδοση μια ΔΙΑΓΡΑΦΉ HTTP σε σχέση με έναν υπάρχοντα πόρο αποθηκευμένη διαδικασία.   

    client.deleteStoredProcedureAsync(createdStoredProcedure.resource._self)
        .then(function (response) {
            return;
        }, function(error) {
            console.log("Error");
        });


### <a name="registering-a-pre-trigger"></a>Καταχώρηση ένα προ-έναυσμα
Καταχώρηση ενός εναύσματος γίνεται με τη δημιουργία ενός νέου πόρου έναυσμα σε μια συλλογή μέσω HTTP POST. Μπορείτε να καθορίσετε εάν το έναυσμα είναι μια προκαθορισμένη ή ένα έναυσμα δημοσίευση και τον τύπο της λειτουργίας μπορεί να είναι συσχετισμένες με το (π.χ. Δημιουργία, αντικατάσταση, διαγραφή ή όλες).   

    var preTrigger = {
        id: "upperCaseId",
        body: function() {
                var item = getContext().getRequest().getBody();
                item.id = item.id.toUpperCase();
                getContext().getRequest().setBody(item);
        },
        triggerType: TriggerType.Pre,
        triggerOperation: TriggerOperation.All
    }
    
    client.createTriggerAsync(collection._self, preTrigger)
        .then(function (createdPreTrigger) {
            console.log("Successfully created trigger");
        }, function(error) {
            console.log("Error");
        });

### <a name="executing-a-pre-trigger"></a>Εκτέλεση μιας προ-εναυσμάτων
Εκτέλεση των ένα έναυσμα γίνεται καθορίζοντας το όνομα ενός υπάρχοντος εναύσματος τη στιγμή της έκδοσης της αίτησης ΔΗΜΟΣΊΕΥΣΗ/ΤΟΠΟΘΈΤΗΣΗ/ΔΙΑΓΡΑΦΉ ενός πόρου εγγράφου μέσω την κεφαλίδα αίτησης.  
 
    client.createDocumentAsync(collection._self, { id: "doc1", key: "Love in the Time of Cholera" }, { preTriggerInclude: "upperCaseId" })
        .then(function(createdDocument) {
            assert.equal(createdDocument.resource.id, "DOC1");
        }, function(error) {
            console.log("Error");
        });

### <a name="unregistering-a-pre-trigger"></a>Κατάργηση καταχώρησης ένα προ-έναυσμα
Κατάργηση καταχώρησης ένα έναυσμα γίνεται απλώς μέσω εκδίδει μια ΔΙΑΓΡΑΦΉ HTTP σε σχέση με έναν υπάρχοντα πόρο έναυσμα.  

    client.deleteTriggerAsync(createdPreTrigger._self);
        .then(function(response) {
            return;
        }, function(error) {
            console.log("Error");
        });

### <a name="registering-a-udf"></a>Καταχώρηση ενός UDF
Καταγραφή των μια UDF γίνεται με τη δημιουργία ενός νέου πόρου UDF σε μια συλλογή μέσω HTTP POST.  

    var udf = { 
        id: "mathSqrt",
        body: function(number) {
                return Math.sqrt(number);
        },
    };
    client.createUserDefinedFunctionAsync(collection._self, udf)
        .then(function (createdUdf) {
            console.log("Successfully created stored procedure");
        }, function(error) {
            console.log("Error");
        });

### <a name="executing-a-udf-as-part-of-the-query"></a>Εκτέλεση μιας UDF ως μέρος του ερωτήματος
Μια UDF μπορεί να οριστεί ως μέρος του ερωτήματος SQL και χρησιμοποιείται για να επεκτείνετε το μέγεθος των κύριων [γλώσσα ερωτήματος SQL του DocumentDB](https://msdn.microsoft.com/library/azure/dn782250.aspx).

    var filterQuery = "SELECT udf.mathSqrt(r.Age) AS sqrtAge FROM root r WHERE r.FirstName='John'";
    client.queryDocuments(collection._self, filterQuery).toArrayAsync();
        .then(function(queryResponse) {
            var queryResponseDocuments = queryResponse.feed;
        }, function(error) {
            console.log("Error");
        });

### <a name="unregistering-a-udf"></a>Κατάργηση καταχώρησης μια UDF 
Κατάργηση καταχώρησης μια UDF γίνεται απλώς με την έκδοση μια ΔΙΑΓΡΑΦΉ HTTP σε σχέση με έναν υπάρχοντα πόρο UDF.  

    client.deleteUserDefinedFunctionAsync(createdUdf._self)
        .then(function(response) {
            return;
        }, function(error) {
            console.log("Error");
        });

Παρόλο που τα παραπάνω τμήματα εμφάνιζε την καταχώρηση (ΔΗΜΟΣΊΕΥΣΗ), κατάργησης (ΤΟΠΟΘΈΤΗΣΗ), ανάγνωση/λίστας (ΛΉΨΗ) και εκτέλεσης (ΔΗΜΟΣΊΕΥΣΗ) μέσω του [DocumentDB JavaScript SDK](https://github.com/Azure/azure-documentdb-js), μπορείτε επίσης να χρησιμοποιήσετε τα [ΥΠΌΛΟΙΠΑ APIs](https://msdn.microsoft.com/library/azure/dn781481.aspx) ή άλλες [SDK προγράμματος-πελάτη](https://msdn.microsoft.com/library/azure/dn781482.aspx). 

## <a name="documents"></a>Έγγραφα
Για να εισαγάγετε, αντικατάσταση, διαγραφή, ανάγνωση, απαρίθμηση και ερωτήματος αυθαίρετο JSON εγγράφων σε μια συλλογή. DocumentDB δεν υποχρεώνει οποιαδήποτε διάταξη και δεν απαιτεί δευτερεύων ευρετήρια προκειμένου να υποστηρίζει την υποβολή ερωτημάτων των εγγράφων σε μια συλλογή.   

Τη υπηρεσίας πραγματικά Άνοιγμα βάσης δεδομένων, DocumentDB δεν πληκτρολογήστε τυχόν τύπους εξειδικευμένες δεδομένων (π.χ., ημερομηνία ώρα) ή συγκεκριμένες κωδικοποιήσεων για έγγραφα JSON. Σημειώστε ότι δεν απαιτεί DocumentDB οποιαδήποτε ειδική συμβάσεις JSON να κωδικοποιηθούν τις σχέσεις μεταξύ των διαφόρων έγγραφα. η σύνταξη SQL του DocumentDB παρέχει ισχυρούς ερωτήματος ιεραρχική και σχεσιακούς τελεστές σε έγγραφα του ερωτήματος και το project χωρίς ειδική σχόλια ή να κωδικοποιηθούν σχέσεις μεταξύ των εγγράφων με χρήση διαφορετικού ιδιότητες.  
 
Ως με άλλους πόρους έγγραφα μπορούν να δημιουργηθούν, αντικατάστασης, Διαγραμμένα, διαβάστε, απαρίθμησης και ερωτημάτων εύκολα χρησιμοποιώντας είτε REST API ή οποιοδήποτε από τα [SDK προγράμματος-πελάτη](https://msdn.microsoft.com/library/azure/dn781482.aspx). Διαγραφή ενός εγγράφου στη στιγμή ελευθερώνει του ορίου αντιστοιχεί σε όλα τα ένθετα συνημμένα. Το επίπεδο ανάγνωσης συνέπειας των εγγράφων που ακολουθεί την πολιτική συνέπειας στη το λογαριασμό βάσης δεδομένων. Αυτή η πολιτική μπορεί να αντικατασταθεί με βάση ανά αίτηση ανάλογα με τις απαιτήσεις συνέπειας δεδομένων της εφαρμογής σας. Κατά την υποβολή ερωτήματος έγγραφα, διαβάστε τη συνέπεια ακολουθεί τη λειτουργία δημιουργίας ευρετηρίου ρύθμιση στη συλλογή. Για "συνεπή", αυτό ακολουθεί πολιτικής συνέπειας του λογαριασμού. 

## <a name="attachments-and-media"></a>Συνημμένα και πολυμέσων
>[AZURE.NOTE] Συνημμένο και μέσα πόρων είναι δυνατότητες preview.
 
DocumentDB σάς επιτρέπει να αποθηκεύετε δυαδικό αντικείμενα BLOB/πολυμέσων με DocumentDB ή το δικό σας χώρο αποθήκευσης απομακρυσμένη πολυμέσων. Επίσης, μπορείτε να αναπαραστήσετε τα μετα-δεδομένα των πολυμέσων όσον αφορά ένα ειδικό έγγραφο που ονομάζεται συνημμένου. Ένα συνημμένο σε DocumentDB είναι ένα ειδικό έγγραφο (JSON) που αναφέρεται το πολυμέσων/blob που είναι αποθηκευμένα σε κάποιο άλλο σημείο. Ένα συνημμένο είναι απλώς ένα ειδικό έγγραφο που καταγράφει τα μετα-δεδομένα (π.χ., θέση, συντάκτη κ.λπ.) μιας πολυμέσων που είναι αποθηκευμένα σε ένα χώρο αποθήκευσης απομακρυσμένη πολυμέσων. 

Εξετάστε το ενδεχόμενο να μια εφαρμογή κοινωνικών ανάγνωσης που χρησιμοποιεί DocumentDB για την αποθήκευση σχόλια με γραφή και μετα-δεδομένων, συμπεριλαμβανομένων των σχολίων, επισημαίνει, σελιδοδείκτες, χαρακτηρισμών, μου αρέσει/αντιπάθειες κ.λπ., που έχει συσχετιστεί για ένα βιβλίο e ένας συγκεκριμένος χρήστης.   

-   Το περιεχόμενο του βιβλίου ίδια είναι αποθηκευμένο στο χώρο αποθήκευσης της πολυμέσων είτε διαθέσιμη ως μέρος του λογαριασμού DocumentDB βάσης δεδομένων ή ένα χώρο αποθήκευσης απομακρυσμένη πολυμέσων. 
-   Μια εφαρμογή ενδέχεται να αποθηκεύουν μετα-δεδομένων κάθε χρήστη ως έγγραφο διακριτές--π.χ., μετα-δεδομένα του Αλέξανδρος για Βιβλίο1 είναι αποθηκευμένο σε ένα έγγραφο στα οποία γίνεται αναφορά από /colls/joe/docs/book1. 
-   Συνημμένα που δείχνει προς τις σελίδες περιεχομένου από μια δεδομένη βιβλίο ενός χρήστη που είναι αποθηκευμένα στην περιοχή το αντίστοιχο έγγραφο /colls/joe/docs/book1/chapter1 π.χ., /colls/joe/docs/book1/chapter2 κ.λπ. 

Σημειώστε ότι τα παραδείγματα που αναφέρονται παραπάνω χρησιμοποιούν φιλικό αναγνωριστικά για να μεταφέρετε την ιεραρχία πόρων. Πόροι είναι προσβάσιμες μέσω τα REST API μέσω του πόρου μοναδικών αναγνωριστικών. 

Για τα πολυμέσα με διαχείριση από DocumentDB, η ιδιότητα _media του συνημμένου θα αναφοράς τα πολυμέσα από το URI. Εξασφαλίζει DocumentDB να απορριμμάτων συλλογής των πολυμέσων όταν όλες τις αναφορές εξαιρετική χάνονται. DocumentDB αυτόματα δημιουργεί το συνημμένο, όταν κάνετε αποστολή το νέο μέσο και συμπληρώνει τη _media ώστε να οδηγούν στο μέσο που προστέθηκε πρόσφατα. Εάν επιλέξετε να αποθηκεύουν τα μέσα σε ένα χώρο αποθήκευσης αντικειμένων blob απομακρυσμένο διαχειριζόμενο από εσάς (π.χ. OneDrive, αποθήκευσης Azure, DropBox κ.λπ.), μπορείτε να χρησιμοποιήσετε συνημμένα για αναφορά των πολυμέσων. Σε αυτήν την περίπτωση, θα δημιουργήσετε το συνημμένο στον εαυτό σας και τη συμπλήρωση την ιδιότητα _media.   

Όπως συμβαίνει με άλλους πόρους συνημμένων μπορούν να δημιουργηθούν, αντικατασταθεί, διαγραφεί, διαβάστε ή απαρίθμηση εύκολα χρησιμοποιώντας είτε REST API ή οποιαδήποτε από το πρόγραμμα-πελάτη SDK. Όπως συμβαίνει με τα έγγραφα, το επίπεδο ανάγνωσης συνέπειας των συνημμένων που ακολουθεί την πολιτική συνέπειας στη το λογαριασμό βάσης δεδομένων. Αυτή η πολιτική μπορεί να αντικατασταθεί με βάση ανά αίτηση ανάλογα με τις απαιτήσεις συνέπειας δεδομένων της εφαρμογής σας. Κατά την υποβολή ερωτήματος για τα συνημμένα, διαβάστε τη συνέπεια ακολουθεί τη λειτουργία δημιουργίας ευρετηρίου ρύθμιση στη συλλογή. Για "συνεπή", αυτό ακολουθεί πολιτικής συνέπειας του λογαριασμού. 
 
## <a name="users"></a>Οι χρήστες
Ένας χρήστης DocumentDB αντιπροσωπεύει ένα λογικό πεδίο ονομάτων για την ομαδοποίηση των δικαιωμάτων. Ένας χρήστης DocumentDB μπορεί να αντιστοιχούν σε ένα χρήστη σε ένα σύστημα διαχείρισης ταυτοτήτων ή ένα ρόλο προκαθορισμένες εφαρμογής. Για DocumentDB, ένας χρήστης αντιπροσωπεύει απλώς μια αφαίρεσης για να ομαδοποιήσετε ένα σύνολο δικαιωμάτων στην περιοχή μιας βάσης δεδομένων.   

Για την εφαρμογή πολλαπλή μίσθωση στην εφαρμογή σας, μπορείτε να δημιουργήσετε χρήστες στο DocumentDB που αντιστοιχεί σε πραγματική τους χρήστες σας ή το μισθωτή της εφαρμογής σας. Στη συνέχεια, μπορείτε να δημιουργήσετε δικαιωμάτων για έναν δεδομένο χρήστη που αντιστοιχούν στο στοιχείο ελέγχου πρόσβασης επάνω από διάφορες συλλογές, έγγραφα, συνημμένα, κ.λπ.   

Καθώς τις εφαρμογές σας πρέπει να κλιμακωθεί με την ανάπτυξη του χρήστη, μπορεί να λάβει διάφοροι τρόποι για να shard τα δεδομένα σας. Μπορείτε να δημιουργήσετε ένα μοντέλο κάθε έναν από τους χρήστες σας ως εξής:   

-   Αντιστοιχίζει κάθε χρήστη σε μια βάση δεδομένων.
-   Αντιστοιχίζει κάθε χρήστη σε μια συλλογή. 
-   Έγγραφα που αντιστοιχεί σε πολλούς χρήστες να μεταβείτε σε μια αποκλειστική συλλογή. 
-   Έγγραφα που αντιστοιχεί σε πολλούς χρήστες να μεταβείτε σε ένα σύνολο συλλογών.   

Ανεξάρτητα από τη στρατηγική συγκεκριμένες sharding που επιλέγετε, μπορείτε να τους χρήστες του μοντέλου ως χρήστες στη βάση δεδομένων DocumentDB και να συσχετίσετε κανονικά κοκκώδης δικαιώματα σε κάθε χρήστη.  

![Συλλογές χρήστη][3]  
**Στρατηγικές sharding και μοντελοποίηση χρήστες**

Όπως όλα τα άλλα μέσα, τους χρήστες σε DocumentDB μπορούν να δημιουργηθούν, αντικατασταθεί, διαγραφεί, διαβάστε ή απαρίθμηση εύκολα χρησιμοποιώντας είτε REST API ή οποιαδήποτε από το πρόγραμμα-πελάτη SDK. DocumentDB παρέχει πάντα ισχυρό συνέπειας για ανάγνωση ή την υποβολή ερωτημάτων τα μετα-δεδομένα από έναν πόρο χρήστη. Αξίζει να παραπέμπουν σε ότι αυτόματη διαγραφή χρήστη εξασφαλίζει ότι δεν έχετε πρόσβαση σε οποιοδήποτε από τα δικαιώματα που περιέχονται σε αυτό. Παρόλο που το DocumentDB ανακτά ο οποίος έχει του ορίου των δικαιωμάτων ως μέρος του διαγραμμένου χρήστη στο παρασκήνιο, τα διαγραμμένα δικαιώματα είναι διαθέσιμη στη στιγμή ξανά για να χρησιμοποιήσετε.  

## <a name="permissions"></a>Δικαιώματα
Από μια προοπτική ελέγχου πρόσβασης, τους πόρους, όπως λογαριασμοί βάσης δεδομένων, βάσεις δεδομένων, οι χρήστες και δικαιώματα θεωρούνται πόροι *διαχείρισης* εφόσον αυτά απαιτούν δικαιώματα διαχειριστή. Από την άλλη πλευρά, πόρους, όπως το συλλογές, έγγραφα, συνημμένα, αποθηκευμένες διαδικασίες, εναύσματα και UDF στοχεύουν κάτω από μια βάση δεδομένων και θεωρούνται *πόρους εφαρμογής*. Σύμφωνα με τους δύο τύπους των πόρων και τους ρόλους που πρόσβαση σε αυτά (δηλαδή τον διαχειριστή και το χρήστη), το μοντέλο εξουσιοδότησης καθορίζει δύο τύπους *πλήκτρων πρόσβασης*: *πρωτεύον κλειδί* και *κλειδί πόρου*. Το πρωτεύον κλειδί είναι ένα τμήμα του λογαριασμού βάσης δεδομένων και να ο προγραμματιστής (ή ο διαχειριστής) που προμήθεια το λογαριασμό βάσης δεδομένων. Σε αυτό το πρωτεύον κλειδί έχει σημασιολογία διαχειριστή, σε που μπορεί να χρησιμοποιηθεί για να εξουσιοδοτήσετε πρόσβασης σε πόρους τόσο διαχείρισης και εφαρμογής. Αντίθετα, έναν αριθμό-κλειδί πόρων είναι ένα κλειδί λεπτομερούς πρόσβασης που επιτρέπει την πρόσβαση σε έναν *συγκεκριμένο* πόρο εφαρμογής. Έτσι, καταγράφει τη σχέση μεταξύ του χρήστη μιας βάσης δεδομένων και τα δικαιώματα που ο χρήστης έχει για ένα συγκεκριμένο πόρο (π.χ. συλλογής, εγγράφου, συνημμένο, αποθηκευμένη διαδικασία, έναυσμα ή UDF).   

Ο μόνος τρόπος για να αποκτήσετε έναν αριθμό-κλειδί πόρος είναι μέσω της δημιουργίας ενός πόρου δικαιωμάτων στην περιοχή ένας συγκεκριμένος χρήστης. Σημειώστε ότι για να δημιουργήσετε ή να ανακτήσετε ένα δικαίωμα, ένα πρωτεύον κλειδί πρέπει να υποβάλλονται στην κεφαλίδα της εξουσιοδότησης. Ένας πόρος δικαιωμάτων συνδέει τον πόρο, την πρόσβαση και ο χρήστης. Μετά τη δημιουργία ενός πόρου δικαίωμα, ο χρήστης πρέπει μόνο να παρουσιάσετε το κλειδί σχετικό πόρος για να αποκτήσετε πρόσβαση σε το σχετικό πόρο. Επομένως, έναν αριθμό-κλειδί πόρων μπορούν να προβληθούν ως μια λογική και συμπαγής αναπαράσταση του πόρου δικαιωμάτων.  

Όπως με άλλους πόρους, δικαιώματα στο DocumentDB μπορούν να δημιουργηθούν, αντικατασταθεί, διαγραφή, διαβάστε ή απαρίθμηση εύκολα χρησιμοποιώντας είτε REST API ή οποιαδήποτε από το πρόγραμμα-πελάτη SDK. DocumentDB παρέχει πάντα ισχυρό συνέπειας για ανάγνωση ή την υποβολή ερωτημάτων τα μετα-δεδομένα από ένα δικαίωμα. 

## <a name="next-steps"></a>Επόμενα βήματα
Μάθετε περισσότερα σχετικά με την εργασία με τους πόρους, χρησιμοποιώντας εντολές HTTP σε [RESTful αλληλεπιδράσεις με DocumentDB πόρους](https://msdn.microsoft.com/library/azure/mt622086.aspx).


[1]: media/documentdb-resources/resources1.png
[2]: media/documentdb-resources/resources2.png
[3]: media/documentdb-resources/resources3.png


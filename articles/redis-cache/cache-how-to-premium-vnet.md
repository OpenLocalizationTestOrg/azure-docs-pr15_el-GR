<properties 
    pageTitle="Πώς μπορείτε να ρυθμίσετε τις παραμέτρους εικονικού δικτύου υποστήριξης για Premium Azure Redis μνήμης Cache | Microsoft Azure" 
    description="Μάθετε πώς μπορείτε να δημιουργήσετε και να διαχειριστείτε την υποστήριξη εικονικού δικτύου για τις παρουσίες Premium επίπεδο Azure Redis Cache" 
    services="redis-cache" 
    documentationCenter="" 
    authors="steved0x" 
    manager="douge" 
    editor=""/>

<tags 
    ms.service="cache" 
    ms.workload="tbd" 
    ms.tgt_pltfrm="cache-redis" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="09/15/2016" 
    ms.author="sdanie"/>

# <a name="how-to-configure-virtual-network-support-for-a-premium-azure-redis-cache"></a>Τρόπος ρύθμισης των παραμέτρων εικονικού υποστήριξη δικτύου για Premium Azure Redis μνήμης Cache
Azure Redis Cache έχει διαφορετικό cache προσφορές που παρέχουν ευελιξία κατά την επιλογή των μέγεθος του cache και τις δυνατότητες, όπως η νέα σειρά Premium.

Οι δυνατότητες Azure Redis Cache premium επίπεδο περιλαμβάνουν σύμπλεγμα, διατήρηση και υποστήριξη εικονικού δικτύου (VNet). Ένα VNet είναι ένα ιδιωτικό δίκτυο στο cloud. Όταν μια παρουσία Azure Redis Cache έχει ρυθμιστεί με έναν VNet, δεν είναι δημόσια μπορούν να χρησιμοποιηθούν και είναι δυνατή η πρόσβαση μόνο από εικονικές μηχανές και εφαρμογές εντός του VNet. Σε αυτό το άρθρο περιγράφει πώς μπορείτε να ρυθμίσετε τις παραμέτρους εικονικού δικτύου υποστήριξης για μια παρουσία Azure Redis Cache premium.

>[AZURE.NOTE] Azure Redis Cache υποστηρίζει δύο κλασική και ARM VNets.

Για πληροφορίες σχετικά με άλλες κορυφαίες δυνατότητες του cache, ανατρέξτε στο θέμα [Εισαγωγή στο επίπεδο Azure Redis Cache Premium](cache-premium-tier-intro.md).

## <a name="why-vnet"></a>Γιατί VNet;
Ανάπτυξη του [Azure εικονικού δικτύου (VNet)](https://azure.microsoft.com/services/virtual-network/) παρέχει βελτιωμένη ασφάλεια και απομόνωσης για το Azure Redis μνήμη Cache, καθώς και δευτερεύοντα δίκτυα, πολιτικών του ελέγχου πρόσβασης και άλλες δυνατότητες για να περιορίσετε περαιτέρω την πρόσβαση σε Azure Redis Cache.

## <a name="virtual-network-support"></a>Υποστήριξη εικονικού δικτύου
Εικονικό υποστήριξη δικτύου (VNet) έχει ρυθμιστεί στο το **Νέο Cache Redis** blade κατά τη δημιουργία του cache. 

[AZURE.INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

Αφού έχετε επιλέξει μια premium τιμολόγησης επίπεδο, μπορείτε να ρυθμίσετε Azure Redis Cache VNet ενοποίησης, επιλέγοντας ένα VNet που βρίσκεται στην ίδια συνδρομή και θέση ως το cache. Για να χρησιμοποιήσετε μια νέα VNet, δημιουργήστε πρώτα, ακολουθώντας τα βήματα στο θέμα [Δημιουργία εικονικών δικτύου με την πύλη Azure](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) ή να [δημιουργήσετε ένα εικονικό δίκτυο (κλασικό), χρησιμοποιώντας την πύλη του Azure](../virtual-network/virtual-networks-create-vnet-classic-portal.md) και, στη συνέχεια, επιστρέψετε το **Νέο Cache Redis** blade για να δημιουργήσετε και να ρυθμίσετε το cache premium.

Για να ρυθμίσετε τις παραμέτρους του VNet για το νέο cache, κάντε κλικ στην εντολή **Εικονικού δικτύου** το **Νέο Cache Redis** blade και επιλέξτε την επιθυμητή VNet από την αναπτυσσόμενη λίστα.

![Εικονικό δίκτυο][redis-cache-vnet]

Επιλέξτε το επιθυμητό υποδίκτυο από την αναπτυσσόμενη λίστα **υποδικτύου** και καθορίστε τη **στατική διεύθυνση IP**που θέλετε. Εάν χρησιμοποιείτε μια κλασική VNet τη **στατική διεύθυνση IP** πεδίο είναι προαιρετικό και, εάν δεν έχει καθοριστεί, θα επιλεγεί από το επιλεγμένο υποδίκτυο.

>[AZURE.IMPORTANT] Κατά την ανάπτυξη μιας Cache Redis Azure σε μια VNet ARM, το cache πρέπει να είναι ένα αποκλειστικό υποδίκτυο που δεν περιέχει άλλους πόρους εκτός από το Azure Redis Cache παρουσίες. Εάν η προσπάθεια για να αναπτύξετε ένα Cache Redis Azure σε μια VNet ARM με ένα δευτερεύον που περιέχει άλλους πόρους, αποτύχει η ανάπτυξη.

![Εικονικό δίκτυο][redis-cache-vnet-ip]

>[AZURE.IMPORTANT] Οι πρώτες τέσσερις διευθύνσεις σε ένα υποδίκτυο είναι δεσμευμένο και δεν μπορεί να χρησιμοποιηθεί. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [υπάρχουν περιορισμοί σχετικά με τη χρήση διευθύνσεων IP μέσα σε αυτά τα δευτερεύοντα δίκτυα;](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)

Μετά τη δημιουργία του cache, μπορείτε να προβάλετε τη ρύθμιση παραμέτρων για το VNet κάνοντας κλικ στην επιλογή **Εικονικού δικτύου** από το blade **Ρυθμίσεις** .

![Εικονικό δίκτυο][redis-cache-vnet-info]


Για να συνδεθείτε με την παρουσία cache Azure Redis κατά τη χρήση μιας VNet, καθορίστε το όνομα κεντρικού υπολογιστή από το cache στη συμβολοσειρά σύνδεσης όπως φαίνεται στο παρακάτω παράδειγμα.

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });
    
    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a>Azure Redis Cache VNet συνήθεις Ερωτήσεις

Η παρακάτω λίστα περιέχει απαντήσεις σε συνήθεις ερωτήσεις σχετικά με την κλίμακα του Azure Redis Cache.

-   [Τι είναι οι κάποια κοινά θέματα εσφαλμένη ρύθμιση παραμέτρων Azure Redis Cache και VNets;](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
-   [Μπορώ να χρησιμοποιήσω VNets με μια τυπική ή βασικές cache;](#can-i-use-vnets-with-a-standard-or-basic-cache)
-   [Γιατί δημιουργήσετε Redis cache αποτυγχάνουν σε ορισμένα δευτερεύοντα δίκτυα, αλλά όχι άλλους χρήστες;](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
-   [Λειτουργούν όλες οι δυνατότητες cache όταν φιλοξενίας ένα cache σε μια VNET;](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)


## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a>Τι είναι οι κάποια κοινά θέματα εσφαλμένη ρύθμιση παραμέτρων Azure Redis Cache και VNets;

Όταν Azure Redis Cache φιλοξενείται σε μια VNet, χρησιμοποιούνται οι θύρες στον παρακάτω πίνακα. Εάν αυτές οι θύρες έχουν αποκλειστεί, το cache ενδέχεται να μην λειτουργεί σωστά. Μία ή περισσότερες από αυτές τις θύρες αποκλεισμένες είναι τα πιο συνηθισμένα ζήτημα εσφαλμένη ρύθμιση παραμέτρων κατά τη χρήση του Cache Redis Azure σε μια VNet.

| Θύρες     | Κατεύθυνση        | Πρωτόκολλο μεταφοράς | Σκοπός                                                                           | Απομακρυσμένη IP                           |
|-------------|------------------|--------------------|-----------------------------------------------------------------------------------|-------------------------------------|
| 80, 443     | Εξερχομένων         | TCP                | Redis εξαρτήσεις σε Azure αποθήκευσης/PKI (Internet)                                | *                                   |
| 53          | Εξερχομένων         | TCP/UDP            | Redis εξαρτήσεων από DNS (Internet VNet)                                         | *                                   |
| 6379, 6380  | Εισερχομένων          | TCP                | Πρόγραμμα-πελάτη επικοινωνία με το Redis, εξισορρόπηση φόρτου Azure                               | VIRTUAL_NETWORK, AZURE_LOADBALANCER |
| 8443        | Εισερχομένων/εξερχομένων | TCP                | Λεπτομέρεια εφαρμογής για Redis                                                   | VIRTUAL_NETWORK                     |
| 8500        | Εισερχομένων          | TCP/UDP            | Εξισορρόπηση φόρτου Azure                                                              | AZURE_LOADBALANCER                  |
| 10221 10231 | Εισερχομένων/εξερχομένων | TCP                | Λεπτομέρεια εφαρμογής για Redis (μπορούν να περιορίσουν απομακρυσμένο τελικό σημείο για να VIRTUAL_NETWORK) | VIRTUAL_NETWORK, AZURE_LOADBALANCER |
| 13000 13999 | Εισερχομένων          | TCP                | Πρόγραμμα-πελάτη επικοινωνία με το Redis συμπλεγμάτων, εξισορρόπηση φόρτου Azure                      | VIRTUAL_NETWORK, AZURE_LOADBALANCER |
| 15000 15999 | Εισερχομένων          | TCP                | Πρόγραμμα-πελάτη επικοινωνία με το Redis συμπλεγμάτων, εξισορρόπηση φόρτου Azure                      | VIRTUAL_NETWORK, AZURE_LOADBALANCER |
| 16001       | Εισερχομένων          | TCP/UDP            | Εξισορρόπηση φόρτου Azure                                                              | AZURE_LOADBALANCER                  |
| 20226       | Εισερχόμενη + εξερχομένων | TCP                | Λεπτομέρεια εφαρμογής για Redis συμπλεγμάτων                                          | VIRTUAL_NETWORK                     |


Υπάρχουν απαιτήσεις συνδεσιμότητας δικτύου για Azure Redis μνήμη Cache που δεν μπορεί να πληρούνται αρχικά σε ένα εικονικό δίκτυο. Azure Redis Cache απαιτεί όλα τα ακόλουθα στοιχεία για να λειτουργήσει σωστά όταν χρησιμοποιείται μέσα σε ένα εικονικό δίκτυο.

-  Η συνδεσιμότητα του δικτύου εξερχομένων στο χώρο αποθήκευσης Azure τελικά σημεία σε όλο τον κόσμο. Αυτό περιλαμβάνει τελικά σημεία που βρίσκεται στην ίδια περιοχή καθώς η παρουσία Azure Redis Cache, καθώς και τα τελικά σημεία αποθήκευσης βρίσκονται σε **άλλες** Azure περιοχές. Επίλυση Azure τελικά σημεία αποθήκευσης κάτω από τους παρακάτω τομείς DNS: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*και *file.core.windows.net*. 
-  Η συνδεσιμότητα του δικτύου εξερχομένων *ocsp.msocsp.com*, *mscrl.microsoft.com* και *crl.microsoft.com*. Αυτή τη σύνδεση είναι απαραίτητη για την υποστήριξη SSL λειτουργικότητας.
-  Τις παραμέτρους DNS για το εικονικό δίκτυο πρέπει να είναι δυνατό να επιλύσει όλα τα τελικά σημεία και τους τομείς που αναφέρονται σε τα παλαιότερα σημεία. Αυτές τις απαιτήσεις DNS μπορεί να πληρούνται διασφαλίζοντας έγκυρη υποδομή DNS είναι ρυθμίσει τις παραμέτρους και να διατηρούνται για το εικονικό δίκτυο.



### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a>Μπορώ να χρησιμοποιήσω VNets με μια τυπική ή βασικές cache;

VNets μπορεί να χρησιμοποιηθεί μόνο με premium μνήμης cache.

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a>Γιατί δημιουργήσετε Redis cache αποτυγχάνουν σε ορισμένα δευτερεύοντα δίκτυα, αλλά όχι άλλους χρήστες;

Εάν αναπτύσσετε ένα Cache Redis Azure σε μια VNet ARM, το cache πρέπει να είναι ένα αποκλειστικό υποδίκτυο που περιέχει κανένα άλλο τύπο πόρου. Εάν γίνει προσπάθεια για να αναπτύξετε ένα Cache Redis Azure σε ένα υποδίκτυο ARM VNet που περιέχει άλλους πόρους, αποτύχει η ανάπτυξη. Πρέπει να διαγράψετε την υπάρχουσα πόρους μέσα στο υποδίκτυο πριν μπορέσετε να δημιουργήσετε ένα νέο cache Redis.

Μπορείτε να αναπτύξετε πολλούς τύπους πόρων σε μια κλασική VNet με την προϋπόθεση ότι έχετε αρκετό διαθέσιμες διευθύνσεις IP.

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a>Λειτουργούν όλες οι δυνατότητες cache όταν φιλοξενίας ένα cache σε μια VNET;

Όταν το cache είναι μέρος μιας VNET, μόνο τα προγράμματα-πελάτες σε το VNET να αποκτήσετε πρόσβαση το cache. Ως αποτέλεσμα, οι ακόλουθες δυνατότητες διαχείρισης cache δεν λειτουργούν αυτήν τη στιγμή.

-   Redis κονσόλας - επειδή Redis κονσόλα χρησιμοποιεί το πρόγραμμα-πελάτη redis cli.exe φιλοξενούνται σε ΣΠΣ που δεν αποτελούν μέρος της VNET σας, δεν μπορεί να συνδεθεί το cache.


## <a name="use-expressroute-with-azure-redis-cache"></a>Χρήση ExpressRoute με Azure Redis Cache

Οι πελάτες να συνδεθείτε ένα κύκλωμα [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) με τους υποδομή εικονικού δικτύου, επέκταση, επομένως, το δίκτυο εσωτερικής εγκατάστασης σε Azure. 

Από προεπιλογή, ένα που έχουν δημιουργηθεί πρόσφατα κύκλωμα ExpressRoute Εμφανίζει κοινοποιήσεις μια προεπιλεγμένη δρομολόγηση που επιτρέπει την εξερχόμενη σύνδεση στο Internet. Με αυτήν τη ρύθμιση, εφαρμογές προγράμματος-πελάτη, θα μπορείτε να συνδεθείτε με άλλες Azure τελικά σημεία, συμπεριλαμβανομένων των Azure Redis Cache.

Ωστόσο είναι μια κοινές ρυθμίσεις παραμέτρων πελάτη για να ορίσετε τις δικές τους προεπιλεγμένη δρομολόγηση (0.0.0.0/0) που επιβάλει εξερχόμενη κυκλοφορία Internet αντί για αυτό ροή εσωτερικής εγκατάστασης. Αυτήν τη ροή κυκλοφορίας αλλαγές είναι πάντοτε συνδεσιμότητας με το Azure Redis Cache επειδή την εξερχόμενη κυκλοφορία είναι είτε αποκλεισμένων εσωτερικής εγκατάστασης ή NAT που κάνατε σε ένα σύνολο αναγνωρίσιμη διευθύνσεις που δεν λειτουργούν πλέον με διάφορες Azure τελικά σημεία.

Η λύση είναι να ορίσετε ένα (ή περισσότερα) που ορίζονται από το χρήστη δρομολογεί (UDRs) στο υποδίκτυο που περιέχει το Cache Redis Azure. Μια UDR καθορίζει δρομολογεί συγκεκριμένο υποδίκτυο που θα εξακολουθήσουν να ισχύουν αντί για την προεπιλεγμένη δρομολόγηση.

Εάν είναι δυνατόν, συνιστάται να χρησιμοποιήσετε τις ακόλουθες ρυθμίσεις παραμέτρων:

- Η ρύθμιση παραμέτρων ExpressRoute κοινοποιείται 0.0.0.0/0 και από προεπιλογή ισχύ διοχετεύει όλα εξερχόμενη κυκλοφορία εσωτερικής εγκατάστασης.
- Το UDR εφαρμόζονται στο υποδίκτυο που περιέχει το Cache Redis Azure καθορίζει 0.0.0.0/0 με έναν τύπο επόμενη μεταπήδηση του Internet (το παράδειγμα αυτό είναι πιο μακριά προς τα κάτω σε αυτό το άρθρο).

Το συνολικό εφέ από αυτά τα βήματα είναι ότι το επίπεδο υποδικτύου UDR υπερισχύει του ExpressRoute υποχρεωτική διοχέτευση, διασφαλίζοντας την εξερχόμενη πρόσβαση στο Internet από το Cache Redis Azure.

Παρόλο που η σύνδεση με μια παρουσία Azure Redis Cache από μια εσωτερική εφαρμογής χρησιμοποιώντας ExpressRoute δεν είναι μια τυπική χρήση σενάριο λόγω λόγους απόδοσης (για καλύτερες επιδόσεις Cache Redis Azure προγράμματα-πελάτες θα πρέπει να είναι στην ίδια περιοχή ως το Cache Redis Azure), σε αυτό το σενάριο της διαδρομής δικτύου εξερχομένων δεν διέρχονται από εσωτερικές εταιρικό διακομιστές μεσολάβησης, ούτε είναι δυνατόν να γίνει διοχέτευση στην εσωτερική εγκατάσταση ισχύ. Αυτή η ενέργεια αλλάζει τη αποτελεσματικές διεύθυνση NAT εξερχόμενη κυκλοφορία δικτύου από το Cache Redis Azure. Αλλαγή της διεύθυνσης NAT από ένα Cache Redis Azure της παρουσίας εξερχόμενη κυκλοφορία του δικτύου προκαλεί αποτυχίες συνδεσιμότητας σε πολλά από τα τελικά σημεία που αναφέρονται παραπάνω. Το αποτέλεσμα αποτυχημένων προσπαθειών δημιουργίας Azure Redis Cache.

**ΣΗΜΑΝΤΙΚΌ:**  Τις διαδρομές που ορίζονται από το σε μια UDR **πρέπει να** είναι συγκεκριμένες για να προηγούνται οποιαδήποτε δρομολογεί κοινοποιείται από τη ρύθμιση παραμέτρων ExpressRoute. Το παρακάτω παράδειγμα χρησιμοποιεί την περιοχή διευθύνσεων γενικά 0.0.0.0/0 και ως τέτοια να ενδεχομένως να κατά λάθος παρακαμφθούν από διαφημίσεις δρομολόγηση χρησιμοποιώντας πιο συγκεκριμένες περιοχές διευθύνσεων.

**ΠΟΛΎ ΣΗΜΑΝΤΙΚΌ:**  Azure Redis Cache δεν υποστηρίζονται με ρυθμίσεις παραμέτρων ExpressRoute που **λάθος σταυρό κοινοποίησης δρομολογεί από τη δημόσια peering διαδρομή προς το ιδιωτικό peering path**. Ρυθμίσεις παραμέτρων ExpressRoute που έχουν δημόσια διεισδύουν ρυθμιστεί, θα λάβετε κοινοποιήσεις διαδρομής από τη Microsoft για μια μεγάλη ομάδα περιοχές διευθύνσεων IP του Microsoft Azure. Εάν αυτές οι περιοχές διευθύνσεων είναι λάθος σταυρό-κοινοποιείται στην ιδιωτική peering διαδρομή, το τελικό αποτέλεσμα είναι ότι όλα τα πακέτα εξερχομένων δικτύου από την παρουσία του Azure Redis Cache υποδίκτυο είναι λάθος ισχύ-γίνει διοχέτευση στην υποδομή δικτύου ενός πελάτη εσωτερικής εγκατάστασης. Αυτήν τη ροή δικτύου αλλαγές Azure Redis Cache. Η λύση για αυτό το πρόβλημα είναι για να διακόψετε την δρομολογεί σταυρό διαφημίσεις από τη δημόσια peering διαδρομή στη διαδρομή ιδιωτικό peering.

Πληροφορίες φόντου σε διαδρομές που ορίζονται από το χρήστη είναι διαθέσιμες σε αυτή η [Επισκόπηση](../virtual-network/virtual-networks-udr-overview.md). 

Για περισσότερες πληροφορίες σχετικά με το ExpressRoute, ανατρέξτε στο θέμα [ExpressRoute Τεχνική επισκόπηση](../expressroute/expressroute-introduction.md)

## <a name="next-steps"></a>Επόμενα βήματα
Μάθετε πώς να χρησιμοποιείτε περισσότερες δυνατότητες cache premium.

-   [Εισαγωγή στο επίπεδο Azure Redis Cache Premium](cache-premium-tier-intro.md)





  
<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png


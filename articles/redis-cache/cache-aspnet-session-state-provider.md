<properties
    pageTitle="Υπηρεσία παροχής περιόδου λειτουργίας ASP.NET cache | Microsoft Azure"
    description="Μάθετε πώς μπορείτε να αποθηκεύσετε περιόδου λειτουργίας ASP.NET χρησιμοποιώντας Azure Redis Cache"
    services="redis-cache"
    documentationCenter="na"
    authors="steved0x"
    manager="douge"
    editor="tysonn" />
<tags
    ms.service="cache"
    ms.devlang="na"
    ms.topic="article"
    ms.tgt_pltfrm="cache-redis"
    ms.workload="tbd"
    ms.date="09/01/2016"
    ms.author="sdanie" />

# <a name="aspnet-session-state-provider-for-azure-redis-cache"></a>Υπηρεσία παροχής περιόδου λειτουργίας ASP.NET για Azure Redis Cache

Azure Redis Cache παρέχει μια υπηρεσία παροχής κατάσταση λειτουργίας που μπορείτε να χρησιμοποιήσετε για να αποθηκεύσετε την κατάσταση λειτουργίας στο cache και όχι στη μνήμη ή σε μια βάση δεδομένων SQL Server. Για να χρησιμοποιήσετε την υπηρεσία παροχής του κατάσταση λειτουργίας σε cache, πρώτα να ρυθμίσετε το cache και, στη συνέχεια, ρύθμιση παραμέτρων της εφαρμογής ASP.NET για cache χρησιμοποιώντας το πακέτο Redis NuGet κατάσταση λειτουργίας Cache.

Δεν είναι συχνά πρακτικό σε μια εφαρμογή ρεαλιστικό cloud για να αποφύγετε την αποθήκευση ορισμένες φόρμας κατάστασης για μια περίοδο λειτουργίας χρήστη, αλλά κάποιες προσεγγίσεις επηρεάσουν επιδόσεις και κλιμάκωση περισσότερα από άλλους χρήστες. Εάν πρέπει να αποθηκεύετε κατάσταση, η καλύτερη λύση είναι να διατηρήσετε το ποσό της κατάστασης μικρό και αποθηκεύστε το σε cookies. Εάν το που δεν είναι εφικτό, η επόμενη καλύτερη λύση είναι να χρησιμοποιήσετε περιόδου λειτουργίας ASP.NET με μια υπηρεσία παροχής για κατανέμεται, στη μνήμη cache. Η λύση χειρότερες από μια επιδόσεις και κλιμάκωση άποψη είναι να χρησιμοποιήσετε μια βάση δεδομένων αντίγραφα υπηρεσίας παροχής κατάσταση περιόδου λειτουργίας. Αυτό το θέμα παρέχει οδηγίες σχετικά με την υπηρεσία παροχής κατάσταση περιόδου λειτουργίας ASP.NET για Azure Redis Cache. Για πληροφορίες σχετικά με άλλες επιλογές κατάστασης περιόδου λειτουργίας, ανατρέξτε στο θέμα [Επιλογές περιόδου λειτουργίας ASP.NET](#aspnet-session-state-options).

## <a name="store-aspnet-session-state-in-the-cache"></a>Αποθήκευση περιόδου λειτουργίας ASP.NET στο cache

Για να ρυθμίσετε μια εφαρμογή προγράμματος-πελάτη στο Visual Studio, χρησιμοποιώντας το πακέτο Redis NuGet κατάσταση λειτουργίας Cache, κάντε δεξί κλικ στο έργο στην **Εξερεύνηση λύσεων** και επιλέξτε **Διαχείριση πακέτων NuGet**.

![Azure Redis Cache διαχείριση πακέτων NuGet](./media/cache-aspnet-session-state-provider/redis-cache-manage-nuget-menu.png)

Πληκτρολογήστε **RedisSessionStateProvider** στο πλαίσιο κειμένου "Αναζήτηση", επιλέξτε την από τα αποτελέσματα και κάντε κλικ στην επιλογή **εγκατάσταση**.

>[AZURE.IMPORTANT] Εάν χρησιμοποιείτε τη δυνατότητα συμπλέγματος από τη σειρά premium, πρέπει να χρησιμοποιήσετε το [RedisSessionStateProvider](https://www.nuget.org/packages/Microsoft.Web.RedisSessionStateProvider) 2.0.1 ή νεότερη έκδοση ή μια εξαίρεση προκαλείται. Αυτή είναι μια αλλαγή πρόσφατες; Για περισσότερες πληροφορίες ανατρέξτε στο θέμα [v2.0.0 διακοπή Αλλαγή λεπτομερειών](https://github.com/Azure/aspnet-redis-providers/wiki/v2.0.0-Breaking-Change-Details).

![Υπηρεσία παροχής κατάσταση περιόδου λειτουργίας Cache Redis Azure](./media/cache-aspnet-session-state-provider/redis-cache-session-state-provider.png)

Το πακέτο Redis περιόδου λειτουργίας κατάσταση υπηρεσίας παροχής NuGet διαθέτει μια εξάρτηση από το πακέτο StackExchange.Redis.StrongName. Εάν το πακέτο StackExchange.Redis.StrongName δεν υπάρχει στο έργο σας θα εγκατασταθούν. Σημειώστε ότι εκτός από το πακέτο StackExchange.Redis.StrongName ισχυρό ονομάζεται εκεί είναι επίσης την έκδοση μη ισχυρό-με όνομα StackExchange.Redis. Εάν το έργο σας χρησιμοποιεί την έκδοση StackExchange.Redis μη ισχυρό-με όνομα που πρέπει να καταργήσετε την εγκατάστασή του, πριν ή μετά την εγκατάσταση του πακέτου Redis NuGet παροχής κατάσταση λειτουργίας, διαφορετικά που θα λάβετε ονομασία διενέξεων στο έργο σας. Για περισσότερες πληροφορίες σχετικά με αυτά τα πακέτα, ανατρέξτε στο θέμα [Ρύθμιση παραμέτρων .NET προγράμματα-πελάτες cache](cache-dotnet-how-to-use-azure-redis-cache.md#configure-the-cache-clients).

Το πακέτο NuGet στοιχεία λήψης και προσθέτει το συγκρότησης που απαιτείται αναφορές και προσθέτει το ακόλουθο προσθέτει την παρακάτω ενότητα στο αρχείο σας web.config που περιέχει τις απαιτούμενες ρυθμίσεις για την εφαρμογή σας ASP.NET για να χρησιμοποιήσετε το Redis Cache κατάσταση υπηρεσίας παροχής περιόδου λειτουργίας.

    <sessionState mode="Custom" customProvider="MySessionStateStore">
        <providers>
        <!--
        <add name="MySessionStateStore"
            host = "127.0.0.1" [String]
            port = "" [number]
            accessKey = "" [String]
            ssl = "false" [true|false]
            throwOnError = "true" [true|false]
            retryTimeoutInMilliseconds = "0" [number]
            databaseId = "0" [number]
            applicationName = "" [String]
            connectionTimeoutInMilliseconds = "5000" [number]
            operationTimeoutInMilliseconds = "5000" [number]
        />
        -->
        <add name="MySessionStateStore" type="Microsoft.Web.Redis.RedisSessionStateProvider" host="127.0.0.1" accessKey="" ssl="false"/>
        </providers>
    </sessionState>

Στην ενότητα σχόλια παρέχει ένα παράδειγμα του χαρακτηριστικά και τις ρυθμίσεις δείγμα για κάθε χαρακτηριστικό.

Ρύθμιση παραμέτρων τα χαρακτηριστικά με τις τιμές από το cache blade στην πύλη του Microsoft Azure και ρυθμίσετε τις άλλες τιμές που θέλετε. Για οδηγίες σχετικά με την πρόσβαση σε ιδιότητες του cache σας, ανατρέξτε στο θέμα [Ρύθμιση παραμέτρων Redis ρυθμίσεις του cache](cache-configure.md#configure-redis-cache-settings).

-   **κεντρικός υπολογιστής** -Καθορίστε το τελικό σημείο cache.
-   **θύρα** – χρήση θύρα σας χωρίς SSL ή το SSL θύρα, ανάλογα με τις ρυθμίσεις ssl.
-   **accessKey** -Χρησιμοποιήστε το πρωτεύον ή δευτερεύον κλειδί για το cache.
-   **ssl** – true εάν θέλετε να ασφαλούς επικοινωνιών cache/προγράμματος-πελάτη με ssl; Διαφορετικά false. Φροντίστε να καθορίσετε τη σωστή θύρα.
    -   Η θύρα μη SSL είναι απενεργοποιημένη από προεπιλογή για νέες μνήμης cache. Καθορίστε την τιμή true για αυτήν τη ρύθμιση για να χρησιμοποιήσετε τη θύρα SSL. Για περισσότερες πληροφορίες σχετικά με την ενεργοποίηση της θύρας χωρίς SSL, ανατρέξτε στην ενότητα [Πρόσβαση θύρες](cache-configure.md#access-ports) στο θέμα [Ρύθμιση παραμέτρων cache](cache-configure.md) .
-   **throwOnError** – true εάν θέλετε μια εξαίρεση για να είναι, σε περίπτωση αποτυχίας, ή false, εάν θέλετε η λειτουργία αποτυχία παρέμβαση του χρήστη. Μπορείτε να ελέγξετε για μια αποτυχία, επιλέγοντας τη στατική ιδιότητα Microsoft.Web.Redis.RedisSessionStateProvider.LastException. Η προεπιλογή είναι true.
-   **retryTimeoutInMilliseconds** – λειτουργίες που αποτύχει επαναλαμβάνονται κατά το καθορισμένο χρονικό διάστημα, σε χιλιοστά του δευτερολέπτου. Την πρώτη επανάληψη αναζήτησης παρουσιαστεί μετά 20 χιλιοστά του δευτερολέπτου, και, στη συνέχεια, επαναλήψεις γίνονται ανά δευτερόλεπτο μέχρι να λήξει το χρονικό διάστημα retryTimeoutInMilliseconds. Αμέσως μετά από αυτό το χρονικό διάστημα, η λειτουργία έχει επαναληφθεί μία τελευταία φορά. Εάν η λειτουργία εξακολουθεί να αποτυγχάνει, η εξαίρεση ξανά για να τον καλούντα, ανάλογα με τη ρύθμιση throwOnError. Η προεπιλεγμένη τιμή είναι 0, γεγονός που σημαίνει ότι δεν υπάρχει επαναλήψεις.
-   **databaseId** – Καθορίζει τη βάση δεδομένων που θα χρησιμοποιηθεί για cache εξόδου δεδομένων. Εάν δεν καθορίζεται, χρησιμοποιείται η προεπιλεγμένη τιμή 0.
-   **applicationName** – πλήκτρα είναι αποθηκευμένα σε redis ως `{<Application Name>_<Session ID>}_Data`. Αυτή η δυνατότητα επιτρέπει πολλές εφαρμογές να μοιράζονται το ίδιο κλειδί. Αυτή η παράμετρος είναι προαιρετική και εάν δεν παρέχεται αυτό χρησιμοποιείται μια προεπιλεγμένη τιμή.
-   **connectionTimeoutInMilliseconds** – αυτή η ρύθμιση σάς επιτρέπει να αντικαταστήσετε τη ρύθμιση connectTimeout στο πρόγραμμα-πελάτη StackExchange.Redis. Εάν δεν καθορίζεται, χρησιμοποιείται η προεπιλεγμένη ρύθμιση connectTimeout 5000. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [μοντέλο ρύθμισης παραμέτρων StackExchange.Redis](http://go.microsoft.com/fwlink/?LinkId=398705).
-   **operationTimeoutInMilliseconds** – αυτή η ρύθμιση σάς επιτρέπει να αντικαταστήσετε τη ρύθμιση syncTimeout στο πρόγραμμα-πελάτη StackExchange.Redis. Εάν δεν καθορίζεται, χρησιμοποιείται η προεπιλεγμένη ρύθμιση syncTimeout 1000. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [μοντέλο ρύθμισης παραμέτρων StackExchange.Redis](http://go.microsoft.com/fwlink/?LinkId=398705).

Για περισσότερες πληροφορίες σχετικά με αυτές τις ιδιότητες, ανατρέξτε στο θέμα το αρχικό ανακοίνωση δημοσίευση ιστολογίου στο [Ανακοίνωση ASP.NET κατάσταση υπηρεσίας παροχής περιόδου λειτουργίας για Redis](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx).

Μην ξεχάσετε να σχολιάσετε τυπική InProc περιόδου λειτουργίας κατάσταση υπηρεσίας παροχής ενότητα στο web.config σας.

    <!-- <sessionState mode="InProc"
         customProvider="DefaultSessionProvider">
         <providers>
            <add name="DefaultSessionProvider"
                  type="System.Web.Providers.DefaultSessionStateProvider,
                        System.Web.Providers, Version=1.0.0.0, Culture=neutral,
                        PublicKeyToken=31bf3856ad364e35"
                  connectionStringName="DefaultConnection" />
          </providers>
    </sessionState> -->

Όταν εκτελούνται αυτά τα βήματα, η εφαρμογή σας έχει ρυθμιστεί να χρησιμοποιεί το Redis Cache κατάσταση υπηρεσίας παροχής περιόδου λειτουργίας. Όταν χρησιμοποιείτε την κατάσταση της περιόδου λειτουργίας στην εφαρμογή σας, θα αποθηκευτεί στο Azure Redis Cache παρουσίας.

>[AZURE.NOTE] Σημειώστε ότι πρέπει να σειριοποιηθεί δεδομένα που είναι αποθηκευμένα στο cache, σε αντίθεση με τα δεδομένα που μπορούν να αποθηκευτούν στην προεπιλεγμένη περιόδου λειτουργίας ASP.NET στη μνήμη κατάστασης υπηρεσίας παροχής. Όταν χρησιμοποιείται η υπηρεσία παροχής κατάσταση λειτουργίας για Redis, βεβαιωθείτε ότι οι τύποι δεδομένων που αποθηκεύονται σε κατάσταση λειτουργίας είναι σειριοποιηθεί.

## <a name="aspnet-session-state-options"></a>Επιλογές κατάστασης περιόδου λειτουργίας ASP.NET

- Στην υπηρεσία παροχής κατάσταση περιόδου λειτουργίας μνήμης - αυτή η υπηρεσία παροχής αποθηκεύει την κατάσταση λειτουργίας στη μνήμη. Το πλεονέκτημα της χρήσης αυτής της υπηρεσίας παροχής είναι είναι εύκολη και γρήγορη. Ωστόσο δεν κλίμακα τις εφαρμογές Web, εάν χρησιμοποιείτε στην υπηρεσία παροχής μνήμης εφόσον δεν διανέμεται.

- Υπηρεσία παροχής κατάσταση περιόδου λειτουργίας του SQL Server - αυτή η υπηρεσία παροχής αποθηκεύει την κατάσταση λειτουργίας στον Sql Server. Θα πρέπει να μπορείτε να χρησιμοποιήσετε αυτήν την υπηρεσία παροχής, εάν θέλετε να διατήρησης της κατάστασης λειτουργίας σε μια μόνιμη χώρου αποθήκευσης. Μπορείτε να κλιμακωθεί την εφαρμογή Web της, αλλά χρησιμοποιώντας τον Sql Server για την περίοδο λειτουργίας θα έχουν επίδραση επιδόσεων στην εφαρμογή Web της.

- Κατανεμημένο στο μνήμης κατάσταση υπηρεσίας παροχής περιόδου λειτουργίας όπως Redis Cache κατάσταση υπηρεσίας παροχής περιόδου λειτουργίας - αυτή η υπηρεσία παροχής παρέχει τα καλύτερα από δύο κατηγορία. Εφαρμογή Web της μπορεί να έχει ένα απλό, γρήγορα και με κατάσταση υπηρεσίας παροχής περιόδου λειτουργίας. Ωστόσο, πρέπει να έχετε υπόψη ότι αυτή η υπηρεσία παροχής αποθηκεύει την κατάσταση λειτουργίας σε μνήμη Cache και περιλαμβάνει την εφαρμογή σας για να ληφθούν υπόψη όλα τα χαρακτηριστικά που έχει συσχετιστεί κατά συνομιλία με κατανεμημένο στη μνήμη Cache όπως αποτυχίες μεταβατικές δικτύου. Για βέλτιστες πρακτικές σχετικά με τη χρήση μνήμης Cache, ανατρέξτε στο θέμα [οδηγίες προσωρινή αποθήκευση](../best-practices-caching.md) από το Microsoft μοτίβα & πρακτικές [Azure Cloud εφαρμογή σχεδίαση και υλοποίηση καθοδήγηση](https://github.com/mspnp/azure-guidance).

Για περισσότερες πληροφορίες σχετικά με την κατάσταση της περιόδου λειτουργίας και άλλες βέλτιστες πρακτικές, ανατρέξτε στο θέμα [Βέλτιστες πρακτικές ανάπτυξης Web (δόμησης ρεαλιστικό Cloud εφαρμογές με το Azure)](http://www.asp.net/aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/web-development-best-practices).

## <a name="next-steps"></a>Επόμενα βήματα

Δείτε την υπηρεσία [Παροχής Cache εξόδου ASP.NET για Azure Redis Cache](cache-aspnet-output-cache-provider.md).

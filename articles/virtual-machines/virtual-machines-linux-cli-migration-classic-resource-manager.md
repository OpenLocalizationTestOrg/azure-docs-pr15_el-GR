<properties
    pageTitle="Μετεγκατάσταση IaaS πόρους από κλασική διαχείριση πόρων για να Azure χρησιμοποιώντας Azure CLI | Microsoft Azure"
    description="Σε αυτό το άρθρο καθοδηγεί σε τη μετεγκατάσταση που υποστηρίζονται πλατφόρμα πόρων από κλασική διαχείριση πόρων για να Azure χρησιμοποιώντας Azure CLI"
    services="virtual-machines-linux"
    documentationCenter=""
    authors="cynthn"
    manager="timlt"
    editor=""
    tags="azure-resource-manager"/>

<tags
    ms.service="virtual-machines-linux"
    ms.workload="infrastructure-services"
    ms.tgt_pltfrm="vm-linux"
    ms.devlang="na"
    ms.topic="article"
    ms.date="07/19/2016"
    ms.author="cynthn"/>

# <a name="migrate-iaas-resources-from-classic-to-azure-resource-manager-by-using-azure-cli"></a>Μετεγκατάσταση IaaS πόρους από κλασική διαχείριση πόρων για να Azure χρησιμοποιώντας Azure CLI

Αυτά τα βήματα σας δείχνουν πώς μπορείτε να χρησιμοποιήσετε εντολές Azure περιβάλλον γραμμής εντολών (CLI) για να μετεγκαταστήσετε υποδομής ως πόροι υπηρεσίας (IaaS) από το μοντέλο κλασική ανάπτυξης στο μοντέλο ανάπτυξης διαχείρισης πόρων Azure. Το άρθρο απαιτεί το [Azure CLI](../xplat-cli-install.md).

>[AZURE.NOTE] Όλες οι λειτουργίες που περιγράφονται εδώ είναι idempotent. Εάν έχετε κάποιο πρόβλημα εκτός μιας μη υποστηριζόμενης δυνατότητας ή ένα σφάλμα παραμέτρων, συνιστάται να επαναλάβετε την προετοιμασία, ματαίωση, ή ολοκλήρωση της λειτουργίας. Η πλατφόρμα θα, στη συνέχεια, επαναλάβετε την ενέργεια.

## <a name="step-1-prepare-for-migration"></a>Βήμα 1: Προετοιμασία για μετεγκατάσταση

Ακολουθούν ορισμένες βέλτιστες πρακτικές που συνιστάται κατά την αξιολόγηση μετεγκατάσταση IaaS πόρους από κλασική διαχείριση πόρων για να:

- Διαβάστε στη [λίστα ρυθμίσεις δεν υποστηρίζονται ή δυνατότητες](virtual-machines-windows-migration-classic-resource-manager.md). Εάν έχετε εικονικές μηχανές που χρησιμοποιούν ρυθμίσεις δεν υποστηρίζονται ή δυνατότητες, συνιστάται να περιμένετε την υποστήριξη/της ρύθμισης παραμέτρων δυνατοτήτων για να ανακοινώσει. Εναλλακτικά, μπορείτε να καταργήσετε αυτήν τη δυνατότητα ή να μετακινήσετε εκτός ότι η ρύθμιση παραμέτρων για να ενεργοποιήσετε την μετεγκατάσταση εάν να ανταποκρίνεται στις ανάγκες σας.
-   Εάν έχετε αυτοματοποιημένη δεσμών ενεργειών που σήμερα ανάπτυξη υποδομή και τις εφαρμογές σας, δοκιμάστε να δημιουργήσετε μια παρόμοια ρύθμιση δοκιμής χρησιμοποιώντας αυτές τις δέσμες ενεργειών για τη μετεγκατάσταση. Εναλλακτικά, μπορείτε να ρυθμίσετε δείγμα περιβάλλοντα, χρησιμοποιώντας την πύλη του Azure.

## <a name="step-2-set-your-subscription-and-register-the-provider"></a>Βήμα 2: Ορίστε τη συνδρομή σας και καταχώρηση της υπηρεσίας παροχής

Για σενάρια μετεγκατάστασης, πρέπει να ρυθμίσετε το περιβάλλον σας για δύο κλασική και διαχείριση πόρων. [Εγκατάσταση CLI Azure](../xplat-cli-install.md) και [Επιλέξτε τη συνδρομή σας](../xplat-cli-connect.md).

Πραγματοποιήστε είσοδο στο λογαριασμό σας.
    
    azure login

Επιλέξτε τη συνδρομή Azure χρησιμοποιώντας την ακόλουθη εντολή.

    azure account set "<azure-subscription-name>"

>[AZURE.NOTE] Η εγγραφή είναι ένα χρονικό βήμα αλλά θα πρέπει να γίνει μία φορά πριν να επιχειρήσετε μετεγκατάστασης. Χωρίς να δηλώσετε θα δείτε το ακόλουθο μήνυμα σφάλματος 

>   *BadRequest: Συνδρομή δεν έχει καταχωρηθεί για μετεγκατάσταση.* 

Καταχωρήστε την υπηρεσία παροχής του πόρου μετεγκατάστασης, χρησιμοποιώντας την ακόλουθη εντολή. Σημειώστε ότι σε ορισμένες περιπτώσεις, αυτή η εντολή λήγει το χρονικό όριο. Ωστόσο, η καταχώρηση θα ολοκληρωθεί με επιτυχία.

    azure provider register Microsoft.ClassicInfrastructureMigrate

Περιμένετε πέντε λεπτά για την καταχώρηση για να ολοκληρώσετε. Μπορείτε να ελέγξετε την κατάσταση έγκρισης, χρησιμοποιώντας την ακόλουθη εντολή. Βεβαιωθείτε ότι είναι RegistrationState `Registered` πριν να συνεχίσετε.

    azure provider show Microsoft.ClassicInfrastructureMigrate

Εναλλαγή τώρα CLI για να το `asm` λειτουργία.

    azure config mode asm

## <a name="step-3-make-sure-you-have-enough-azure-resource-manager-virtual-machine-cores-in-the-azure-region-of-your-current-deployment-or-vnet"></a>Βήμα 3: Βεβαιωθείτε ότι έχετε αρκετό πυρήνων Azure διαχείριση πόρων εικονική μηχανή στην περιοχή Azure της τρέχουσας ανάπτυξης ή VNET

Για αυτό το βήμα, θα πρέπει να μεταβείτε σε `arm` λειτουργία. Κάντε τα εξής με την ακόλουθη εντολή.

```
azure config mode arm
```

Μπορείτε να χρησιμοποιήσετε την παρακάτω εντολή CLI για να ελέγξετε την τρέχουσα πυρήνων που έχετε στη Διαχείριση Azure πόρων. Για να μάθετε περισσότερα σχετικά με τα όρια πυρήνα, ανατρέξτε στο θέμα [όρια και τη διαχείριση πόρων Azure](../articles/azure-subscription-service-limits.md#limits-and-the-azure-resource-manager)

```
azure vm list-usage -l "<Your VNET or Deployment's Azure region"
```

Αφού ολοκληρώσετε τη διαδικασία επαλήθευσης αυτό το βήμα, μπορείτε να επιστρέψετε στην `asm` λειτουργία.

    azure config mode asm


## <a name="step-4-option-1---migrate-virtual-machines-in-a-cloud-service"></a>Βήμα 4: Επιλογή 1 - μετεγκατάσταση εικονικές μηχανές σε μια υπηρεσία στο cloud 

Λήψη της λίστας των υπηρεσιών cloud, χρησιμοποιώντας την ακόλουθη εντολή και, στη συνέχεια, επιλέξτε την υπηρεσία cloud που θέλετε να μετεγκαταστήσετε. Λάβετε υπόψη ότι εάν του ΣΠΣ στην υπηρεσία cloud είναι ένα εικονικό δίκτυο ή αν έχει web/εργαζόμενου ρόλους, θα λάβετε ένα μήνυμα σφάλματος.

    azure service list

Εκτελέστε την παρακάτω εντολή για να λάβετε το όνομα ανάπτυξης για την υπηρεσία cloud από τα λεπτομερή δεδομένα εξόδου. Στις περισσότερες περιπτώσεις, το όνομα ανάπτυξης είναι το ίδιο με το όνομα της υπηρεσίας cloud.

    azure service show <serviceName> -vv

Προετοιμάστε τις εικονικές μηχανές στην υπηρεσία cloud για μετεγκατάσταση. Έχετε δύο επιλογές για να επιλέξετε.

Εάν θέλετε για τη μετεγκατάσταση του ΣΠΣ σε μια πλατφόρμα δημιουργήθηκε εικονικού δικτύου, χρησιμοποιήστε την ακόλουθη εντολή.

    azure service deployment prepare-migration <serviceName> <deploymentName> new "" "" ""

Εάν θέλετε να μετεγκαταστήσετε σε ένα υπάρχον δίκτυο εικονικού στο μοντέλο ανάπτυξης για τη διαχείριση πόρων, χρησιμοποιήστε την ακόλουθη εντολή.

    azure service deployment prepare-migration <serviceName> <deploymentName> existing <destinationVNETResourceGroupName> subnetName <vnetName>

Μετά τη λειτουργία προετοιμασία είναι επιτυχής, μπορείτε να δείτε τη λεπτομερή δεδομένα εξόδου για τη λήψη της κατάστασης μετεγκατάστασης του ΣΠΣ και βεβαιωθείτε ότι είναι σε το `Prepared` κατάσταση.

    azure vm show <vmName> -vv

Ελέγξτε τις παραμέτρους για τους πόρους προετοιμασμένο χρησιμοποιώντας CLI ή την πύλη του Azure. Εάν δεν είστε έτοιμοι για μετεγκατάσταση και θέλετε να επιστρέψετε στην παλιά κατάσταση, χρησιμοποιήστε την ακόλουθη εντολή.

    azure service deployment abort-migration <serviceName> <deploymentName>

Εάν σας αρέσει το προετοιμασμένο ρύθμισης παραμέτρων, μπορείτε να μετακινηθείτε προς τα εμπρός και ολοκλήρωση τους πόρους, χρησιμοποιώντας την ακόλουθη εντολή.

    azure service deployment commit-migration <serviceName> <deploymentName>


    
## <a name="step-4-option-2----migrate-virtual-machines-in-a-virtual-network"></a>Βήμα 4: Επιλογή 2 - μετεγκατάσταση εικονικές μηχανές σε ένα εικονικό δίκτυο

Επιλέξτε το εικονικό δίκτυο που θέλετε να μετεγκαταστήσετε. Λάβετε υπόψη ότι εάν το εικονικό δίκτυο περιέχει ρόλους web/εργαζόμενου ή ΣΠΣ με ρυθμίσεις δεν υποστηρίζονται, θα λάβετε ένα μήνυμα σφάλματος επικύρωσης.

Λάβετε όλα τα δίκτυα εικονικού στην συνδρομή, χρησιμοποιώντας την ακόλουθη εντολή.

    azure network vnet list
    
Το αποτέλεσμα θα μοιάζει κάπως έτσι:

![Στιγμιότυπο οθόνης της γραμμής εντολών με το όνομα ολόκληρη εικονικού δικτύου επισημασμένο.](./media/virtual-machines-linux-cli-migration-classic-resource-manager/vnet.png)

Στο παραπάνω παράδειγμα, το **virtualNetworkName** είναι ολόκληρο το όνομα **"Classicubuntu16 classicubuntu16 ομάδας"**.

Προετοιμασία το εικονικό δίκτυο της επιλογής σας για τη μετεγκατάσταση, χρησιμοποιώντας την ακόλουθη εντολή.

    azure network vnet prepare-migration <virtualNetworkName>

Ελέγξτε τις παραμέτρους για τις προετοιμασμένο εικονικές μηχανές χρησιμοποιώντας CLI ή την πύλη του Azure. Εάν δεν είστε έτοιμοι για μετεγκατάσταση και θέλετε να επιστρέψετε στην παλιά κατάσταση, χρησιμοποιήστε την ακόλουθη εντολή.

    azure network vnet abort-migration <virtualNetworkName>

Εάν σας αρέσει το προετοιμασμένο ρύθμισης παραμέτρων, μπορείτε να μετακινηθείτε προς τα εμπρός και ολοκλήρωση τους πόρους, χρησιμοποιώντας την ακόλουθη εντολή.

    azure network vnet commit-migration <virtualNetworkName>

## <a name="step-5-migrate-a-storage-account"></a>Βήμα 5: Μετεγκατάσταση ενός λογαριασμού χώρου αποθήκευσης

Όταν ολοκληρώσετε τη μετεγκατάσταση του εικονικές μηχανές, συνιστάται να κάνετε μετεγκατάσταση του λογαριασμού χώρου αποθήκευσης.

Προετοιμασία του λογαριασμού χώρου αποθήκευσης για τη μετεγκατάσταση, χρησιμοποιώντας την ακόλουθη εντολή

    azure storage account prepare-migration <storageAccountName>

Ελέγξτε τις παραμέτρους για το λογαριασμό χώρου αποθήκευσης προετοιμασμένο χρησιμοποιώντας CLI ή την πύλη του Azure. Εάν δεν είστε έτοιμοι για μετεγκατάσταση και θέλετε να επιστρέψετε στην παλιά κατάσταση, χρησιμοποιήστε την ακόλουθη εντολή.

    azure storage account abort-migration <storageAccountName>

Εάν σας αρέσει το προετοιμασμένο ρύθμισης παραμέτρων, μπορείτε να μετακινηθείτε προς τα εμπρός και ολοκλήρωση τους πόρους, χρησιμοποιώντας την ακόλουθη εντολή.

    azure storage account commit-migration <storageAccountName>

## <a name="next-steps"></a>Επόμενα βήματα

- [Υποστηριζόμενες πλατφόρμες μετεγκατάστασης IaaS πόρων από κλασική για τη διαχείριση πόρων](virtual-machines-windows-migration-classic-resource-manager.md)
- [Τεχνική βαθύ κατάρρευση στη μετεγκατάσταση πλατφόρμα που υποστηρίζονται από κλασική για τη διαχείριση πόρων](virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)

<properties
   pageTitle="Επαναφορά κωδικού πρόσβασης τοπικού Windows όταν δεν είναι εγκατεστημένο παράγοντα Azure επισκέπτη | Microsoft Azure"
   description="Πώς μπορείτε να επαναφέρετε τον κωδικό πρόσβασης του τοπικού λογαριασμού χρήστη των Windows, όταν ο παράγοντας Azure επισκέπτη δεν έχει εγκατασταθεί ή λειτουργεί σε μια εικονική Μηχανή"
   services="virtual-machines-windows"
   documentationCenter=""
   authors="iainfoulds"
   manager="timlt"
   editor=""/>

<tags
   ms.service="virtual-machines-windows"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="vm-windows"
   ms.workload="infrastructure-services"
   ms.date="10/05/2016"
   ms.author="iainfou"/>

# <a name="how-to-reset-local-windows-password-for-azure-vm"></a>Πώς μπορείτε να επαναφέρετε τοπικό κωδικό πρόσβασης των Windows για Εικονική Azure
Μπορείτε να επαναφέρετε τον τοπικό κωδικό πρόσβασης των Windows από μια Εικονική στα Azure χρησιμοποιώντας την [πύλη του Azure ή Azure PowerShell](virtual-machines-windows-reset-rdp.md) που παρέχεται εγκαταστήσει τον παράγοντα Azure επισκέπτη. Αυτή η μέθοδος είναι ο κύριος τρόπος για να επαναφέρετε έναν κωδικό πρόσβασης για μια Εικονική Azure. Εάν αντιμετωπίζετε προβλήματα με τον παράγοντα Azure επισκέπτη δεν ανταποκρίνεται ή αποτυχία εγκατάστασης μετά την αποστολή ενός προσαρμοσμένου ειδώλου, μπορείτε να κάνετε με μη αυτόματο τρόπο επαναφορά κωδικού πρόσβασης των Windows. Αυτό το άρθρο περιγράφει πώς μπορείτε να επαναφέρετε έναν κωδικό πρόσβασης του λογαριασμού τοπικού επισυνάπτοντας το εικονικό δίσκο προέλευσης λειτουργικό σύστημα σε ένα άλλο Εικονική. 

> [AZURE.WARNING] Να χρησιμοποιήσετε αυτήν τη διαδικασία μόνο ως τελευταία λύση. Πάντα προσπαθήστε να επαναφέρετε έναν κωδικό πρόσβασης που χρησιμοποιείτε το [Azure πύλη ή Azure PowerShell](virtual-machines-windows-reset-rdp.md) πρώτα.


## <a name="overview-of-the-process"></a>Επισκόπηση της διεργασίας
Τα βήματα πυρήνα για την εκτέλεση Επαναφορά για μια Εικονική των Windows στα Azure όταν δεν υπάρχει πρόσβαση στον παράγοντα Azure επισκέπτη μιας τοπικής κωδικού πρόσβασης είναι ως εξής:

- Διαγραφή της προέλευσης Εικονική. Το εικονικών δίσκων διατηρούνται.
- Επισύναψη την προέλευση εικονική Μηχανή OS δίσκου σε άλλη Εικονική εντός Azure τη συνδρομή σας. Αυτή η Εικονική αναφέρεται ως η Εικονική αντιμετώπισης προβλημάτων.
- Χρησιμοποιώντας την Εικονική αντιμετώπισης προβλημάτων, δημιουργήστε μερικά αρχεία ρύθμισης παραμέτρων από την προέλευση εικονική Μηχανή OS δίσκο.
- Απόσπαση η Εικονική OS δίσκου από την Εικονική αντιμετώπισης προβλημάτων.
- Χρήση προτύπου για τη διαχείριση πόρων για να δημιουργήσετε μια Εικονική, χρησιμοποιώντας τον αρχικό εικονικό δίσκο.
- Κατά την εκκίνηση του νέου Εικονική, τα αρχεία ρύθμισης παραμέτρων που δημιουργείτε ενημερώνετε τον κωδικό πρόσβασης του χρήστη για τον απαιτούμενο.


## <a name="detailed-steps"></a>Λεπτομερείς οδηγίες
Πάντα προσπαθήστε να επαναφέρετε έναν κωδικό πρόσβασης που χρησιμοποιείτε το [Azure πύλη ή Azure PowerShell](virtual-machines-windows-reset-rdp.md) πριν να δοκιμάσετε τα παρακάτω βήματα. Βεβαιωθείτε ότι έχετε ένα αντίγραφο ασφαλείας της Εικονική σας πριν να ξεκινήσετε. 

1. Διαγράψτε το που επηρεάζεται Εικονική στα Azure πύλη. Διαγραφή του Εικονική θα διαγράψει μόνο τα μετα-δεδομένα, η αναφορά του η Εικονική εντός Azure. Το εικονικών δίσκων διατηρούνται όταν διαγράφεται η Εικονική:

    - Επιλέξτε την εικονική Μηχανή στην πύλη του Azure, κάντε κλικ στην επιλογή *Διαγραφή*:

    ![Διαγραφή υπάρχουσας Εικονική](./media/virtual-machines-windows-reset-local-password-without-guest-agent/delete_vm.png)

2. Επισύναψη δίσκου λειτουργικό σύστημα του εικονική Μηχανή προέλευσης για την αντιμετώπιση προβλημάτων εικονική Μηχανή. Πρέπει να είναι η Εικονική αντιμετώπισης προβλημάτων στην ίδια περιοχή ως την προέλευση εικονική Μηχανή OS δίσκο (όπως είναι οι `West US`):

    - Επιλέξτε την Εικονική αντιμετώπισης προβλημάτων στην πύλη του Azure. Κάντε κλικ στην επιλογή *δίσκων* | *υπάρχουσες επισύναψη*:

    ![Επισύναψη υπάρχοντα δίσκο](./media/virtual-machines-windows-reset-local-password-without-guest-agent/disks_attach_existing.png)

    Επιλέξτε *Αρχείο VHD* και, στη συνέχεια, επιλέξτε το λογαριασμό χώρου αποθήκευσης που περιέχει την προέλευση Εικονική:

    ![Επιλέξτε το λογαριασμό χώρου αποθήκευσης](./media/virtual-machines-windows-reset-local-password-without-guest-agent/disks_select_storageaccount.PNG)

    Επιλέξτε το κοντέινερ προέλευσης. Το κοντέινερ προέλευσης είναι συνήθως *οι VHD*:

    ![Επιλέξτε κοντέινερ χώρου αποθήκευσης](./media/virtual-machines-windows-reset-local-password-without-guest-agent/disks_select_container.png)

    Επιλέξτε τον vhd λειτουργικό σύστημα για να επισυνάψετε. Κάντε κλικ στην *επιλογή* για να ολοκληρώσετε τη διαδικασία:

    ![Επιλέξτε δίσκο εικονικού προέλευσης](./media/virtual-machines-windows-reset-local-password-without-guest-agent/disks_select_source_vhd.png)

3. Σύνδεση με την αντιμετώπιση προβλημάτων εικονική Μηχανή χρησιμοποιώντας απομακρυσμένης επιφάνειας εργασίας και βεβαιωθείτε ότι την προέλευση εικονική Μηχανή OS δίσκου είναι ορατό:

    - Επιλέξτε την Εικονική αντιμετώπισης προβλημάτων στην πύλη του Azure και κάντε κλικ στην επιλογή *σύνδεση*.
    - Ανοίξτε το αρχείο RDP που κάνει λήψη. Πληκτρολογήστε το όνομα χρήστη και τον κωδικό πρόσβασης για την αντιμετώπιση προβλημάτων εικονική Μηχανή.
    - Στην Εξερεύνηση αρχείων, αναζητήστε το δίσκο δεδομένων που έχουν επισυναφθεί. Εάν η προέλευση του Εικονική VHD είναι ο δίσκος μόνο τα δεδομένα που έχουν επισυναφθεί σε η Εικονική αντιμετώπισης προβλημάτων, θα πρέπει να μπορεί να είναι η μονάδα δίσκου στ::

    ![Προβολή του δίσκου συνημμένα δεδομένα](./media/virtual-machines-windows-reset-local-password-without-guest-agent/troubleshooting_vm_fileexplorer.png)

4. Δημιουργία `gpt.ini` στο `\Windows\System32\GroupPolicy` στη μονάδα δίσκου του εικονική Μηχανή προέλευσης (εάν υπάρχει gpt.ini, μετονομάστε το σε gpt.ini.bak):

    > [AZURE.WARNING] Βεβαιωθείτε ότι δεν δημιουργήσατε κατά λάθος τα ακόλουθα αρχεία στο C:\Windows, η μονάδα δίσκου λειτουργικό σύστημα για την αντιμετώπιση προβλημάτων εικονική Μηχανή. Δημιουργήστε τα ακόλουθα αρχεία στη μονάδα δίσκου λειτουργικού Συστήματος για το αρχείο προέλευσης Εικονική που είναι συνδεδεμένος με ένα δίσκο δεδομένων.

    - Προσθέστε τις ακόλουθες γραμμές σε το `gpt.ini` αρχείο που δημιουργήσατε:

    ```
    [General]
    gPCFunctionalityVersion=2
    gPCMachineExtensionNames=[{42B5FAAE-6536-11D2-AE5A-0000F87571E3}{40B6664F-4972-11D1-A7CA-0000F87571E3}]
    Version=1
    ```

    ![Δημιουργία gpt.ini](./media/virtual-machines-windows-reset-local-password-without-guest-agent/create_gpt_ini.png)
 
5. Δημιουργία `scripts.ini` στο `\Windows\System32\GroupPolicy\Machine\Scripts`. Βεβαιωθείτε ότι εμφανίζονται οι τους κρυφούς φακέλους. Εάν είναι απαραίτητο, δημιουργήστε το `Machine` ή `Scripts` φακέλους.

    - Προσθέστε τις ακόλουθες γραμμές του `scripts.ini` αρχείο που δημιουργήσατε:

    ```
    [Startup]
    0CmdLine=C:\Windows\System32\FixAzureVM.cmd
    0Parameters=
    ```

    ![Δημιουργία scripts.ini](./media/virtual-machines-windows-reset-local-password-without-guest-agent/create_scripts_ini.png)
 
6. Δημιουργία `FixAzureVM.cmd` στο `\Windows\System32` με το παρακάτω περιεχόμενο, αντικαθιστώντας `<username>` και `<newpassword>` με τις δικές σας τιμές:

    ```
    NET USER <username> <newpassword>
    ```

    ![Δημιουργία FixAzureVM.cmd](./media/virtual-machines-windows-reset-local-password-without-guest-agent/create_fixazure_cmd.png)

    Πρέπει να πληρούνται οι απαιτήσεις πολυπλοκότητα κωδικού πρόσβασης έχει ρυθμιστεί για την Εικονική κατά τον καθορισμό τον νέο κωδικό πρόσβασης.

7. Στην πύλη Azure, αποσυνδέστε το δίσκο από την Εικονική αντιμετώπισης προβλημάτων:

    - Επιλέξτε την Εικονική αντιμετώπισης προβλημάτων στην πύλη του Azure, κάντε κλικ στην επιλογή *δίσκων*.
    - Επιλέξτε το δίσκο δεδομένων συνημμένα στο βήμα 2, κάντε κλικ στην επιλογή *Αποσύνδεση*:

    ![Απόσπαση δίσκου](./media/virtual-machines-windows-reset-local-password-without-guest-agent/detach_disk.png)

8. Πριν να δημιουργήσετε μια Εικονική, αποκτήστε το URI σας δίσκο OS προέλευση:

    - Επιλέξτε το λογαριασμό χώρου αποθήκευσης στην πύλη του Azure, κάντε κλικ στην επιλογή *αντικείμενα BLOB*.
    - Επιλέξτε το κοντέινερ. Το κοντέινερ προέλευσης είναι συνήθως *οι VHD*:

    ![Επιλέξτε χώρο αποθήκευσης αντικειμένων blob λογαριασμού](./media/virtual-machines-windows-reset-local-password-without-guest-agent/select_storage_details.png)

    Επιλέξτε την προέλευσή σας Εικονική OS VHD και κάντε κλικ στο κουμπί *Αντιγραφή* δίπλα στο όνομα της *διεύθυνσης URL* :

    ![Αντιγραφή δίσκου URI](./media/virtual-machines-windows-reset-local-password-without-guest-agent/copy_source_vhd_uri.png)

9. Για να δημιουργήσετε μια Εικονική από την προέλευση εικονική Μηχανή OS δίσκο:

    - Χρησιμοποιήστε [αυτό το πρότυπο διαχείρισης πόρων Azure](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vm-from-specialized-vhd) για να δημιουργήσετε μια Εικονική από έναν εξειδικευμένο VHD. Κάντε κλικ στην επιλογή το `Deploy to Azure` κουμπί για να ανοίξετε την πύλη του Azure με τα πρότυπα λεπτομέρειες συμπληρωμένο για εσάς.
    - Εάν θέλετε να διατηρήσετε όλες τις προηγούμενες ρυθμίσεις για την εικονική Μηχανή, επιλέξτε *Επεξεργασία προτύπου* για την παροχή του υπάρχοντος VNet, υποδίκτυο, προσαρμογέα δικτύου ή δημόσια IP.
    - Στο το `OSDISKVHDURI` παραμέτρου πλαισίου κειμένου, επικολλήστε το URI της προέλευσης VHD αποκτήσετε στο προηγούμενο βήμα:

    ![Δημιουργήστε μια Εικονική από πρότυπο](./media/virtual-machines-windows-reset-local-password-without-guest-agent/create_new_vm_from_template.png)

10. Μετά την εκτέλεση του νέου Εικονική, σύνδεση με την εικονική Μηχανή χρήση απομακρυσμένης επιφάνειας εργασίας με τον νέο κωδικό πρόσβασης που καθορίσατε στο το `FixAzureVM.cmd` δέσμης ενεργειών.

11. Από την απομακρυσμένη περίοδο λειτουργίας για τη νέα Εικονική, καταργήστε τα ακόλουθα αρχεία για να καθαρίσετε το περιβάλλον:

    - Από %windir%\System32
        - Κατάργηση FixAzureVM.cmd
    - Από το %windir%\System32\GroupPolicy\Machine\
        - Κατάργηση scripts.ini
    - Από το %windir%\System32\GroupPolicy
        - Κατάργηση gpt.ini (Εάν υπήρχε gpt.ini πριν από και μετονομάσατε gpt.ini.bak, μετονομάστε το αρχείο .bak πίσω στην gpt.ini)

## <a name="next-steps"></a>Επόμενα βήματα
Εάν εξακολουθείτε να μπορείτε να συνδεθείτε με χρήση απομακρυσμένης επιφάνειας εργασίας, ανατρέξτε στο θέμα [Οδηγός RDP αντιμετώπισης προβλημάτων](virtual-machines-windows-troubleshoot-rdp-connection.md). Ο [Οδηγός αντιμετώπισης προβλημάτων λεπτομερείς RDP](virtual-machines-windows-detailed-troubleshoot-rdp.md) εξετάζει αντιμετώπιση προβλημάτων μεθόδους και όχι συγκεκριμένα βήματα. Μπορείτε επίσης να [ανοίξετε μια πρόσκληση Azure υποστήριξης](https://azure.microsoft.com/support/options/) για βοήθεια πρακτικής.
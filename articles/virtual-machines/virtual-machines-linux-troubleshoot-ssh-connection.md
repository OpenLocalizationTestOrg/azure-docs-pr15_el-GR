<properties
    pageTitle="Αντιμετώπιση προβλημάτων σύνδεσης SSH σε μια Εικονική | Microsoft Azure"
    description="Τρόπος αντιμετώπισης προβλημάτων όπως 'SSH σύνδεσης απέτυχε' ή 'Άρνηση σύνδεσης SSH' για μια Εικονική Azure εκτελείται Linux."
    keywords="SSH Άρνηση σύνδεσης, ssh σφάλμα, azure ssh, SSH σύνδεση απέτυχε"
    services="virtual-machines-linux"
    documentationCenter=""
    authors="iainfoulds"
    manager="timlt"
    editor=""
    tags="top-support-issue,azure-service-management,azure-resource-manager"/>

<tags
    ms.service="virtual-machines-linux"
    ms.workload="infrastructure-services"
    ms.tgt_pltfrm="vm-linux"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/27/2016"
    ms.author="iainfou"/>

# <a name="troubleshoot-ssh-connections-to-an-azure-linux-vm-that-fails-errors-out-or-is-refused"></a>Αντιμετώπιση προβλημάτων SSH συνδέσεων σε μια Εικονική Linux Azure που αποτύχει, σφάλματα, ή απορρίφθηκε
Υπάρχουν διάφορες αιτίες που αντιμετωπίζετε σφάλματα ασφαλούς κελύφους (SSH), SSH αποτυχίες σύνδεσης, ή SSH απορρίφθηκε όταν προσπαθείτε να συνδεθείτε με μια εικονική μηχανή Linux (Εικονική). Σε αυτό το άρθρο σάς βοηθά να εντοπίσετε και να διορθώσετε τα προβλήματα. Μπορείτε να χρησιμοποιήσετε την πύλη Azure, Azure CLI ή Εικονική επέκταση πρόσβαση για Linux, για αντιμετώπιση και επίλυση προβλημάτων σύνδεσης.

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-both-include.md)]

Εάν χρειάζεστε περισσότερη βοήθεια σε οποιοδήποτε σημείο σε αυτό το άρθρο, μπορείτε να επικοινωνήσετε με το Azure τους ειδικούς στο [MSDN Azure και φόρουμ υπερχείλισης στοίβας](http://azure.microsoft.com/support/forums/). Εναλλακτικά, μπορείτε να υποβάλετε ένα περιστατικό Azure υποστήριξης. Μεταβείτε στην [τοποθεσία υποστήριξης Azure](http://azure.microsoft.com/support/options/) και επιλέξτε **υποστήριξη**. Για πληροφορίες σχετικά με τη χρήση Azure υποστήριξης, διαβάστε το [Microsoft Azure υποστήριξης συνήθεις Ερωτήσεις](http://azure.microsoft.com/support/faq/).


## <a name="quick-troubleshooting-steps"></a>Γρήγορα βήματα αντιμετώπισης προβλημάτων
Μετά από κάθε βήμα της αντιμετώπισης προβλημάτων, δοκιμάστε ξανά για να την εικονική Μηχανή.

1. Επαναφέρει τη ρύθμιση παραμέτρων SSH.
2. Επαναφέρετε τα διαπιστευτήρια για το χρήστη.
3. Επαλήθευση των κανόνων [Ομάδα ασφαλείας δικτύου](../virtual-network/virtual-networks-nsg.md) επιτρέψετε την κυκλοφορία SSH.
    - Βεβαιωθείτε ότι υπάρχει ένας κανόνας ομάδα ασφαλείας δικτύου για να επιτρέψετε την κυκλοφορία SSH (από προεπιλογή, θύρα TCP 22).
    - Δεν μπορείτε να χρησιμοποιήσετε ανακατεύθυνση θύρας / Αντιστοίχιση χωρίς τη χρήση μιας Azure εξισορρόπηση φόρτου.
4. Ελέγξτε την [εύρυθμη λειτουργία των πόρων Εικονική](../resource-health/resource-health-overview.md). 
    - Βεβαιωθείτε ότι η Εικονική αναφέρει ότι η που έχει τεθεί σε καλή κατάσταση.
    - Εάν έχετε ενεργοποιημένη Διαγνωστικά εκκίνησης, επαληθεύστε την εικονική Μηχανή δεν είναι η αναφορά σφαλμάτων εκκίνησης στα αρχεία καταγραφής.
5. Επανεκκινήστε την εικονική Μηχανή.
6. Αναπτύξτε ξανά την εικονική Μηχανή.

Συνεχίστε να διαβάζετε για πιο λεπτομερή βήματα αντιμετώπισης προβλημάτων και επεξηγήσεις.


## <a name="available-methods-to-troubleshoot-ssh-connection-issues"></a>Διαθέσιμες μεθόδους για την αντιμετώπιση προβλημάτων σύνδεσης SSH

Μπορείτε να επαναφέρετε τα διαπιστευτήρια ή ρύθμισης παραμέτρων SSH χρησιμοποιώντας μία από τις παρακάτω μεθόδους:

- [Πύλη του azure](#using-the-azure-portal) - εξαιρετική εάν πρέπει να τον επαναφέρετε γρήγορα τις ρυθμίσεις παραμέτρων SSH ή πλήκτρο SSH και δεν έχετε το Azure εγκατεστημένα τα εργαλεία.
- [Εντολές azure CLI](#using-the-azure-cli) - Εάν είστε ήδη στη γραμμή εντολών, γρήγορα επαναφέρετε τα SSH ρύθμισης παραμέτρων ή διαπιστευτήρια.
- [Επέκταση azure VMAccessForLinux](#using-the-vmaccess-extension) - Δημιουργήστε και εκ νέου χρήση αρχεία ορισμού json για να επαναφέρετε τα διαπιστευτήρια SSH ρύθμισης παραμέτρων ή χρήστη.

Μετά από κάθε βήμα της αντιμετώπισης προβλημάτων, δοκιμάστε να συνδεθείτε ξανά με το Εικονική. Εάν εξακολουθείτε να μπορείτε να συνδεθείτε, δοκιμάστε το επόμενο βήμα.


## <a name="using-the-azure-portal"></a>Με την πύλη Azure
Η πύλη του Azure παρέχει ένα γρήγορο τρόπο για να επαναφέρετε τα διαπιστευτήρια SSH ρύθμισης παραμέτρων ή χρήστη χωρίς να εγκαταστήσετε οποιαδήποτε εργαλεία στον τοπικό σας υπολογιστή.

Επιλέξτε το Εικονική στην πύλη του Azure. Κάντε κύλιση προς τα κάτω στην ενότητα **υποστήριξης + αντιμετώπιση προβλημάτων** και επιλέξτε **Επαναφορά κωδικού πρόσβασης** όπως στο ακόλουθο παράδειγμα:

![Ρύθμιση παραμέτρων SSH επαναφορά ή διαπιστευτήρια στην πύλη του Azure](./media/virtual-machines-linux-troubleshoot-ssh-connection/reset-credentials-using-portal.png)

### <a name="reset-the-ssh-configuration"></a>Επαναφέρει τη ρύθμιση παραμέτρων SSH
Ως πρώτο βήμα, επιλέξτε `Reset SSH configuration only` από το αναπτυσσόμενο μενού **λειτουργία** όπως στο προηγούμενο στιγμιότυπο οθόνης, στη συνέχεια, κάντε κλικ στο κουμπί **Επαναφορά** . Μόλις ολοκληρωθεί αυτή η ενέργεια, δοκιμάστε να αποκτήσετε ξανά πρόσβαση σας Εικονική.

### <a name="reset-ssh-credentials-for-a-user"></a>Επαναφορά διαπιστευτηρίων SSH για ένα χρήστη
Για να επαναφέρετε τα διαπιστευτήρια από έναν υπάρχοντα χρήστη, επιλέξτε ένα από τα `Reset SSH public key` ή `Reset password` από το αναπτυσσόμενο μενού **λειτουργία** , όπως το προηγούμενο στιγμιότυπο οθόνης. Καθορίστε το όνομα χρήστη και ένα πλήκτρο SSH ή νέο κωδικό πρόσβασης και, στη συνέχεια, κάντε κλικ στο κουμπί **Επαναφορά** .

Μπορείτε επίσης να δημιουργήσετε ένα χρήστη με δικαιώματα sudo στο η Εικονική από αυτό το μενού. Πληκτρολογήστε ένα νέο όνομα χρήστη και κωδικό πρόσβασης που σχετίζονται ή πλήκτρο SSH και, στη συνέχεια, κάντε κλικ στο κουμπί **Επαναφορά** .


## <a name="using-the-azure-cli"></a>Χρήση του Azure CLI
Εάν δεν το έχετε κάνει ήδη, [εγκαταστήστε το CLI Azure και να συνδεθείτε με τη συνδρομή σας στο Azure](../xplat-cli-install.md). Βεβαιωθείτε ότι χρησιμοποιείτε λειτουργία διαχείρισης πόρων ως εξής:

```
azure config mode arm
```

Εάν δημιουργήσατε και αποστολή ενός προσαρμοσμένου ειδώλου δίσκου Linux, βεβαιωθείτε ότι το [Microsoft Azure Linux Agent](virtual-machines-linux-agent-user-guide.md) έκδοση 2.0.5 ή νεότερη έκδοση είναι εγκατεστημένο. Για ΣΠΣ που έχουν δημιουργηθεί με τη χρήση συλλογή εικόνων, αυτή την επέκταση πρόσβασης είναι ήδη εγκατεστημένη και έχει ρυθμιστεί για εσάς.

### <a name="reset-ssh-configuration"></a>Επαναφορά SSH ρύθμισης παραμέτρων
Η ρύθμιση παραμέτρων SSHD ίδια μπορεί να είναι εσφαλμένες ή η υπηρεσία αντιμετώπισε σφάλμα. Μπορείτε να επαναφέρετε SSHD, για να βεβαιωθείτε ότι οι παράμετροι SSH ίδια είναι έγκυρες. Η επαναφορά SSHD πρέπει να είναι το πρώτο βήμα της αντιμετώπισης προβλημάτων που τραβάτε.

Το παρακάτω παράδειγμα επαναφέρει SSHD σε μια Εικονική με το όνομα `myVM` στην ομάδα πόρων με το όνομα `myResourceGroup`. Χρησιμοποιήστε τα δικά σας ονόματα ομάδων Εικονική και πόρων ως εξής:

```bash
azure vm reset-access --resource-group myResourceGroup --name myVM \
    --reset-ssh
```

### <a name="reset-ssh-credentials-for-a-user"></a>Επαναφορά διαπιστευτηρίων SSH για ένα χρήστη
Εάν εμφανιστεί το SSHD για να λειτουργήσουν σωστά, μπορείτε να επαναφέρετε τον κωδικό πρόσβασης για ένα χρήστη giver. Το παρακάτω παράδειγμα επαναφέρει τα διαπιστευτήρια για `myUsername` στην τιμή που καθορίζεται στο `myPassword`, στην την εικονική Μηχανή με το όνομα `myVM` στο `myResourceGroup`. Χρησιμοποιήστε τις δικές σας τιμές ως εξής:

```bash
azure vm reset-access --resource-group myResourceGroup --name myVM \
     --username myUsername --password myPassword
```

Εάν χρησιμοποιείτε τον έλεγχο ταυτότητας κλειδί SSH, μπορείτε να επαναφέρετε το SSH κλειδί για τον συγκεκριμένο χρήστη. Το παρακάτω παράδειγμα ενημερώνει το κλειδί SSH που είναι αποθηκευμένα σε `~/.ssh/azure_id_rsa.pub` για το χρήστη με το όνομα `myUsername`, στην την εικονική Μηχανή με το όνομα `myVM` στο `myResourceGroup`. Χρησιμοποιήστε τις δικές σας τιμές ως εξής:

```bash
azure vm reset-access --resource-group myResourceGroup --name myVM \
    --username myUsername --ssh-key-file ~/.ssh/azure_id_rsa.pub
```


## <a name="using-the-vmaccess-extension"></a>Χρησιμοποιώντας την επέκταση VMAccess
Επέκταση της Access Εικονική για Linux διαβάζει σε ένα αρχείο json που ορίζει τις ενέργειες για την εκτέλεση. Αυτές οι ενέργειες περιλαμβάνουν την επαναφορά SSHD, την επαναφορά του κλειδιού SSH ή η προσθήκη ενός χρήστη. Εξακολουθείτε να μπορείτε χρησιμοποιήσετε την CLI Azure για να καλέσετε την επέκταση VMAccess, αλλά μπορείτε να χρησιμοποιήσετε ξανά τα αρχεία json σε πολλές ΣΠΣ εάν θέλετε. Αυτή η προσέγγιση σάς επιτρέπει να δημιουργήσετε ένα αποθετήριο δεδομένων json αρχείων που μπορούν να, στη συνέχεια, να απαιτείται η συγκεκριμένη σενάρια.

### <a name="reset-sshd"></a>Επαναφορά SSHD
Δημιουργήστε ένα αρχείο με το όνομα `PrivateConf.json` με το παρακάτω περιεχόμενο:

```bash
{  
    "reset_ssh":"True"
}
```

Χρησιμοποιώντας το Azure CLI, στη συνέχεια, καλείτε τη `VMAccessForLinux` επέκταση για να επαναφέρετε τη σύνδεση SSHD, καθορίζοντας το αρχείο json. Το παρακάτω παράδειγμα επαναφέρει SSHD στην η Εικονική με το όνομα `myVM` στο `myResourceGroup`. Χρησιμοποιήστε τις δικές σας τιμές ως εξής:

```bash
azure vm extension set myResourceGroup myVM \
    VMAccessForLinux Microsoft.OSTCExtensions "1.2" \
    --private-config-path PrivateConf.json
```

### <a name="reset-ssh-credentials-for-a-user"></a>Επαναφορά SSH διαπιστευτήρια για ένα χρήστη
Εάν εμφανιστεί το SSHD για να λειτουργήσουν σωστά, μπορείτε να επαναφέρετε τα διαπιστευτήρια για ένα χρήστη giver. Για να επαναφέρετε τον κωδικό πρόσβασης για ένα χρήστη, δημιουργήστε ένα αρχείο με το όνομα `PrivateConf.json`. Το παρακάτω παράδειγμα επαναφέρει τα διαπιστευτήρια για `myUsername` στην τιμή που καθορίζεται στο `myPassword`. Πληκτρολογήστε τις ακόλουθες γραμμές σε σας `PrivateConf.json` αρχείων, χρησιμοποιώντας τη δική σας τιμές:

```bash
{
    "username":"myUsername", "password":"myPassword"
}
```

Ή για να επαναφέρετε το κλειδί SSH για ένα χρήστη, δημιουργήστε πρώτα ένα αρχείο με το όνομα `PrivateConf.json`. Το παρακάτω παράδειγμα επαναφέρει τα διαπιστευτήρια για `myUsername` στην τιμή που καθορίζεται στο `myPassword`, στην την εικονική Μηχανή με το όνομα `myVM` στο `myResourceGroup`. Πληκτρολογήστε τις ακόλουθες γραμμές σε σας `PrivateConf.json` αρχείων, χρησιμοποιώντας τη δική σας τιμές:

```bash
{
    "username":"myUsername", "ssh_key":"mySSHKey"
}
```

Αφού δημιουργήσετε το αρχείο json, χρησιμοποιήστε το CLI Azure για να καλέσετε το `VMAccessForLinux` επέκταση για να επαναφέρετε τα διαπιστευτήριά σας SSH χρήστη, καθορίζοντας το αρχείο json. Το παρακάτω παράδειγμα επαναφέρει διαπιστευτηρίων στο η Εικονική με το όνομα `myVM` στο `myResourceGroup`. Χρησιμοποιήστε τις δικές σας τιμές ως εξής:

```
azure vm extension set myResourceGroup myVM \
    VMAccessForLinux Microsoft.OSTCExtensions "1.2" \
    --private-config-path PrivateConf.json
```


## <a name="restart-a-vm"></a>Επανεκκινήστε μια εικονική Μηχανή
Εάν έχετε επαναφέρετε τα διαπιστευτήρια χρήστη και ρύθμισης παραμέτρων SSH ή αντιμετώπισε σφάλμα σε αυτήν την περίπτωση, μπορείτε να δοκιμάσετε την επανεκκίνηση του η Εικονική διεύθυνση υποκείμενων προβλημάτων υπολογισμού.

### <a name="azure-portal"></a>Πύλη του Azure
Για να επανεκκινήσετε μια Εικονική με την πύλη Azure, επιλέξτε Εικονική σας και κάντε κλικ στην επιλογή το ***επανεκκινήστε το** κουμπί όπως στο ακόλουθο παράδειγμα:

![Επανεκκινήστε μια Εικονική στην πύλη του Azure](./media/virtual-machines-linux-troubleshoot-ssh-connection/restart-vm-using-portal.png)

### <a name="azure-cli"></a>Azure CLI
Το παρακάτω παράδειγμα επανεκκίνηση του την εικονική Μηχανή με το όνομα `myVM` στην ομάδα πόρων με το όνομα `myResourceGroup`. Χρησιμοποιήστε τις δικές σας τιμές ως εξής:

```bash
azure vm restart --resource-group myResourceGroup --name myVM
```


## <a name="redeploy-a-vm"></a>Αναπτύξτε ξανά μια εικονική Μηχανή
Μπορείτε να αναπτύξετε εκ νέου μια Εικονική σε άλλο κόμβο μέσα σε Azure, η οποία μπορεί να διορθώσετε ζητήματα δικτύωσης υποκείμενα. Για πληροφορίες σχετικά με την επανάληψη ανάπτυξης μια Εικονική, ανατρέξτε στο θέμα [αναπτύξτε ξανά εικονική μηχανή σε νέα Azure κόμβο](virtual-machines-windows-redeploy-to-new-node.md).

> [AZURE.NOTE] Αφού ολοκληρωθεί αυτή η λειτουργία, θα χαθούν δεδομένα προσωρινές δίσκου και δυναμικές διευθύνσεις IP που συσχετίζονται με την εικονική μηχανή θα ενημερωθεί.

### <a name="azure-portal"></a>Πύλη του Azure
Για να αναπτύξετε εκ νέου μια Εικονική με την πύλη Azure, επιλέξτε το Εικονική και κάντε κύλιση προς τα κάτω στην ενότητα **υποστήριξης + αντιμετώπιση προβλημάτων** . Κάντε κλικ στο κουμπί **αναπτύξτε ξανά** , όπως στο ακόλουθο παράδειγμα:

![Αναπτύξτε ξανά μια Εικονική στην πύλη του Azure](./media/virtual-machines-linux-troubleshoot-ssh-connection/redeploy-vm-using-portal.png)

### <a name="azure-cli"></a>Azure CLI
Το παρακάτω παράδειγμα redeploys η Εικονική με το όνομα `myVM` στην ομάδα πόρων με το όνομα `myResourceGroup`. Χρησιμοποιήστε τις δικές σας τιμές ως εξής:

```bash
azure vm redeploy --resource-group myResourceGroup --name myVM
```

## <a name="vms-created-by-using-the-classic-deployment-model"></a>ΣΠΣ που έχουν δημιουργηθεί με τη χρήση του μοντέλου κλασική ανάπτυξης

Δοκιμάστε αυτά τα βήματα για να επιλύσετε τα πιο συνηθισμένα αποτυχίες σύνδεσης SSH για ΣΠΣ που έχουν δημιουργηθεί με τη χρήση του μοντέλου κλασική ανάπτυξης. Μετά από κάθε βήμα, δοκιμάστε ξανά για να την εικονική Μηχανή.

- Επαναφορά απομακρυσμένη πρόσβαση από την [πύλη του Azure](https://portal.azure.com). Στην πύλη του Azure, επιλέξτε Εικονική σας και κάντε κλικ στο κουμπί **Επαναφορά απομακρυσμένο...** .

- Επανεκκινήστε την εικονική Μηχανή. Στην [πύλη του Azure](https://portal.azure.com), επιλέξτε Εικονική σας και κάντε κλικ στο κουμπί **επανεκκίνηση** .

    -Ή-

    Στην [πύλη του Azure κλασική](https://manage.windowsazure.com), επιλέξτε **εικονικές μηχανές** > **παρουσίες** > **επανεκκίνηση**.

- Αναπτύξτε ξανά την εικονική Μηχανή σε έναν νέο Azure κόμβο. Για πληροφορίες σχετικά με τον τρόπο για να αναπτύξετε εκ νέου μια Εικονική, ανατρέξτε στο θέμα [αναπτύξτε ξανά εικονική μηχανή σε νέα Azure κόμβο](virtual-machines-windows-redeploy-to-new-node.md).

    Αφού ολοκληρωθεί αυτή η λειτουργία, θα χαθούν δεδομένα προσωρινές δίσκου και δυναμικές διευθύνσεις IP που συσχετίζονται με την εικονική μηχανή θα ενημερωθεί.

- Ακολουθήστε τις οδηγίες στο θέμα [πώς μπορείτε να επαναφέρετε έναν κωδικό πρόσβασης ή SSH για βάσει Linux εικονικές μηχανές](virtual-machines-linux-classic-reset-access.md) :
    - Επαναφέρετε τον κωδικό πρόσβασης ή πλήκτρο SSH.
    - Δημιουργήστε ένα λογαριασμό χρήστη _sudo_ .
    - Επαναφέρει τη ρύθμιση παραμέτρων SSH.

- Έλεγχος εύρυθμης λειτουργίας του Εικονική πόρων για ζητήματα πλατφόρμας.<br>
  Επιλέξτε το Εικονική και κάντε κύλιση προς τα κάτω **Ρυθμίσεις** > **Έλεγχος εύρυθμης λειτουργίας**.


## <a name="additional-resources"></a>Πρόσθετοι πόροι

- Εάν εξακολουθείτε να μην μπορείτε να SSH για να σας Εικονική αφού ακολουθήσετε τα βήματα μετά, ανατρέξτε στο θέμα [πιο λεπτομερή βήματα αντιμετώπισης προβλημάτων](virtual-machines-linux-detailed-troubleshoot-ssh-connection.md) για να δείτε πρόσθετα βήματα για να επιλύσετε το ζήτημα.

- Για περισσότερες πληροφορίες σχετικά με την αντιμετώπιση προβλημάτων πρόσβασης εφαρμογή, ανατρέξτε στο θέμα [Αντιμετώπιση προβλημάτων πρόσβασης σε μια εφαρμογή που εκτελείται σε μια εικονική μηχανή Azure](virtual-machines-linux-troubleshoot-app-connection.md)

- Για περισσότερες πληροφορίες σχετικά με την αντιμετώπιση εικονικές μηχανές που έχουν δημιουργηθεί με τη χρήση του μοντέλου κλασική ανάπτυξης, ανατρέξτε στο θέμα [πώς μπορείτε να επαναφέρετε έναν κωδικό πρόσβασης ή SSH για βάσει Linux εικονικές μηχανές](virtual-machines-linux-classic-reset-access.md).

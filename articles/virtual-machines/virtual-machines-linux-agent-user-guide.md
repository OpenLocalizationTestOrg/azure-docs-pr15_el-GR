<properties 
    pageTitle="Οδηγός παράγοντας Linux | Microsoft Azure" 
    description="Μάθετε πώς μπορείτε να εγκαταστήσετε και να ρυθμίσετε έναν παράγοντα Linux (waagent) για να διαχειριστείτε την εικονική μηχανή επικοινωνίας με ελεγκτή ύφασμα Azure." 
    services="virtual-machines-linux" 
    documentationCenter="" 
    authors="szarkos" 
    manager="timlt" 
    editor=""
    tags="azure-service-management,azure-resource-manager" />

<tags 
    ms.service="virtual-machines-linux" 
    ms.workload="infrastructure-services" 
    ms.tgt_pltfrm="vm-linux" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="10/17/2016" 
    ms.author="szark"/>



# <a name="azure-linux-agent-user-guide"></a>Οδηγός Azure Linux παράγοντα χρήστη

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-both-include.md)]

## <a name="introduction"></a>Εισαγωγή

Το Microsoft Azure Linux Agent (waagent) διαχειρίζεται Linux & FreeBSD προμήθεια και Εικονική αλληλεπίδραση με τον ελεγκτή ύφασμα Azure. Παρέχει τις ακόλουθες λειτουργίες για Linux και FreeBSD IaaS αναπτύξεις:

> [AZURE.NOTE] Δείτε τον παράγοντα Azure Linux [αρχείο README](https://github.com/Azure/WALinuxAgent/blob/master/README.md) για περισσότερες λεπτομέρειες.

* **Προμήθεια εικόνας**
  - Η δημιουργία λογαριασμού χρήστη
  - Ρύθμιση παραμέτρων SSH τύπους ελέγχου ταυτότητας
  - Ανάπτυξη του SSH δημόσια κλειδιά και ζεύγη κλειδιών
  - Ρύθμιση του ονόματος κεντρικού υπολογιστή
  - Δημοσίευση το όνομα κεντρικού υπολογιστή για την πλατφόρμα DNS
  - Αναφορά SSH host κλειδιού αποτυπώματος της πλατφόρμας
  - Διαχείριση δίσκου πόρων
  - Μορφοποίηση και τοποθέτηση του δίσκου πόρων
  - Ρύθμιση παραμέτρων χώρος αντιμετάθεσης

* **Δικτύωση**
  - Διαχειρίζεται διαδρομές για βελτίωση της συμβατότητας με τους διακομιστές DHCP πλατφόρμα
  - Εξασφαλίζει ότι η σταθερότητα του ονόματος του περιβάλλοντος εργασίας δικτύου

* **Πυρήνα**
  - Ρυθμίζει τις παραμέτρους εικονικού NUMA (Απενεργοποίηση για πυρήνα < 2.6.37)
  - Καταναλώνει Hyper-V εντροπίας για /dev/random
  - Ρυθμίζει τις παραμέτρους των χρονικών ορίων SCSI για τη συσκευή ρίζας (το οποίο μπορεί να είναι απομακρυσμένο)

* **Εργαλεία διαγνωστικών**
  - Ανακατεύθυνση κονσόλας στη σειριακή θύρα

* **SCVMM αναπτύξεις**
    - Εντοπίζει και εκκινείται το πρωτόκολλο τον παράγοντα VMM για Linux όταν εκτελείται σε ένα περιβάλλον συστήματος κέντρο εικονική μηχανή Manager 2012 R2

* **Εικονική επέκτασης**
    - Εισαγωγή στοιχείου που δημιουργήθηκε από τη Microsoft και τους συνεργάτες σε Linux Εικονική (IaaS) για να ενεργοποιήσετε το λογισμικό και αυτοματισμού ρύθμισης παραμέτρων
    - Επέκταση Εικονική εφαρμογή αναφοράς σε [https://github.com/Azure/azure-linux-extensions](https://github.com/Azure/azure-linux-extensions)


## <a name="communication"></a>Επικοινωνίας
Της ροής πληροφοριών από την πλατφόρμα στον παράγοντα παρουσιάζεται μέσω δύο κανάλια:

* Μια εκκίνηση που έχουν επισυναφθεί το DVD για αναπτύξεις IaaS. Αυτό το DVD περιλαμβάνει συμβατών με OVF αρχείο ρύθμισης παραμέτρων που περιλαμβάνει όλες τις πληροφορίες παροχής εκτός από την πραγματική keypairs SSH.
* Ένα τελικό σημείο TCP εκθέσετε μια REST API χρησιμοποιείται για τη λήψη ανάπτυξης και ρύθμισης παραμέτρων τοπολογίας.


## <a name="requirements"></a>Απαιτήσεις
Τα ακόλουθα συστήματα έχουν ελεγχθεί και γνωρίζετε ότι λειτουργούν με τον παράγοντα Linux Azure:

> [AZURE.NOTE] Αυτή η λίστα ενδέχεται να διαφέρουν από τη λίστα επίσημη υποστηριζόμενα συστήματα στην πλατφόρμα Azure της Microsoft, όπως περιγράφεται εδώ: [http://support.microsoft.com/kb/2805216](http://support.microsoft.com/kb/2805216)

* CoreOS
* CentOS 6.3 +
* Για μεγάλες επιχειρήσεις Linux κόκκινο καπέλο 6,7 +
* Debian 7.0 +
* Ubuntu 12.04 +
* openSUSE 12.3 +
* SLES 11 SP3 +
* Oracle Linux 6.4 +

Άλλα υποστηριζόμενα συστήματα:

* FreeBSD 10 + (Azure παράγοντας Linux v2.0.10 +)

Ο παράγοντας Linux εξαρτάται από ορισμένα πακέτα συστήματος για να λειτουργήσει σωστά:

* Python 2.6 +
* OpenSSL 1.0 +
* OpenSSH 5.3 +
* Βοηθητικά προγράμματα συστήματος αρχείων: διαίρεση sfdisk, fdisk, mkfs,
* Εργαλεία τον κωδικό πρόσβασης: chpasswd, sudo
* Εργαλεία επεξεργασίας του κειμένου: sed, grep
* Εργαλεία δικτύου: δρομολόγηση ip
* Πυρήνα υποστήριξης για την τοποθέτηση UDF filesystems.

## <a name="installation"></a>Εγκατάσταση
Εγκατάσταση χρησιμοποιώντας μια RPM ή ένα πακέτο DEB από την κατανομή πακέτου αποθετήριο είναι την προτιμώμενη μέθοδο εγκατάσταση και αναβάθμιση τον παράγοντα Linux Azure. Όλα τα [θεωρηθεί υπηρεσίες παροχής διανομής](virtual-machines-linux-endorsed-distros.md) να ενσωματώσετε το πακέτο παράγοντας Azure Linux στη τους εικόνες και αποθετήρια.

Ανατρέξτε στην τεκμηρίωση στο το [Azure Linux παράγοντας repo σε Github](https://github.com/Azure/WALinuxAgent) για επιλογές εγκατάστασης για προχωρημένους, όπως την εγκατάσταση από το αρχείο προέλευσης ή προσαρμοσμένες θέσεις ή προθέματα.


## <a name="command-line-options"></a>Επιλογές γραμμής εντολών

### <a name="flags"></a>Σημαίες

- Λεπτομερής: αύξηση λεπτομέρειες της καθορισμένης εντολής
- επιβολή: παραλείψετε αλληλεπιδραστικών επιβεβαίωσης για ορισμένες εντολές

### <a name="commands"></a>Οι εντολές

- Βοήθεια: Παραθέτει τις υποστηριζόμενες εντολές και οι σημαίες.

- διαχειριστείτε: επιχειρήσει να καθαρίσετε το σύστημα και να είναι κατάλληλη για την προμήθεια του εκ νέου. Αυτή η λειτουργία διαγράψει τα εξής:
 * Όλα SSH κλειδιά κεντρικού υπολογιστή (εάν Provisioning.RegenerateSshHostKeyPair είναι 'y' στο αρχείο παραμέτρων)
 * Ρύθμιση παραμέτρων του διακομιστή ονομάτων στο /etc/resolv.conf
 * Ριζικό τον κωδικό πρόσβασης από /etc/shadow (εάν Provisioning.DeleteRootPassword είναι 'y' στο αρχείο παραμέτρων)
 * Στο cache μισθώσεις προγράμματος-πελάτη DHCP
 * Επαναφέρει όνομα κεντρικού υπολογιστή για να localhost.localdomain


> [AZURE.WARNING] Deprovisioning δεν εγγυάται ότι η εικόνα είναι απενεργοποιημένο όλων των ευαίσθητων πληροφοριών και είναι κατάλληλο για αναδιανομή.


- διαχειριστείτε + χρήστη: εκτελεί όλα τα στοιχεία στην περιοχή - διαχειριστείτε (παραπάνω) και επίσης διαγράφει το τελευταίο λογαριασμό προμήθεια του φακέλου χρήστη (που λαμβάνονται από /var/lib/waagent) και σχετικές δεδομένων. Αυτή η παράμετρος είναι κατά την προμήθεια καταργήστε την μια εικόνα που προηγουμένως προμήθεια στην Azure, ώστε να μπορεί να καταγράφονται και χρησιμοποιούνται ξανά.

- έκδοση: Εμφανίζει την έκδοση του waagent

- serialconsole: Ρυθμίζει τις παραμέτρους ΕΚΣΚΑΦΉ για να επισημάνετε ttyS0 (η πρώτη σειρά θύρα) ως την Κονσόλα εκκίνησης. Αυτό εξασφαλίζει ότι αρχεία καταγραφής εκκίνησης πυρήνα είναι αποστέλλονται στη σειριακή θύρα και που καθίστανται διαθέσιμες για τον εντοπισμό σφαλμάτων.

- μονού: εκτέλεση waagent ως ένα μονού να διαχειριστείτε την αλληλεπίδραση με την πλατφόρμα. Αυτό το όρισμα είναι καθορισμένο για να waagent στη δέσμη ενεργειών προετοιμασία waagent.

- Έναρξη: εκτέλεση waagent ως διαδικασία στο παρασκήνιο


## <a name="configuration"></a>Ρύθμιση παραμέτρων

Ένα αρχείο ρύθμισης παραμέτρων (/ etc/waagent.conf) ελέγχει τις ενέργειες του waagent. Ένα παράδειγμα αρχείου ρύθμισης παραμέτρων φαίνεται παρακάτω:

    Provisioning.Enabled=y
    Provisioning.DeleteRootPassword=n
    Provisioning.RegenerateSshHostKeyPair=y
    Provisioning.SshHostKeyPairType=rsa
    Provisioning.MonitorHostName=y
    Provisioning.DecodeCustomData=n
    Provisioning.ExecuteCustomData=n
    Provisioning.PasswordCryptId=6
    Provisioning.PasswordCryptSaltLength=10
    ResourceDisk.Format=y
    ResourceDisk.Filesystem=ext4
    ResourceDisk.MountPoint=/mnt/resource
    ResourceDisk.MountOptions=None
    ResourceDisk.EnableSwap=n
    ResourceDisk.SwapSizeMB=0
    LBProbeResponder=y
    Logs.Verbose=n
    OS.RootDeviceScsiTimeout=300
    OS.OpensslPath=None
    HttpProxy.Host=None
    HttpProxy.Port=None

Τις διάφορες επιλογές ρύθμισης παραμέτρων περιγράφονται αναλυτικά παρακάτω. Είναι οι επιλογές ρύθμισης παραμέτρων από τους τρεις τύπους; Δυαδική τιμή, της συμβολοσειράς ή ακέραιο αριθμό. Οι επιλογές ρύθμισης παραμέτρων Boolean μπορεί να οριστεί ως "ν" ή "n". Η ειδική λέξη-κλειδί "Κανένα" μπορεί να χρησιμοποιηθεί για ορισμένες συμβολοσειρά ρύθμισης παραμέτρων εγγραφές τύπου όπως περιγράφεται παρακάτω.

**Provisioning.Enabled:**  
Τύπος: δυαδική  
Προεπιλεγμένη: y

Αυτό σας επιτρέπει στο χρήστη να ενεργοποιήσετε ή να απενεργοποιήσετε τη λειτουργικότητα παροχής στον παράγοντα. Έγκυρες τιμές είναι "ν" ή "n". Εάν προμήθεια είναι απενεργοποιημένη, διατηρούνται SSH κεντρικού υπολογιστή και χρήστη πλήκτρα στην εικόνα και οποιαδήποτε ρύθμιση παραμέτρων που καθορίζεται στο το Azure προμήθεια API παραβλέπεται.

> [AZURE.NOTE] Το `Provisioning.Enabled` η προεπιλεγμένη τιμή παραμέτρου "n" σε εικόνες Cloud Ubuntu που χρησιμοποιούν cloud την προετοιμασία για προμήθεια.

  
**Provisioning.DeleteRootPassword:**  
Τύπος: δυαδική  
Προεπιλεγμένη: n

Εάν το σύνολο, τον κωδικό πρόσβασης του ριζικού στο αρχείο σκιά/κ.λπ/διαγράφονται κατά τη διάρκεια της διαδικασίας προετοιμασίας.


**Provisioning.RegenerateSshHostKeyPair:**  
Τύπος: δυαδική  
Προεπιλεγμένη: y

Εάν το σύνολο, όλα SSH host ζεύγη κλειδιών (ecdsa, dsa και rsa) διαγράφονται κατά τη διάρκεια της διαδικασίας προετοιμασίας από /etc/ssh /. Και δημιουργείται ένα μεμονωμένο ζεύγος Φρέσκο κλειδιού.

Ο τύπος κρυπτογράφησης για το νέο ζεύγος κλειδιών είναι δυνατό να ρυθμιστεί από την εγγραφή που Provisioning.SshHostKeyPairType. Έχετε υπόψη ότι ορισμένες κατανομές θα αναδημιουργήσει ζεύγη κλειδιών SSH για οποιουσδήποτε τύπους κρυπτογράφησης που λείπουν κατά την επανεκκίνηση του μονού SSH (για παράδειγμα, κατά την επανεκκίνηση).


**Provisioning.SshHostKeyPairType:**  
Τύπος: συμβολοσειρά  
Προεπιλεγμένη: rsa

Αυτό μπορεί να οριστεί σε έναν τύπο αλγόριθμο κρυπτογράφησης που υποστηρίζεται από το μονού SSH στον υπολογιστή εικονική. Οι συνήθως υποστηριζόμενες τιμές είναι "rsa", "dsa" και "ecdsa". Σημειώστε ότι "putty.exe" στα Windows δεν υποστηρίζει "ecdsa". Επομένως, αν σκοπεύετε να χρησιμοποιήσετε putty.exe των Windows για να συνδεθείτε με μια ανάπτυξη Linux, χρησιμοποιήστε "rsa" ή "dsa".


**Provisioning.MonitorHostName:**  
Τύπος: δυαδική  
Προεπιλεγμένη: y

Εάν ορίσετε, waagent θα ελέγχει την εικονική μηχανή Linux για αλλαγές όνομα κεντρικού υπολογιστή (όπως επιστρέφονται από την εντολή "όνομα κεντρικού υπολογιστή") και να ενημερώνει αυτόματα τις παραμέτρους δικτύου στην εικόνα για να απεικονίζει την αλλαγή. Για να προωθήσετε την αλλαγή του ονόματος με τους διακομιστές DNS, δικτύωση θα γίνει επανεκκίνηση του υπολογιστή εικονική. Αυτό θα έχει ως αποτέλεσμα σύντομη απώλεια της σύνδεσης στο Internet.


**Provisioning.DecodeCustomData**  
Τύπος: δυαδική  
Προεπιλεγμένη: n

Εάν ορίσετε, waagent θα αποκωδικοποιείτε CustomData από Base64.


**Provisioning.ExecuteCustomData**  
Τύπος: δυαδική  
Προεπιλεγμένη: n

Εάν ορίσετε, waagent θα εκτελεστεί CustomData μετά την προμήθεια.


**Provisioning.PasswordCryptId**  
Τύπος: συμβολοσειρά  
Προεπιλογή: 6

Ο αλγόριθμος χρησιμοποιείται από κρυπτογραφημένου κατά τη δημιουργία κατακερματισμός τον κωδικό πρόσβασης.  
 1 - MD5  
 2α - Blowfish  
 5 - SHA-256  
 6 - SHA-512  


**Provisioning.PasswordCryptSaltLength**  
Τύπος: συμβολοσειρά  
Προεπιλογή: 10

Μήκος τυχαία το αλάτι που χρησιμοποιείται κατά τη δημιουργία κατακερματισμός τον κωδικό πρόσβασης.


**ResourceDisk.Format:**  
Τύπος: δυαδική  
Προεπιλεγμένη: y

Εάν ορίσετε, ο δίσκος πόρων που παρέχεται από την πλατφόρμα θα μορφοποιηθεί και ενεργοποίησή του από waagent εάν ο τύπος του συστήματος αρχείων που ζητήθηκε από το χρήστη στο "ResourceDisk.Filesystem" είναι όλα τα στοιχεία εκτός από "ntfs". Ένα μεμονωμένο διαμερίσματα του τύπου Linux (83) θα γίνουν διαθέσιμες στο δίσκο. Σημειώστε ότι αυτό διαμερίσματα δεν θα μορφοποιηθεί εάν αυτό μπορεί να ενεργοποιηθεί με επιτυχία.


**ResourceDisk.Filesystem:**  
Τύπος: συμβολοσειρά  
Προεπιλεγμένη: ext4

Καθορίζει τον τύπο του συστήματος αρχείων για το δίσκο πόρων. Υποστηριζόμενες τιμές διαφέρουν ανάλογα με Linux διανομής. Εάν η συμβολοσειρά X, στη συνέχεια, mkfs. X πρέπει να εμφανίζονται στην εικόνα της Linux. Εικόνες SLES 11 συνήθως πρέπει να χρησιμοποιήσετε 'ext3'. Εικόνες FreeBSD πρέπει να χρησιμοποιήσετε 'ufs2' εδώ.


**ResourceDisk.MountPoint:**  
Τύπος: συμβολοσειρά  
Προεπιλογή: / mnt/πόρων 

Καθορίζει τη διαδρομή στο οποίο έχει τοποθετηθεί το δίσκο πόρων. Σημειώστε ότι ο δίσκος πόρων είναι ένα *προσωρινό* δίσκο και να αδειάζετε όταν η Εικονική καταργείται.


**ResourceDisk.MountOptions**  
Τύπος: συμβολοσειρά  
Προεπιλεγμένη: καμία

Καθορίζει επιλογές ενεργοποίησης δίσκου να περάσει στο την εντολή -o ενεργοποίησης. Αυτή είναι μια λίστα τιμών, τιμές διαχωρισμένες με κόμμα. 'nodev, nosuid'. Ανατρέξτε στο θέμα mount(8) για λεπτομέρειες.


**ResourceDisk.EnableSwap:**  
Τύπος: δυαδική  
Προεπιλεγμένη: n

Εάν ορίσετε, αρχείο αντιμετάθεσης (/ αρχείο μετάθεσης) δημιουργείται στο δίσκο πόρων και προστίθεται στο χώρο αντιμετάθεσης συστήματος.


**ResourceDisk.SwapSizeMB:**  
Τύπος: ακέραιο  
Προεπιλεγμένη: 0

Το μέγεθος του αρχείου κάνετε εναλλαγή σε megabyte.


**Logs.Verbose:**  
Τύπος: δυαδική  
Προεπιλεγμένη: n

Εάν το σύνολο, λεπτομέρειες καταγραφής ενισχύεται. Waagent καταγράφει /var/log/waagent.log και αξιοποιεί τη λειτουργικότητα logrotate συστήματος για να περιστρέψετε αρχεία καταγραφής.


**ΛΕΙΤΟΥΡΓΙΚΌ ΣΎΣΤΗΜΑ. EnableRDMA**  
Τύπος: δυαδική  
Προεπιλεγμένη: n

Εάν ορίσετε, τον παράγοντα θα επιχειρήσει να εγκαταστήσετε και, στη συνέχεια, να φορτώσετε ένα πρόγραμμα οδήγησης πυρήνα RDMA που αντιστοιχεί στην έκδοση του υλικολογισμικού από το υποκείμενο υλικό.


**ΛΕΙΤΟΥΡΓΙΚΌ ΣΎΣΤΗΜΑ. RootDeviceScsiTimeout:**  
Τύπος: ακέραιο  
Προεπιλεγμένη: 300

Αυτό ρυθμίζει τις παραμέτρους του χρονικού ορίου SCSI σε δευτερόλεπτα στις μονάδες δίσκου και δεδομένα OS. Εάν δεν ορίσετε, το σύστημα που χρησιμοποιούνται από τις προεπιλεγμένες ρυθμίσεις.


**ΛΕΙΤΟΥΡΓΙΚΌ ΣΎΣΤΗΜΑ. OpensslPath:**  
Τύπος: συμβολοσειρά  
Προεπιλεγμένη: καμία

Αυτό μπορεί να χρησιμοποιηθεί για να καθορίσετε μια εναλλακτική διαδρομή για το δυαδικό για να χρησιμοποιήσετε για λειτουργίες κρυπτογράφησης openssl.


**HttpProxy.Host, HttpProxy.Port**  
Τύπος: συμβολοσειρά  
Προεπιλεγμένη: καμία

Εάν ορίσετε, τον παράγοντα θα χρησιμοποιήσει αυτόν το διακομιστή μεσολάβησης για να αποκτήσετε πρόσβαση στο internet. 


## <a name="ubuntu-cloud-images"></a>Εικόνες ubuntu Cloud

Σημειώστε ότι εικόνες Cloud Ubuntu χρησιμοποιούν [την προετοιμασία cloud](https://launchpad.net/ubuntu/+source/cloud-init) για να εκτελούν πολλές εργασίες ρύθμισης παραμέτρων που θα γίνεται διαφορετικά από τον παράγοντα Linux Azure.  Λάβετε υπόψη τις ακόλουθες διαφορές:


- **Provisioning.Enabled** από προεπιλογή "n" σε εικόνες Cloud Ubuntu που χρησιμοποιούν την προετοιμασία cloud για να εκτελέσετε εργασίες προετοιμασίας.

- Οι παρακάτω παράμετροι έχουν καμία επίδραση στην Ubuntu Cloud οι εικόνες που χρησιμοποιούν cloud την προετοιμασία για τη διαχείριση του δίσκου πόρων και εναλλαγή χώρο:

 - **ResourceDisk.Format**
 - **ResourceDisk.Filesystem**
 - **ResourceDisk.MountPoint**
 - **ResourceDisk.EnableSwap**
 - **ResourceDisk.SwapSizeMB**

- Ανατρέξτε στους παρακάτω πόρους για να ρυθμίσετε το σημείο ενεργοποίησης δίσκου πόρων και εναλλαγή χώρο στην Ubuntu Cloud εικόνες κατά την προμήθεια του:

 - [Ubuntu Wiki: Ρύθμιση παραμέτρων διαμερίσματα αντιμετάθεσης](http://go.microsoft.com/fwlink/?LinkID=532955&clcid=0x409)
 - [Έγχυση προσαρμοσμένα δεδομένα σε μια εικονική μηχανή Azure](virtual-machines-windows-classic-inject-custom-data.md)


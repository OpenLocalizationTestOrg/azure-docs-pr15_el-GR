<properties
pageTitle="Προετοιμασία μια εικονική μηχανή Linux Oracle για Azure | Microsoft Azure"
description="Βήμα προς βήμα ρύθμιση παραμέτρων για μια εικονική μηχανή Oracle εκτελείται Linux στο Microsoft Azure."
services="virtual-machines-linux"
authors="bbenz"
manager="timlt"
documentationCenter="virtual-machines"
tags="azure-service-management,azure-resource-manager"
/>

<tags
ms.service="virtual-machines-linux"
ms.devlang="na"
ms.topic="article"
ms.tgt_pltfrm="vm-linux"
ms.workload="infrastructure-services"
ms.date="06/22/2015"
ms.author="bbenz" />

# <a name="prepare-an-oracle-linux-virtual-machine-for-azure"></a>Προετοιμασία μια εικονική μηχανή Oracle Linux για Azure

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-both-include.md)]


-   [Προετοιμασία μια εικονική μηχανή Linux Oracle 6.4 + για Azure](virtual-machines-linux-oracle-create-upload-vhd.md)

-   [Προετοιμασία μια εικονική μηχανή Linux Oracle 7.0 + για Azure](virtual-machines-linux-oracle-create-upload-vhd.md)

## <a name="prerequisites"></a>Προαπαιτούμενα στοιχεία
Σε αυτό το άρθρο προϋποθέτει ότι έχετε εγκαταστήσει ήδη σε λειτουργικό σύστημα Oracle Linux για εικονικού σκληρού δίσκου. Υπάρχουν πολλά εργαλεία για να δημιουργήσετε αρχεία .vhd, για παράδειγμα, μια λύση virtualization όπως το Hyper-V. Για οδηγίες, ανατρέξτε στο θέμα [εγκατάσταση Hyper-V και να δημιουργήσετε μια εικονική μηχανή](http://technet.microsoft.com/library/hh846766.aspx).

**Σημειώσεις εγκατάστασης Linux Oracle**

- Συμβατά πυρήνα καπέλο κόκκινο της Oracle και το UEK3 (παραβιαστούν πυρήνα για μεγάλες επιχειρήσεις) που υποστηρίζονται σε Hyper-V και Azure. Για καλύτερα αποτελέσματα, φροντίστε να ενημερώνετε την πιο πρόσφατη πυρήνα κατά την προετοιμασία του VHD Linux Oracle.

- UEK2 της Oracle δεν υποστηρίζεται σε Hyper-V και Azure, καθώς δεν περιλαμβάνει τα απαιτούμενα προγράμματα οδήγησης.

- Στη νεότερη μορφή VHDX δεν υποστηρίζεται στο Azure. Μπορείτε να μετατρέψετε το δίσκο VHD μορφή χρησιμοποιώντας το Hyper-V Manager ή το cmdlet vhd μετατροπή.

- Όταν εγκαθιστάτε το σύστημα Linux, συνιστάται να χρησιμοποιήσετε βασικά διαμερίσματα και όχι LVM (συχνά η προεπιλογή για πολλές εγκαταστάσεις). Αυτό θα αποφύγετε LVM όνομα έρχεται σε διένεξη με κλωνοποιημένο ΣΠΣ, ιδίως εάν ένα δίσκο OS πρέπει ποτέ να επισυναφθεί σε μια άλλη Εικονική για την αντιμετώπιση προβλημάτων. LVM ή [RAID](virtual-machines-linux-configure-raid.md) μπορεί να χρησιμοποιηθεί σε δίσκων δεδομένων εάν προτιμώμενη.

- NUMA δεν υποστηρίζεται για μεγαλύτερα μεγέθη Εικονική λόγω σφάλματος σε εκδόσεις πυρήνα Linux κάτω από το 2.6.37. Αυτό το ζήτημα επηρεάζει κυρίως κατανομές που χρησιμοποιούν τη νέα κόκκινο καπέλο 2.6.32 πυρήνα. Μη αυτόματη εγκατάσταση των τον παράγοντα Azure Linux (waagent) θα απενεργοποιήσετε αυτόματα NUMA στη ρύθμιση παραμέτρων ΕΚΣΚΑΦΉ για τον πυρήνα Linux. Μπορείτε να βρείτε περισσότερες πληροφορίες σχετικά με αυτό στα παρακάτω βήματα.

- Χωρίς ρύθμιση ένα διαμερίσματα αντιμετάθεσης στο δίσκο OS. Ο παράγοντας Linux μπορεί να ρυθμιστεί για να δημιουργήσετε ένα αρχείο αντιμετάθεσης στο δίσκο προσωρινών πόρων. Μπορείτε να βρείτε περισσότερες πληροφορίες σχετικά με αυτό στα παρακάτω βήματα.

- Όλα τα VHD πρέπει να έχετε τα μεγέθη που είναι πολλαπλάσιο του 1 MB.

- Βεβαιωθείτε ότι το `Addons` αποθετήριο δεδομένων είναι ενεργοποιημένη. Επιλέξτε για να επεξεργαστείτε το αρχείο `/etc/yum.repo.d/public-yum-ol6.repo`(Oracle Linux 6) ή `/etc/yum.repo.d/public-yum-ol7.repo`(Oracle Linux), και αλλάξτε τη γραμμή `enabled=0` να `enabled=1` στην περιοχή **[ol6_addons]** ή **[ol7_addons]** σε αυτό το αρχείο.


## <a name="oracle-linux-64"></a>Oracle Linux 6.4 +
Πρέπει να ολοκληρώσετε τα βήματα συγκεκριμένη ρύθμιση παραμέτρων του λειτουργικού συστήματος για την εικονική μηχανή για να εκτελέσετε στο Azure.

1. Στο κεντρικό παράθυρο του Hyper-V Manager, επιλέξτε την εικονική μηχανή.

2. Κάντε κλικ στην επιλογή **σύνδεση** για να ανοίξετε το παράθυρο για την εικονική μηχανή.

3. Κατάργηση εγκατάστασης NetworkManager, εκτελώντας την ακόλουθη εντολή:

        # sudo rpm -e --nodeps NetworkManager

    >[AZURE.NOTE] Εάν το πακέτο δεν είναι ήδη εγκατεστημένο, αυτή η εντολή θα αποτύχει με ένα μήνυμα σφάλματος. Αυτό είναι αναμενόμενο.

4. Δημιουργήστε ένα αρχείο με το όνομα **δικτύου** σε /etc/sysconfig/καταλόγου που περιέχει το ακόλουθο κείμενο:

    `NETWORKING=yes`  
    `HOSTNAME=localhost.localdomain`

5.  Δημιουργήστε ένα αρχείο με το όνομα **ifcfg eth0** στο το /etc/sysconfig/network-scripts / κατάλογο που περιέχει το ακόλουθο κείμενο:

        DEVICE=eth0
        ONBOOT=yes
        BOOTPROTO=dhcp
            TYPE=Ethernet
            USERCTL=no
            PEERDNS=yes
        IPV6INIT=no

6.  Μετακίνηση (ή κατάργηση) udev κανόνες για να αποφευχθεί η δημιουργία στατικής κανόνες για τη διασύνδεση Ethernet. Αυτούς τους κανόνες προκαλέσει προβλήματα όταν θέλετε να αντιγράψετε μια εικονική μηχανή στο Azure ή Hyper-V:

        # sudo mkdir -m 0700 /var/lib/waagent
        # sudo mv /lib/udev/rules.d/75-persistent-net-generator.rules /var/lib/waagent/ 2\>/dev/null
        # sudo mv /etc/udev/rules.d/70-persistent-net.rules /var/lib/waagent/ 2\>/dev/null

7.  Βεβαιωθείτε ότι η υπηρεσία δικτύου θα ξεκινήσει κατά την εκκίνηση, εκτελώντας την ακόλουθη εντολή:

        # chkconfig network on

8.  Εγκαταστήστε python pyasn1, εκτελώντας την ακόλουθη εντολή:

        # sudo yum install python-pyasn1

9.  Τροποποίηση της γραμμής εκκίνησης πυρήνα στο εκσκαφή ρύθμιση των παραμέτρων σας για να συμπεριλάβετε τις παραμέτρους επιπλέον πυρήνα για Azure. Για να το κάνετε αυτό, ανοίξτε "/ boot/grub/menu.lst" σε ένα πρόγραμμα επεξεργασίας κειμένου και βεβαιωθείτε ότι η προεπιλεγμένη πυρήνα περιλαμβάνει τις ακόλουθες παραμέτρους:

        console=ttyS0 earlyprintk=ttyS0 rootdelay=300 numa=off

    Αυτό θα εξασφαλίσει επίσης ότι όλα τα μηνύματα κονσόλας αποστέλλονται την πρώτη σειρά θύρα, την οποία μπορούν να σας βοηθήσουν Azure υποστήριξης με τον εντοπισμό σφαλμάτων θέματα. Αυτό θα απενεργοποιήσει NUMA λόγω σφάλμα σε συμβατά πυρήνα καπέλο κόκκινο της Oracle.

    Εκτός από τα παραπάνω, συνιστάμε να *καταργήσετε* τις ακόλουθες παραμέτρους:

        rhgb quiet crashkernel=auto

    Δεν είναι χρήσιμη σε ένα περιβάλλον cloud όπου θέλουμε όλα τα αρχεία καταγραφής θα αποσταλούν στη σειριακή θύρα γραφικών και ήσυχο εκκίνησης.

    Το `crashkernel` επιλογή ενδέχεται να έχει ρυθμιστεί εάν θέλετε τα αριστερά, αλλά Σημειώστε ότι αυτή η παράμετρος θα τη μείωση της διαθέσιμης μνήμης σε η Εικονική από 128 MB ή μεγαλύτερη. Αυτό μπορεί να είναι προβληματικό τα μικρότερα μεγέθη Εικονική.

10.  Βεβαιωθείτε ότι ο διακομιστής SSH έχει εγκατασταθεί και ρυθμιστεί να ξεκινά κατά την εκκίνηση. Συνήθως, αυτή είναι η προεπιλεγμένη.

11.  Εγκαταστήστε τον παράγοντα Linux Azure, εκτελώντας την ακόλουθη εντολή:

        # <a name="sudo-yum-install-walinuxagent"></a>εγκατάσταση yum sudo WALinuxAgent

    Σημειώστε ότι κατά την εγκατάσταση του πακέτου WALinuxAgent θα καταργήσει τα NetworkManager και NetworkManager gnome πακέτων εάν αυτά δεν ήδη καταργήθηκαν όπως περιγράφεται στο βήμα 2.

12.  Μην δημιουργήσετε αντιμετάθεσης χώρο στο δίσκο λειτουργικό σύστημα.

    Ο παράγοντας Linux Azure μπορεί να ρυθμίσει αυτόματα χώρος αντιμετάθεσης με τη χρήση του δίσκου τοπικός πόρος που συνδέεται με την εικονική Μηχανή μετά την προμήθεια του Azure. Σημειώστε ότι ο δίσκος τοπικός πόρος είναι ένα *προσωρινό* και μπορεί να αδειάσει όταν η Εικονική καταργείται. Αφού εγκαταστήσετε τον παράγοντα Linux Azure (ανατρέξτε στο προηγούμενο βήμα), τροποποιήστε κατάλληλα τις ακόλουθες παραμέτρους στην /etc/waagent.conf:

        ResourceDisk.Format=y

        ResourceDisk.Filesystem=ext4

        ResourceDisk.MountPoint=/mnt/resource

        ResourceDisk.EnableSwap=y

        ResourceDisk.SwapSizeMB=2048 ## ΣΗΜΕΊΩΣΗ: Ορίστε αυτή σε ό, τι πρέπει να είναι.

13.  Εκτελέστε τις ακόλουθες εντολές deprovision η εικονική μηχανή και προετοιμασία για προμήθεια στην Azure:

        # <a name="sudo-waagent--force--deprovision"></a>sudo waagent-επιβάλετε - διαχειριστείτε
        # <a name="export-histsize0"></a>Εξαγωγή HISTSIZE = 0
        # <a name="logout"></a>αποσύνδεσης

14.  Κάντε κλικ στην επιλογή **ενέργεια -\> Τερματισμός** στον Hyper-V Manager. Σας VHD Linux είναι τώρα έτοιμο να αποσταλεί Azure.

## <a name="oracle-linux-70"></a>Oracle Linux 7.0 +
**Αλλαγές στο Oracle Linux 7**

Προετοιμασία μια εικονική μηχανή Oracle Linux 7 για Azure είναι παρόμοια με τη διαδικασία για Oracle Linux 6. Ωστόσο, υπάρχουν πολλές σημαντικές διαφορές αξίζει να αναφερθούν:

-   Το κόκκινο καπέλο συμβατά πυρήνα και της Oracle UEK3 υποστηρίζονται στο Azure. Συνιστάται η πυρήνα UEK3.

-   Το πακέτο NetworkManager δεν είναι πλέον διένεξη με τον παράγοντα Azure Linux. Αυτό το πακέτο είναι εγκατεστημένο από προεπιλογή και συνιστάται να ότι δεν καταργείται.

-   GRUB2 τώρα χρησιμοποιείται ως το προεπιλεγμένο bootloader, ώστε η διαδικασία για την επεξεργασία παράμετροι πυρήνα έχει αλλάξει (δείτε παρακάτω).

-   XFS είναι τώρα το προεπιλεγμένο σύστημα αρχείων. Το σύστημα αρχείων ext4 εξακολουθεί να μπορεί να χρησιμοποιηθεί, εάν θέλετε.

**Βήματα ρύθμισης παραμέτρων**

1.  Στη Διαχείριση Hyper-V, επιλέξτε την εικονική μηχανή.

2.  Κάντε κλικ στην επιλογή **σύνδεση** για να ανοίξετε ένα παράθυρο κονσόλας για την εικονική μηχανή.

3.  Δημιουργήστε ένα αρχείο με το όνομα **δικτύου** σε /etc/sysconfig/καταλόγου που περιέχει το ακόλουθο κείμενο:

        NETWORKING=yes
        HOSTNAME=localhost.localdomain

4.  Δημιουργήστε ένα αρχείο με το όνομα **ifcfg eth0** στο το /etc/sysconfig/network-scripts / κατάλογο που περιέχει το ακόλουθο κείμενο:

        DEVICE=eth0
        ONBOOT=yes
        BOOTPROTO=dhcp
        TYPE=Ethernet
        USERCTL=no
            PEERDNS=yes
        IPV6INIT=no

5.  Μετακίνηση (ή κατάργηση) udev κανόνες για να αποφευχθεί η δημιουργία στατικής κανόνες για τη διασύνδεση Ethernet. Αυτούς τους κανόνες προκαλέσει προβλήματα όταν θέλετε να αντιγράψετε μια εικονική μηχανή στο Microsoft Azure ή Hyper-V.

        # sudo mkdir -m 0700 /var/lib/waagent
        # sudo mv /lib/udev/rules.d/75-persistent-net-generator.rules /var/lib/waagent/ 2>/dev/null
        # sudo mv /etc/udev/rules.d/70-persistent-net.rules /var/lib/waagent/ 2>/dev/null

6.  Βεβαιωθείτε ότι η υπηρεσία δικτύου θα ξεκινήσει κατά την εκκίνηση, εκτελώντας την ακόλουθη εντολή:

        # sudo chkconfig network on

7.  Εγκατάσταση του πακέτου python pyasn1, εκτελώντας την ακόλουθη εντολή:

        # sudo yum install python-pyasn1

8.  Εκτελέστε την παρακάτω εντολή για να καταργήσετε την τρέχουσα μετα-δεδομένων yum και εγκαταστήστε τις ενημερώσεις:

        # sudo yum clean all
        # sudo yum -y update

9.  Τροποποίηση της γραμμής εκκίνησης πυρήνα στο εκσκαφή ρύθμιση των παραμέτρων σας για να συμπεριλάβετε τις παραμέτρους επιπλέον πυρήνα για Azure. Για να το κάνετε αυτό, Άνοιγμα "/ κ.λπ/προεπιλεγμένη/εκσκαφή" σε ένα πρόγραμμα επεξεργασίας κειμένου και επεξεργαστείτε το ΕΚΣΚΑΦΉ\_CMDLINE\_LINUX παράμετρο, για παράδειγμα:

        GRUB\_CMDLINE\_LINUX="rootdelay=300 console=ttyS0 earlyprintk=ttyS0"

    Αυτό θα εξασφαλίσει επίσης όλα τα μηνύματα κονσόλας στην οποία αποστέλλονται την πρώτη σειρά θύρα, την οποία μπορούν να σας βοηθήσουν Azure υποστήριξης με τον εντοπισμό σφαλμάτων θέματα. Εκτός από τα παραπάνω, συνιστάμε να *καταργήσετε* τις ακόλουθες παραμέτρους:

        rhgb quiet crashkernel=auto

    Δεν είναι χρήσιμη σε ένα περιβάλλον cloud όπου θέλουμε όλα τα αρχεία καταγραφής θα αποσταλούν στη σειριακή θύρα γραφικών και ήσυχο εκκίνησης.

    Το `crashkernel` επιλογή ενδέχεται να έχει ρυθμιστεί εάν θέλετε τα αριστερά, αλλά Σημειώστε ότι αυτή η παράμετρος θα τη μείωση της διαθέσιμης μνήμης σε η Εικονική από 128 MB ή μεγαλύτερη. Αυτό μπορεί να είναι προβληματικό τα μικρότερα μεγέθη Εικονική.

10.  Όταν ολοκληρώσετε την επεξεργασία "/ κ.λπ/προεπιλεγμένη/εκσκαφή", εκτελέστε την ακόλουθη εντολή για να δημιουργήσετε ξανά τις παραμέτρους εκσκαφή:

        # <a name="sudo-grub2-mkconfig--o-bootgrub2grubcfg"></a>sudo grub2 mkconfig - o /boot/grub2/grub.cfg

11.  Βεβαιωθείτε ότι ο διακομιστής SSH έχει εγκατασταθεί και ρυθμιστεί να ξεκινά κατά την εκκίνηση. Συνήθως, αυτή είναι η προεπιλεγμένη.

12.  Εγκαταστήστε τον παράγοντα Linux Azure, εκτελώντας την ακόλουθη εντολή:

        # <a name="sudo-yum-install-walinuxagent"></a>εγκατάσταση yum sudo WALinuxAgent

13.  Μην δημιουργήσετε αντιμετάθεσης χώρο στο δίσκο λειτουργικό σύστημα.

    Ο παράγοντας Linux Azure μπορεί να ρυθμίσει αυτόματα χώρος αντιμετάθεσης με τη χρήση του δίσκου τοπικός πόρος που συνδέεται με την εικονική Μηχανή μετά την προμήθεια του Azure. Σημειώστε ότι ο δίσκος τοπικός πόρος είναι ένα *προσωρινό* και μπορεί να αδειάσει όταν η Εικονική καταργείται. Αφού εγκαταστήσετε τον παράγοντα Linux Azure (ανατρέξτε στο προηγούμενο βήμα), τροποποιήστε κατάλληλα τις ακόλουθες παραμέτρους στην /etc/waagent.conf:

        ResourceDisk.Format=y ResourceDisk.Filesystem=ext4 ResourceDisk.MountPoint=/mnt/resource ResourceDisk.EnableSwap=y ResourceDisk.SwapSizeMB=2048 ## ΣΗΜΕΊΩΣΗ: Ορίστε αυτή σε ό, τι πρέπει να είναι.

14.  Εκτελέστε τις ακόλουθες εντολές deprovision η εικονική μηχανή και προετοιμασία για προμήθεια στην Azure:

        # <a name="sudo-waagent--force--deprovision"></a>sudo waagent-επιβάλετε - διαχειριστείτε
        # <a name="export-histsize0"></a>Εξαγωγή HISTSIZE = 0
        # <a name="logout"></a>αποσύνδεσης

15.  Κάντε κλικ στην επιλογή **ενέργεια -\> Τερματισμός** στον Hyper-V Manager. Σας VHD Linux είναι τώρα έτοιμο να αποσταλεί Azure.

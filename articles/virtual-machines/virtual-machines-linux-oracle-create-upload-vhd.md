<properties
    pageTitle="Δημιουργία και αποστολή ενός VHD Linux Oracle | Microsoft Azure"
    description="Μάθετε πώς να δημιουργήσετε και να στείλετε ένα Azure εικονικού σκληρού δίσκου (VHD) που περιέχει ένα λειτουργικό σύστημα Oracle Linux."
    services="virtual-machines-linux"
    documentationCenter=""
    authors="szarkos"
    manager="timlt"
    editor="tysonn"
    tags="azure-service-management,azure-resource-manager" />

<tags
    ms.service="virtual-machines-linux"
    ms.workload="infrastructure-services"
    ms.tgt_pltfrm="vm-linux"
    ms.devlang="na"
    ms.topic="article"
    ms.date="08/24/2016"
    ms.author="szark"/>

# <a name="prepare-an-oracle-linux-virtual-machine-for-azure"></a>Προετοιμασία μια εικονική μηχανή Oracle Linux για Azure

[AZURE.INCLUDE [learn-about-deployment-models](../../includes/learn-about-deployment-models-both-include.md)]

## <a name="prerequisites"></a>Προαπαιτούμενα στοιχεία ##

Σε αυτό το άρθρο προϋποθέτει ότι έχετε εγκαταστήσει ήδη σε λειτουργικό σύστημα Oracle Linux για εικονικού σκληρού δίσκου. Υπάρχουν πολλά εργαλεία για να δημιουργήσετε αρχεία .vhd, για παράδειγμα, μια λύση virtualization όπως το Hyper-V. Για οδηγίες, ανατρέξτε στο θέμα [εγκατάσταση του ρόλου Hyper-V και ρύθμιση παραμέτρων μια εικονική μηχανή](http://technet.microsoft.com/library/hh846766.aspx).


### <a name="oracle-linux-installation-notes"></a>Σημειώσεις εγκατάστασης Linux Oracle

- Ανατρέξτε στο θέμα επίσης [Γενικές σημειώσεις εγκατάστασης Linux](virtual-machines-linux-create-upload-generic.md#general-linux-installation-notes) για περισσότερες συμβουλές σχετικά με την προετοιμασία Linux για Azure.

- Συμβατά πυρήνα καπέλο κόκκινο της Oracle και τους UEK3 (παραβιαστούν πυρήνα για μεγάλες επιχειρήσεις) που υποστηρίζονται σε Hyper-V και Azure. Για καλύτερα αποτελέσματα, βεβαιωθείτε ότι έχετε για να ενημερώσετε την πιο πρόσφατη πυρήνα κατά την προετοιμασία του VHD Linux Oracle.

- UEK2 της Oracle δεν υποστηρίζεται σε Hyper-V και Azure, καθώς δεν περιλαμβάνει τα απαιτούμενα προγράμματα οδήγησης.

- Η μορφή VHDX δεν υποστηρίζεται στο Azure, μόνο **σταθερής VHD**.  Μπορείτε να μετατρέψετε το δίσκο VHD μορφή χρησιμοποιώντας το Hyper-V Manager ή το cmdlet vhd μετατροπή.

- Κατά την εγκατάσταση του συστήματος Linux συνιστάται να χρησιμοποιήσετε βασικά διαμερίσματα και όχι LVM (συχνά η προεπιλογή για πολλές εγκαταστάσεις). Αυτό θα αποφύγετε LVM όνομα έρχεται σε διένεξη με κλωνοποιημένο ΣΠΣ, ιδίως εάν ένα δίσκο OS πρέπει ποτέ να επισυναφθεί σε μια άλλη Εικονική για την αντιμετώπιση προβλημάτων. [LVM](virtual-machines-linux-configure-lvm.md) ή [RAID](virtual-machines-linux-configure-raid.md) μπορεί να χρησιμοποιηθεί σε δίσκων δεδομένων εάν προτιμώμενη.

- NUMA δεν υποστηρίζεται για μεγαλύτερα μεγέθη Εικονική λόγω σφάλματος σε εκδόσεις πυρήνα Linux κάτω από το 2.6.37. Αυτό το ζήτημα επηρεάζει κυρίως κατανομές χρησιμοποιώντας τη νέα κόκκινο καπέλο 2.6.32 πυρήνα. Μη αυτόματη εγκατάσταση των τον παράγοντα Azure Linux (waagent) θα απενεργοποιήσετε αυτόματα NUMA στη ρύθμιση παραμέτρων ΕΚΣΚΑΦΉ για τον πυρήνα Linux. Μπορείτε να βρείτε περισσότερες πληροφορίες σχετικά με αυτό στα παρακάτω βήματα.

- Χωρίς ρύθμιση ένα διαμερίσματα αντιμετάθεσης στο δίσκο OS. Ο παράγοντας Linux μπορεί να ρυθμιστεί για να δημιουργήσετε ένα αρχείο αντιμετάθεσης στο δίσκο προσωρινών πόρων.  Μπορείτε να βρείτε περισσότερες πληροφορίες σχετικά με αυτό στα παρακάτω βήματα.

- Όλα τα VHD πρέπει να έχετε τα μεγέθη που είναι πολλαπλάσιο του 1 MB.

- Βεβαιωθείτε ότι το `Addons` αποθετήριο δεδομένων είναι ενεργοποιημένη. Επεξεργαστείτε το αρχείο `/etc/yum.repo.d/public-yum-ol6.repo`(Oracle Linux 6) ή `/etc/yum.repo.d/public-yum-ol7.repo`(Oracle Linux), και αλλάξτε τη γραμμή `enabled=0` να `enabled=1` στην περιοχή **[ol6_addons]** ή **[ol7_addons]** σε αυτό το αρχείο.


## <a name="oracle-linux-64"></a>Oracle Linux 6.4 + ##

Πρέπει να ολοκληρώσετε τα βήματα συγκεκριμένη ρύθμιση παραμέτρων του λειτουργικού συστήματος για την εικονική μηχανή για να εκτελέσετε στο Azure.

1. Στο κεντρικό παράθυρο του Hyper-V Manager, επιλέξτε την εικονική μηχανή.

2. Κάντε κλικ στην επιλογή **σύνδεση** για να ανοίξετε το παράθυρο για την εικονική μηχανή.

3. Κατάργηση εγκατάστασης NetworkManager, εκτελώντας την ακόλουθη εντολή:

        # sudo rpm -e --nodeps NetworkManager

    **Σημείωση:** Εάν το πακέτο δεν είναι ήδη εγκατεστημένο, αυτή η εντολή θα αποτύχει με ένα μήνυμα σφάλματος. Αυτό είναι αναμενόμενο.

4.  Δημιουργήστε ένα αρχείο με το όνομα **δικτύου** σε το `/etc/sysconfig/` κατάλογο που περιέχει το ακόλουθο κείμενο:

        NETWORKING=yes
        HOSTNAME=localhost.localdomain

5.  Δημιουργήστε ένα αρχείο με το όνομα **ifcfg eth0** στο το `/etc/sysconfig/network-scripts/` κατάλογο που περιέχει το ακόλουθο κείμενο:

        DEVICE=eth0
        ONBOOT=yes
        BOOTPROTO=dhcp
        TYPE=Ethernet
        USERCTL=no
        PEERDNS=yes
        IPV6INIT=no

6.  Τροποποίηση udev κανόνες για να αποφευχθεί η δημιουργία στατικής κανόνες για τις διασυνδέσεις Ethernet. Αυτοί οι κανόνες μπορεί να προκαλέσει προβλήματα όταν κλωνοποίηση μια εικονική μηχανή στο Microsoft Azure ή Hyper-V:

        # sudo ln -s /dev/null /etc/udev/rules.d/75-persistent-net-generator.rules
        # sudo rm -f /etc/udev/rules.d/70-persistent-net.rules

7. Βεβαιωθείτε ότι η υπηρεσία δικτύου θα ξεκινήσει κατά την εκκίνηση, εκτελώντας την ακόλουθη εντολή:

        # chkconfig network on

8. Εγκαταστήστε python pyasn1, εκτελώντας την ακόλουθη εντολή:

        # sudo yum install python-pyasn1

9.  Τροποποίηση της γραμμής εκκίνησης πυρήνα στο εκσκαφή ρύθμιση των παραμέτρων σας για να συμπεριλάβετε τις παραμέτρους επιπλέον πυρήνα για Azure. Για να το κάνετε αυτό, ανοίξτε "/ boot/grub/menu.lst" σε ένα πρόγραμμα επεξεργασίας κειμένου και βεβαιωθείτε ότι η προεπιλεγμένη πυρήνα περιλαμβάνει τις ακόλουθες παραμέτρους:

        console=ttyS0 earlyprintk=ttyS0 rootdelay=300 numa=off

    Αυτό θα εξασφαλίσει επίσης όλα τα μηνύματα κονσόλας στην οποία αποστέλλονται την πρώτη σειρά θύρα, την οποία μπορούν να σας βοηθήσουν Azure υποστήριξης με τον εντοπισμό σφαλμάτων θέματα. Αυτό θα απενεργοποιήσει NUMA λόγω σφάλμα σε συμβατά πυρήνα καπέλο κόκκινο της Oracle.

    Εκτός από τα παραπάνω, συνιστάται να *καταργήσετε* τις ακόλουθες παραμέτρους:

        rhgb quiet crashkernel=auto

    Δεν είναι χρήσιμη σε ένα περιβάλλον cloud όπου θέλουμε όλα τα αρχεία καταγραφής θα αποσταλούν στη σειριακή θύρα γραφικών και ήσυχο εκκίνησης.

    Το `crashkernel` επιλογή ενδέχεται να έχει ρυθμιστεί εάν θέλετε τα αριστερά, αλλά Σημειώστε ότι αυτή η παράμετρος θα μείωση της ποσότητας διαθέσιμη μνήμη σε η Εικονική από 128MB ή μεγαλύτερη, που μπορεί να είναι προβληματικό τα μικρότερα μεγέθη Εικονική.


10. Βεβαιωθείτε ότι ο διακομιστής SSH έχει εγκατασταθεί και ρυθμιστεί να ξεκινά κατά την εκκίνηση.  Συνήθως, αυτή είναι η προεπιλεγμένη.

11. Εγκαταστήστε τον παράγοντα Linux Azure, εκτελώντας την ακόλουθη εντολή. Η πιο πρόσφατη έκδοση είναι 2.0.15.

        # sudo yum install WALinuxAgent

    Σημειώστε ότι κατά την εγκατάσταση του πακέτου WALinuxAgent θα καταργήσει τα NetworkManager και NetworkManager gnome πακέτων εάν αυτά δεν ήδη καταργήθηκαν όπως περιγράφεται στο βήμα 2.

12. Μην δημιουργήσετε αντιμετάθεσης χώρο στο δίσκο λειτουργικό σύστημα.

    Ο παράγοντας Linux Azure αυτόματα να ρυθμίσετε τις παραμέτρους χώρος αντιμετάθεσης χρησιμοποιώντας το δίσκο τοπικός πόρος που συνδέεται με την εικονική Μηχανή μετά την προμήθεια του Azure. Σημειώστε ότι ο δίσκος τοπικός πόρος είναι ένα *προσωρινό* δίσκο και να αδειάζετε όταν η Εικονική καταργείται. Μετά την εγκατάσταση του τον παράγοντα Linux Azure (ανατρέξτε στο προηγούμενο βήμα), τροποποιήστε κατάλληλα τις ακόλουθες παραμέτρους στην /etc/waagent.conf:

        ResourceDisk.Format=y
        ResourceDisk.Filesystem=ext4
        ResourceDisk.MountPoint=/mnt/resource
        ResourceDisk.EnableSwap=y
        ResourceDisk.SwapSizeMB=2048    ## NOTE: set this to whatever you need it to be.

13. Εκτελέστε τις ακόλουθες εντολές deprovision η εικονική μηχανή και προετοιμασία για προμήθεια στην Azure:

        # sudo waagent -force -deprovision
        # export HISTSIZE=0
        # logout

14. Κάντε κλικ στο κουμπί **Τερματισμός λειτουργίας -> ενέργεια προς τα κάτω** στον Hyper-V Manager. Σας VHD Linux είναι τώρα έτοιμο να αποσταλεί Azure.


----------


## <a name="oracle-linux-70"></a>Oracle Linux 7.0 + ##

**Αλλαγές στο Oracle Linux 7**

Προετοιμασία μια εικονική μηχανή Oracle Linux 7 για Azure είναι παρόμοια με 6 Linux Oracle, ωστόσο, υπάρχουν πολλές σημαντικές διαφορές αξίζει να αναφερθούν:

 - Το κόκκινο καπέλο συμβατά πυρήνα και της Oracle UEK3 υποστηρίζονται στο Azure.  Προτείνεται πυρήνα των UEK3.
 - Το πακέτο NetworkManager δεν είναι πλέον διένεξη με τον παράγοντα Azure Linux. Αυτό το πακέτο είναι εγκατεστημένο από προεπιλογή και συνιστάται να ότι δεν καταργείται.
 - GRUB2 τώρα χρησιμοποιείται ως το προεπιλεγμένο bootloader, ώστε η διαδικασία για την επεξεργασία παράμετροι πυρήνα έχει αλλάξει (δείτε παρακάτω).
 - XFS είναι τώρα το προεπιλεγμένο σύστημα αρχείων. Το σύστημα αρχείων ext4 εξακολουθεί να μπορεί να χρησιμοποιηθεί, εάν θέλετε.


**Βήματα ρύθμισης παραμέτρων**

1. Στη Διαχείριση Hyper-V, επιλέξτε την εικονική μηχανή.

2. Κάντε κλικ στην επιλογή **σύνδεση** για να ανοίξετε ένα παράθυρο κονσόλας για την εικονική μηχανή.

3.  Δημιουργήστε ένα αρχείο με το όνομα **δικτύου** σε το `/etc/sysconfig/` κατάλογο που περιέχει το ακόλουθο κείμενο:

        NETWORKING=yes
        HOSTNAME=localhost.localdomain

4.  Δημιουργήστε ένα αρχείο με το όνομα **ifcfg eth0** στο το `/etc/sysconfig/network-scripts/` κατάλογο που περιέχει το ακόλουθο κείμενο:

        DEVICE=eth0
        ONBOOT=yes
        BOOTPROTO=dhcp
        TYPE=Ethernet
        USERCTL=no
        PEERDNS=yes
        IPV6INIT=no

5.  Τροποποίηση udev κανόνες για να αποφευχθεί η δημιουργία στατικής κανόνες για τις διασυνδέσεις Ethernet. Αυτοί οι κανόνες μπορεί να προκαλέσει προβλήματα όταν κλωνοποίηση μια εικονική μηχανή στο Microsoft Azure ή Hyper-V:

        # sudo ln -s /dev/null /etc/udev/rules.d/75-persistent-net-generator.rules

6. Βεβαιωθείτε ότι η υπηρεσία δικτύου θα ξεκινήσει κατά την εκκίνηση, εκτελώντας την ακόλουθη εντολή:

        # sudo chkconfig network on

7. Εγκατάσταση του πακέτου python pyasn1, εκτελώντας την ακόλουθη εντολή:

        # sudo yum install python-pyasn1

8.  Εκτελέστε την παρακάτω εντολή για να καταργήσετε την τρέχουσα μετα-δεδομένων yum και εγκαταστήστε τις ενημερώσεις:

        # sudo yum clean all
        # sudo yum -y update

9.  Τροποποίηση της γραμμής εκκίνησης πυρήνα στο εκσκαφή ρύθμιση των παραμέτρων σας για να συμπεριλάβετε τις παραμέτρους επιπλέον πυρήνα για Azure. Για να το κάνετε αυτό ανοιχτό "/ κ.λπ/προεπιλεγμένη/εκσκαφή" σε ένα πρόγραμμα επεξεργασίας κειμένου και επεξεργαστείτε το `GRUB_CMDLINE_LINUX` παράμετρο, για παράδειγμα:

        GRUB_CMDLINE_LINUX="rootdelay=300 console=ttyS0 earlyprintk=ttyS0 net.ifnames=0"

    Αυτό θα εξασφαλίσει επίσης όλα τα μηνύματα κονσόλας στην οποία αποστέλλονται την πρώτη σειρά θύρα, την οποία μπορούν να σας βοηθήσουν Azure υποστήριξης με τον εντοπισμό σφαλμάτων θέματα. Επίσης απενεργοποιεί τις νέες συμβάσεις ονομασίας OEL 7 για NIC. Εκτός από τα παραπάνω, συνιστάται να *καταργήσετε* τις ακόλουθες παραμέτρους:

        rhgb quiet crashkernel=auto

    Δεν είναι χρήσιμη σε ένα περιβάλλον cloud όπου θέλουμε όλα τα αρχεία καταγραφής θα αποσταλούν στη σειριακή θύρα γραφικών και ήσυχο εκκίνησης.

    Το `crashkernel` επιλογή ενδέχεται να έχει ρυθμιστεί εάν θέλετε τα αριστερά, αλλά Σημειώστε ότι αυτή η παράμετρος θα μείωση της ποσότητας διαθέσιμη μνήμη σε η Εικονική από 128MB ή μεγαλύτερη, που μπορεί να είναι προβληματικό τα μικρότερα μεγέθη Εικονική.


10. Όταν ολοκληρώσετε την επεξεργασία "/ κ.λπ/προεπιλεγμένη/εκσκαφή" ανά παραπάνω, εκτελέστε την ακόλουθη εντολή για να δημιουργήσετε ξανά τις παραμέτρους εκσκαφή:

        # sudo grub2-mkconfig -o /boot/grub2/grub.cfg

11. Βεβαιωθείτε ότι ο διακομιστής SSH έχει εγκατασταθεί και ρυθμιστεί να ξεκινά κατά την εκκίνηση.  Συνήθως, αυτή είναι η προεπιλεγμένη.

12. Εγκαταστήστε τον παράγοντα Linux Azure, εκτελώντας την ακόλουθη εντολή:

        # sudo yum install WALinuxAgent
        # sudo systemctl enable waagent

13. Μην δημιουργήσετε αντιμετάθεσης χώρο στο δίσκο λειτουργικό σύστημα.

    Ο παράγοντας Linux Azure αυτόματα να ρυθμίσετε τις παραμέτρους χώρος αντιμετάθεσης χρησιμοποιώντας το δίσκο τοπικός πόρος που συνδέεται με την εικονική Μηχανή μετά την προμήθεια του Azure. Σημειώστε ότι ο δίσκος τοπικός πόρος είναι ένα *προσωρινό* δίσκο και να αδειάζετε όταν η Εικονική καταργείται. Μετά την εγκατάσταση του τον παράγοντα Linux Azure (ανατρέξτε στο θέμα το προηγούμενο βήμα), τροποποιήστε κατάλληλα τις ακόλουθες παραμέτρους στην /etc/waagent.conf:

        ResourceDisk.Format=y
        ResourceDisk.Filesystem=ext4
        ResourceDisk.MountPoint=/mnt/resource
        ResourceDisk.EnableSwap=y
        ResourceDisk.SwapSizeMB=2048    ## NOTE: set this to whatever you need it to be.

14. Εκτελέστε τις ακόλουθες εντολές deprovision η εικονική μηχανή και προετοιμασία για προμήθεια στην Azure:

        # sudo waagent -force -deprovision
        # export HISTSIZE=0
        # logout

15. Κάντε κλικ στο κουμπί **Τερματισμός λειτουργίας -> ενέργεια προς τα κάτω** στον Hyper-V Manager. Σας VHD Linux είναι τώρα έτοιμο να αποσταλεί Azure.


## <a name="next-steps"></a>Επόμενα βήματα
Τώρα είστε έτοιμοι να χρησιμοποιήσετε το .vhd Oracle Linux για να δημιουργήσετε νέα εικονικές μηχανές στο Azure. Εάν αυτή είναι η πρώτη φορά που που αποστέλλετε το αρχείο .vhd να Azure, δείτε τα βήματα 2 και 3 στη [Δημιουργία και αποστολή ενός εικονικού σκληρού δίσκου που περιέχει το λειτουργικό σύστημα Linux](virtual-machines-linux-classic-create-upload-vhd.md).

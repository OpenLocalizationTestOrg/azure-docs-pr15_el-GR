<properties
   pageTitle="Μετεγκατάσταση τον κώδικα SQL στο αποθήκη δεδομένων του SQL | Microsoft Azure"
   description="Συμβουλές για τη μετεγκατάσταση του κώδικα SQL σε αποθήκη δεδομένων του SQL Azure για την ανάπτυξη λύσεων."
   services="sql-data-warehouse"
   documentationCenter="NA"
   authors="lodipalm"
   manager="barbkess"
   editor=""/>

<tags
   ms.service="sql-data-warehouse"
   ms.devlang="NA"
   ms.topic="article"
   ms.tgt_pltfrm="NA"
   ms.workload="data-services"
   ms.date="08/02/2016"
   ms.author="lodipalm;barbkess;sonyama;jrj"/>

# <a name="migrate-your-sql-code-to-sql-data-warehouse"></a>Μετεγκατάσταση τον κώδικα SQL στο αποθήκη δεδομένων του SQL

Κατά τη μετεγκατάσταση του κώδικα από μια άλλη βάση δεδομένων σε αποθήκη δεδομένων του SQL, πιθανότατα θα πρέπει να κάνετε αλλαγές σε βάση σας κώδικα. Ορισμένες δυνατότητες αποθήκη δεδομένων του SQL σημαντικά να βελτιώσετε την απόδοση που έχουν σχεδιαστεί για να εργαστείτε με κατανέμεται τρόπο. Ωστόσο, για να διατηρήσετε τις επιδόσεις και την κλίμακα, ορισμένες δυνατότητες επίσης δεν είναι διαθέσιμες.

## <a name="common-t-sql-limitations"></a>Κοινές περιορισμοί T-SQL

Λίστα που ακολουθεί συνοψίζει τα πιο συνηθισμένα δυνατότητα που δεν υποστηρίζονται στο αποθήκη δεδομένων του SQL Azure. Οι συνδέσεις σας μεταφέρει σε λύσεις για τη δυνατότητα που δεν υποστηρίζεται:

- [Σύνδεσμοι ANSI ενημερώσεις][]
- [Σύνδεσμοι ANSI στα διαγράφει][]
- [δήλωση συγχώνευσης][]
- βάση δεδομένων σταυρό σύνδεσμοι
- [δείκτες][]
- [ΕΠΙΛΈΞΤΕ... ΣΕ][]
- [ΕΙΣΑΓΩΓΉ... ΕΚΤΈΛΕΣΗ][]
- όρος εξόδου
- ενσωματωμένες συναρτήσεις που ορίζονται από το χρήστη
- πολλαπλή δήλωση συναρτήσεων
- [κοινές παραστάσεις πίνακα](#Common-table-expressions)
- [επαναλαμβανόμενες κοινές παραστάσεις πίνακα (CTE)] (#Recursive-common-table-expressions-(CTE)
- Συναρτήσεις CLR και διαδικασίες
- συνάρτηση $partition
- μεταβλητές πίνακα
- παράμετροι τιμή πίνακα
- κατανεμημένες συναλλαγές
- Ολοκλήρωση / εργασία επαναφοράς
- Αποθήκευση συναλλαγής
- εκτέλεση περιβάλλοντα (EXECUTE AS)
- [Ομαδοποίηση κατά όρο με rollup / κύβος / σύνολα επιλογές ομαδοποίησης][]
- [τα επίπεδα ένθεσης πέρα από 8][]
- [ενημέρωση στις προβολές][]
- [χρήση του, επιλέξτε για ανάθεση μεταβλητής][]
- [Τύπος δεδομένων χωρίς MAX για δυναμική συμβολοσειρών SQL][]

Ευτυχώς περισσότερες από αυτούς τους περιορισμούς μπορούν να εργαστούν γύρω από. Εξηγήσεις παρέχονται στο στα άρθρα σχετικές ανάπτυξης που αναφέρονται παραπάνω.

## <a name="supported-cte-features"></a>Υποστηριζόμενες δυνατότητες CTE

Κοινές παραστάσεις πίνακα (CTEs) υποστηρίζονται μερικώς στο αποθήκη δεδομένων του SQL.  Οι παρακάτω δυνατότητες CTE υποστηρίζονται αυτήν τη στιγμή:

- Μια CTE μπορεί να καθοριστεί σε μια πρόταση SELECT.
- Μια CTE μπορεί να καθοριστεί σε μια πρόταση CREATE VIEW.
- Μια CTE μπορεί να καθοριστεί σε μια πρόταση ΔΗΜΙΟΥΡΓΊΑ ΠΊΝΑΚΑ ΩΣ ΕΠΙΛΟΓΉ (CTAS).
- Μια CTE μπορεί να καθοριστεί σε μια πρόταση ΔΗΜΙΟΥΡΓΊΑ ΑΠΟΜΑΚΡΥΣΜΈΝΟΥ ΠΊΝΑΚΑ ΩΣ ΕΠΙΛΟΓΉ (CRTAS).
- Μια CTE μπορεί να καθοριστεί σε μια πρόταση ΔΗΜΙΟΥΡΓΊΑ ΕΞΩΤΕΡΙΚΏΝ ΠΊΝΑΚΑ ΩΣ ΕΠΙΛΟΓΉ (CETAS).
- Απομακρυσμένο πίνακα μπορούν να χρησιμοποιηθούν από μια CTE.
- Έναν εξωτερικό πίνακα μπορούν να χρησιμοποιηθούν από μια CTE.
- Πολλές ορισμών ερωτήματος CTE μπορεί να οριστεί σε ένα CTE.

## <a name="cte-limitations"></a>Περιορισμοί CTE

Κοινές παραστάσεις πίνακα έχουν ορισμένοι περιορισμοί στην συμπεριλαμβανομένων αποθήκη δεδομένων του SQL:

- Ένα CTE πρέπει να ακολουθείται από μια μεμονωμένη πρόταση SELECT. Εισαγωγή, ΕΝΗΜΈΡΩΣΗ, ΔΙΑΓΡΑΦΉ, και προτάσεις ΣΥΓΧΏΝΕΥΣΗΣ δεν υποστηρίζονται.
- Μια κοινή παράσταση πίνακα που περιλαμβάνουν αναφορές στον εαυτό (μια επαναλαμβανόμενη κοινές παράσταση πίνακα) δεν υποστηρίζεται (δείτε παρακάτω ενότητα).
- Καθορισμός περισσότερες από μία με όρο σε μια CTE δεν επιτρέπεται. Για παράδειγμα, εάν μια CTE_query_definition περιέχει ένα δευτερεύον ερώτημα, που δευτερεύοντος ερωτήματος δεν μπορεί να περιέχει μια ένθετη με όρο που καθορίζει μια άλλη CTE.
- Όρο ORDER BY δεν είναι δυνατό να χρησιμοποιηθούν σε το CTE_query_definition, εκτός από όταν έχει καθοριστεί έναν όρο TOP.
- Όταν μια CTE χρησιμοποιείται σε μια πρόταση που είναι μέρος μιας δέσμης, την πρόταση πριν από αυτό πρέπει να ακολουθείται από ένα ελληνικό ερωτηματικό.
- Όταν χρησιμοποιείται σε δηλώσεις συντάσσουν sp_prepare, CTEs θα συμπεριφέρονται τον ίδιο τρόπο όπως άλλες προτάσεις SELECT στο PDW. Ωστόσο, εάν CTEs χρησιμοποιούνται ως μέρος της CETAS συντάσσουν sp_prepare, τη συμπεριφορά να αναβάλετε την από το SQL Server και άλλες προτάσεις PDW λόγω τον τρόπο σύνδεσης έχει υλοποιηθεί για sp_prepare. Εάν ΕΠΙΛΈΞΤΕ ότι αναφορές CTE χρησιμοποιεί μια εσφαλμένη στήλη που δεν υπάρχει στο CTE, το sp_prepare θα περάσουν χωρίς τον εντοπισμό το σφάλμα, αλλά το σφάλμα θα είναι προέκυψε κατά τη διάρκεια sp_execute αντί για αυτό.

## <a name="recursive-ctes"></a>CTEs περιοδικότητας

Επαναλαμβανόμενες CTEs δεν υποστηρίζονται στο αποθήκη δεδομένων του SQL.  Το migraion της περιοδικότητας CTE μπορεί να είναι κάπως ολοκλήρωσης και η βέλτιστη διαδικασία είναι να διασπάστε το σε πολλά βήματα. Συνήθως, μπορείτε να χρησιμοποιήσετε ένα βρόχο και να συμπληρώσετε ένα προσωρινό πίνακα καθώς κάνετε διαδοχικές προσεγγίσεις επάνω από τα ερωτήματα ενδιάμεσες επαναλαμβανόμενες. Μόλις συμπληρώνεται τον προσωρινό πίνακα μπορείτε να επιστρέψετε στη συνέχεια, τα δεδομένα ως ένα μονό σύνολο αποτελεσμάτων. Μια παρόμοια προσέγγιση έχει χρησιμοποιηθεί για την επίλυση `GROUP BY WITH CUBE` στο άρθρο [Ομαδοποίηση κατά όρο με rollup / κύβος / σύνολα επιλογές ομαδοποίησης][] .

## <a name="unsupported-system-functions"></a>Συναρτήσεις σύστημα που δεν υποστηρίζεται

Υπάρχουν επίσης ορισμένες από τις συναρτήσεις σύστημα που δεν υποστηρίζονται. Ορισμένες του κύριου αυτές μπορεί να σας φανούν συνήθως χρησιμοποιούνται στα δεδομένα αποταμίευσης είναι:

- NEWSEQUENTIALID()
- @@NESTLEVEL()
- @@IDENTITY()
- @@ROWCOUNT()
- ROWCOUNT_BIG
- ERROR_LINE()

Ορισμένα από τα παρακάτω θέματα μπορούν να εργαστούν γύρω από.

## <a name="rowcount-workaround"></a>@@ROWCOUNTλύση:

Για να επιλύσετε την έλλειψη υποστήριξης για @@ROWCOUNT, Δημιουργία αποθηκευμένης διαδικασίας που θα ανακτήσει το τελευταίο πλήθος γραμμών από sys.dm_pdw_request_steps και, στη συνέχεια, εκτελέστε `EXEC LastRowCount` μετά από μια πρόταση ΟΘΔ.

```sql
CREATE PROCEDURE LastRowCount AS
WITH LastRequest as 
(   SELECT TOP 1    request_id
    FROM            sys.dm_pdw_exec_requests
    WHERE           session_id = SESSION_ID()
    AND             resource_class IS NOT NULL
    ORDER BY end_time DESC
),
LastRequestRowCounts as
(
    SELECT  step_index, row_count
    FROM    sys.dm_pdw_request_steps
    WHERE   row_count >= 0
    AND     request_id IN (SELECT request_id from LastRequest)
)
SELECT TOP 1 row_count FROM LastRequestRowCounts ORDER BY step_index DESC
;
```

## <a name="next-steps"></a>Επόμενα βήματα
Για μια πλήρη λίστα με όλες τις υποστηριζόμενες προτάσεις T SQL, ανατρέξτε στο θέμα [θέματα Transact-SQL][].

<!--Image references-->

<!--Article references-->
[ANSI σύνδεσμοι ενημερώσεις]: ./sql-data-warehouse-develop-ctas.md#ansi-join-replacement-for-update-statements
[Σύνδεσμοι ANSI στα διαγράφει]: ./sql-data-warehouse-develop-ctas.md#ansi-join-replacement-for-delete-statements
[δήλωση συγχώνευσης]: ./sql-data-warehouse-develop-ctas.md#replace-merge-statements
[ΕΙΣΑΓΩΓΉ... ΕΚΤΈΛΕΣΗ]: ./sql-data-warehouse-tables-temporary.md#modularizing-code
[Θέματα Transact-SQL]: ./sql-data-warehouse-reference-tsql-statements.md

[δείκτες]: ./sql-data-warehouse-develop-loops.md
[ΕΠΙΛΈΞΤΕ... ΣΕ]: ./sql-data-warehouse-develop-ctas.md#selectinto
[Ομαδοποίηση κατά όρο με rollup / κύβος / σύνολα επιλογές ομαδοποίησης]: ./sql-data-warehouse-develop-group-by-options.md
[τα επίπεδα ένθεσης πέρα από 8]: ./sql-data-warehouse-develop-transactions.md
[ενημέρωση στις προβολές]: ./sql-data-warehouse-develop-views.md
[χρήση του, επιλέξτε για ανάθεση μεταβλητής]: ./sql-data-warehouse-develop-variable-assignment.md
[Τύπος δεδομένων χωρίς MAX για δυναμική συμβολοσειρών SQL]: ./sql-data-warehouse-develop-dynamic-sql.md

<!--MSDN references-->

<!--Other Web references-->

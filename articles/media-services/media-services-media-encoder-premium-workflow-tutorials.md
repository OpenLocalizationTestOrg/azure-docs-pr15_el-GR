<properties 
    pageTitle="Προγράμματα εκμάθησης Avanced Media Encoder Premium ροής εργασίας" 
    description="Αυτό το έγγραφο περιέχει αναλυτικές παρουσιάσεις που σας δείχνουν πώς μπορείτε να εκτελέσετε σύνθετες εργασίες με ροή εργασίας Premium κωδικοποιητή πολυμέσων, καθώς και πώς μπορείτε να δημιουργήσετε σύνθετες ροές εργασιών με το πρόγραμμα σχεδίασης ροής εργασίας." 
    services="media-services" 
    documentationCenter="" 
    authors="xstof" 
    manager="erikre" 
    editor=""/>

<tags 
    ms.service="media-services" 
    ms.workload="media" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="10/03/2016"  
    ms.author="xstof;xpouyat;juliako"/>

#<a name="advanced-media-encoder-premium-workflow-tutorials"></a>Προγράμματα εκμάθησης για προχωρημένους ροής εργασίας Premium κωδικοποιητή πολυμέσων

##<a name="overview"></a>Επισκόπηση 

Αυτό το έγγραφο περιέχει αναλυτικές παρουσιάσεις που σας δείχνουν πώς μπορείτε να προσαρμόσετε τις ροές εργασίας με το **Πρόγραμμα σχεδίασης ροής εργασίας**. Μπορείτε να βρείτε την πραγματική ροή εργασιών αρχεία [εδώ](https://github.com/Azure/azure-media-services-samples/tree/master/Encoding%20Presets/VoD/MediaEncoderPremiumWorkfows/PremiumEncoderWorkflowSamples).  

##<a name="toc"></a>ΠΊΝΑΚΑΣ ΠΕΡΙΕΧΟΜΈΝΩΝ

Καλύπτονται τα ακόλουθα θέματα:

- [Κωδικοποίηση MXF σε ένα μεμονωμένο ρυθμό μετάδοσης bit MP4](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4)
    - [Έναρξη νέας ροής εργασίας](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_start_new) 
    - [Χρήση της εισόδου αρχείων πολυμέσων](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_file_input)
    - [Επιθεώρηση ροές πολυμέσων](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_streams)
    - [Προσθήκη ενός βίντεο encoder για. Δημιουργία αρχείων mp4](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_file_generation)
    - [Κωδικοποίηση στη ροή ήχου](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_audio)
    - [Πολυπλεξία ροές ήχου και βίντεο σε ένα κοντέινερ MP4](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_audio_and_fideo)
    - [Εγγραφή του αρχείου MP4](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_writing_mp4)
    - [Δημιουργία ενός περιουσιακού στοιχείου υπηρεσίες πολυμέσων από το αρχείο εξόδου](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_asset_from_output)
    - [Δοκιμή ολοκληρωθεί ροής εργασίας τοπικά](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_test)
- [Κωδικοποίηση MXF σε multibitrate MP4s - δυναμικής συσκευασία με δυνατότητα](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging)
    - [Προσθήκη ενός ή περισσότερων πρόσθετων εξόδους MP4](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging_more_outputs)
    - [Ρύθμιση παραμέτρων τα ονόματα αρχείων εξόδου](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging_conf_output_names)
    - [Προσθήκη μια ξεχωριστή παρακολούθηση ήχου](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging_audio_tracks)
    - [Προσθήκη του. Αρχείο SMIL ISM](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging_ism_file)
- [Κωδικοποίηση MXF σε multibitrate MP4 - βελτιωμένο σχέδιο](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to__multibitrate_MP4)
    - [Επισκόπηση ροής εργασιών για τη βελτίωση](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to__multibitrate_MP4_overview)
    - [Συμβάσεις ονοματοδοσίας αρχείων](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to__multibitrate_MP4_file_naming)
    - [Ιδιότητες δημοσίευσης στοιχείων στον ριζικό κατάλογο της ροής εργασίας](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to__multibitrate_MP4_publishing)
    - [Έχετε που δημιουργούνται από το αρχείο εξόδου ονόματα που βασίζονται σε τιμές δημοσιευμένη ιδιοτήτων](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to__multibitrate_MP4_output_files)
- [Προσθήκη μικρογραφίες multibitrate MP4 εξόδου](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to__multibitrate_MP4)
    - [Επισκόπηση ροής εργασιών για να προσθέσετε μικρογραφίες για να](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to_multibitrate_MP4_overview)
    - [Προσθήκη JPG κωδικοποίηση](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to__multibitrate_MP4__with_jpg)
    - [Χειρισμός μετατροπή χώρου χρωμάτων](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to__multibitrate_MP4_color_space)
    - [Η σύνταξη των μικρογραφιών](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to__multibitrate_MP4_writing_thumbnails)
    - [Εντοπισμός σφαλμάτων σε μια ροή εργασίας](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to__multibitrate_MP4_errors)
    - [Εργασία ροής εργασίας](media-services-media-encoder-premium-workflow-tutorials.md#thumbnails_to__multibitrate_MP4_finish)
- [Βάσει χρόνου περικοπής multibitrate MP4 εξόδου](media-services-media-encoder-premium-workflow-tutorials.md#time_based_trim)
    - [Επισκόπηση ροής εργασιών για να ξεκινήσετε να προσθέτετε περικοπής για να](media-services-media-encoder-premium-workflow-tutorials.md#time_based_trim_start)
    - [Χρησιμοποιώντας τη μονάδα περικοπής ροής](media-services-media-encoder-premium-workflow-tutorials.md#time_based_trim_use_stream_trimmer)
    - [Εργασία ροής εργασίας](media-services-media-encoder-premium-workflow-tutorials.md#time_based_trim_finish)
- [Εισαγωγή στοιχείου δέσμης ενεργειών](media-services-media-encoder-premium-workflow-tutorials.md#scripting)
    - [Δέσμες ενεργειών σε μια ροή εργασίας: Χαίρετε](media-services-media-encoder-premium-workflow-tutorials.md#scripting_hello_world)
- [Βασίζεται στο πλαίσιο περικοπής multibitrate MP4 εξόδου](media-services-media-encoder-premium-workflow-tutorials.md#frame_based_trim)
    - [Επισκόπηση σχέδιο για να ξεκινήσετε να προσθέτετε περικοπής για να](media-services-media-encoder-premium-workflow-tutorials.md#frame_based_trim_start)
    - [Χρήση της λίστας Clip XML](media-services-media-encoder-premium-workflow-tutorials.md#frame_based_trim_clip_list)
    - [Τροποποίηση της λίστας clip από ένα στοιχείο δέσμης ενεργειών](media-services-media-encoder-premium-workflow-tutorials.md#frame_based_trim_modify_clip_list)
    - [Προσθήκη μια ιδιότητα ευκολία ClippingEnabled](media-services-media-encoder-premium-workflow-tutorials.md#frame_based_trim_clippingenabled_prop)

##<a id="MXF_to_MP4"></a>Κωδικοποίηση MXF σε ένα μεμονωμένο ρυθμό μετάδοσης bit MP4
 
Σε αυτές τις οδηγίες θα δημιουργήσουμε μια μεμονωμένη ρυθμό μετάδοσης bit. Αρχείο mp4 με AAC-HE κωδικοποιημένη ήχο από ένα. Το αρχείο εισαγωγής MXF. 

###<a id="MXF_to_MP4_start_new"></a>Έναρξη νέας ροής εργασίας 

Ανοίξτε το πρόγραμμα σχεδίασης ροής εργασίας και επιλέξτε "Αρχείο"-"νέο χώρο εργασίας"-"μετατρέπει σχέδιο" 

Η νέα ροή εργασίας θα εμφανίσει 3 στοιχεία: 

- Αρχείο προέλευσης πρωτεύοντος
- Λίστα clip XML
- Αρχείο εξόδου/περιουσιακών στοιχείων  

![Νέα ροή εργασίας κωδικοποίησης](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-transcode-blueprint.png)

*Νέα ροή εργασίας κωδικοποίησης*

###<a id="MXF_to_MP4_with_file_input"></a>Χρήση της εισόδου αρχείων πολυμέσων

Για να αποδεχθείτε το αρχείο εισαγωγής πολυμέσων, ένα ξεκινά με την προσθήκη ενός στοιχείου πολυμέσων αρχείου εισαγωγής. Για να προσθέσετε ένα στοιχείο της ροής εργασίας, αναζητήστε στο πλαίσιο αναζήτησης αποθετήριο και σύρετε την καταχώρηση που θέλετε στο παράθυρο σχεδίασης. Κάντε τα εξής για εισαγωγής αρχείων πολυμέσων και συνδέστε το στοιχείο πρωτεύον αρχείο προέλευσης με το όνομα του αρχείου εισαγωγής pin από εισαγωγής αρχείων πολυμέσων.

![Πολυμέσα συνδεδεμένου αρχείου εισαγωγής](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-file-input.png)

*Πολυμέσα συνδεδεμένου αρχείου εισαγωγής*

Πριν μπορούμε να κάνουμε ιδιαίτερα άλλο, θα σας θα πρέπει πρώτα να υποδείξετε στη Σχεδίαση ροής εργασίας τι δείγμα αρχείου που θα σας θα θέλατε να χρησιμοποιήσετε για να σχεδιάσετε τη ροή εργασίας με. Για να το κάνετε αυτό, κάντε κλικ στο φόντο του παραθύρου σχεδίασης και αναζητήστε την ιδιότητα πρωτεύον αρχείο προέλευσης στο παράθυρο ιδιοτήτων στα δεξιά. Κάντε κλικ στο εικονίδιο του φακέλου και επιλέξτε το επιθυμητό αρχείο για να ελέγξετε τη ροή εργασίας με. Μόλις το κάνετε αυτό, το στοιχείο εισαγωγής αρχείων πολυμέσων θα ελέγξετε το αρχείο και να συμπληρώσετε το PIN εξόδου, προκειμένου να αντικατοπτρίζει το αρχείο την επιθεώρηση.

![Εισαγωγή αρχείων συμπληρωμένη πολυμέσων](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-populated-media-file-input.png)

*Εισαγωγή αρχείων συμπληρωμένη πολυμέσων*

Ενώ καθορίζει με τι εισαγωγής θα σας θα θέλατε να εργαστείτε, αυτό δεν ενημερώνουν ακόμη το πού πρέπει να αποθηκεύονται τα κωδικοποιημένα εξόδου. Έχουν ρυθμιστεί οι παράμετροι παρόμοιο με το πώς το πρωτεύον αρχείο προέλευσης, τώρα ρύθμιση παραμέτρων την ιδιότητα εξόδου φάκελο μεταβλητής, ακριβώς κάτω από αυτό.

![Ρύθμιση παραμέτρων ιδιοτήτων εισόδου και εξόδου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-configured-io-properties.png)

*Ρύθμιση παραμέτρων ιδιοτήτων εισόδου και εξόδου*

###<a id="MXF_to_MP4_streams"></a>Επιθεώρηση ροές πολυμέσων

Συχνά περιλαμβάνει θέλετε να μάθετε πώς η ροή μοιάζει με ροών μέσω της ροής εργασίας. Για να ελέγξετε μια ροή σε οποιοδήποτε σημείο της ροής εργασίας, απλώς κάντε κλικ μια εξόδου ή εισόδου pin σε οποιοδήποτε από τα στοιχεία. Σε αυτήν την περίπτωση, δοκιμάστε να κάνετε κλικ στην το pin εξόδου αρχεία μη συμπιεσμένων βίντεο από μας εισαγωγής αρχείων πολυμέσων. Ένα παράθυρο διαλόγου θα ανοίξει προς τα επάνω, που σας επιτρέπει να ελέγξετε το εξερχόμενο βίντεο.

![Επιθεώρηση το pin εξόδου αρχεία μη συμπιεσμένων βίντεο](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-inspecting-uncompressed-video-output.png)

*Επιθεώρηση το pin εξόδου αρχεία μη συμπιεσμένων βίντεο*

Σε περίπτωση μας, ενημερώνει μας για παράδειγμα που θα σας χειρισμός μια εισαγωγής 1920 x 1080 στο 24 καρέ ανά δευτερόλεπτο στο 4: δειγματοληψία 2:2 για ένα βίντεο σχεδόν δύο λεπτά.

###<a id="MXF_to_MP4_file_generation"></a>Προσθήκη ενός βίντεο encoder για. Δημιουργία αρχείων mp4

Σημειώστε ότι τώρα, μια αρχεία μη συμπιεσμένων βίντεο και πολλά αριθμοί PIN εξόδου αρχεία μη συμπιεσμένων ήχου είναι διαθέσιμες για χρήση σε μας εισαγωγής αρχείων πολυμέσων. Για να κωδικοποιήσετε το εισερχόμενο βίντεο, χρειαζόμαστε ένα στοιχείο κωδικοποίησης - σε αυτήν την περίπτωση για τη δημιουργία. Αρχεία mp4.

Για να κωδικοποιήσετε τη ροή βίντεο για να H.264, προσθέστε το στοιχείο βίντεο Encoder AVC στην επιφάνεια σχεδίασης. Αυτό το στοιχείο λαμβάνει μια ροή βίντεο αποσυμπίεση ως είσοδο και προσφέρει μια AVC συμπιεσμένη ροή βίντεο στην το pin εξόδου.

![Αποσυνδεδεμένη Encoder AVC](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-unconnected-avc-encoder.png)

*Αποσυνδεδεμένη Encoder AVC*

Τις ιδιότητές καθορίζουν πώς γίνεται η κωδικοποίηση ακριβώς. Ας ρίξουμε μια ματιά σε κάποιες από τις πιο σημαντικές ρυθμίσεις:

- Αποτέλεσμα πλάτους και ύψους εξόδου: αυτά προσδιορίσετε την ανάλυση του κωδικοποιημένο βίντεο. Ας εξετάσουμε με 640 x 360 στην περίπτωσή μας
- Ρυθμός καρέ: Όταν οριστεί διέλευση του απλώς θα υιοθετήσουν το ρυθμό καρέ προέλευσης, είναι δυνατό να αντικαταστήσετε αυτό μέσω. Σημειώστε ότι η μετατροπή ταχύτητα καρέ είναι δεν κίνησης-αποζημίωση.
- Προφίλ και επίπεδο: αυτές τις καθορίζουν το επίπεδο και AVC προφίλ. Για να εύκολα να λάβετε περισσότερες πληροφορίες σχετικά με τα διάφορα επίπεδα και προφίλ, κάντε κλικ στο εικονίδιο αγγλικού ερωτηματικού στο στοιχείο κωδικοποιητή βίντεο AVC και σελίδας της Βοήθειας θα εμφανιστούν περισσότερες λεπτομέρειες σχετικά με κάθε ένα από τα επίπεδα. Για το δείγμα μας, ας εξετάσουμε με κύριες προφίλ στο επίπεδο 3,2 (προεπιλογή).
- Χαρακτηρισμός τον έλεγχο της λειτουργίας και ρυθμό μετάδοσης bit (kbps): σε μας σενάριο επιλέξετε για ένα σταθερό ρυθμό μετάδοσης bit (CBR) έξοδο κάθε 1200 kbps
- Μορφή βίντεο: αυτό είναι σχετικά με το VUI (πληροφορίες χρηστικότητας βίντεο) που λαμβάνει γραμμένο σε ροή H.264 (πλευρά πληροφορίες που μπορεί να χρησιμοποιείται από ένα αποκωδικοποιητή για να βελτιώσετε την εμφάνιση, αλλά δεν είναι απαραίτητα για σωστά αποκωδικοποιείτε):
- NTSC (τυπική για ΗΠΑ ή Ιαπωνία, χρησιμοποιώντας 30 fps)
- PAL (τυπική για την Ευρώπη, χρησιμοποιώντας 25 fps)
- Λειτουργία μέγεθος GOP: θα σας θα ρυθμίσετε τις παραμέτρους σταθερό μέγεθος GOP για τους σκοπούς μας με έναν αριθμό-κλειδί χρονικό διάστημα 2 δευτερόλεπτα με κλειστό GOPs. Αυτό εξασφαλίζει παρέχει συμβατότητας με τις υπηρεσίες πολυμέσων Azure δυναμικής συσκευασία.

Για να μας encoder AVC τροφοδοσίας συνδέσετε το pin εξόδου αρχεία μη συμπιεσμένων βίντεο από το στοιχείο εισαγωγής αρχείων πολυμέσων με το pin εισόδου αρχεία μη συμπιεσμένων βίντεο από τον κωδικοποιητή AVC.

![Συνδεδεμένο Encoder AVC](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-connected-avc-encoder.png)

*Συνδεδεμένο encoder κύριες AVC*

###<a id="MXF_to_MP4_audio"></a>Κωδικοποίηση στη ροή ήχου

Σε αυτό το σημείο, θα σας έχουν κωδικοποιημένη βίντεο, αλλά η αρχική αρχεία μη συμπιεσμένων ροή ήχου εξακολουθεί να πρέπει να συμπιεστεί. Για αυτό θα σας θα μεταβείτε με κωδικοποίηση AAC από το στοιχείο AAC Encoder (Dolby). Προσθέστε το με τη ροή εργασίας.

![Αποσυνδεδεμένη Encoder AVC](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-unconnected-aac-encoder.png)

*Αποσυνδεδεμένη encoder AAC*

Τώρα, υπάρχει μια ασυμβατότητα: δεν υπάρχει μόνο μία αρχεία μη συμπιεσμένων ήχου εισαγωγής pin από τον κωδικοποιητή AAC ενώ το πιθανότερο εισαγωγής αρχείων πολυμέσων θα έχει δύο διαφορετικά αρχεία μη συμπιεσμένων ήχου διαθέσιμη ροή: μία για το αριστερό κανάλι ήχου και μία για τα δεξιά. (Εάν χειρισμός περιβάλλοντα ήχο, που είναι 6 κανάλια.) Επομένως, δεν είναι δυνατή για απευθείας σύνδεση στον ήχο από το αρχείο προέλευσης εισαγωγής αρχείων πολυμέσων σε ο κωδικοποιητής ήχου AAC. Το στοιχείο AAC αναμένει λεγόμενες "διεμπλεκόμενο" ροή ήχου: μια μεμονωμένη ροή που έχει στα αριστερά και τα δεξιά κανάλια παρεμβαλλόμενα μεταξύ τους. Μόλις γνωρίζουμε από το αρχείο προέλευσης πολυμέσων ποια κομμάτια ήχου είναι σε ποια θέση στο αρχείο προέλευσης, μπορέσουμε να δημιουργήσουμε όπως διεμπλεκόμενο ροή ήχου με τις θέσεις που του έχουν ανατεθεί σωστά ομιλητή για αριστερά και δεξιά.

Πρώτα ένα θέλετε να που δημιουργούνται διεμπλεκόμενο ροή ενός από τα κανάλια ήχου απαιτείται προέλευσης. Το στοιχείο Interleaver ροή ήχου θα χειρίζεται αυτό για μας. Προσθέστε τη με τη ροή εργασίας και σύνδεση εξόδους του ήχου από την είσοδο του αρχείου πολυμέσων σε αυτήν.

![Συνδεδεμένο Interleaver ροή ήχου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-connected-audio-stream-interleaver.png)

*Συνδεδεμένο Interleaver ροή ήχου*

Τώρα που έχουμε μια διεμπλεκόμενο ροή ήχου, θα σας εξακολουθούν να δεν Καθορίστε τη θέση των θέσεων ομιλητή προς τα αριστερά ή δεξιά για να εκχωρήσετε. Για να καθορίσετε αυτό, θα σας να αξιοποιήσετε το ηχείο Assigner θέση.

![Προσθήκη μιας Assigner θέση ομιλητή](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-adding-speaker-position-assigner.png)

*Προσθήκη μιας Assigner θέση ομιλητή*

Μπορείτε να ρυθμίσετε τις παραμέτρους του Assigner θέση ομιλητή για χρήση με ένα στερεοφωνικού ροή δεδομένων εισόδου μέσω ενός φίλτρου προκαθορισμένες Encoder "Προσαρμογή" και το κανάλι προκαθορισμένες που ονομάζεται "2.0 (L, R)". (Αυτό θα εκχωρήσετε κανάλι 1 στη θέση αριστερό ηχείο και τη θέση δεξιά ομιλητή κανάλι 2.)

Συνδέστε το αποτέλεσμα του ομιλητή Assigner θέση για την είσοδο του κωδικοποιητή AAC. Στη συνέχεια, πείτε ο κωδικοποιητής AAC για να εργαστείτε με μια "2.0 (L, R)" προκαθορισμένες καναλιού, ώστε να μάθει να ασχοληθείτε με στερεοφωνικού ήχου ως είσοδο.

###<a id="MXF_to_MP4_audio_and_fideo"></a>Πολυπλεξία ροές ήχου και βίντεο σε ένα κοντέινερ MP4

Η δεδομένη μας AVC κωδικοποιημένο ροή βίντεο και μας AAC κωδικοποιημένη ροή ήχου, θα σας μπορούν να καταγράφουν και τα δύο σε μια. Mp4 κοντέινερ. Η διαδικασία ανάμιξη διαφορετικές ροές σε ένα μεμονωμένο ονομάζεται "Πολυπλεξία" (ή "muxing"). Σε αυτήν την περίπτωση θα σας παρεμβολή στον ήχο και το βίντεο ροών σε μία σκηνικό. Το πακέτο mp4. Το στοιχείο που συντεταγμένες για μια. Κοντέινερ mp4 ονομάζεται το Πολυπλέκτης ISO MPEG-4. Προσθέστε ένα στην επιφάνεια σχεδίασης και σύνδεση ο κωδικοποιητής βίντεο AVC και ο κωδικοποιητής AAC με τα στοιχεία εισόδου.

![Συνδεδεμένο MPEG4 Πολυπλέκτης](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-connected-mpeg4-multiplexer.png)

*Συνδεδεμένο MPEG4 Πολυπλέκτης*

###<a id="MXF_to_MP4_writing_mp4"></a>Εγγραφή του αρχείου MP4

Όταν συντάσσετε ένα αρχείο εξόδου, χρησιμοποιείται το στοιχείο αρχείο εξόδου. Θα σας να συνδεθείτε αυτό το αποτέλεσμα του Πολυπλέκτης ISO MPEG-4, έτσι ώστε τα αποτελέσματά λαμβάνει γραμμένο σε δίσκο. Για να το κάνετε αυτό, συνδέστε το pin εξόδου κοντέινερ (MPEG-4) για να το pin εισόδου εγγραφής από το αρχείο εξόδου.

![Συνδεδεμένο αρχείο εξόδου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-connected-file-output.png)

*Συνδεδεμένο αρχείο εξόδου*

Το όνομα του αρχείου που θα χρησιμοποιηθεί καθορίζεται από την ιδιότητα του αρχείου. Ενώ αυτή την ιδιότητα μπορεί να είναι κωδικοποιημένη για να μια τιμή που δίνεται, πιθανότατα μία θα θέλετε να ορίσετε μέσω μιας παράστασης.

Για να τη ροή εργασίας να προσδιορίσουν αυτόματα το αποτέλεσμα αρχείων ιδιότητα όνομα από μια παράσταση, κάντε κλικ στην επιλογή το buton δίπλα στο όνομα αρχείου (δίπλα στο εικονίδιο του φακέλου). Από το αναπτυσσόμενο μενού, στη συνέχεια, επιλέξτε "Παράσταση". Αυτό θα εμφανιστεί το πρόγραμμα επεξεργασίας παράσταση. Πρώτα, καταργήστε τα περιεχόμενα του προγράμματος επεξεργασίας.

![Κενή παράσταση επεξεργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-empty-expression-editor.png)

*Κενή παράσταση επεξεργασίας*

Πρόγραμμα επεξεργασίας παράσταση σας επιτρέπει να εισαγάγετε οποιαδήποτε τιμή λεκτικής σταθεράς, μεικτή με μία ή περισσότερες μεταβλητές. Μεταβλητές Ξεκινήστε με ένα σύμβολο δολαρίου. Καθώς πατήσετε το πλήκτρο $, το πρόγραμμα επεξεργασίας θα εμφανιστεί ένα πλαίσιο αναπτυσσόμενης λίστας με μια επιλογή διαθέσιμη μεταβλητών. Σε περίπτωση μας θα χρησιμοποιήσουμε ένα συνδυασμό η μεταβλητή εξόδου του καταλόγου και η μεταβλητή όνομα αρχείου εισαγωγής βάσης:

    ${ROOT_outputWriteDirectory}\\${ROOT_sourceFileBaseName}.MP4

![Γέμισμα ανάληψη πρόγραμμα επεξεργασίας παραστάσεων](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-expression-editor.png)

*Γέμισμα ανάληψη πρόγραμμα επεξεργασίας παραστάσεων*

>[AZURE.NOTE]Για να βλέπετε τα δείτε ένα αρχείο εξόδου μιας εργασίας κωδικοποίησης στο Azure, πρέπει να δώσετε μια τιμή στο πρόγραμμα επεξεργασίας παράσταση. 

Όταν επιβεβαιώσετε την παράσταση με πάτημα ok, θα προεπισκόπηση του παραθύρου ιδιοτήτων για την τιμή σε αυτό το σημείο στο φορά ο αναλύεται ιδιοτήτων αρχείου.

![Αρχείο παράστασης είναι dir εξόδου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-file-expression-resolves-output-dir.png)

*Αρχείο παράστασης είναι dir εξόδου*

###<a id="MXF_to_MP4_asset_from_output"></a>Δημιουργία ενός περιουσιακού στοιχείου υπηρεσίες πολυμέσων από το αρχείο εξόδου

Ενώ θα σας έχουν εγγραφεί ένα αρχείο εξόδου MP4, εξακολουθεί να πρέπει να υποδείξετε ότι αυτό το αρχείο ανήκει σε παγίου εξόδου που θα δημιουργήσει υπηρεσίες πολυμέσων ως αποτέλεσμα την εκτέλεση αυτής της ροής εργασίας. Για το σκοπό αυτό, χρησιμοποιείται ο κόμβος αρχείο εξόδου/περιουσιακών στοιχείων στον καμβά ροής εργασίας. Όλα τα εισερχόμενα αρχεία σε αυτόν τον κόμβο θα κάνει τμήμα του περιουσιακού στοιχείου που προκύπτει υπηρεσιών Azure Media Services.

Συνδέστε το στοιχείο αρχείο εξόδου στο στοιχείο αρχείο εξόδου/περιουσιακού στοιχείου για να ολοκληρώσετε τη ροή εργασίας.

![Εργασία ροής εργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-finished-workflow.png)

*Εργασία ροής εργασίας*

###<a id="MXF_to_MP4_test"></a>Δοκιμή ολοκληρωθεί ροής εργασίας τοπικά

Για να ελέγξετε τη ροή εργασίας τοπικά, πατήστε το κουμπί αναπαραγωγή από τη γραμμή εργαλείων στο επάνω μέρος. Όταν η ροή εργασίας ολοκληρωθεί η εκτέλεση, έλεγχος την έξοδο που δημιουργείται στο φάκελο ρυθμισμένο εξόδου. Θα δείτε το τελικό αρχείο εξόδου MP4 που έχει κωδικοποιηθεί από το αρχείο προέλευσης εισαγωγής MXF.

##<a id="MXF_to_MP4_with_dyn_packaging"></a>Κωδικοποίηση MXF σε MP4 - multibitrate με δυνατότητα δυναμικής συσκευασία

Σε αυτές τις οδηγίες θα δημιουργήσουμε ένα σύνολο από πολλά αρχεία MP4 ρυθμό μετάδοσης bit με AAC κωδικοποίηση ήχου από ένα ενιαίο. Το αρχείο εισαγωγής MXF.

Όταν ένα αποτέλεσμα περιουσιακών στοιχείων πολλούς-ρυθμό μετάδοσης bit είναι επιθυμητό για χρήση σε συνδυασμό με τις δυνατότητες δυναμικής συσκευασία που παρέχεται από υπηρεσιών Azure Media Services, πολλαπλά αρχεία MP4 στοίχιση GOP κάθε θα πρέπει να δημιουργηθεί ένα διαφορετικό ρυθμό μετάδοσης bit και ανάλυση. Για να το κάνετε αυτό, η [Κωδικοποίηση MXF σε ένα μεμονωμένο ρυθμό μετάδοσης bit MP4](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4) οδηγίες μας παρέχει ένα καλό σημείο εκκίνησης.

![Έναρξη ροής εργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-starting-workflow.png)

*Έναρξη ροής εργασίας*

###<a id="MXF_to_MP4_with_dyn_packaging_more_outputs"></a>Προσθήκη ενός ή περισσότερων πρόσθετων εξόδους MP4

Κάθε αρχείο MP4 μας που προκύπτει περιουσιακών στοιχείων των υπηρεσιών Azure Media Services θα υποστηρίζει ένα διαφορετικό ρυθμό μετάδοσης bit και ανάλυση. Προσθέστε ένα ή περισσότερα αρχεία εξόδου MP4 με τη ροή εργασίας.

Για να βεβαιωθείτε ότι έχουμε όλους τους κωδικοποιητές βίντεο δημιουργήθηκε με τις ίδιες ρυθμίσεις, είναι πιο εύκολη η αναπαραγωγή ήδη υπάρχον κωδικοποιητή βίντεο AVC και ρύθμιση παραμέτρων άλλο συνδυασμό ανάλυση και το ρυθμό μετάδοσης bit (ας προσθέσουμε μία από 960 x 540 στο 25 καρέ ανά δευτερόλεπτο στα 2,5 Mbps). Για να αναπαραγάγετε την υπάρχουσα κωδικοποιητή, αντιγράψτε το επικολλήσετε στην επιφάνεια σχεδίασης.

Συνδέστε το pin εξόδου αρχεία μη συμπιεσμένων βίντεο της εισόδου αρχείων πολυμέσων σε μας νέο στοιχείο AVC.

![Δεύτερο AVC encoder συνδεδεμένοι](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-second-avc-encoder-connected.png)

*Δεύτερο AVC encoder συνδεδεμένοι*

Τώρα να προσαρμόσετε τη ρύθμιση παραμέτρων για το νέο encoder AVC για να εξαγάγετε 960 x 540 στα 2,5 Mbps. (Χρησιμοποιήστε τις ιδιότητες "πλάτος εξόδου", "Εξόδου ύψος" και "Ρυθμός μετάδοσης bit (kbps)" για αυτό.)

Δεδομένο θέλουμε να χρησιμοποιήσετε που προκύπτει παγίου μαζί με υπηρεσιών Azure Media Services των δυναμικών συσκευασία, το τελικό σημείο ροής πρέπει να είναι σε θέση να παράγει από αυτά τα αρχεία MP4 τμήματα MP4 HLS/Fragmented/ΠΑΎΛΑΣ που στοιχίζονται ακριβώς μεταξύ τους με τρόπο που προγράμματα-πελάτες που εναλλαγή ανάμεσα σε διαφορετικές bitrates λάβετε ένα μεμονωμένο ομαλή συνεχής βίντεο και εμπειρία ήχου. Για να κάνετε που πραγματοποιούνται, πρέπει να διασφαλίσετε ότι, στις ιδιότητες και τα δύο κωδικοποιητές AVC το GOP ("ομάδα εικόνων") μέγεθος για τα αρχεία και τα δύο MP4 έχει οριστεί σε 2 δευτερόλεπτα, τα οποία μπορούν να γίνουν με:

- ρύθμιση της λειτουργίας μέγεθος GOP GOP σταθερό μέγεθος και
- το χρονικό πλαίσιο αριθμού-κλειδιού σε δύο δευτερόλεπτα.
- επίσης να ορίσετε το στοιχείο ελέγχου IDR GOP να κλείσει GOP για να βεβαιωθείτε ότι όλα GOP μόνιμη μόνος χωρίς εξαρτήσεις

Για να κάνετε πιο εύκολο να κατανοήσετε τη ροή εργασίας, μετονομάστε την πρώτη encoder AVC σε "κωδικοποιητή βίντεο AVC 640 x 360 1200kbps" και το δεύτερο κωδικοποιητή AVC "κωδικοποιητή βίντεο AVC 960 x 540 2500 kbps".

Προσθέστε τώρα μια δεύτερη Πολυπλέκτης ISO MPEG-4 και ένα δεύτερο αρχείο εξόδου. Σύνδεση του Πολυπλέκτης με το νέο encoder AVC και βεβαιωθείτε ότι τα αποτελέσματά απευθύνεται σε το αποτέλεσμα του αρχείου. Στη συνέχεια, συνδεθείτε επίσης το AAC κωδικοποίησης ήχου εξόδου στο νέο Πολυπλέκτης της εισαγωγής. Το αποτέλεσμα του αρχείου με τη σειρά μπορεί, στη συνέχεια, να συνδεθεί με τον κόμβο αρχείο εξόδου/περιουσιακού στοιχείου για να το προσθέσετε στο πάγιο υπηρεσίες πολυμέσων που θα δημιουργηθεί.

![Δεύτερο Muxer και το αποτέλεσμα του αρχείου συνδεδεμένοι](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-second-muxer-file-output-connected.png)

*Δεύτερο Muxer και το αποτέλεσμα του αρχείου συνδεδεμένοι*

Για συμβατότητα με δυναμική συσκευασία των υπηρεσιών Azure Media Services, ρύθμιση παραμέτρων του Πολυπλέκτης λειτουργίας μπλοκ πλήθος GOP ή διάρκεια και ορίστε την GOPs ανά μπλοκ σε 1. (Αυτή είναι η προεπιλεγμένη.)

![Λειτουργίες Muxer μπλοκ](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-muxer-chunk-modes.png)

*Λειτουργίες Muxer μπλοκ*

Σημείωση: μπορείτε να επαναλάβετε τη διαδικασία για τους υπόλοιπους ρυθμό μετάδοσης bit και ανάλυση συνδυασμούς που θέλετε να προσθέσετε στο αποτέλεσμα του περιουσιακού στοιχείου.

###<a id="MXF_to_MP4_with_dyn_packaging_conf_output_names"></a>Ρύθμιση παραμέτρων τα ονόματα αρχείων εξόδου

Έχουμε περισσότερα από ένα μόνο αρχείο προστεθεί παγίου εξόδου. Αυτή η δυνατότητα παρέχει ένα πρέπει να βεβαιωθείτε ότι τα ονόματα αρχείων για κάθε ένα από τα αρχεία εξόδου είναι διαφορετικές μεταξύ τους και ίσως ακόμα και να εφαρμόσετε μια σύμβαση ονομασίας, ώστε να μετατραπεί Απαλοιφή από το όνομα του αρχείου τι που ενδιαφέρει.

Αρχείο εξόδου ονομασία μπορεί να ελέγχεται μέσω παραστάσεων στη σχεδίαση. Ανοίξτε το παράθυρο ιδιοτήτων για ένα από τα στοιχεία αρχείο εξόδου και ανοίξτε το πρόγραμμα επεξεργασίας παράσταση για την ιδιότητα του αρχείου. Το πρώτο αρχείο εξόδου έχουν ρυθμιστεί οι παράμετροι έως την ακόλουθη παράσταση (ανατρέξτε στο θέμα το πρόγραμμα εκμάθησης για τη μετάβαση από [MXF σε ένα μεμονωμένο ρυθμό μετάδοσης bit MP4 εξόδου](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4)):

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}.MP4

Αυτό σημαίνει ότι το όνομα του αρχείου προσδιορίζεται από δύο μεταβλητές: ο κατάλογος εξόδου για να γράψετε και το όνομα βάσης του αρχείου προέλευσης. Οι πρώτες εκτίθεται ως μια ιδιότητα στη ρίζα της ροής εργασίας και το τελευταίο προσδιορίζεται από το εισερχόμενο αρχείο. Σημειώστε ότι ο κατάλογος εξόδου είναι τα στοιχεία που χρησιμοποιείτε για τον τοπικό έλεγχο; Αυτή η ιδιότητα θα αντικατασταθούν από το μηχανισμό ροής εργασίας, όταν η ροή εργασίας εκτελείται από τον επεξεργαστή πολυμέσων που βασίζεται στο cloud στο υπηρεσιών Azure Media Services.
Για να δώσετε και τα δύο μας αρχεία εξόδου μια ονομασία συνεπή εξόδου, αλλάξτε το πρώτο αρχείο ονομασία παράσταση για να:

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_640x360_1.MP4

και το δεύτερο για να:

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_960x540_2.MP4

Εκτελέστε μια ενδιάμεση δοκιμής για να βεβαιωθείτε ότι και τα δύο αρχεία εξόδου MP4 δημιουργούνται σωστά.

###<a id="MXF_to_MP4_with_dyn_packaging_audio_tracks"></a>Προσθήκη μια ξεχωριστή παρακολούθηση ήχου

Όπως παρουσιάζεται ο αργότερα όταν θα σας δημιουργούν ένα αρχείο .ism για να μεταβείτε με τα αρχεία μας MP4 εξόδου, θα σας θα απαιτούν επίσης ένα αρχείο MP4 μόνο ήχου ως το κομμάτι ήχου για μας προσαρμόσιμη ροής. Για να δημιουργήσετε αυτό το αρχείο, προσθέστε μια επιπλέον muxer με τη ροή εργασίας (Πολυπλέκτης ISO-MPEG-4) και σύνδεση pin εξόδου του κωδικοποιητή AAC με το pin εισόδου για παρακολούθηση 1.

![Ήχου Muxer προστεθεί](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-audio-muxer-added.png)

*Ήχου Muxer προστεθεί*

Δημιουργήστε έναν τρίτο στοιχείο αρχείο εξόδου εξόδου εξερχομένων ροής από το muxer και ρύθμισης παραμέτρων του αρχείου ονομασία παράσταση ως:
    
    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_128kbps_audio.MP4

![Ήχου Muxer τη δημιουργία αρχείο εξόδου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-audio-muxer-creating-file-output.png)

*Ήχου Muxer τη δημιουργία αρχείο εξόδου*

###<a id="MXF_to_MP4_with_dyn_packaging_ism_file"></a>Προσθήκη του. Αρχείο SMIL ISM

Για τη δυναμική συσκευασία ώστε να λειτουργεί σε συνδυασμό με MP4 αρχεία (και το MP4 μόνο ήχου) στο μας περιουσιακών στοιχείων Media Services, χρειαζόμαστε επίσης ένα αρχείο δηλώσεων (ονομάζεται επίσης ένα αρχείο "SMIL": συγχρονίζονται γλώσσας ενοποίησης πολυμέσα). Αυτό το αρχείο υποδεικνύει την υπηρεσιών Azure Media Services ποια αρχεία MP4 είναι διαθέσιμες για δυναμική συσκευασία και ποιες από αυτές για να λάβετε υπόψη σας για τη ροή ήχου. Ένα τυπικό αρχείο δηλώσεων για ένα σύνολο του MP4 με μια μεμονωμένη ροή ήχου μοιάζει κάπως έτσι:
    
    <?xml version="1.0" encoding="utf-8" standalone="yes"?>
    <smil xmlns="http://www.w3.org/2001/SMIL20/Language">
      <head>
        <meta name="formats" content="mp4" />
      </head>
      <body>
        <switch>
          <video src="H264_1900kbps_AAC_und_ch2_96kbps.mp4" />
          <video src="H264_1300kbps_AAC_und_ch2_96kbps.mp4" />
          <video src="H264_900kbps_AAC_und_ch2_96kbps.mp4" />
          <audio src="AAC_ch2_96kbps.mp4" title="AAC_und_ch2_96kbps" />
        </switch>
      </body>
    </smil>

Το αρχείο .ism περιέχει μέσα σε μια πρόταση αλλαγής, μια αναφορά σε καθένα από τα μεμονωμένα αρχεία βίντεο MP4 και εκτός από αυτές τις αναφορές αρχείου ήχου επίσης ένα (ή περισσότερα) με ένα MP4 που περιέχει μόνο το αρχείο ήχου.

Δημιουργία αρχείο δήλωσης για το σύνολο του MP4 μπορεί να γίνει μέσω ενός στοιχείου που ονομάζεται "Αθροιστικής μέτρησης ενισχύσεων δήλωσης εγγραφής της". Για να χρησιμοποιήσετε, σύρετέ το στην επιφάνεια και συνδέστε το "Εγγραφή ολοκλήρωσης" αριθμοί PIN εξόδου από τα τρία στοιχεία αρχείο εξόδου με την είσοδο αθροιστικής μέτρησης ενισχύσεων δήλωσης εγγραφής. Στη συνέχεια, βεβαιωθείτε ότι έχετε σύνδεση το αποτέλεσμα της δήλωσης εγγραφής της αθροιστικής μέτρησης ενισχύσεων για να το αποτέλεσμα του αρχείου/περιουσιακών στοιχείων.

Όπως συμβαίνει με τα άλλα αρχείο εξόδου στοιχεία, ρυθμίστε το όνομα .ism αρχείο εξόδου με μια παράσταση:

    ${ROOT_outputWriteDirectory}\\${ROOT_sourceFileBaseName}_manifest.ism

Μας εργασία ροής εργασίας που μοιάζει με το κάτω από:

![Ολοκληρωμένη MXF με ροή εργασίας MP4 multibitrate](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-finished-mxf-to-multibitrate-mp4-workflow.png)

*Ολοκληρωμένη MXF με ροή εργασίας MP4 multibitrate*

##<a id="MXF_to__multibitrate_MP4"></a>Κωδικοποίηση MXF σε multibitrate MP4 - βελτιωμένο σχέδιο

Σε την [προηγούμενη ροής εργασίας αναλυτικές οδηγίες](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging) θα σας έχετε δει πώς ένα μεμονωμένο περιουσιακών στοιχείων εισαγωγής MXF μπορεί να μετατραπεί σε ενός περιουσιακού στοιχείου εξόδου με αρχεία MP4 πολλούς-ρυθμό μετάδοσης bit, ένα αρχείο MP4 μόνο ήχου και ένα αρχείο δήλωσης για χρήση σε συνδυασμό με δυναμική συσκευασία των υπηρεσιών Azure Media Services.

Αυτόν τον οδηγό θα εμφανίσει τον τρόπο ορισμένα από τα στοιχεία μπορούν να βελτιωμένη και κάνει πιο εύκολη.

###<a id="MXF_to_multibitrate_MP4_overview"></a>Επισκόπηση ροής εργασιών για τη βελτίωση

![Βελτίωση της ροής εργασιών Multibitrate MP4](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-multibitrate-mp4-workflow-to-enhance.png)

*Βελτίωση της ροής εργασιών Multibitrate MP4*

###<a id="MXF_to__multibitrate_MP4_file_naming"></a>Συμβάσεις ονοματοδοσίας αρχείων

Στην προηγούμενη ροής εργασίας σας που καθορίζεται μια απλή παράσταση ως βάση για την παραγωγή ονομάτων αρχείο εξόδου. Έχουμε ορισμένες αναπαραγωγής μέσω: όλα τα τα στοιχεία εξόδου μεμονωμένων αρχείων όπως παράσταση που καθορίζεται.

Για παράδειγμα, το στοιχείο αρχείο εξόδου για το πρώτο αρχείο βίντεο έχει ρυθμιστεί με αυτήν την παράσταση:

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_640x360_1.MP4

Για το δεύτερο αποτέλεσμα του βίντεο, έχουμε μια παράσταση όπως:

    ${ROOT_outputWriteDirectory}\\${ROOT_sourceFileBaseName}_960x540_2.MP4

Δεν θα ήταν πιο καθαρή, λιγότερο ευνοεί και πιο εύχρηστη εάν θα μπορούσε να κατάργηση ορισμένων αυτό αναπαραγωγής και κάνετε πράγματα πιο με δυνατότητα ρύθμισης παραμέτρων αντί για αυτό το σφάλμα; Ευτυχώς μπορούμε: δυνατότητες παράσταση στη σχεδίαση σε συνδυασμό με τη δυνατότητα να δημιουργήσετε προσαρμοσμένες ιδιότητες σε μας ριζικό κατάλογο της ροής εργασίας θα σας δώσει μας πρόσθετο επίπεδο με ευκολία.

Ας υποθέσουμε ότι θα σας θα καθοδηγούν ρύθμισης παραμέτρων όνομα αρχείου από το bitrates των μεμονωμένων αρχείων MP4. Αυτές οι bitrates που θα σας θα στόχος για να ρυθμίσετε τις παραμέτρους σε ένα κεντρικό σημείο (στη ρίζα της μας γραφήματος), από όπου θα είναι πρόσβαση για τη ρύθμιση παραμέτρων και δημιουργία ονομάτων αρχείων μονάδα δίσκου. Για να το κάνετε αυτό, θα σας Έναρξη, δημοσιεύοντάς την ιδιότητα ρυθμό μετάδοσης bit από δύο κωδικοποιητές AVC στη ρίζα της μας ροή εργασίας, ώστε να γίνει προσβάσιμα από δύο το ριζικό κατάλογο καθώς και από το κωδικοποιητές AVC. (Ακόμα και αν εμφανίζεται σε δύο διαφορετικά σημεία, υπάρχει μόνο μία τιμή υποκείμενα.)

###<a id="MXF_to__multibitrate_MP4_publishing"></a>Ιδιότητες δημοσίευσης στοιχείων στον ριζικό κατάλογο της ροής εργασίας

Ανοίξτε το πρώτο encoder AVC, μεταβείτε στην ιδιότητα ρυθμό μετάδοσης bit (kbps) και από την αναπτυσσόμενη λίστα, επιλέξτε δημοσίευση.

![Δημοσίευση της ιδιότητας ρυθμό μετάδοσης bit](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-publishing-bitrate-property.png)

*Δημοσίευση της ιδιότητας ρυθμό μετάδοσης bit*

Ρυθμίστε το παράθυρο διαλόγου δημοσίευση να δημοσιεύσετε το ριζικό κατάλογο της μας graph ροής εργασίας, με ένα δημοσιευμένο όνομα "video1bitrate" και ένα ευανάγνωστο εμφανιζόμενο όνομα του "Ρυθμό μετάδοσης 1 βίντεο bit". Ρύθμιση παραμέτρων ένα προσαρμοσμένο όνομα ομάδας που ονομάζεται "Bitrates ροής" και πατήστε δημοσίευση.

![Δημοσίευση της ιδιότητας ρυθμό μετάδοσης bit](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-publishing-dialog-for-bitrate-property.png)

*Παράθυρο διαλόγου "δημοσίευσης" για την ιδιότητα ρυθμό μετάδοσης bit*

Επαναλάβετε την ίδια για την ιδιότητα ρυθμό μετάδοσης bit του δεύτερου κωδικοποιητή AVC και ονομάστε το "video2bitrate" με το εμφανιζόμενο όνομα "Βίντεο 2 ρυθμό μετάδοσης bit", στην ίδια προσαρμοσμένη ομάδα "Ροή Bitrates".

Εάν σας τώρα έλεγχος των ιδιοτήτων ριζικό κατάλογο της ροής εργασίας, παρουσιάζεται μας προσαρμοσμένη ομάδα με τις δύο δημοσιευμένη ιδιότητες που εμφανίζονται. Και τα δύο αναλογιστείτε με την τιμή του τους ρυθμό μετάδοσης encoder αντίστοιχα AVC bit.

![Περίπτερου δημοσιευμένη ρυθμό μετάδοσης bit στη ρίζα της ροής εργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-published-bitrate-props-on-workflow-root.png)

Κάθε φορά που θέλουμε να αποκτήσετε πρόσβαση σε αυτές τις ιδιότητες από κώδικα ή από μια παράσταση, μπορούμε να κάνουμε αυτό ως εξής:

- από τον ενσωματωμένο κώδικα από ένα στοιχείο ακριβώς κάτω από το ριζικό κατάλογο: node.getPropertyAsString('.. / video1bitrate', null)
- μέσα σε μια παράσταση: ${ROOT_video1bitrate}
 
Ας ολοκληρώστε την ομάδα "Bitrates ροής", δημοσιεύοντάς μας κομματιού ρυθμό μετάδοσης bit το καθώς και. Εντός των ιδιοτήτων ο κωδικοποιητής AAC, αναζήτηση για τη ρύθμιση ρυθμό μετάδοσης bit και επιλέξτε δημοσίευση από την αναπτυσσόμενη λίστα δίπλα της. Δημοσίευση στον ριζικό κατάλογο του γραφήματος με το όνομα "audio1bitrate" και εμφανιζόμενο όνομα "Ρυθμό μετάδοσης 1 ήχου bit" μέσα σε μας "Bitrates ροής" προσαρμοσμένη ομάδα.

![Παράθυρο δημοσίευσης για το ρυθμό μετάδοσης bit ήχου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-publishing-dialog-for-audio-bitrate.png)

*Παράθυρο δημοσίευσης για το ρυθμό μετάδοσης bit ήχου*

![Που προκύπτει περίπτερου βίντεο και ήχου στη ρίζα](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-resulting-video-and-audio-props-on-root.png)

*Που προκύπτει περίπτερου βίντεο και ήχου στη ρίζα*

Σημειώστε ότι η αλλαγή οποιασδήποτε από αυτές τις τρεις τιμές επίσης εκ νέου ρυθμίζει τις παραμέτρους και αλλάζει τις τιμές σε τα αντίστοιχα στοιχεία που είναι συνδεδεμένα με (και το σημείο όπου δημοσιεύτηκε από).

###<a id="MXF_to__multibitrate_MP4_output_files"></a>Έχετε που δημιουργούνται από το αρχείο εξόδου ονόματα που βασίζονται σε τιμές δημοσιευμένη ιδιοτήτων

Αντί να hardcoding μας ονόματα αρχείου που έχει δημιουργηθεί, μπορεί να τώρα αλλάξουμε μας παράσταση όνομα αρχείου σε καθένα από τα στοιχεία αρχείο εξόδου να βασίζονται στις ιδιότητες ρυθμό μετάδοσης bit που δημοσιεύτηκε μόνο στη ρίζα graph. Ξεκινώντας με το πρώτο αρχείο εξόδου, βρείτε την ιδιότητα του αρχείου και επεξεργαστείτε την παράσταση ως εξής:

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_${ROOT_video1bitrate}kbps.MP4

Τις διαφορετικές παραμέτρους σε αυτήν την παράσταση μπορεί να είναι δυνατή η πρόσβαση και να που εισάγονται από το σύμβολο δολαρίου στο πληκτρολόγιο ενώ βρίσκεστε στο παράθυρο παράσταση πάτημα. Μία από τις διαθέσιμες παραμέτρους είναι μας ιδιότητας video1bitrate, η οποία που δημοσιεύτηκε νωρίτερα.

![Πρόσβαση σε παραμέτρους μέσα σε μια παράσταση](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-accessing-parameters-within-an-expression.png)

*Πρόσβαση σε παραμέτρους μέσα σε μια παράσταση*

Κάντε το ίδιο για το αποτέλεσμα του αρχείου για το δεύτερο βίντεο:

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_${ROOT_video2bitrate}kbps.MP4

και για το αποτέλεσμα του αρχείου μόνο ήχου:

    ${ROOT_outputWriteDirectory}\${ROOT_sourceFileBaseName}_${ROOT_audio1bitrate}bps_audio.MP4

Εάν αλλάξουμε τώρα το ρυθμό μετάδοσης bit για οποιοδήποτε από τα αρχεία βίντεο ή ήχου, τα αντίστοιχα encoder θα ρυθμιστούν και της σύμβασης όνομα αρχείου με βάση το ρυθμό μετάδοσης bit θα εξακολουθήσουν να ισχύουν όλα γίνονται αυτόματα.

##<a id="thumbnails_to__multibitrate_MP4"></a>Προσθήκη μικρογραφίες multibitrate MP4 εξόδου

Ξεκινώντας από μια ροή εργασίας που δημιουργεί [μια multibitrate MP4 Έξοδος από μια MXF εισαγωγής](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging), θα σας θα τώρα να ανατρέξουν στο Προσθήκη μικρογραφιών στο αποτέλεσμα.

###<a id="thumbnails_to__multibitrate_MP4_overview"></a>Επισκόπηση ροής εργασιών για να προσθέσετε μικρογραφίες για να

![Multibitrate MP4 ροής εργασίας για να ξεκινήσετε από](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-multibitrate-mp4-workflow-to-start-from.png)

*Multibitrate MP4 ροής εργασίας για να ξεκινήσετε από*

###<a id="thumbnails_to__multibitrate_MP4__with_jpg"></a>Προσθήκη JPG κωδικοποίηση

Η καρδιά μας μικρογραφιών γενιά θα είναι το στοιχείο JPG Encoder, μπορείτε να εξαγάγετε αρχεία JPG.

![JPG Encoder](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-jpg-encoder.png)

*JPG Encoder*

Ωστόσο απευθείας, θα σας δεν μπορεί να συνδεθεί μας ροή αρχεία μη συμπιεσμένων βίντεο από την είσοδο του αρχείου πολυμέσων σε ο κωδικοποιητής JPG. Αντί για αυτό, που θεωρεί ότι θα παραδίδονται μεμονωμένα καρέ. Αυτό, μπορούμε να κάνουμε μέσω του στοιχείου πύλη πλαισίου βίντεο.

![Σύνδεση μια πύλη πλαισίου με τον κωδικοποιητή JPG](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-connect-frame-gate-to-jpg-encoder.png)

*Σύνδεση μια πύλη πλαισίου με τον κωδικοποιητή JPG*

Η πύλη του πλαισίου μία φορά κάθε τόσα δευτερόλεπτα ή πλαίσια επιτρέπει πλαισίου βίντεο για τη μεταβίβαση. Το χρονικό διάστημα και την ώρα μετατόπιση με το οποίο συμβαίνει αυτό είναι δυνατό να ρυθμιστεί στις ιδιότητες.

![Ιδιότητες πλαισίου πύλη βίντεο](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-video-frame-gate-properties.png)

*Ιδιότητες πλαισίου πύλη βίντεο*

Ας δημιουργήσουμε μια μικρογραφία κάθε λεπτό, ορίζοντας την κατάσταση λειτουργίας σε χρόνο (δευτερόλεπτα) και το χρονικό διάστημα έως 60.

###<a id="thumbnails_to__multibitrate_MP4_color_space"></a>Χειρισμός μετατροπή χώρου χρωμάτων

Ενώ θα ήταν λογικό τώρα μπορούν να συνδεθούν και οι δύο αριθμοί PIN αρχεία μη συμπιεσμένων βίντεο από την πύλη πλαισίου και την εισαγωγή του αρχείου πολυμέσων, θα σας θα εμφανίζεται μια προειδοποίηση, εάν θα σας θα το κάνετε αυτό.

![Χρώμα χώρο σφάλμα εισόδου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-input-color-space-error.png)

*Χρώμα χώρο σφάλμα εισόδου*

Αυτό συμβαίνει επειδή ο τρόπος ποια έγχρωμες πληροφορίες αντιπροσωπεύεται στο μας αρχικό ανεπεξέργαστα αρχεία μη συμπιεσμένων ροής βίντεο, που προέρχονται από MXF μας, διαφέρει από το τι αναμένει ο κωδικοποιητής JPG. Πιο συγκεκριμένα, μια λεγόμενες "Χώρος χρώματος" από "RGB" ή "Κλίμακα του γκρι" αναμένεται ροής στο. Αυτό σημαίνει ότι η βίντεο πύλη πλαισίου εισερχομένων ροή βίντεο θα πρέπει να έχουν μια μετατροπή πρώτα την εφαρμογή σχετικά με το χώρο χρωμάτων.

Σύρετε τη ροή εργασίας του μετατροπέα χώρο χρώματος - Intel και συνδέστε τη με την πύλη πλαισίου.

![Σύνδεση ενός μετατροπέα χώρο χρώματος](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-connect-color-space-convertor.png)

*Σύνδεση ενός μετατροπέα χώρο χρώματος*

Στο παράθυρο διαλόγου Ιδιότητες, επιλέξτε την καταχώρηση BGR 24 από τη λίστα προκαθορισμένα.

###<a id="thumbnails_to__multibitrate_MP4_writing_thumbnails"></a>Η σύνταξη των μικρογραφιών

Διαφορετικό από του βίντεο MP4 μας, το στοιχείο JPG Encoder θα περισσότερα από ένα αρχείο εξόδου. Για να ασχοληθείτε με αυτό, μπορεί να χρησιμοποιηθεί ένα στοιχείο σκηνή αναζήτησης JPG αρχείο Writer: θα λαμβάνουν τις εισερχόμενες μικρογραφίες JPG και γραφής τους, κάθε όνομα αρχείου που έχει τεθεί επίθημα από ένα διαφορετικό αριθμό. (Ο αριθμός συνήθως που υποδεικνύει τον αριθμό των δευτερολέπτων/μονάδων στη ροή οποίο σχεδιάστηκε από τη μικρογραφία.)


![Εισαγωγή εγγραφής αρχείου JPG της σκηνής αναζήτησης](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-scene-search-jpg-file-writer.png)

*Εισαγωγή εγγραφής αρχείου JPG της σκηνής αναζήτησης*

Ρύθμιση παραμέτρων της ιδιότητας διαδρομή φακέλου εξόδου στην παράσταση: ${ROOT_outputWriteDirectory} 

και η ιδιότητα Filename πρόθεμα με: 

    ${ROOT_sourceFileBaseName}_thumb_

Το πρόθεμα θα καθορίσει πώς τα μικρογραφιών αρχεία που ονομάζονται. Αυτά θα είναι επίθημα με έναν αριθμό που υποδηλώνει το πρακτικός θέση στη ροή.


![Ιδιότητες αναζήτησης JPG αρχείο Writer σκηνής](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-scene-search-jpg-file-writer-properties.png)

*Ιδιότητες αναζήτησης JPG αρχείο Writer σκηνής*

Σύνδεση εγγραφής αρχείου JPG της σκηνής αναζήτησης στον κόμβο αρχείο εξόδου/περιουσιακών στοιχείων.

###<a id="thumbnails_to__multibitrate_MP4_errors"></a>Εντοπισμός σφαλμάτων σε μια ροή εργασίας

Σύνδεση της εισόδου του μετατροπέα χώρο χρώμα με τα ανεπεξέργαστα αρχεία μη συμπιεσμένων εξόδου βίντεο. Τώρα μπορείτε να εκτελέσετε μια τοπική δοκιμής για τη ροή εργασίας. Μια καλή πιθανότητα είναι η ροή εργασίας ξαφνικά θα σταματήσει να εκτελείται και να υποδείξετε με κόκκινο περίγραμμα στο στοιχείο που αντιμετώπισε σφάλμα:

![Σφάλμα μετατροπέα χώρο χρώματος](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-color-space-converter-error.png)

*Σφάλμα μετατροπέα χώρο χρώματος*

Κάντε κλικ στο μικρό κόκκινο εικονίδιο "Ε" στην επάνω δεξιά γωνία του στοιχείου χρώμα χώρο μετατροπέα για να δείτε ποιος είναι ο λόγος η προσπάθεια κωδικοποίησης απέτυχε.

![Παράθυρο διαλόγου σφάλματος μετατροπέα χώρο χρώματος](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-color-space-converter-error-dialog.png)

*Παράθυρο διαλόγου σφάλματος μετατροπέα χώρο χρώματος*

Ενεργοποιεί, όπως μπορείτε να δείτε, ότι εισερχόμενες χώρο χρώμα τυπική για το χρώμα μετατροπέα χώρου πρέπει να είναι rec601 για μας ζητήθηκε μετατροπή YUV σε RGB. Προφανώς μας ροή δεν υποδείξετε rec601 του. (Εγγραφής 601 είναι ένα πρότυπο κωδικοποίησης συνενωμένες αναλογικά βίντεο σήματα σε ψηφιακή μορφή βίντεο. Καθορίζει μια ενεργή περιοχή που καλύπτεται από 720 δείγματα φωτεινότητας και 360 chrominance δείγματα ανά γραμμή. Το χρώμα κωδικοποίηση σύστημα που είναι γνωστό ως YCbCr 4:2:2.)

Για να διορθώσετε αυτό το πρόβλημα, θα αναφέρουμε στην τα μετα-δεδομένα μας ροής που θα σας χειρισμός rec601 περιεχόμενο. Για να το κάνετε θα χρησιμοποιήσουμε ένα στοιχείο προγράμματος ενημέρωσης τύπο δεδομένων βίντεο, το οποίο θα θέτει ανάμεσα στα μας ανεπεξέργαστα προέλευσης και του στοιχείου χρώμα χώρο μετατροπής. Αυτό προγράμματος ενημέρωσης τύπος δεδομένων επιτρέπει τη μη αυτόματη ενημέρωση των ορισμένων δεδομένων βίντεο ιδιότητες τύπου. Ρυθμίστε τις παραμέτρους του για να υποδείξετε ένα χρώμα χώρο τυπική του "Εγγραφής 601". Αυτό θα προκαλέσει την προγράμματος ενημέρωσης τύπο δεδομένων βίντεο για να προσθέσετε ετικέτα στη ροή με το χώρο χρώματος "Εγγραφής 601", εάν δεν υπήρχε χώρος χρώματος που ορίζονται από το ακόμη. (Αυτό δεν υπερισχύει οποιαδήποτε υπάρχοντα μετα-δεδομένα, εκτός και εάν έγινε μεταβίβαση ελέγχου στο πλαίσιο ελέγχου παράκαμψη.)

![Ενημέρωση τυπική χώρο χρώματος σε του προγράμματος ενημέρωσης τύπου δεδομένων](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-update-color-space-standard-on-data-type.png)

*Ενημέρωση τυπική χώρο χρώματος σε του προγράμματος ενημέρωσης τύπου δεδομένων*

###<a id="thumbnails_to__multibitrate_MP4_finish"></a>Εργασία ροής εργασίας

Τώρα που μας μας ροή εργασίας έχει ολοκληρωθεί, κάντε μια άλλη δοκιμή εκτέλεση για να το δείτε μεταβιβάζουν.

![Εργασία ροής εργασίας για πολλούς mp4 εξόδου με μικρογραφίες](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-finished-workflow-for-multi-mp4-thumbnails.png)

*Εργασία ροής εργασίας για πολλούς mp4 εξόδου με μικρογραφίες*

##<a id="time_based_trim"></a>Βάσει χρόνου περικοπής multibitrate MP4 εξόδου

Ξεκινώντας από μια ροή εργασίας που δημιουργεί [μια multibitrate MP4 Έξοδος από μια MXF εισαγωγής](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging), θα σας θα τώρα να ανατρέξουν στο περικοπή του βίντεο προέλευσης που βασίζονται σε χρονική σήμανση.

###<a id="time_based_trim_start"></a>Επισκόπηση ροής εργασιών για να ξεκινήσετε να προσθέτετε περικοπής για να

![Έναρξη ροής εργασίας για να προσθέσετε περικοπής για να](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-starting-workflow-to-add-trimming.png)

*Έναρξη ροής εργασίας για να προσθέσετε περικοπής για να*

###<a id="time_based_trim_use_stream_trimmer"></a>Χρησιμοποιώντας τη μονάδα περικοπής ροής

Το στοιχείο ροή μονάδα περικοπής επιτρέπει να αποκόψετε αρχή και στο τέλος μια ροή δεδομένων εισόδου βάσης στην χρονομέτρηση πληροφορίες (δευτερόλεπτα, λεπτά,...). Η μονάδα περικοπής δεν υποστηρίζει βάσει πλαισίου περικοπής.

![Ροή μονάδα περικοπής](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-stream-trimmer.png)

*Ροή μονάδα περικοπής*

Αντί για σύνδεση της AVC κωδικοποιητές και assigner θέση ομιλητή για την είσοδο του αρχείου πολυμέσων απευθείας, θα σας θα τοποθετήσετε ανάμεσα στα αυτές τη μονάδα περικοπής ροής. (Μία για το σήμα βίντεο και μία για το σήμα ήχου διεμπλεκόμενο.)

![Τοποθέτηση στο μεταξύ ροή μονάδα περικοπής](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-put-stream-trimmer-in-between.png)

*Τοποθέτηση στο μεταξύ ροή μονάδα περικοπής*

Ρυθμίστε τις παραμέτρους του τη μονάδα περικοπής ας ώστε θα μόνο επεξεργαστούμε βίντεο και ήχου μεταξύ 15 δευτερολέπτων και 60 δευτερόλεπτα του βίντεο.

Μεταβείτε στις ιδιότητες των μονάδα περικοπής ροή του βίντεο και ρύθμιση παραμέτρων ώρα έναρξης (μέσος) και ιδιότητες ώρα λήξης (60s). Για να βεβαιωθείτε ότι τόσο μας μονάδα περικοπής ήχου και βίντεο έχουν ρυθμιστεί πάντα στο ίδιο έναρξης και λήξης τιμές, θα σας θα δημοσιεύσετε αυτά στη ρίζα της ροής εργασίας.

![Δημοσίευση ιδιότητα ώρα έναρξης από ροή μονάδα περικοπής](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-publish-start-time-from-stream-trimmer.png)

*Δημοσίευση ιδιότητα ώρα έναρξης από ροή μονάδα περικοπής*

![Δημοσίευση παράθυρο διαλόγου ιδιοτήτων για ώρα έναρξης](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-publish-dialog-for-start-time.png)

*Δημοσίευση παράθυρο διαλόγου ιδιοτήτων για ώρα έναρξης*

![Δημοσίευση παράθυρο διαλόγου ιδιοτήτων για ώρα λήξης](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-publish-dialog-for-end-time.png)

*Δημοσίευση παράθυρο διαλόγου ιδιοτήτων για ώρα λήξης*


Εάν θα σας έλεγχος τώρα το ριζικό κατάλογο της μας ροής εργασίας, και οι δύο ιδιότητες θα αποτελεσματικά εμφανιζόμενη και με δυνατότητα ρύθμισης παραμέτρων από εκεί.

![Δημοσιευμένη ιδιότητες που είναι διαθέσιμες στη ρίζα](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-published-properties-available-on-root.png)

*Δημοσιευμένη ιδιότητες που είναι διαθέσιμες στη ρίζα*

Τώρα να ανοίξετε τις ιδιότητες περικοπής από τη μονάδα περικοπής ήχου και ρύθμιση παραμέτρων ώρες έναρξης και λήξης με μια παράσταση που αναφέρεται στις ιδιότητες δημοσιευμένη στη ρίζα της μας ροής εργασίας.

Για την ώρα έναρξης της περικοπής του ήχου:

    ${ROOT_TrimmingStartTime}

καθώς και για την ώρα λήξης:

    ${ROOT_TrimmingEndTime}

###<a id="time_based_trim_finish"></a>Εργασία ροής εργασίας

![Εργασία ροής εργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-finished-workflow-time-base-trimming.png)

*Εργασία ροής εργασίας*


##<a id="scripting"></a>Εισαγωγή στοιχείου δέσμης ενεργειών

Τα στοιχεία δέσμης ενεργειών μπορεί να εκτελέσει αυθαίρετο δέσμες ενεργειών κατά τις φάσεις εκτέλεσης μας ροής εργασίας. Υπάρχουν τέσσερα διαφορετικά δέσμες ενεργειών που μπορεί να εκτελεστεί, κάθε μία με συγκεκριμένα χαρακτηριστικά και τις δικές τους σημείο του κύκλου ζωής ροής εργασίας:

- **commandScript**
- **realizeScript**
- **processInputScript**
- **lifeCycleScript**

Μετάβαση στην τεκμηρίωση του στοιχείου δέσμης ενεργειών με περισσότερες λεπτομέρειες για κάθε ένα από τα παραπάνω. Στην [ενότητα που ακολουθεί](media-services-media-encoder-premium-workflow-tutorials.md#frame_based_trim), το στοιχείο δέσμης ενεργειών **realizeScript** χρησιμοποιείται για να δημιουργήσετε μια xml cliplist δυναμική κατά την εκκίνηση της ροής εργασίας. Αυτή η δέσμη ενεργειών ονομάζεται κατά την εγκατάσταση στοιχείου, το οποίο συμβαίνει μόνο μία φορά στο κύκλου ζωής του.


###<a id="scripting_hello_world"></a>Δέσμες ενεργειών σε μια ροή εργασίας: Χαίρετε

Σύρετε ένα στοιχείο δέσμης ενεργειών επάνω στην επιφάνεια σχεδίασης και μετονομάστε την (για παράδειγμα, "SetClipListXML").

![Προσθήκη ενός στοιχείου δέσμης ενεργειών](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-add-scripted-comp.png)

*Προσθήκη ενός στοιχείου δέσμης ενεργειών*

Όταν ελέγχετε τις ιδιότητες του στοιχείου δέσμης ενεργειών, τους τέσσερις τύπους διαφορετική δέσμη ενεργειών θα φαίνεται, κάθε με δυνατότητα ρύθμισης παραμέτρων σε μια διαφορετική δέσμη ενεργειών.

![Δέσμες ενεργειών ιδιότητες στοιχείων](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-scripted-comp-properties.png)

*Δέσμες ενεργειών ιδιότητες στοιχείων*

Καταργήστε την επιλογή από το processInputScript και ανοίξτε το πρόγραμμα επεξεργασίας για το realizeScript. Τώρα είστε μπορούμε να εγκαταστήσουμε προς τα επάνω και είστε έτοιμοι να ξεκινήσετε δέσμες ενεργειών.

Οι δέσμες ενεργειών είναι γραμμένες σε Groovy, μια δυναμική μεταγλωττισμένο γλώσσας δέσμης ενεργειών για την πλατφόρμα Java που διατηρεί τη συμβατότητα με Java. Στην πραγματικότητα, οι περισσότερες κώδικα Java είναι έγκυρος Groovy κωδικός.

Ας συντάξετε μια απλή hello world groovy δέσμη ενεργειών στο περιβάλλον της μας realizeScript. Πληκτρολογήστε τα εξής στο πρόγραμμα επεξεργασίας:

    node.log("hello world");

Τώρα η εκτέλεση μιας τοπικής δοκιμής εκτέλεση. Μετά από αυτήν την εκτέλεση, έλεγχος (μέσω καρτέλα συστήματος στο στοιχείο δέσμης ενεργειών) την ιδιότητα αρχεία καταγραφής.

![Γεια σας κόσμο καταγραφής εξόδου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-log-output.png)

*Γεια σας κόσμο καταγραφής εξόδου*

Το αντικείμενο κόμβου ονομάζουμε τη μέθοδο καταγραφής, αναφέρεται σε μας τρέχοντα "κόμβο" ή του στοιχείου που θα σας δέσμες ενεργειών μέσα σε. Κάθε στοιχείο έχει ως έχουν τη δυνατότητα να δεδομένα καταγραφής εξόδου, μέσω της καρτέλα συστήματος. Σε αυτήν την περίπτωση, εξόδου η λεκτική σταθερά συμβολοσειράς "Χαίρετε". Είναι σημαντικό να κατανοήσετε εδώ είναι ότι αυτό να αποδείξετε είναι ένα πολύτιμο εργαλείο εντοπισμού σφαλμάτων, παρέχει πληροφορίες για σε τη δέσμη ενεργειών στην πραγματικότητα ενέργειες.

Από μας δέσμης ενεργειών περιβάλλοντος, επίσης έχουμε πρόσβαση στις ιδιότητες σε άλλα στοιχεία. Δοκιμάστε το εξής:


    //inspect current node: 
    def nodepath = node.getNodePath(); 
    node.log("this node path: " + nodepath);
    
    //walking up to other nodes: 
    def parentnode = node.getParentNode(); 
    def parentnodepath = parentnode.getNodePath(); 
    node.log("parent node path: " + parentnodepath);
    
    //read properties from a node: 
    def sourceFileExt = parentnode.getPropertyAsString( "sourceFileExtension", null ); 
    def sourceFileName = parentnode.getPropertyAsString("sourceFileBaseName", null); 
    node.log("source file name with extension " + sourceFileExt + " is: " + sourceFileName);

Το παράθυρο αρχείο καταγραφής θα εμφανίσει μας τα εξής:

![Έξοδος του αρχείου καταγραφής για την πρόσβαση σε διαδρομές κόμβου](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-log-output2.png)

*Έξοδος του αρχείου καταγραφής για την πρόσβαση σε διαδρομές κόμβου*


##<a id="frame_based_trim"></a>Βασίζεται στο πλαίσιο περικοπής multibitrate MP4 εξόδου

Ξεκινώντας από μια ροή εργασίας που δημιουργεί [μια multibitrate MP4 Έξοδος από μια MXF εισαγωγής](media-services-media-encoder-premium-workflow-tutorials.md#MXF_to_MP4_with_dyn_packaging), θα σας θα τώρα να ανατρέξουν στο περικοπή του βίντεο προέλευσης που βασίζεται σε πλαίσιο πλήθος.

###<a id="frame_based_trim_start"></a>Επισκόπηση σχέδιο για να ξεκινήσετε να προσθέτετε περικοπής για να

![Για να ξεκινήσετε να προσθέτετε περικοπής για να της ροής εργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-workflow-start-adding-trimming-to.png)

*Για να ξεκινήσετε να προσθέτετε περικοπής για να της ροής εργασίας*

###<a id="frame_based_trim_clip_list"></a>Χρήση της λίστας Clip XML

Σε όλα προηγούμενη εκμάθηση ροής εργασίας, χρησιμοποιήσαμε το στοιχείο εισαγωγής αρχείων πολυμέσων ως μας προέλευση εισόδου βίντεο. Για αυτό το σενάριο, θα χρησιμοποιούμε το στοιχείο προέλευση λίστα Clip αντί για αυτό. Σημειώστε ότι αυτή δεν είναι ο καλύτερος τρόπος εργασίας; χρησιμοποιήσετε την προέλευση της λίστας εικόνων Clip μόνο όταν υπάρχει μια πραγματική λόγος για να το κάνετε (όπως στην το κάτω από την περίπτωση, όπου θα σας πραγματοποιείτε χρησιμοποιήστε τις δυνατότητες αποκοπή λίστα clip).

Για να μεταβείτε από μας εισαγωγής αρχείων πολυμέσων στην προέλευση λίστα Clip, σύρετε το στοιχείο προέλευση λίστα Clip επάνω στην επιφάνεια σχεδίασης και συνδέστε το pin Clip λίστα XML στον κόμβο XML λίστα Clip της σχεδίασης ροής εργασίας. Αυτό θα πρέπει να συμπληρώσετε η προέλευση της λίστας Clip με αριθμοί PIN εξόδου, σύμφωνα με το βίντεο εισαγωγής. Σύνδεση τώρα τα αρχεία μη συμπιεσμένων βίντεο και ήχος αρχεία μη συμπιεσμένων αριθμοί PIN από το η προέλευση της λίστας Clip για να το αντίστοιχο AVC κωδικοποιητές και Interleaver ροή ήχου. Τώρα μπορείτε να καταργήσετε τα δεδομένα εισόδου του αρχείου πολυμέσων.

![Αντικατασταθεί το εισαγωγής αρχείων πολυμέσων με την προέλευση λίστα Clip](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-replaced-media-file-with-clip-source.png)

*Αντικατασταθεί το εισαγωγής αρχείων πολυμέσων με την προέλευση λίστα Clip*

Το στοιχείο προέλευση λίστα Clip χρειάζονται ως είσοδο "Clip λίστα XML". Όταν επιλέγετε το αρχείο προέλευσης για να ελέγξετε με τοπικά, αυτό xml λίστα clip συμπληρώνεται αυτόματα για εσάς.

![Αυτόματη συμπλήρωση ιδιότητα Clip λίστα XML](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-auto-populated-clip-list-xml-property.png)

*Αυτόματη συμπλήρωση ιδιότητα Clip λίστα XML*

Εμφάνιση λίγο πιο κοντά στην XML, αυτό είναι πώς έχει τη μορφή:

![Παράθυρο διαλόγου λίστα clip επεξεργασία](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-edit-clip-list-dialog.png)

*Παράθυρο διαλόγου λίστα clip επεξεργασία*

Αυτό ωστόσο δεν αντικατοπτρίζει τις δυνατότητες του clip λίστα xml. Μία επιλογή που έχετε είναι να προσθέσετε ένα στοιχείο "Αποκοπή" στην περιοχή τόσο το βίντεο και ήχου προέλευσης, ως εξής:

![Προσθήκη ενός στοιχείου trim στη λίστα clip](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-adding-trim-element-to-clip-list.png)

*Προσθήκη ενός στοιχείου trim στη λίστα clip*

Εάν τροποποίηση του xml λίστα clip ως εξής παραπάνω και εκτελέστε μια τοπική δοκιμή εκτέλεση, θα δείτε το βίντεο σωστά έχουν αποκοπεί από 10 έως 20 δευτερόλεπτα του βίντεο.

Αντίθετα με τι συμβαίνει όταν κάνετε μέσω ενός τοπικού εκτέλεση, αυτό πολύ ίδια xml cliplist δεν θα έχει το ίδιο αποτέλεσμα όταν εφαρμόζονται σε μια ροή εργασίας που εκτελείται στο υπηρεσιών Azure Media Services. Κατά την εκκίνηση του Azure Premium Encoder, το xml cliplist δημιουργείται κάθε φορά που ξανά, με βάση το αρχείο εισαγωγής που δόθηκε η κωδικοποίησης εργασία. Αυτό σημαίνει ότι τυχόν αλλαγές κάνουμε στο αρχείο xml Δυστυχώς μπορεί να παρακαμφθούν.

Για να μετρητή cliplist xml που έχει τεθεί σβήσιμο κατά την έναρξη μιας εργασίας κωδικοποίησης, θα σας μπορεί να δημιουργήσετε ξανά το το δυναμική μόνο μετά την έναρξη της μας ροής εργασίας. Οι προσαρμοσμένες ενέργειες μπορούν να ληφθούν από αυτό που ονομάζεται "Δέσμης ενεργειών στοιχείου". Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Εισαγωγή το στοιχείο δέσμης ενεργειών](media-services-media-encoder-premium-workflow-tutorials.md#scripting).


Σύρετε ένα στοιχείο δέσμης ενεργειών επάνω στην επιφάνεια σχεδίασης και μετονομάστε το σε "SetClipListXML".

![Προσθήκη ενός στοιχείου δέσμης ενεργειών](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-add-scripted-comp.png)

*Προσθήκη ενός στοιχείου δέσμης ενεργειών*

Όταν ελέγχετε τις ιδιότητες του στοιχείου δέσμης ενεργειών, τους τέσσερις τύπους διαφορετική δέσμη ενεργειών θα φαίνεται, κάθε με δυνατότητα ρύθμισης παραμέτρων σε μια διαφορετική δέσμη ενεργειών.

![Δέσμες ενεργειών ιδιότητες στοιχείων](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-scripted-comp-properties.png)

*Δέσμες ενεργειών ιδιότητες στοιχείων*


###<a id="frame_based_trim_modify_clip_list"></a>Τροποποίηση της λίστας clip από ένα στοιχείο δέσμης ενεργειών

Πριν από την εκ νέου θα σας μπορεί να γράψετε cliplist xml που δημιουργείται κατά την εκκίνηση ροής εργασίας, θα πρέπει να έχετε πρόσβαση σε την ιδιότητα cliplist xml και το περιεχόμενο. Μπορούμε να κάνουμε αυτό ως εξής:

    // get cliplist xml: 
    def clipListXML = node.getProperty("../clipListXml");
    node.log("clip list xml coming in: " + clipListXML);

![Εισερχόμενες clip λίστα να είστε συνδεδεμένοι](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-incoming-clip-list-logged.png)

*Εισερχόμενες clip λίστα να είστε συνδεδεμένοι*

Πρώτα πρέπει ένας τρόπος για να προσδιορίσετε από ποιο σημείο μέχρι ποιο σημείο θέλουμε να αποκόψετε το βίντεο. Για να γίνει αυτή η εύκολη για το χρήστη λιγότερο τεχνικής της ροής εργασίας, δημοσιεύστε δύο ιδιότητες στον ριζικό κατάλογο του γραφήματος. Για να κάνετε αυτό, κάντε δεξί κλικ στην επιφάνεια σχεδίασης και επιλέξτε "Προσθήκη ιδιότητας":

- Πρώτη ιδιότητα: "ClippingTimeStart" του τύπου: "ΚΩΔΙΚΟΎ"
- Δεύτερο ιδιότητα: "ClippingTimeEnd" του τύπου: "ΚΩΔΙΚΟΎ"

![Προσθήκη παράθυρο διαλόγου ιδιοτήτων για το απόσπασμα ώρα έναρξης](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-clip-start-time.png)

*Προσθήκη παράθυρο διαλόγου ιδιοτήτων για το απόσπασμα ώρα έναρξης*

![Δημοσίευση απόσπασμα περίπτερου χρόνου στη ρίζα της ροής εργασίας](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-clip-time-props.png)

*Δημοσίευση απόσπασμα περίπτερου χρόνου στη ρίζα της ροής εργασίας*

Ρύθμιση παραμέτρων και οι δύο ιδιότητες σε μια κατάλληλη τιμή:

![Ρύθμιση παραμέτρων απόσπασμα Έναρξη και τερματισμός ιδιότητες](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-configure-clip-start-end-prop.png)

*Ρύθμιση παραμέτρων απόσπασμα Έναρξη και τερματισμός ιδιότητες*

Τώρα, από μέσα από τη δέσμη ενεργειών, θα σας να αποκτήσετε πρόσβαση και οι δύο ιδιότητες, ως εξής:

    
    // get start and end of clipping:
    def clipstart = node.getProperty("../ClippingTimeStart").toString();
    def clipend = node.getProperty("../ClippingTimeEnd").toString();
    
    node.log("clipping start: " + clipstart);
    node.log("clipping end: " + clipend);

![Αρχείο καταγραφής παράθυρο που εμφανίζει έναρξης και λήξης του αποσπάσματος](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-show-start-end-clip.png)

*Αρχείο καταγραφής παράθυρο που εμφανίζει έναρξης και λήξης του αποσπάσματος*

Ας ανάλυσης τις συμβολοσειρές κωδικού σε μια πιο εύκολο να χρησιμοποιήσετε φόρμα, χρησιμοποιώντας μια απλή κανονική παράσταση:
    
    //parse the start timing: 
    def startregresult = (~/(\d\d:\d\d:\d\d:\d\d)\/(\d\d)/).matcher(clipstart); 
    startregresult.matches(); 
    def starttimecode = startregresult.group(1); 
    node.log("timecode start is: " + starttimecode); 
    def startframerate = startregresult.group(2); 
    node.log("framerate start is: " + startframerate);
    
    //parse the end timing: 
    def endregresult = (~/(\d\d:\d\d:\d\d:\d\d)\/(\d\d)/).matcher(clipend); 
    endregresult.matches(); 
    def endtimecode = endregresult.group(1); 
    node.log("timecode end is: " + endtimecode); 
    def endframerate = endregresult.group(2); 
    node.log("framerate end is: " + endframerate);

![Παράθυρο αρχείου καταγραφής με το αποτέλεσμα ενός αναλυμένη κωδικού](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-output-parsed-timecode.png)

*Παράθυρο αρχείου καταγραφής με το αποτέλεσμα ενός αναλυμένη κωδικού*

Με αυτές τις πληροφορίες με μη αυτόματο τρόπο, θα σας τώρα να τροποποιήσετε το cliplist xml ώστε να αντικατοπτρίζει τις ώρες έναρξης και λήξης για την επιθυμητή πλαισίου ακριβή περικοπή της ταινίας.

![Κώδικα δέσμης ενεργειών για να προσθέσετε στοιχεία trim](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-add-trim-elements.png)

*Κώδικα δέσμης ενεργειών για να προσθέσετε στοιχεία trim*

Αυτό έγινε μέσω λειτουργίες χειρισμού κανονική συμβολοσειράς. Η xml λίστα τροποποιημένη εικόνα clip art που προκύπτει εγγράφεται ξανά την ιδιότητα clipListXML στη ρίζα της ροής εργασίας έως τη μέθοδο "Ορισμός ιδιότητας". Το παράθυρο αρχείο μετά την εκτέλεση του άλλου δοκιμής θα μας δείχνουν τα εξής:

![Καταγραφή στη λίστα που προκύπτει clip](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-log-result-clip-list.png)

*Καταγραφή στη λίστα που προκύπτει clip*

Κάνετε μια δοκιμαστική χρήση για να δείτε πώς έχει έχουν αποκοπεί ροών βίντεο και ήχου. Όπως θα κάνετε περισσότερες από μία εκτέλεση δοκιμής με διαφορετικές τιμές για τα σημεία περικοπής, θα παρατηρήσετε ότι αυτές θα δεν λαμβάνονται υπόψη Ωστόσο! Ο λόγος για αυτό είναι ότι το εργαλείο σχεδίασης, σε αντίθεση με το περιβάλλον εκτέλεσης Azure, δεν παρακάμπτει το xml cliplist κάθε εκτέλεση. Αυτό σημαίνει ότι μόνο την πρώτη φορά που ορίσατε το στο και ανάληψη σημεία, θα έχει ως αποτέλεσμα το xml για το μετασχηματισμό, όλων των άλλων ωρών, μας όρος επιφυλακή (εάν (clipListXML.indexOf ("<trim>") == -1)) θα εμποδίσει τη ροή εργασίας να προσθέσετε ένα άλλο στοιχείο trim όταν υπάρχει ήδη μία παρουσίαση.

Για να κάνετε πιο εύκολο να δοκιμάσετε τοπικά μας ροής εργασίας, βέλτιστη προσθέσουμε ορισμένα house διατήρηση κώδικα που ελέγχει εάν υπήρχε ήδη ένα στοιχείο trim. Εάν Ναι, θα σας να το καταργήσετε πριν να συνεχίσετε, τροποποιώντας το xml με τις νέες τιμές. Αντί να χρησιμοποιήσετε χειρισμούς απλό συμβολοσειρά, είναι πιο ασφαλής πιθανώς να το κάνετε αυτό μέσω μοντέλου αντικειμένου πραγματικό xml κατά την ανάλυση.

Πριν να προσθέσουμε όπως κώδικα μέσω, θα πρέπει πρώτα να προσθέσετε έναν αριθμό από τις προτάσεις εισαγωγής στην αρχή της μας δέσμης ενεργειών:
    
    import javax.xml.parsers.*; 
    import org.xml.sax.*; 
    import org.w3c.dom.*;
    import javax.xml.*;
    import javax.xml.xpath.*; 
    import javax.xml.transform.*; 
    import javax.xml.transform.stream.*; 
    import javax.xml.transform.dom.*;

Μετά από αυτό, θα σας να προσθέσετε τα απαιτούμενα καθαρισμού κώδικα:

    //for local testing: delete any pre-existing trim elements from the clip list xml by parsing the xml into a DOM:
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder();
    InputSource is=new InputSource(new StringReader(clipListXML)); 
    Document dom=builder.parse(is);

    //find the trim element inside videoSource and audioSource and remove it if it exists already: 
    XPath xpath = XPathFactory.newInstance().newXPath();
    String findAllTrimElements = "//trim"; 
    NodeList trimelems = xpath.evaluate(findAllTrimElements,dom,XPathConstants.NODESET);

    //copy trim nodes into a "to-be-deleted" collection 
    Set<Element> elementsToDelete = new HashSet<Element>(); 
    for (int i = 0; i < trimelems.getLength(); i++) { 
        Element e = (Element)trimelems.item(i); 
        elementsToDelete.add(e); 
    }

    node.log("about to delete any existing trim nodes");
     //delete the trim nodes: 
    elementsToDelete.each{ 
        e -> e.getParentNode().removeChild(e);
    }; 
    node.log("deleted any existing trim nodes");
    
    //serialize the modified clip list xml dom into a string: 
    def transformer = TransformerFactory.newInstance().newTransformer();
    StreamResult result = new StreamResult(new StringWriter());
    DOMSource source = new DOMSource(dom);
    transformer.transform(source, result); 
    clipListXML = result.getWriter().toString();
    
Αυτός ο κωδικός μεταβαίνει ακριβώς επάνω από το σημείο στο οποίο προσθέσουμε τα trim στοιχεία στην XML cliplist.

Σε αυτό το σημείο, να εκτελέσετε και τροποποίηση μας ροής εργασίας, όπως κατά τον ίδιο τρόπο όπως θέλουμε ενώ χρειάζεται τις αλλαγές που έχουν εφαρμοστεί ποτέ ώρας.    

###<a id="frame_based_trim_clippingenabled_prop"></a>Προσθήκη μια ιδιότητα ευκολία ClippingEnabled

Ενδέχεται να μην πάντα θέλετε περικοπή να συμβεί, ας λήξης απενεργοποίηση μας ροής εργασίας, προσθέτοντας μια εύκολη σημαία boolean που υποδεικνύει ή όχι θέλουμε να ενεργοποιήσετε την περικοπή / απόσπασμα.

Απλώς ως προτού, δημοσιεύστε μια νέα ιδιότητα στη ρίζα της μας ροή εργασίας που ονομάζεται "ClippingEnabled" του τύπου "BOOLEAN".

![Δημοσίευση ιδιότητας για ενεργοποίηση της περικοπής](./media/media-services-media-encoder-premium-workflow-tutorials/media-services-enable-clip.png)

*Δημοσίευση ιδιότητας για ενεργοποίηση της περικοπής*

Με το κάτω από τον όρο FROM απλή επιφυλακή, να επιλέξτε εάν απαιτείται περικοπής και να αποφασίσετε εάν τη λίστα clip ως τέτοια πρέπει να τροποποιηθεί ή όχι.

    //check if clipping is required: 
    def clippingrequired = node.getProperty("../ClippingEnabled"); 
    node.log("clipping required: " + clippingrequired.toString()); 
    if(clippingrequired == null || clippingrequired == false) 
    {
        node.setProperty("../clipListXml",clipListXML); 
        node.log("no clipping required"); 
        return; 
    }


###<a id="code"></a>Ολοκλήρωση κώδικα

    import javax.xml.parsers.*; 
    import org.xml.sax.*; 
    import org.w3c.dom.*;
    import javax.xml.*;
    import javax.xml.xpath.*; 
    import javax.xml.transform.*; 
    import javax.xml.transform.stream.*; 
    import javax.xml.transform.dom.*;
    
    // get cliplist xml: 
    def clipListXML = node.getProperty("../clipListXml");
    node.log("clip list xml coming in: \n" + clipListXML);
    // get start and end of clipping: 
    def clipstart = node.getProperty("../ClippingTimeStart").toString();
    def clipend = node.getProperty("../ClippingTimeEnd").toString();
    
    //parse the start timing:
    def startregresult = (~/(\d\d:\d\d:\d\d:\d\d)\/(\d\d)/).matcher(clipstart); 
    startregresult.matches(); 
    def starttimecode = startregresult.group(1);
    node.log("timecode start is: " + starttimecode);
    def startframerate = startregresult.group(2);
    node.log("framerate start is: " + startframerate);
    
    //parse the end timing: 
    def endregresult = (~/(\d\d:\d\d:\d\d:\d\d)\/(\d\d)/).matcher(clipend);
    endregresult.matches(); 
    def endtimecode = endregresult.group(1); 
    node.log("timecode end is: " + endtimecode); 
    def endframerate = endregresult.group(2);

    node.log("framerate end is: " + endframerate);
    
    //for local testing: delete any pre-existing trim elements 
    //from the clip list xml by parsing the xml into a DOM:
    
    DocumentBuilderFactory factory=DocumentBuilderFactory.newInstance();
    DocumentBuilder builder=factory.newDocumentBuilder(); 
    InputSource is=new InputSource(new StringReader(clipListXML)); 
    Document dom=builder.parse(is);

    //find the trim element inside videoSource and audioSource and remove it if it exists already:
    XPath xpath = XPathFactory.newInstance().newXPath(); 
    String findAllTrimElements = "//trim"; 
    NodeList trimelems = xpath.evaluate(findAllTrimElements, dom, XPathConstants.NODESET);

    //copy trim nodes into a "to-be-deleted" collection 
    Set<Element> elementsToDelete = new HashSet<Element>(); 
    for (int i = 0; i < trimelems.getLength(); i++) { 
        Element e = (Element)trimelems.item(i); 
        elementsToDelete.add(e); 
    }
    
    node.log("about to delete any existing trim nodes");
    //delete the trim nodes:
    elementsToDelete.each{ e -> 
        e.getParentNode().removeChild(e); 
    };
    node.log("deleted any existing trim nodes");

    //serialize the modified clip list xml dom into a string:
    def transformer = TransformerFactory.newInstance().newTransformer();
    StreamResult result = new StreamResult(new StringWriter());
    DOMSource source = new DOMSource(dom);
    transformer.transform(source, result);
    clipListXML = result.getWriter().toString();

    //check if clipping is required:
    def clippingrequired = node.getProperty("../ClippingEnabled");
    node.log("clipping required: " + clippingrequired.toString()); 
    if(clippingrequired == null || clippingrequired == false) 
    {
        node.setProperty("../clipListXml",clipListXML);
        node.log("no clipping required");
        return; 
    }

    //add trim elements to cliplist xml 
    if ( clipListXML.indexOf("<trim>") == -1 ) 
    {
        //trim video 
        clipListXML = clipListXML.replace("<videoSource>","<videoSource>\n <trim>\n <inPoint fps=\""+ 
            startframerate +"\">" + starttimecode + 
            "</inPoint>\n" + "<outPoint fps=\"" + endframerate +"\"> " + endtimecode + 
            " </outPoint>\n </trim> \n"); 
        //trim audio 
        clipListXML = clipListXML.replace("<audioSource>","<audioSource>\n <trim>\n <inPoint fps=\""+ 
            startframerate +"\">" + starttimecode + 
            "</inPoint>\n" + "<outPoint fps=\""+ endframerate +"\">" + 
            endtimecode + "</outPoint>\n </trim>\n");
        node.log( "clip list going out: \n" +clipListXML ); 
        node.setProperty("../clipListXml",clipListXML); 
    }


##<a name="also-see"></a>Δείτε επίσης 

[Εισαγωγή Premium κωδικοποίηση στο Azure Media Services](http://azure.microsoft.com/blog/2015/03/05/introducing-premium-encoding-in-azure-media-services)

[Πώς μπορείτε να χρησιμοποιήσετε Premium κωδικοποίηση στο Azure Media Services](http://azure.microsoft.com/blog/2015/03/06/how-to-use-premium-encoding-in-azure-media-services)

[Κωδικοποίηση On Demand περιεχομένου με την υπηρεσία πολυμέσων Azure](media-services-encode-asset.md#media_encoder_premium_workflow)

[Μορφές ροής εργασίας Premium κωδικοποιητή πολυμέσων και τους κωδικοποιητές](media-services-premium-workflow-encoder-formats.md)

[Δείγματα αρχείων ροής εργασίας](http://github.com/Azure/azure-media-services-samples/tree/master/Encoding%20Presets/VoD/MediaEncoderPremiumWorkfows)

[Εργαλείο Explorer υπηρεσίες πολυμέσων Azure](http://aka.ms/amse)

##<a name="media-services-learning-paths"></a>Διαδικασίες εκμάθησης Media Services

[AZURE.INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

##<a name="provide-feedback"></a>Παροχή σχολίων

[AZURE.INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

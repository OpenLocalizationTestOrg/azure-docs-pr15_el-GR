<properties 
    pageTitle="Χρήση castLabs για την παράδοση Widevine άδειες χρήσης σε υπηρεσιών Azure Media Services | Microsoft Azure" 
    description="Σε αυτό το άρθρο περιγράφει πώς μπορείτε να χρησιμοποιήσετε Azure Media Services (αθροιστικής μέτρησης ενισχύσεων) για να παρέχουν μια ροή που είναι κρυπτογραφημένα δυναμικά από αθροιστικής μέτρησης ενισχύσεων με PlayReady και Widevine DRMs. Η άδεια χρήσης PlayReady προέρχεται από διακομιστή αδειών χρήσης PlayReady υπηρεσίες πολυμέσων και παραδίδεται Widevine άδειας χρήσης από castLabs άδεια χρήσης του διακομιστή." 
    services="media-services" 
    documentationCenter="" 
    authors="Mingfeiy" 
    manager="erikre" 
    editor=""/>

<tags 
    ms.service="media-services" 
    ms.workload="media" 
    ms.tgt_pltfrm="na" 
    ms.devlang="na" 
    ms.topic="article" 
    ms.date="09/26/2016"  
    ms.author="Mingfeiy;willzhan;Juliako"/>


#<a name="using-castlabs-to-deliver-widevine-licenses-to-azure-media-services"></a>Χρήση castLabs για την παράδοση Widevine άδειες χρήσης σε υπηρεσιών Azure Media Services

> [AZURE.SELECTOR]
- [Axinom](media-services-axinom-integration.md)
- [castLabs](media-services-castlabs-integration.md)

##<a name="overview"></a>Επισκόπηση

Σε αυτό το άρθρο περιγράφει πώς μπορείτε να χρησιμοποιήσετε Azure Media Services (αθροιστικής μέτρησης ενισχύσεων) για να παρέχουν μια ροή που είναι κρυπτογραφημένα δυναμικά από αθροιστικής μέτρησης ενισχύσεων με PlayReady και Widevine DRMs. Η άδεια χρήσης PlayReady προέρχεται από διακομιστή αδειών χρήσης PlayReady υπηρεσίες πολυμέσων και παραδίδεται Widevine άδειας χρήσης από **castLabs** άδεια χρήσης του διακομιστή.

Για αναπαραγωγή ροής περιεχόμενο που προστατεύεται από CENC (PlayReady ή/και Widevine), μπορείτε να χρησιμοποιήσετε [Azure Media Player](http://amsplayer.azurewebsites.net/azuremediaplayer.html). Για λεπτομέρειες, ανατρέξτε στο θέμα [AMP εγγράφου](http://amp.azure.net/libs/amp/latest/docs/) .

Το παρακάτω διάγραμμα παρουσιάζει μια υψηλού επιπέδου υπηρεσιών Azure Media Services και την αρχιτεκτονική ενοποίηση castLabs.

![ενοποίηση](./media/media-services-castlabs-integration/media-services-castlabs-integration.png)

##<a name="typical-system-set-up"></a>Τυπικό σύστημα ρύθμιση

- Περιεχόμενο πολυμέσων είναι αποθηκευμένο στο αθροιστικής μέτρησης ενισχύσεων.
- Πλήκτρο αναγνωριστικά περιεχομένου πλήκτρων αποθηκεύονται στο castLabs και αθροιστικής μέτρησης ενισχύσεων.
- castLabs και αθροιστικής μέτρησης ενισχύσεων έχουν διακριτικού ελέγχου ταυτότητας ενσωματωμένη. Οι παρακάτω ενότητες περιγράφουν κωδικοί ελέγχου ταυτότητας. 
- Όταν ένα πρόγραμμα-πελάτη αιτήσεις ροή του βίντεο, το περιεχόμενο είναι δυναμικά κρυπτογραφημένα με **Κοινές κρυπτογράφησης** (CENC) και δυναμικά συσκευαστούν με αθροιστικής μέτρησης ενισχύσεων για ομαλή ροή και ΠΑΎΛΑΣ. Θα σας κάνουν επίσης PlayReady M2TS κρυπτογράφησης δημοτικού ροής για ροή πρωτόκολλο HLS.
- Ανάκτηση άδειας χρήσης PlayReady από διακομιστή αδειών χρήσης αθροιστικής μέτρησης ενισχύσεων και ανάκτηση άδειας χρήσης Widevine από castLabs διακομιστή αδειών χρήσης. 
- Πρόγραμμα αναπαραγωγής πολυμέσων καθορίζεται αυτόματα ποια άδειας χρήσης για τη λήψη με βάση τη δυνατότητα πλατφόρμα προγράμματος-πελάτη. 

##<a name="authentication-token-generation-for-getting-a-license"></a>Έλεγχος ταυτότητας διακριτικού γενιάς για την απόκτηση της άδειας χρήσης

CastLabs και αθροιστικής μέτρησης ενισχύσεων υποστηρίζει διακριτικού μορφή JWT (JSON Web διακριτικού) που χρησιμοποιείται για να εξουσιοδοτήσετε μια άδεια χρήσης. 

###<a name="jwt-token-in-ams"></a>Το διακριτικό JWT στην αθροιστικής μέτρησης ενισχύσεων 

Ο παρακάτω πίνακας περιγράφει το διακριτικό JWT στην αθροιστικής μέτρησης ενισχύσεων. 

Εκδότης|Συμβολοσειρά εκδότη από την επιλεγμένη ασφαλούς υπηρεσίας διακριτικού (STS)
---|---
Ακροατηρίου|Συμβολοσειρά ακροατήριο από το χρησιμοποιούνται STS
Αξιώσεις|Ένα σύνολο αξιώσεων
NotBefore|Έναρξη της ισχύος του διακριτικού
Λήξη|Λήξης ισχύος του διακριτικού
Διαπιστευτήρια υπογραφής|Το κλειδί που χρησιμοποιούνται από κοινού από PlayReady διακομιστή αδειών χρήσης, castLabs διακομιστή αδειών χρήσης και STS, θα ήταν συμμετρική ή ασύμμετρη αριθμού-κλειδιού.

###<a name="jwt-token-in-castlabs"></a>Το διακριτικό JWT στην castLabs

Ο παρακάτω πίνακας περιγράφει το διακριτικό JWT στην castLabs. 

Όνομα|Περιγραφή
---|---
optData|Μια συμβολοσειρά JSON που περιέχει πληροφορίες σχετικά με εσάς. 
CRT|Μια συμβολοσειρά JSON που περιέχει πληροφορίες σχετικά με το περιουσιακών στοιχείων, τα δικαιώματα πληροφορίες και αναπαραγωγή την άδεια χρήσης.
IAT|Το τρέχον datetime στη χρονική σήμανση.
jti|Ένα μοναδικό αναγνωριστικό σχετικά με αυτό το διακριτικό (κάθε διακριτικό μπορεί να χρησιμοποιηθεί μόνο μία φορά στο σύστημα του castLabs).

##<a name="sample-solution-set-up"></a>Δείγμα λύσης ρύθμιση 

Η [λύση δείγμα](https://github.com/AzureMediaServicesSamples/CastlabsIntegration) αποτελείται από δύο έργα:

-   Μια εφαρμογή κονσόλας που μπορούν να χρησιμοποιηθούν για να ορίσετε περιορισμούς DRM σε μια ήδη αναρροφώμενου περιουσιακών στοιχείων, για PlayReady και Widevine.
-   Μια εφαρμογή Web που χέρια ανάληψη διακριτικά, που μπορεί να θεωρούνται ως μια έκδοση ΠΟΛΎ ΑΠΛΟΠΟΙΗΜΈΝΑ του ένα STS.


Για να χρησιμοποιήσετε την εφαρμογή κονσόλας:

1.  Αλλαγή του app.config εγκατάστασης αθροιστικής μέτρησης ενισχύσεων διαπιστευτήρια, castLabs διαπιστευτήρια, ρύθμιση παραμέτρων STS και κοινόχρηστο κλειδί.
2.  Αποστολή ενός περιουσιακού στοιχείου σε αθροιστικής μέτρησης ενισχύσεων.
3.  Λάβετε το UUID από το απεσταλμένο περιουσιακών στοιχείων και αλλάξτε 32 γραμμή στο αρχείο Program.cs:

         var objIAsset = _context.Assets.Where(x => x.Id == "nb:cid:UUID:dac53a5d-1500-80bd-b864-f1e4b62594cf").FirstOrDefault();

4.  Χρησιμοποιήστε ένα AssetId για την ονομασία του περιουσιακού στοιχείου στο σύστημα του castLabs (44 γραμμή στο αρχείο Program.cs).

    Πρέπει να ορίσετε AssetId για **castLabs**; πρέπει να είναι μια μοναδική αλφαριθμητική συμβολοσειρά.

5.  Εκτέλεση του προγράμματος.


Για να χρησιμοποιήσετε την εφαρμογή Web (STS):

1.  Αλλάξτε το αρχείο web.config σε εμπορικών castlabs ρύθμισης Αναγνωριστικό, τη ρύθμιση παραμέτρων STS και το κοινόχρηστο κλειδί.
2.  Ανάπτυξη Azure τοποθεσίες Web που διαθέτετε.
3.  Μεταβείτε στην τοποθεσία Web.

##<a name="playing-back-a-video"></a>Αναπαραγωγή βίντεο

Για αναπαραγωγή βίντεο κρυπτογραφημένα με κοινές κρυπτογράφησης (PlayReady ή/και Widevine), μπορείτε να χρησιμοποιήσετε το [Πρόγραμμα αναπαραγωγής πολυμέσων Azure](http://amsplayer.azurewebsites.net/azuremediaplayer.html). Κατά την εκτέλεση της εφαρμογής κονσόλας, το Αναγνωριστικό αριθμό-κλειδί περιεχομένου και τη διεύθυνση URL δήλωσης επαναλαμβάνονται.

1.  Ανοίξτε μια νέα καρτέλα και εκκίνηση σας STS: http://[yourStsName].azurewebsites.net/api/token/assetid/[yourCastLabsAssetId]/contentkeyid/[thecontentkeyid].
2.  Μεταβείτε στο [πρόγραμμα αναπαραγωγής πολυμέσων Azure](http://amsplayer.azurewebsites.net/azuremediaplayer.html).
3.  Επικολλήστε τη διεύθυνση URL ροής.
4.  Επιλέξτε το πλαίσιο ελέγχου **Επιλογές για προχωρημένους** .
5.  Στην αναπτυσσόμενη λίστα **προστασία** , επιλέξτε PlayReady ή/και Widevine.
6.  Επικολλήστε το διακριτικό που λάβατε από την STS στο πλαίσιο κειμένου διακριτικού. 
    
    Δεν χρειάζεται ο διακομιστής αδειών χρήσης castLab το "φορέα =" πρόθεμα μπροστά από το διακριτικό. Επομένως, καταργήστε που πριν από την υποβολή το διακριτικό.
7.  Ενημερώστε το πρόγραμμα αναπαραγωγής.
8.  Θα πρέπει να η αναπαραγωγή του βίντεο.


##<a name="media-services-learning-paths"></a>Διαδικασίες εκμάθησης Media Services

[AZURE.INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

##<a name="provide-feedback"></a>Παροχή σχολίων

[AZURE.INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

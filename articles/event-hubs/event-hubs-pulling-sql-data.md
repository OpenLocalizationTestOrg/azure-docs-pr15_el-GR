<properties
   pageTitle="Έλξη δεδομένων SQL σε διανομείς συμβάν Azure | Microsoft Azure"
   description="Επισκόπηση των οι διανομείς συμβάν εισαγωγή από το δείγμα SQL"
   services="event-hubs"
   documentationCenter="na"
   authors="spyrossak"
   manager="timlt"
   editor=""/>

<tags 
   ms.service="event-hubs"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="08/25/2016"
   ms.author="spyros;sethm" />

# <a name="pulling-data-from-sql-into-an-azure-event-hub"></a>Έλξη δεδομένων από το SQL σε ένα διανομέα συμβάν Azure

Μια τυπική αρχιτεκτονική για μια εφαρμογή επεξεργασίας δεδομένα σε πραγματικό χρόνο περιλαμβάνει πρώτα Ώθηση το με ένα διανομέα συμβάν Azure. Μπορεί να είναι ένα σενάριο IoT, όπως η παρακολούθηση την κυκλοφορία σε διαφορετικά τμήματα της μια highway, ή ένα σενάριο παιχνιδιών, παρακολούθηση ενεργειών που οφείλονται σε μια Βάλτε της frenzied contestants, ή ένα σενάριο για μεγάλες επιχειρήσεις, όπως η παρακολούθηση δόμησης διάθεση των χώρων. Σε αυτές τις περιπτώσεις, οι πάροχοι δεδομένων είναι γενικά εξωτερικά αντικείμενα παράγουν χρονολογική σειρά δεδομένων που χρειάζεστε για να συλλέξετε, αναλύει, αποθήκευση και act κατά και, ενδέχεται να έχετε επενδύσει πολλές προσπάθειας σε δόμησης εκτός της υποδομής για αυτές τις διαδικασίες. Τι κάνετε εάν θέλετε να εισαγάγετε δεδομένα από κάτι όπως μια βάση δεδομένων και όχι μια προέλευση δεδομένων ροής και χρήση σε συνδυασμό με άλλες ροής τα δεδομένα σας; Εξετάστε το ενδεχόμενο να στην υπόθεση όπου θέλετε να χρησιμοποιήσετε Azure ροή ανάλυση, απομακρυσμένο Εξερεύνηση δεδομένων (RDX) ή ορισμένες άλλες εργαλείο για την ανάλυση και την εκτέλεση ενεργειών σε αργά-αλλαγή των δεδομένων από το Microsoft Dynamics AX ή σύστημα διαχείριση εγκαταστάσεων; Για να επιλύσετε αυτό το πρόβλημα, χρησιμοποιούμε έχετε γράψει και άνοιγμα-φορολόγησης που προέρχονται από ένα δείγμα μικρές cloud που μπορείτε να τροποποιήσετε και να υλοποιήσετε που θα εξαγάγετε τα δεδομένα από έναν πίνακα SQL και να προωθήσετε το σε μια ενότητα συμβάν Azure για να χρησιμοποιήσετε ως εισαγωγή στις εφαρμογές σας ροής αναλυτικής. Συνειδητοποιήσετε ότι αυτό είναι ένα σενάριο σπάνιων και το αντίθετο από τι κάνετε συνήθως με ένα διανομέα συμβάν. Ωστόσο, εάν διαπιστώσετε ότι στην περίπτωση όπου πρόκειται για τι πρέπει να κάνετε, μπορείτε να βρείτε τον κώδικα στη συλλογή Azure δείγματα, [εδώ](https://azure.microsoft.com/documentation/samples/event-hubs-dotnet-import-from-sql/).  

Σημειώστε ότι ο κώδικας σε αυτό το δείγμα είναι ακριβώς αυτό, ένα δείγμα. Είναι **δεν** πρόκειται να μια εφαρμογή παραγωγής, και έχουν γίνει χωρίς προσπάθειες ώστε να είναι κατάλληλες για χρήση σε ένα περιβάλλον όπως - είναι stricly μια DIY, προγραμματιστής εστίαση, παράδειγμα. Πρέπει να εξετάσετε όλα τα είδη των ασφαλείας, επιδόσεων, Λειτουργίες και κόστους παράγοντες πριν από την εκκαθάριση του σε μια αρχιτεκτονική για ολοκληρωμένες.

## <a name="application-structure"></a>Δομή εφαρμογής

Η εφαρμογή είναι γραμμένο σε C# και το αρχείο readme.md στο δείγμα περιέχει όλες τις πληροφορίες που χρειάζεστε για να τροποποιήσετε, να δημιουργήσετε και να δημοσιεύσετε την εφαρμογή. Οι παρακάτω ενότητες παρέχουν μια επισκόπηση υψηλού επιπέδου του τι κάνει η εφαρμογή.

Θα σας Ξεκινήστε με την προϋπόθεση ότι έχετε πρόσβαση σε έναν πίνακα SQL Azure. Θα χρειαστεί επίσης να έχετε ρυθμίσει ένα διανομέα συμβάν Azure και γνωρίζετε τη σύνδεση συμβολοσειράς που απαιτείται για την πρόσβαση σε αυτό.

Κατά την εκκίνηση της λύσης SqlToEventHub, διαβάζει ένα αρχείο ρύθμισης παραμέτρων (App.config) για να βρείτε έναν αριθμό πράγματα, όπως περιγράφεται στο αρχείο readme.md. Αυτές είναι αρκετά αυτονόητα, όπως το όνομα του πίνακα δεδομένων, κ.λπ και χωρίς να χρειάζεται να rehash οι εξηγήσεις εδώ. 

Μόλις η εφαρμογή έχει διαβάσει το αρχείο ρύθμισης παραμέτρων, το μεταβαίνει σε βρόχο, ανάγνωση του πίνακα SQL και προώθηση εγγραφές σε ενότητα συμβάντων, στη συνέχεια, αναμονή για ένα διάστημα που ορίζονται από το χρήστη αναμονής πριν να κάνετε από ξανά. Μερικά πράγματα είναι αξίζει να αναφερθούν:

1. Η εφαρμογή βασίζεται υπόθεση που ο πίνακας SQL ενημερώνεται από ορισμένα εξωτερικά διεργασία και που θέλετε να στείλετε όλα και μόνο τις ενημερώσεις με ένα διανομέα συμβάν.
2. Ο πίνακας SQL πρέπει να έχει ένα πεδίο που έχει ένα μοναδικό και αυξανόμενου τον αριθμό, για παράδειγμα, μια εγγραφή ΑΡΙΘΜΟΣ. Αυτό μπορεί να είναι τόσο απλή όσο ένα πεδίο που ονομάζεται "Αναγνωριστικό" ή οτιδήποτε άλλο αυξάνεται ως ό, τι ενημερώνει αυτήν τη βάση δεδομένων προσθέτει εγγραφές όπως "Creation_time" ή "Sequence_number". Η εφαρμογή σημειώσεων και αποθηκεύει την τιμή αυτού του πεδίου σε κάθε επανάληψη. Σε κάθε οι επόμενες πέρασμα έως το βρόχο, η εφαρμογή ουσιαστικά ερωτήματα στον πίνακα για όλες τις εγγραφές όπου η τιμή του πεδίου που υπερβαίνει την τιμή του είδατε την τελευταία φορά που διέρχεται από το βρόχο. Θα σας καλείτε αυτήν την τελευταία τιμή "Μετατόπιση".
3. Η εφαρμογή δημιουργεί έναν πίνακα "TableOffsets" όταν ξεκινά προς τα επάνω, για να αποθηκεύσετε τις αποστάσεις. Ο πίνακας δημιουργείται με το ερώτημα "CreateOffsetTableQuery" ορίζονται στο αρχείο ρύθμισης παραμέτρων. 
4. Υπάρχουν πολλά ερωτήματα που χρησιμοποιούνται για την εργασία με το offset πίνακα, που ορίζεται στο αρχείο ρύθμισης παραμέτρων ως "OffsetQuery", "UpdateOffsetQuery" και "InsertOffsetQuery". Δεν πρέπει να αλλάξετε τα εξής.
5. Τέλος, το ερώτημα "ερώτημα δεδομένων" που ορίζονται από το στο αρχείο παραμέτρων είναι το ερώτημα που θα εκτελεστεί για να αποσπάσετε τις εγγραφές από τον πίνακα SQL. Περιορίζεται αυτήν τη στιγμή στην αρχή 1.000 εγγραφών με κάθε κίνηση μέσω του βρόχου για σκοπούς βελτιστοποίηση - εάν, για παράδειγμα, 25.000 εγγραφές έχουν προστεθεί στη βάση δεδομένων από το τελευταίο ερώτημα, που ενδέχεται να χρειαστεί κάποιος χρόνος για να εκτελέσετε το ερώτημα. Με τον περιορισμό του ερωτήματος σε 1.000 εγγραφές κάθε φορά, τα ερωτήματα είναι πολύ πιο γρήγορα. Επιλογή επάνω 1.000 απλό προωθεί διαδοχικές δέσμες 1.000 εγγραφών στο διανομέα συμβάν.    

## <a name="next-steps"></a>Επόμενα βήματα

Για να αναπτύξετε τη λύση, κλωνοποίηση ή κάντε λήψη της εφαρμογής SqlToEventHub, επεξεργαστείτε το αρχείο App.config, δημιουργήστε το και τέλος δημοσιεύστε το. Αφού έχετε δημοσιεύσει την εφαρμογή, μπορείτε να το δείτε εκτελείται στην πύλη του Azure κλασική κάτω από τις υπηρεσίες Cloud και παρακολουθείτε τα συμβάντα που προέρχονται από το κέντρο του συμβάντος σας. Σημειώστε ότι η συχνότητα θα προσδιοριστεί από δύο πράγματα: τη συχνότητα από τις ενημερώσεις για τον πίνακα SQL και το χρονικό διάστημα αναμονής που έχετε καθορίσει στο αρχείο ρύθμισης παραμέτρων για την εφαρμογή.
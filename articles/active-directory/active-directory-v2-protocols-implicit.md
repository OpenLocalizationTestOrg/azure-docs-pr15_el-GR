<properties
    pageTitle="Azure AD v2.0 έμμεσα ροής | Microsoft Azure"
    description="Εφαρμογές web δόμησης με χρήση του Azure AD v2.0 υλοποίηση της ροής της έμμεσα για μία μόνο σελίδα εφαρμογών."
    services="active-directory"
    documentationCenter=""
    authors="dstrockis"
    manager="mbaldwin"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/16/2016"
    ms.author="dastrock"/>

# <a name="v20-protocols---spas-using-the-implicit-flow"></a>v2.0 πρωτόκολλα - ιαματικές πηγές με την μη ρητή ροής
Με το τελικό σημείο v2.0, μπορείτε να υπογράφετε οι χρήστες σας εφαρμογές μίας σελίδας με προσωπικές και εταιρικό/σχολικό λογαριασμούς από τη Microsoft.  Μεμονωμένη σελίδα και άλλες εφαρμογές JavaScript που εκτελούνται κυρίως σε ένα πρόγραμμα περιήγησης πρόσωπο ενδιαφέρον μερικές προκλήσεις στον τομέα όταν θέλετε να τον έλεγχο ταυτότητας:

- Τα χαρακτηριστικά ασφαλείας του αυτές τις εφαρμογές είναι σημαντικά διαφορετικό από τις εφαρμογές web που βασίζονται σε παραδοσιακά διακομιστή.
- Πολλά διακομιστές εξουσιοδότησης & υπηρεσίες παροχής ταυτότητας δεν υποστηρίζουν αιτήσεις CORS.
- Πρόγραμμα περιήγησης πλήρους σελίδας ανακατευθύνει μακριά από την εφαρμογή γίνονται ιδιαίτερα επεμβατικά στην εμπειρία του χρήστη.

Για αυτές τις εφαρμογές (πιστεύετε ότι: AngularJS, Ember.js, React.js, κλπ) Azure AD υποστηρίζει το διακριτικό 2.0 έμμεσα εκχώρηση ροής.  Μη ρητή ροής της περιγράφεται στην [Προδιαγραφή 2.0 OAuth](http://tools.ietf.org/html/rfc6749#section-4.2).  Το βασικό πλεονέκτημα είναι να επιτρέπει στην εφαρμογή για να λάβετε τα διακριτικά από το Azure AD χωρίς την εκτέλεση ενός διακομιστή παρασκηνίου διαπιστευτηρίων exchange.  Αυτό σας επιτρέπει την εφαρμογή για να εισέλθετε στο χρήστη, να διατηρείτε την περίοδο λειτουργίας και λάβετε τα διακριτικά για άλλες web APIs όλα αυτά μέσα σε πρόγραμμα-πελάτη κώδικα JavaScript.  Υπάρχουν ορισμένα ζητήματα ασφαλείας σημαντικό να λάβετε υπόψη κατά τη χρήση της ροής έμμεσα - συγκεκριμένα γύρω από [υπολογιστή-πελάτη](http://tools.ietf.org/html/rfc6749#section-10.3) και [απομίμησης χρήστη](http://tools.ietf.org/html/rfc6749#section-10.3).

Εάν θέλετε να χρησιμοποιήσετε την μη ρητή ροής και Azure AD για να προσθέσετε τον έλεγχο ταυτότητας σε εφαρμογή της JavaScript, συνιστάται να χρησιμοποιείτε το άνοιγμα JavaScript Βιβλιοθήκη αρχείων προέλευσης [adal.js](https://github.com/AzureAD/azure-activedirectory-library-for-js).  Υπάρχουν μερικά προγράμματα εκμάθησης AngularJS [εδώ](active-directory-appmodel-v2-overview.md#getting-started) για να σας βοηθήσει να ξεκινήσετε.  

Ωστόσο, εάν προτιμάτε να μην χρησιμοποιεί μια βιβλιοθήκη στην εφαρμογή μεμονωμένη σελίδα και αποστολή μηνυμάτων πρωτόκολλο στον εαυτό σας, ακολουθήστε τα παρακάτω γενικά βήματα.

> [AZURE.NOTE]
    Δεν όλα τα σενάρια Azure Active Directory και δυνατότητες που υποστηρίζονται από το τελικό σημείο v2.0.  Για να καθορίσετε εάν θα πρέπει να χρησιμοποιήσετε το τελικό σημείο v2.0, διαβάστε σχετικά με [τους περιορισμούς v2.0](active-directory-v2-limitations.md).
    
## <a name="protocol-diagram"></a>Πρωτόκολλο διαγράμματος
Ολόκληρη έμμεσα είσοδος ροής μοιάζει κάπως έτσι - κάθε ένα από τα βήματα που περιγράφονται λεπτομερώς παρακάτω.

![OpenId σύνδεση κλειστών λωρίδων](../media/active-directory-v2-flows/convergence_scenarios_implicit.png)

## <a name="send-the-sign-in-request"></a>Στείλτε την πρόσκληση εισόδου

Για να συνδεθείτε αρχικά το χρήστη στην εφαρμογή σας, μπορείτε να στείλετε μια αίτηση εξουσιοδότησης [OpenID σύνδεση](active-directory-v2-protocols-oidc.md) και να λάβετε μια `id_token` από το τελικό σημείο v2.0:

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=id_token+token
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&scope=openid%20https%3A%2F%2Fgraph.microsoft.com%2Fmail.read
&response_mode=fragment
&state=12345
&nonce=678910
```

> [AZURE.TIP] Κάντε κλικ στη σύνδεση παρακάτω για να εκτελέσει αυτήν την αίτηση! Μετά την είσοδο, θα πρέπει να ανακατευθύνονται το πρόγραμμα περιήγησης `https://localhost/myapp/` με ένα `id_token` στη γραμμή διευθύνσεων.
    <a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=id_token+token&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&scope=openid%20https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment&state=12345&nonce=678910" target="_blank">https://Login.microsoftonline.com/Common/oauth2/v2.0/Authorize...</a>

| Παράμετρος | | Περιγραφή |
| ----------------------- | ------------------------------- | --------------- |
| μισθωτή | απαιτείται | Το `{tenant}` τιμή στη διαδρομή της αίτησης μπορούν να χρησιμοποιηθούν για να ελέγχετε ποιος μπορεί να συνδεθείτε στην εφαρμογή.  Οι επιτρεπόμενοι τιμές είναι `common`, `organizations`, `consumers`, και μισθωτή αναγνωριστικά.  Για περισσότερες λεπτομέρειες, ανατρέξτε στο θέμα [βασικές δυνατότητες πρωτόκολλο](active-directory-v2-protocols.md#endpoints). |
| client_id | απαιτείται | Το αναγνωριστικό εφαρμογής ότι η πύλη εγγραφής ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)), στους οποίους έχουν ανατεθεί την εφαρμογή σας. |
| response_type | απαιτείται | Πρέπει να περιλαμβάνει `id_token` για OpenID σύνδεση εισόδου.  Μπορεί επίσης να περιλαμβάνει το response_type `token`. Χρήση `token` εδώ θα σας επιτρέψει να λαμβάνετε ένα διακριτικό πρόσβασης αμέσως από το τελικό σημείο εξουσιοδότηση, χωρίς να χρειάζεται να κάνετε μια δεύτερη αίτηση το τελικό σημείο εξουσιοδότηση εφαρμογή σας.  Εάν χρησιμοποιείτε το `token` response_type, το `scope` παραμέτρου πρέπει να περιέχει ένα εύρος που υποδεικνύει τον πόρο που θα το διακριτικό για το πρόβλημα. |
| redirect_uri | Συνιστάται | Το redirect_uri της εφαρμογής, όπου μπορούν να αποστολής και λήψης από την εφαρμογή του ελέγχου ταυτότητας των απαντήσεων.  Αυτό πρέπει να αντιστοιχεί ακριβώς ένα από τα redirect_uris που έχουν καταχωρηθεί στην πύλη του, εκτός από αυτό πρέπει να κωδικοποιηθεί ως διεύθυνση url. |
| πεδίο εφαρμογής | απαιτείται | Μια λίστα διαχωρισμένες με εύρους.  Για να συνδεθείτε OpenID, πρέπει να περιλαμβάνει την εμβέλεια `openid`, που μεταφράζει το δικαίωμα "Είσοδος στο" στη συγκατάθεση περιβάλλοντος εργασίας Χρήστη.  Προαιρετικά μπορεί επίσης να θέλετε να συμπεριλάβετε το `email` ή `profile` [εύρους](active-directory-v2-scopes.md) για να αποκτήσετε πρόσβαση σε δεδομένα επιπλέον χρήστη.  Μπορείτε επίσης να συμπεριλάβετε άλλα πεδία σε αυτήν την αίτηση για την αίτηση συγκατάθεση για διάφορους πόρους.  |
| response_mode | Συνιστάται | Καθορίζει τη μέθοδο που πρέπει να χρησιμοποιούνται για την αποστολή που προκύπτει διακριτικού πίσω για την εφαρμογή σας.  Πρέπει να `fragment` για την μη ρητή ροής.  |
| κατάσταση | Συνιστάται | Μια τιμή που περιλαμβάνονται στην αίτηση που θα επιστραφεί επίσης στην διακριτικού απάντηση.  Μπορεί να είναι μια συμβολοσειρά οποιοδήποτε περιεχόμενο που θέλετε.  Μια μοναδική τιμή που δημιούργησε τυχαία χρησιμοποιείται συνήθως για την [Αποτροπή επιθέσεις πλαστογράφησης διατοποθεσιακή αίτηση](http://tools.ietf.org/html/rfc6749#section-10.12).  Η κατάσταση χρησιμοποιείται επίσης για την κωδικοποίηση πληροφοριών σχετικά με την κατάσταση του χρήστη στην εφαρμογή πριν από την αίτηση ελέγχου ταυτότητας προέκυψε, όπως τη σελίδα ή την προβολή που είχαν στην. |
| nonce | απαιτείται | Μια τιμή που περιλαμβάνονται στην αίτηση, που δημιουργούνται από την εφαρμογή, που θα συμπεριληφθούν στο την προκύπτουσα id_token ως δήλωση.  Η εφαρμογή, στη συνέχεια, να επιβεβαιώσετε αυτήν την τιμή για τον περιορισμό επιθέσεις διακριτικού αναπαραγωγής.  Η τιμή είναι συνήθως μια τυχαία, μοναδικό συμβολοσειρά που μπορούν να χρησιμοποιηθούν για να προσδιορίσετε την προέλευση της αίτησης.  |
| γραμμή εντολών | προαιρετικό | Υποδεικνύει τον τύπο της αλληλεπίδραση με το χρήστη που είναι απαραίτητη.  Οι έγκυρες μόνο τιμές αυτήν τη στιγμή είναι "σύνδεση", "Καμία", και 'συγκατάθεση'.  `prompt=login`θα επιβάλετε το χρήστη για να εισαγάγετε τα διαπιστευτήριά τους σε αυτό το αίτημα, προσήμου καθολικής σύνδεσης σε.  `prompt=none`είναι το αντίθετο - εξασφαλίζει ότι ο χρήστης δεν παρέχονται αλληλεπίδραση με το χρήστη οποιαδήποτε.  Εάν δεν είναι δυνατή η ολοκλήρωση της αίτησης σιωπηρά μέσω καθολικής σύνδεσης στην, το τελικό σημείο v2.0 θα επιστρέψουν σφάλμα.  `prompt=consent`θα ενεργοποιήσει το παράθυρο διαλόγου συγκατάθεση διακριτικό αφού ο χρήστης που πραγματοποιεί είσοδο, που σας ρωτά το χρήστη για να εκχωρήσετε δικαιώματα για την εφαρμογή. |
| login_hint | προαιρετικό | Μπορεί να χρησιμοποιηθεί για προ-συμπληρώσετε το πεδίο διεύθυνση username/ηλεκτρονικού ταχυδρομείου της διαδικασίας Πραγματοποιήστε είσοδο στη σελίδα για το χρήστη, εάν γνωρίζετε το όνομα χρήστη εκ των προτέρων.  Συχνά οι εφαρμογές θα χρησιμοποιήσετε αυτήν την παράμετρο κατά την επανάληψη του ελέγχου ταυτότητας, έχοντας ήδη που έχουν εξαχθεί το όνομα χρήστη από μια προηγούμενη είσοδος με χρήση του `preferred_username` διεκδίκηση. |
| domain_hint | προαιρετικό | Μπορεί να είναι μία από `consumers` ή `organizations`.  Εάν συμπεριλαμβάνεται, αυτό θα παραλείψετε τη διαδικασία εντοπισμού βασίζεται στο ηλεκτρονικό ταχυδρομείο αυτόν το χρήστη, έχετε στη σελίδα, είσοδος v2.0 αποτέλεσμα ελαφρώς πιο ομαλή εμπειρία χρήστη.  Συχνά οι εφαρμογές θα χρησιμοποιήσετε αυτήν την παράμετρο κατά την επανάληψη του ελέγχου ταυτότητας, κατά την εξαγωγή του `tid` διεκδίκηση από το id_token.  Εάν το `tid` διεκδίκηση τιμή είναι `9188040d-6c67-4c5b-b112-36a304b66dad`, θα πρέπει να χρησιμοποιήσετε `domain_hint=consumers`.  Διαφορετικά, χρησιμοποιήστε `domain_hint=organizations`. |

Σε αυτό το σημείο, ο χρήστης θα σας ζητηθεί να εισαγάγετε τα διαπιστευτήριά τους και να ολοκληρώσετε τον έλεγχο ταυτότητας.  Το τελικό σημείο v2.0 θα εξασφαλίσει ότι ο χρήστης έχει δεχθεί να τα δικαιώματα που υποδεικνύεται στην επίσης το `scope` ερώτημα παραμέτρων.  Εάν ο χρήστης δεν έχει δεχθεί σε οποιαδήποτε από αυτά τα δικαιώματα, αυτό θα ερώτηση στο χρήστη για να δώσετε τη συγκατάθεσή σας για να τα απαραίτητα δικαιώματα.  Λεπτομέρειες [δικαιώματα, συγκατάθεση, και εφαρμογές πολλών μισθωτή παρέχονται εδώ](active-directory-v2-scopes.md).

Όταν ο χρήστης πραγματοποιεί έλεγχο ταυτότητας και εκχωρεί συγκατάθεση, το τελικό σημείο v2.0 θα επιστρέψει μια απάντηση σε εφαρμογή στο του καθορισμένου `redirect_uri`, χρησιμοποιώντας τη μέθοδο που καθορίζεται στο το `response_mode` παραμέτρου.

#### <a name="successful-response"></a>Επιτυχής απόκρισης

Μια επιτυχημένη απόκριση με τη χρήση `response_mode=fragment` και `response_type=id_token+token` μοιάζει με τα εξής, με τις αλλαγές γραμμών για αναγνωσιμότητα:

```
GET https://localhost/myapp/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&token_type=Bearer
&expires_in=3599
&scope=https%3a%2f%2fgraph.microsoft.com%2fmail.read 
&id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=12345
```

| Παράμετρος | Περιγραφή |
| ----------------------- | ------------------------------- |
| access_token | Εάν περιλαμβάνεται `response_type` περιλαμβάνει `token`. Το διακριτικό πρόσβασης που η εφαρμογή ζητήθηκε, σε αυτήν την περίπτωση για το Microsoft Graph.  Το διακριτικό πρόσβασης δεν πρέπει να αποκωδικοποιείται ή να διαφορετικά επιθεώρηση, μπορούν να θεωρούνται ως συμβολοσειρά αδιαφανές. |
| token_type | Εάν περιλαμβάνεται `response_type` περιλαμβάνει `token`.  Θα είναι πάντα `Bearer`. |
| expires_in | Εάν περιλαμβάνεται `response_type` περιλαμβάνει `token`.  Υποδεικνύει τον αριθμό των δευτερολέπτων το διακριτικό δεν είναι έγκυρο, για προσωρινή αποθήκευση σκοπούς. |
| πεδίο εφαρμογής | Εάν περιλαμβάνεται `response_type` περιλαμβάνει `token`.  Υποδεικνύει ότι το εύρος για την οποία θα ισχύει η access_token. |
| id_token | Το id_token που ζητήθηκε από την εφαρμογή. Μπορείτε να χρησιμοποιήσετε το id_token για να επαληθεύσετε την ταυτότητα του χρήστη και να ξεκινήσετε μια περίοδο λειτουργίας με το χρήστη.  Η [αναφορά διακριτικού τελικού σημείου v2.0](active-directory-v2-tokens.md)περιλαμβάνει περισσότερες λεπτομέρειες σχετικά με id_tokens και τα περιεχόμενά τους.  |
| κατάσταση | Εάν μια παράμετρος κατάσταση περιλαμβάνει την αίτηση, την ίδια τιμή θα πρέπει να εμφανίζεται στην απάντηση. Η εφαρμογή θα πρέπει να βεβαιωθείτε ότι τις τιμές κατάσταση της αίτησης και της απόκρισης είναι πανομοιότυπες. |


#### <a name="error-response"></a>Απόκριση σφάλμα
Απαντήσεις σφάλματος μπορεί να αποσταλούν επίσης για το `redirect_uri` , ώστε η εφαρμογή να τους χειριστεί σωστά:

```
GET https://localhost/myapp/#
error=access_denied
&error_description=the+user+canceled+the+authentication
```

| Παράμετρος | Περιγραφή |
| ----------------------- | ------------------------------- |
| Σφάλμα | Μια συμβολοσειρά κωδικό σφάλματος που μπορεί να χρησιμοποιηθεί για την ταξινόμηση των τύπων σφάλματα που προκύπτουν και μπορεί να χρησιμοποιηθεί προκειμένου να αντιμετωπίζεται σφάλματα. |
| error_description | Ένα συγκεκριμένο μήνυμα σφάλματος που μπορεί να σας βοηθήσει ο προγραμματιστής Προσδιορισμός της αρχικής αιτίας ενός σφάλματος ελέγχου ταυτότητας.  |

## <a name="validate-the-idtoken"></a>Επικυρώστε τη id_token
Μόλις λαμβάνει μια id_token δεν επαρκεί για τον έλεγχο ταυτότητας του χρήστη. πρέπει να επικυρώσετε τη id_token υπογραφή και επαληθεύστε την αξιώσεων στο διακριτικό ανά απαιτήσεις της εφαρμογής σας.  Το τελικό σημείο v2.0 χρησιμοποιεί [Τα διακριτικά Web JSON (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) και κρυπτογράφηση δημόσιου κλειδιού να πραγματοποιήσετε τα διακριτικά και να επιβεβαιώσετε ότι είναι έγκυρα.

Μπορείτε να επιλέξετε να επικυρώσετε τη `id_token` στο πρόγραμμα-πελάτη κώδικα, αλλά μια κοινή πρακτική είναι να στείλετε το `id_token` σε ένα διακομιστή υποστήριξης και να εκτελέσετε την επικύρωση εκεί.  Αφού έχετε επικύρωση την υπογραφή του id_token, υπάρχουν μερικά αξιώσεων που θα σας ζητηθεί να επιβεβαιώσετε.  Ανατρέξτε στο άρθρο [αναφορά διακριτικού v2.0](active-directory-v2-tokens.md) για περισσότερες πληροφορίες, όπως [Την επικύρωση διακριτικά](active-directory-v2-tokens.md#validating-tokens) και [Σημαντικές πληροφορίες σχετικά με την είσοδο κλειδί κατάδειξης](active-directory-v2-tokens.md#validating-tokens).  Συνιστάται να κάνουν χρήση μιας βιβλιοθήκης για ανάλυση και επικύρωση διακριτικά - υπάρχει τουλάχιστον μία για περισσότερες γλώσσες και πλατφόρμες.
<!--TODO: Improve the information on this-->

Επίσης, ίσως θελήσετε να επικυρώσετε επιπλέον αξιώσεων ανάλογα με το σενάριό σας.  Ορισμένες κοινές επικυρώσεων περιλαμβάνουν τα εξής:

- Διασφάλιση ότι το χρήστη/εταιρείας έχει εγγραφεί για την εφαρμογή.
- Διασφάλιση ότι ο χρήστης δεν διαθέτει εξουσιοδότηση proper/δικαιώματα
- Διασφάλιση ότι ένα συγκεκριμένο ισχύ του ελέγχου ταυτότητας Παρουσιάστηκε, όπως τον έλεγχο ταυτότητας πολλών παραγόντων.

Για περισσότερες πληροφορίες σχετικά με τις απαιτήσεις σε μια id_token, ανατρέξτε στο άρθρο [αναφορά διακριτικού v2.0 τελικού σημείου](active-directory-v2-tokens.md).

Μόλις που έχουν επικύρωση εντελώς το id_token, μπορείτε να ξεκινήσετε μια περίοδο λειτουργίας με το χρήστη και να χρησιμοποιήσετε το αξιώσεων στο το id_token για τη λήψη πληροφοριών σχετικά με το χρήστη στην εφαρμογή.  Αυτές οι πληροφορίες μπορεί να χρησιμοποιηθεί για την εμφάνιση, εγγραφών, άδειες, κ.λπ.

## <a name="get-access-tokens"></a>Λήψη διακριτικά πρόσβασης

Τώρα που έχετε εισέλθει στο χρήστη στην εφαρμογή σας μία μόνο σελίδα, μπορείτε να λάβετε διακριτικά πρόσβασης για κλήση web APIs ασφαλές από Azure AD, όπως το [Microsoft Graph](https://graph.microsoft.io).  Ακόμα και αν έχετε ήδη λάβει ένα διακριτικού χρησιμοποιώντας το `token` response_type, μπορείτε να χρησιμοποιήσετε αυτήν τη μέθοδο για να αποκτήσετε τα διακριτικά με επιπλέον πόρους χωρίς να χρειάζεται να ανακατευθύνετε το χρήστη για να συνδεθείτε ξανά.

Στην κανονική ροή OpenID σύνδεση/OAuth, θα το κάνετε αυτό, καθιστώντας μια αίτηση για την έκδοση 2.0 `/token` τελικού σημείου.  Ωστόσο, το τελικό σημείο v2.0 δεν υποστηρίζει τις αιτήσεις CORS, ώστε να πραγματοποιήσετε κλήσεις AJAX για τη λήψη και να ανανεώσετε τα διακριτικά είναι εκτός των ερώτηση.  Αντί για αυτό, μπορείτε να χρησιμοποιήσετε τη ροή έμμεσα σε ένα iframe, κρυφά για να λάβετε νέα διακριτικών για άλλες APIs web: 

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=token
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment
&state=12345&nonce=678910
&prompt=none
&domain_hint=organizations
&login_hint=myuser@mycompany.com
```

> [AZURE.TIP] Δοκιμάστε την αντιγραφή και επικόλληση το κάτω από την αίτηση σε μια καρτέλα του προγράμματος περιήγησης! (Μην ξεχάσετε να αντικαταστήσετε το `domain_hint` και το `login_hint` τιμών με τις σωστές τιμές για το χρήστη)

```
https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=token&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment&state=12345&nonce=678910&prompt=none&domain_hint={{consumers-or-organizations}}&login_hint={{your-username}}
```

| Παράμετρος | | Περιγραφή |
| ----------------------- | ------------------------------- | --------------- |
| μισθωτή | απαιτείται | Το `{tenant}` τιμή στη διαδρομή της αίτησης μπορούν να χρησιμοποιηθούν για να ελέγχετε ποιος μπορεί να συνδεθείτε στην εφαρμογή.  Οι επιτρεπόμενοι τιμές είναι `common`, `organizations`, `consumers`, και μισθωτή αναγνωριστικά.  Για περισσότερες λεπτομέρειες, ανατρέξτε στο θέμα [βασικές δυνατότητες πρωτόκολλο](active-directory-v2-protocols.md#endpoints). |
| client_id | απαιτείται | Το αναγνωριστικό εφαρμογής ότι η πύλη εγγραφής ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)), στους οποίους έχουν ανατεθεί την εφαρμογή σας. |
| response_type | απαιτείται | Πρέπει να περιλαμβάνει `id_token` για OpenID σύνδεση εισόδου.  Μπορεί επίσης να περιλαμβάνει άλλες response_types, όπως είναι οι `code`. |
| redirect_uri | Συνιστάται | Το redirect_uri της εφαρμογής, όπου μπορούν να αποστολής και λήψης από την εφαρμογή του ελέγχου ταυτότητας των απαντήσεων.  Αυτό πρέπει να αντιστοιχεί ακριβώς ένα από τα redirect_uris που έχουν καταχωρηθεί στην πύλη του, εκτός από αυτό πρέπει να κωδικοποιηθεί ως διεύθυνση url. |
| πεδίο εφαρμογής | απαιτείται | Μια λίστα διαχωρισμένες με εύρους.  Για λήψη διακριτικά, συμπεριλάβετε όλα τα [πεδία](active-directory-v2-scopes.md) που απαιτείται για τον πόρο που σας ενδιαφέρουν.  |
| response_mode | Συνιστάται | Καθορίζει τη μέθοδο που πρέπει να χρησιμοποιούνται για την αποστολή που προκύπτει διακριτικού πίσω για την εφαρμογή σας.  Μπορεί να είναι του `query`, `form_post`, ή `fragment`.  |
| κατάσταση | Συνιστάται | Μια τιμή που περιλαμβάνονται στην αίτηση που θα επιστραφεί επίσης στην διακριτικού απάντηση.  Μπορεί να είναι μια συμβολοσειρά οποιοδήποτε περιεχόμενο που θέλετε.  Μια μοναδική τιμή που δημιούργησε τυχαία χρησιμοποιείται συνήθως για την αποτροπή επιθέσεις πλαστογράφησης διατοποθεσιακή αίτηση.  Η κατάσταση χρησιμοποιείται επίσης για την κωδικοποίηση πληροφοριών σχετικά με την κατάσταση του χρήστη στην εφαρμογή πριν από την αίτηση ελέγχου ταυτότητας προέκυψε, όπως τη σελίδα ή την προβολή που είχαν στην. |
| nonce | απαιτείται | Μια τιμή που περιλαμβάνονται στην αίτηση, που δημιουργούνται από την εφαρμογή, που θα συμπεριληφθούν στο την προκύπτουσα id_token ως δήλωση.  Η εφαρμογή, στη συνέχεια, να επιβεβαιώσετε αυτήν την τιμή για τον περιορισμό επιθέσεις διακριτικού αναπαραγωγής.  Η τιμή είναι συνήθως μια τυχαία, μοναδικό συμβολοσειρά που μπορούν να χρησιμοποιηθούν για να προσδιορίσετε την προέλευση της αίτησης.  |
| γραμμή εντολών | απαιτείται | Για ανανέωση και γρήγορα τα διακριτικά σε ένα iframe, κρυφά, θα πρέπει να χρησιμοποιήσετε `prompt=none` για να βεβαιωθείτε ότι το iframe δεν κλείνει τη γραμμή στη σελίδα εισόδου του v2.0 και επιστρέφει αμέσως. |
| login_hint | απαιτείται | Για ανανέωση και γρήγορα τα διακριτικά σε ένα iframe, κρυφά, πρέπει να συμπεριλάβετε το όνομα χρήστη του χρήστη στο αυτή η υπόδειξη για να διακρίνετε ανάμεσα σε πολλές περίοδοι λειτουργίας, ο χρήστης μπορεί να έχει σε μια δεδομένη χρονική στιγμή. Μπορείτε να εξαγάγετε το όνομα χρήστη από μια προηγούμενη είσοδος με χρήση του `preferred_username` διεκδίκηση. |
| domain_hint | απαιτείται | Μπορεί να είναι μία από `consumers` ή `organizations`.  Για ανανέωση και γρήγορα τα διακριτικά σε ένα iframe, κρυφά, πρέπει να συμπεριλάβετε το domain_hint στην αίτηση.  Θα πρέπει να μπορείτε να εξαγάγετε τα `tid` διεκδίκηση από το id_token από μια προηγούμενη είσοδος για να καθορίσετε ποια τιμή για να χρησιμοποιήσετε.  Εάν το `tid` διεκδίκηση τιμή είναι `9188040d-6c67-4c5b-b112-36a304b66dad`, θα πρέπει να χρησιμοποιήσετε `domain_hint=consumers`.  Διαφορετικά, χρησιμοποιήστε `domain_hint=organizations`. |

Ευχαριστώντας το `prompt=none` παράμετρο, αυτή η αίτηση θα είτε επιτύχει ή αποτύχει αμέσως και να επιστρέψετε στην εφαρμογή σας.  Θα σταλεί μια επιτυχημένη απόκριση σε εφαρμογή στο του καθορισμένου `redirect_uri`, χρησιμοποιώντας τη μέθοδο που καθορίζεται στο το `response_mode` παραμέτρου.

#### <a name="successful-response"></a>Επιτυχής απόκρισης
Μια επιτυχημένη απόκριση με τη χρήση `response_mode=fragment` μοιάζει με:

```
GET https://localhost/myapp/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=12345
&token_type=Bearer
&expires_in=3599
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read
```

| Παράμετρος | Περιγραφή |
| ----------------------- | ------------------------------- |
| access_token | Το διακριτικό που ζητήθηκε από την εφαρμογή. |
| token_type | Θα είναι πάντα `Bearer`. |
| κατάσταση | Εάν μια παράμετρος κατάσταση περιλαμβάνει την αίτηση, την ίδια τιμή θα πρέπει να εμφανίζεται στην απάντηση. Η εφαρμογή θα πρέπει να βεβαιωθείτε ότι τις τιμές κατάσταση της αίτησης και της απόκρισης είναι πανομοιότυπες. |
| expires_in | Πόσο χρόνο το διακριτικό πρόσβασης είναι έγκυρη (σε δευτερόλεπτα). |
| πεδίο εφαρμογής | Τα πεδία που ισχύει για το διακριτικό πρόσβασης. |

#### <a name="error-response"></a>Απόκριση σφάλμα
Απαντήσεις σφάλματος μπορεί να αποσταλούν επίσης για το `redirect_uri` , ώστε η εφαρμογή να τους χειριστεί σωστά.  Της `prompt=none`, θα είναι το αναμενόμενο σφάλμα:

```
GET https://localhost/myapp/#
error=user_authentication_required
&error_description=the+request+could+not+be+completed+silently
```

| Παράμετρος | Περιγραφή |
| ----------------------- | ------------------------------- |
| Σφάλμα | Μια συμβολοσειρά κωδικό σφάλματος που μπορεί να χρησιμοποιηθεί για την ταξινόμηση των τύπων σφάλματα που προκύπτουν και μπορεί να χρησιμοποιηθεί προκειμένου να αντιμετωπίζεται σφάλματα. |
| error_description | Ένα συγκεκριμένο μήνυμα σφάλματος που μπορεί να σας βοηθήσει ο προγραμματιστής Προσδιορισμός της αρχικής αιτίας ενός σφάλματος ελέγχου ταυτότητας.  |

Εάν λάβετε αυτό το σφάλμα στην πρόσκληση σε iframe, ο χρήστης πρέπει να αλληλεπιδραστικά εισέλθετε ξανά για να ανακτήσετε έναν νέο κωδικό.  Μπορείτε να επιλέξετε να χειρίζεται αυτήν την περίπτωση σε οποιονδήποτε τρόπο με τον οποίο έχει νόημα για την εφαρμογή σας.

## <a name="refreshing-tokens"></a>Ανανέωση διακριτικά

Και τα δύο `id_token`s και `access_token`s θα λήγουν μετά από ένα σύντομο χρονική περίοδο, ώστε να την εφαρμογή σας πρέπει να προετοιμαστείτε για να ανανεώσετε αυτά τα διακριτικά περιοδικά.  Για να ανανεώσετε οποιονδήποτε τύπο διακριτικού, μπορείτε να εκτελέσετε την ίδια πρόσκληση σε κρυφές iframe από σημείο άνωθεν χρησιμοποιώντας το `prompt=none` παραμέτρου για τον έλεγχο της συμπεριφοράς Azure AD.  Εάν θέλετε να λαμβάνετε ένα νέο `id_token`, φροντίστε να χρησιμοποιήσετε `response_type=id_token` και `scope=openid`, καθώς και μια `nonce` παραμέτρου.


## <a name="send-a-sign-out-request"></a>Στείλτε μια πρόσκληση σε Έξοδος

Το OpenIdConnect `end_session_endpoint` δεν υποστηρίζεται αυτήν τη στιγμή από το τελικό σημείο v2.0. Αυτό σημαίνει ότι την εφαρμογή σας δεν είναι δυνατό να στείλετε μια αίτηση στο τελικό σημείο v2.0 για να τερματίσετε την περίοδο λειτουργίας ενός χρήστη και καταργήστε την επιλογή από τα cookies που έχουν οριστεί από το τελικό σημείο v2.0.
Για να πραγματοποιήσετε χρήστη ανάληψη, την εφαρμογή σας μπορεί να απλώς τελειώνει το δικό της περιόδου λειτουργίας με το χρήστη και αφήστε την περίοδο λειτουργίας του χρήστη με το v2.0 τελικό σημείο στο-ανέπαφες.  Την επόμενη φορά που ο χρήστης επιχειρεί να πραγματοποιήσετε είσοδο, θα δουν μια σελίδα "επιλέξτε λογαριασμού", με τους λογαριασμούς ενεργά συνδεδεμένοι στο που παρατίθενται.
Σε αυτήν τη σελίδα, ο χρήστης μπορεί να επιλέξει για να εξέλθετε από οποιονδήποτε λογαριασμό, τερματίζει την περίοδο λειτουργίας με το τελικό σημείο v2.0.

<!--

When you wish to sign the user out of the  app, it is not sufficient to clear your app's cookies or otherwise end the session with the user.  You must also redirect the user to the v2.0 endpoint for sign out.  If you fail to do so, the user will be able to re-authenticate to your app without entering their credentials again, because they will have a valid single sign-on session with the v2.0 endpoint.

You can simply redirect the user to the `end_session_endpoint` listed in the OpenID Connect metadata document:

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/logout?
post_logout_redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
```

| Parameter | | Description |
| ----------------------- | ------------------------------- | ------------ |
| post_logout_redirect_uri | recommended | The URL which the user should be redirected to after successful logout.  If not included, the user will be shown a generic message by the v2.0 endpoint.  |

-->
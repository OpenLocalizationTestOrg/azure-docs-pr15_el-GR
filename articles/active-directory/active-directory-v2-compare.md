<properties
    pageTitle="Το τελικό σημείο v2.0 Azure AD | Microsoft Azure"
    description="Μια σύγκριση μεταξύ του αρχικού Azure AD και τα τελικά σημεία v2.0."
    services="active-directory"
    documentationCenter=""
    authors="dstrockis"
    manager="mbaldwin"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/16/2016"
    ms.author="dastrock"/>

# <a name="whats-different-about-the-v20-endpoint"></a>Ποια είναι η διαφορά σχετικά με το τελικό σημείο v2.0;

Εάν είστε εξοικειωμένοι με το Azure Active Directory ή έχετε συνδέσει εφαρμογές με Azure AD στο παρελθόν, μπορεί να υπάρχουν ορισμένες διαφορές σε το τελικό σημείο v2.0 που που δεν θα περιμένατε.  Αυτό το έγγραφο κλήσεις από αυτές τις διαφορές για την κατανόηση.

> [AZURE.NOTE]
    Δεν όλα τα σενάρια Azure Active Directory και δυνατότητες που υποστηρίζονται από το τελικό σημείο v2.0.  Για να καθορίσετε εάν θα πρέπει να χρησιμοποιήσετε το τελικό σημείο v2.0, διαβάστε σχετικά με [τους περιορισμούς v2.0](active-directory-v2-limitations.md).


## <a name="microsoft-accounts-and-azure-ad-accounts"></a>Λογαριασμοί Microsoft και λογαριασμοί Azure AD
το τελικό σημείο v2.0 επιτρέπει στους προγραμματιστές να γράψετε εφαρμογές που αποδέχονται είσοδο από λογαριασμούς Microsoft και Azure AD λογαριασμούς, χρησιμοποιώντας ένα τελικό σημείο μία auth.  Αυτό σας δίνει τη δυνατότητα εγγραφής της εφαρμογής σας εντελώς λογαριασμού-agnostic; μπορεί να είναι ignorant του τύπου του λογαριασμού που ο χρήστης πραγματοποιήσει με.  Φυσικά, μπορείτε *να* κάνετε εφαρμογή σας γνωρίζουν τον τύπο του λογαριασμού που χρησιμοποιείται σε μια συγκεκριμένη περίοδο λειτουργίας, αλλά δεν χρειάζεται να.

Για παράδειγμα, εάν η εφαρμογή σας καλεί το [Microsoft Graph](https://graph.microsoft.io), ορισμένες πρόσθετες λειτουργίες και τα δεδομένα θα είναι διαθέσιμες στους χρήστες για μεγάλες επιχειρήσεις, όπως τοποθεσίες του SharePoint ή του καταλόγου δεδομένων τους.  Αλλά για πολλές ενέργειες, όπως η [Ανάγνωση αλληλογραφίας του χρήστη](https://graph.microsoft.io/docs/api-reference/v1.0/resources/message), τον κωδικό μπορούν να εγγραφούν ακριβώς το ίδιο για λογαριασμούς Microsoft και Azure AD λογαριασμούς.  

Ενοποίηση της εφαρμογής σας με το Microsoft και των λογαριασμών Azure AD είναι τώρα μια απλή διαδικασία.  Μπορείτε να χρησιμοποιήσετε ένα σύνολο τελικά σημεία, μια μεμονωμένη βιβλιοθήκη και μια μεμονωμένη εφαρμογή εγγραφής για να αποκτήσετε πρόσβαση σε κατηγορία τόσο το καταναλωτή και για μεγάλες επιχειρήσεις.  Για να μάθετε περισσότερα σχετικά με το τελικό σημείο v2.0, δείτε [την επισκόπηση](active-directory-appmodel-v2-overview.md).


## <a name="new-app-registration-portal"></a>Νέα πύλη καταχώρηση εφαρμογής
το τελικό σημείο v2.0 μόνο μπορεί να έχει εγγραφεί σε μια νέα θέση: [apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList).  Αυτή είναι η πύλη όπου μπορείτε να αποκτήσετε ένα αναγνωριστικό εφαρμογής, προσαρμόστε την εμφάνιση της εφαρμογής σας στη σελίδα εισόδου και πολλά άλλα.  Μόνο που πρέπει να αποκτήσετε πρόσβαση στη πύλη είναι ένας λογαριασμός Microsoft που υποστηρίζεται - για προσωπική χρήση ή εταιρικό/σχολικό λογαριασμό.  

Θα συνεχίσουμε να προσθέσετε περισσότερες και περισσότερες λειτουργίες σε αυτήν την πύλη καταχώρηση εφαρμογής μέσα στο χρόνο.  Ο στόχος είναι ότι θα αυτήν την πύλη στη νέα θέση όπου μπορείτε να μεταβείτε για να διαχειριστείτε όλα τα στοιχεία και όλα όσα χρειάζεται να κάνω με τις εφαρμογές της Microsoft.


## <a name="one-app-id-for-all-platforms"></a>Ένα αναγνωριστικό εφαρμογής για όλες τις πλατφόρμες
Στην αρχική υπηρεσία Azure Active Directory, ενδέχεται να έχουν καταχωρηθεί πολλές διαφορετικές εφαρμογές για το έργο.  Ήταν υποχρεωμένοι να χρησιμοποιήσετε ξεχωριστή εφαρμογή καταχωρήσεων εγγενή προγράμματα-πελάτες και εφαρμογές web:

![Παλιά εγγραφή εφαρμογών περιβάλλοντος εργασίας Χρήστη](../media/active-directory-v2-flows/old_app_registration.PNG)

Για παράδειγμα, αν δημιουργήσει μια τοποθεσία Web και μια εφαρμογή iOS, θα έπρεπε να καταχωρήσετε ξεχωριστά, χρησιμοποιώντας δύο διαφορετικές αναγνωριστικών εφαρμογής.  Εάν είχατε μια τοποθεσία Web και έναν υπολογιστή στο παρασκήνιο api στο web, που μπορεί να έχετε καταχωρήσει κάθε ως ξεχωριστή εφαρμογή στο Azure AD.  Εάν είχατε μια εφαρμογή iOS και Android εφαρμογής, που επίσης μπορεί να έχετε καταχωρήσει δύο διαφορετικές εφαρμογές.  

<!-- You may have even registered different apps for each of your build environments - one for dev, one for test, and one for production. -->

Τώρα, μόνο που πρέπει να είναι μια μεμονωμένη εφαρμογή καταχώρησης και ένα μεμονωμένο αναγνωριστικό εφαρμογής για κάθε ένα από τα έργα σας.  Μπορείτε να προσθέσετε πολλές "πλατφόρμες" σε κάθε έργο, και παρέχει τα κατάλληλα δεδομένα για κάθε πλατφόρμα που μπορείτε να προσθέσετε.  Φυσικά, μπορείτε να δημιουργήσετε όσο το δυνατόν περισσότερες εφαρμογές που σας αρέσει ανάλογα με τις απαιτήσεις σας, αλλά για το μεγαλύτερο μέρος των περιπτώσεις μόνο ένα αναγνωριστικό εφαρμογής πρέπει να είναι απαραίτητο.

<!-- You can also label a particular platform as "production-ready" when it is ready to be published to the outside world, and use that same Application Id safely in your development environments. -->

Στόχος μας είναι ότι αυτό θα οδηγήσει σε μια εμπειρία ανάπτυξης και πιο απλοποιημένη διαχείριση εφαρμογών και δημιουργήστε μια πιο ενοποιημένη προβολή των ένα έργο που μπορεί εργάζεστε σε.


## <a name="scopes-not-resources"></a>Εύρος, όχι πόροι
Στην αρχική υπηρεσία Azure AD, μια εφαρμογή μπορεί να συμπεριφέρεται ως έναν **πόρο**ή έναν παραλήπτη από διακριτικά.  Ένας πόρος να ορίσετε έναν αριθμό **εύρους** ή **oAuth2Permissions** που κατανοούν, επιτρέποντάς προγράμματος-πελάτη εφαρμογές για να ζητήσετε διακριτικά σε αυτόν τον πόρο για ένα συγκεκριμένο σύνολο εύρους.  Εξετάστε το API Azure AD γράφημα ως παράδειγμα ενός πόρου:

- Αναγνωριστικό πόρου, ή `AppID URI`:`https://graph.windows.net/`
- Εύρος, ή `OAuth2Permissions`: `Directory.Read`, `Directory.Write`κ.λπ.  

Όλα αυτά ισχύει για το το τελικό σημείο v2.0.  Μια εφαρμογή μπορεί να εξακολουθεί να συμπεριφέρεται ως πόρο, ορισμός εύρους και προσδιορίζεται από ένα URI.  Εφαρμογές προγράμματος-πελάτη εξακολουθούν να μπορούν να αίτηση για πρόσβαση σε αυτά τα πεδία.  Ωστόσο, ο τρόπος με την οποία ένας υπολογιστής-πελάτης ζητά αυτά τα δικαιώματα έχει αλλάξει.  Στο παρελθόν, εγκρίνετε μια 2.0 διακριτικό αίτηση για Azure AD ενδέχεται να έχετε αναζητήσει όπως:

```
GET https://login.microsoftonline.com/common/oauth2/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&resource=https%3A%2F%2Fgraph.windows.net%2F
...
```

όπου η παράμετρος **πόρων** που υποδεικνύεται τον πόρο στην εφαρμογή υπολογιστή-πελάτη ζητά άδεια.  Azure AD υπολογιστεί τα δικαιώματα που απαιτούνται από την εφαρμογή που βασίζεται σε στατική ρύθμιση παραμέτρων στην πύλη του Azure και εκδοθεί διακριτικά αντίστοιχα.  Τώρα, το ίδιο 2.0 διακριτικό επιτρέπουν την αίτηση φαίνεται ότι:

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

όπου η παράμετρος **εύρος** δηλώνει τον πόρο και δικαιώματα στην εφαρμογή ζητά άδεια για. Η επιθυμητή πόρων εξακολουθεί να είναι πολύ παρουσίαση στην πρόσκληση σε - απλώς που περικλείονται σε κάθε μία από τις τιμές της παραμέτρου εύρος.  Χρήση της παραμέτρου εμβέλειας με αυτόν τον τρόπο επιτρέπει το τελικό σημείο v2.0 να είναι πιο συμβατή με την προδιαγραφή OAuth 2.0 και Στοιχίζει λεπτομερέστερα με κοινές πρακτικές κλάδο.  Επιτρέπει επίσης εφαρμογές για να εκτελέσετε [αυξάνονται συγκατάθεση](#incremental-and-dynamic-consent), που περιγράφεται στην επόμενη ενότητα.

## <a name="incremental-and-dynamic-consent"></a>Τμηματική και δυναμικές συγκατάθεση
Εφαρμογές που έχουν καταχωρηθεί στο τα γενικά διαθέσιμο Azure AD χρειάζεται, για να καθορίσετε τα απαραίτητα δικαιώματα διακριτικό 2.0 στην πύλη του Azure, κατά τη δημιουργία εφαρμογής υπηρεσίας:

![Δικαιώματα εγγραφής περιβάλλοντος εργασίας Χρήστη](../media/active-directory-v2-flows/app_reg_permissions.PNG)

Τα δικαιώματα εφαρμογής απαιτείται έχουν ρυθμιστεί **στατικά**.  Ενώ αυτή επιτρέπεται η ρύθμιση των παραμέτρων της εφαρμογής για να υπάρχει στην πύλη του Azure και διατηρούνται τον κώδικα όμορφες και απλό, παρουσιάζει ορισμένα ζητήματα για τους προγραμματιστές:

- Μια εφαρμογή έπρεπε να γνωρίζουν όλα τα δικαιώματα που θα χρειαστεί ποτέ κατά τη δημιουργία εφαρμογής.  Προσθήκη δικαιωμάτων μέσα στο χρόνο ήταν μια δύσκολη διαδικασία.
- Μια εφαρμογή έπρεπε να γνωρίζουν όλοι οι πόροι που μπορεί να ποτέ πρόσβαση σε εκ των προτέρων.  Ήταν δύσκολη διαδικασία για να δημιουργήσετε εφαρμογές που μπορεί να έχουν πρόσβαση ένας αυθαίρετος αριθμός πόρων.
- Μια εφαρμογή έπρεπε να ζητήσετε όλα τα δικαιώματα που θα χρειαστεί κατά του χρήστη πρώτη είσοδος.  Σε ορισμένες περιπτώσεις αυτό οδήγησε σε μια μεγάλη λίστα με δικαιώματα, τα οποία αποτρέπεται οι τελικοί χρήστες από την έγκριση της εφαρμογής access στην αρχική εισόδου.

Με το τελικό σημείο v2.0, μπορείτε να καθορίσετε τα δικαιώματα της εφαρμογής σας χρειάζεται **δυναμικά**, κατά το χρόνο εκτέλεσης, κατά την κανονική χρήση της εφαρμογής σας.  Για να το κάνετε αυτό, μπορείτε να καθορίσετε το εύρος της εφαρμογής σας χρειάζεται σε οποιοδήποτε σημείο δεδομένη στιγμή, συμπεριλαμβάνοντας τους στο το `scope` παραμέτρου μιας αίτησης εξουσιοδότησης:

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/authorize?
client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read%20https%3A%2F%2Fgraph.windows.net%2Fdirectory.write
...
```

Το παραπάνω αιτήσεις δικαιωμάτων για την εφαρμογή για την ανάγνωση ενός χρήστη Azure AD καταλόγου δεδομένων, καθώς και εγγραφή δεδομένων σε τους καταλόγου.  Εάν ο χρήστης έχει δεχθεί σε αυτά τα δικαιώματα στο παρελθόν για αυτήν την εφαρμογή συγκεκριμένο, απλώς θα εισαγάγετε τα διαπιστευτήριά τους και να έχετε πραγματοποιήσει στην εφαρμογή.  Εάν ο χρήστης δεν έχει δεχθεί σε οποιαδήποτε από αυτά τα δικαιώματα, το τελικό σημείο v2.0 θα ζητήστε από το χρήστη για τη συγκατάθεσή για αυτά τα δικαιώματα.  Για περισσότερες πληροφορίες, μπορείτε να διαβάσετε προς τα επάνω σε [δικαιώματα, συγκατάθεση, και εύρους](active-directory-v2-scopes.md).

Παρέχει μια εφαρμογή για να ζητήσετε δικαιώματα δυναμικά μέσω του `scope` παραμέτρου παρέχει πλήρη έλεγχο εμπειρία χρήστη σας.  Εάν θέλετε, μπορείτε να επιλέξετε να frontload τη συγκατάθεσή σας εμπειρία και ρωτήστε για όλα τα δικαιώματα σε μία αίτηση αρχικής άδειας.  Ή, εάν η εφαρμογή σας απαιτεί μεγάλο αριθμό δικαιωμάτων, μπορείτε να επιλέξετε να συγκεντρώσετε αυτά τα δικαιώματα από το χρήστη κατά αύξουσα σειρά, όπως προσπαθήσουν να χρησιμοποιήσετε ορισμένες δυνατότητες της εφαρμογής σας μέσα στο χρόνο.

## <a name="well-known-scopes"></a>Οι γνωστές εύρους

#### <a name="offline-access"></a>Πρόσβαση χωρίς σύνδεση
το τελικό σημείο v2.0 ενδέχεται να απαιτούν τη χρήση του μια νέα γνωστές δικαιωμάτων για τις εφαρμογές - το `offline_access` εύρος.  Όλες οι εφαρμογές θα πρέπει να ζητήσετε αυτό το δικαίωμα, εάν πρέπει να αποκτήσετε πρόσβαση σε πόρους για το λογαριασμό χρήστη για μια μακρά χρονική περίοδο, ακόμη και όταν ο χρήστης ίσως δεν θα χρησιμοποιήσει την εφαρμογή.  Το `offline_access` εύρος θα εμφανίζεται στο χρήστη σε παράθυρα διαλόγου συγκατάθεση ως "Πρόσβαση στα δεδομένα σας χωρίς σύνδεση", όπου ο χρήστης πρέπει να συμφωνεί με.  Αίτηση το `offline_access` δικαιωμάτων θα ενεργοποιήσετε την εφαρμογή web της λήψης 2.0 διακριτικό refresh_tokens από το τελικό σημείο v2.0.  Refresh_tokens είναι μεγάλης διάρκειας, ενώ μπορείτε να ανταλλάσσετε για νέα access_tokens διακριτικό 2.0 για μεγάλο χρονικό διάστημα της access.  

Εάν η εφαρμογή σας δεν ζητήσει η `offline_access` εύρος, αυτό δεν θα λαμβάνετε refresh_tokens.  Αυτό σημαίνει ότι κατά την εξαργύρωση ενός authorization_code της [ροής κώδικα εξουσιοδότησης διακριτικό 2.0](active-directory-v2-protocols.md#oauth2-authorization-code-flow), θα λαμβάνετε μόνο ξανά μια access_token από το `/token` τελικού σημείου.  Access_token που θα εξακολουθεί να ισχύει για ένα σύντομο χρονικό διάστημα (συνήθως μία ώρα), αλλά τελικά θα λήξει.  Επιστροφή AT που χρονική στιγμή, την εφαρμογή σας θα πρέπει να ανακατευθύνετε το χρήστη του `/authorize` τελικό σημείο για να ανακτήσετε μια νέα authorization_code.  Κατά τη διάρκεια αυτής της ανακατεύθυνσης, ο χρήστης μπορεί να ή ίσως να μην χρειάζεται να εισαγάγετε ξανά τα διαπιστευτήριά τους ή εκ νέου τη συγκατάθεσή σας για να δικαιώματα, ανάλογα με το τον τύπο της εφαρμογής.

Για να μάθετε περισσότερα σχετικά με το διακριτικό 2.0, refresh_tokens και access_tokens, δείτε την [αναφορά πρωτόκολλο v2.0](active-directory-v2-protocols.md).

#### <a name="openid-profile--email"></a>OpenID, προφίλ & ηλεκτρονικού ταχυδρομείου

Στην αρχική υπηρεσία Azure Active Directory, την πιο βασικές OpenID σύνδεση εισόδου ροής θα μπορούσε να παρέχει πληθώρα πληροφοριών σχετικά με το χρήστη στο το id_token που προκύπτει.  Το αξιώσεων σε μια id_token να συμπεριλάβετε του χρήστη όνομα, προτιμώμενη όνομα χρήστη, τη διεύθυνση ηλεκτρονικού ταχυδρομείου, Αναγνωριστικό αντικειμένου και πολλά άλλα.

Τώρα θα σας ο περιορισμός τις πληροφορίες που το `openid` εύρος δίνει την πρόσβαση εφαρμογής.  Το εύρος 'openid' θα μόνο να επιτρέψετε την εφαρμογή σας για να συνδεθείτε στο χρήστη στο και να λαμβάνετε ένα αναγνωριστικό εφαρμογής ειδικά για το χρήστη.  Εάν θέλετε να αποκτήσετε αναγνωρίσιμα προσωπικά στοιχεία (PII) σχετικά με το χρήστη στην εφαρμογή, την εφαρμογή σας θα πρέπει να ζητήσετε πρόσθετα δικαιώματα από το χρήστη.  Θα σας εισαγωγή δύο νέα εύρους – το `email` και `profile` εύρους – που σας επιτρέπουν να το κάνετε.

Το `email` εμβέλειας είναι πολύ απλές-να επιτρέπει την πρόσβαση εφαρμογής του χρήστη κύρια διεύθυνση ηλεκτρονικού ταχυδρομείου μέσω του `email` διεκδίκηση στο το id_token.  Το `profile` εύρος δίνει την πρόσβασή σας εφαρμογή σε όλες τις άλλες βασικές πληροφορίες σχετικά με το χρήστη – τους όνομα, το όνομα χρήστη προτιμώμενη, Αναγνωριστικό αντικειμένου και ούτω καθεξής.

Αυτό σας επιτρέπει να κώδικα την εφαρμογή σας με τον τρόπο ελάχιστους αποκάλυψης – μπορείτε μόνο να ζητήσετε από το χρήστη για το σύνολο των πληροφοριών που απαιτεί την εφαρμογή σας για να κάνετε τη δουλειά.  Για περισσότερες πληροφορίες σχετικά με αυτές τις επιλογές εύρους, ανατρέξτε [στην](active-directory-v2-scopes.md)αναφορά εύρος v2.0. 

## <a name="token-claims"></a>Αξιώσεις διακριτικού

Δεν θα είναι ίδιο με τα διακριτικά εκδοθεί από τα γενικά διαθέσιμο το αξιώσεων στο διακριτικών που εκδίδονται από το τελικό σημείο v2.0 τελικά σημεία Azure AD - εφαρμογές τη μετεγκατάσταση για τη νέα υπηρεσία δεν πρέπει να θεωρήσετε μια συγκεκριμένη διεκδίκηση θα υπάρχει σε id_tokens ή access_tokens.   Διακριτικά που εκδίδονται από το τελικό σημείο v2.0 είναι συμβατά με το διακριτικό 2.0 και συνδέστε OpenID προδιαγραφές, αλλά ενδέχεται να ακολουθήσετε διαφορετική σημασιολογία από τα γενικά διαθέσιμο Azure AD υπηρεσίας.

Για να μάθετε περισσότερα σχετικά με το συγκεκριμένο αξιώσεων που εκπέμπει στο v2.0 διακριτικά, ανατρέξτε στο άρθρο [αναφορά διακριτικού v2.0](active-directory-v2-tokens.md).

## <a name="limitations"></a>Περιορισμοί
Υπάρχουν μερικά περιορισμοί για να λάβετε υπόψη όταν χρησιμοποιείτε το σημείο v2.0.  Ανατρέξτε στην [v2.0 περιορισμοί έγγραφο](active-directory-v2-limitations.md) για να δείτε εάν ισχύει οποιαδήποτε από αυτές τις περιορισμούς στη δική σας περίπτωση.

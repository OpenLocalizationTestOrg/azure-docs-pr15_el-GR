<properties
    pageTitle="Azure AD v2.0 διακριτικού αναφοράς | Microsoft Azure"
    description="Οι τύποι διακριτικά και αξιώσεων που εκπέμπει το τελικό σημείο v2.0"
    services="active-directory"
    documentationCenter=""
    authors="dstrockis"
    manager="mbaldwin"
    editor=""/>

<tags
    ms.service="active-directory"
    ms.workload="identity"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/30/2016"
    ms.author="dastrock"/>

# <a name="v20-token-reference"></a>αναφορά διακριτικού v2.0

Το τελικό σημείο v2.0 εκπέμπει διάφορους τύπους διακριτικά ασφαλείας κατά την επεξεργασία του κάθε [ροής ελέγχου ταυτότητας](active-directory-v2-flows.md). Αυτό το έγγραφο περιγράφει τη μορφή, χαρακτηριστικά ασφαλείας και περιεχόμενα κάθε τύπο διακριτικού.

> [AZURE.NOTE]
    Δεν όλα τα σενάρια Azure Active Directory και δυνατότητες που υποστηρίζονται από το τελικό σημείο v2.0.  Για να καθορίσετε εάν θα πρέπει να χρησιμοποιήσετε το τελικό σημείο v2.0, διαβάστε σχετικά με [τους περιορισμούς v2.0](active-directory-v2-limitations.md).

## <a name="types-of-tokens"></a>Τύποι διακριτικά

Το τελικό σημείο v2.0 υποστηρίζει το [πρωτόκολλο εξουσιοδότησης διακριτικό 2.0](active-directory-v2-protocols.md), που χρησιμοποιεί το access_tokens και refresh_tokens.  Επίσης, υποστηρίζει τον έλεγχο ταυτότητας και είσοδος μέσω [Σύνδεση OpenID](active-directory-v2-protocols.md#openid-connect-sign-in-flow), που παρουσιάζει ένα τρίτο τύπο διακριτικό, το id_token.  Κάθε ένα από αυτά τα διακριτικά αναπαρίσταται ως "διακριτικό φορέα".

Διακριτικό φορέα είναι διακριτικό ελαφριά ασφαλείας που εκχωρεί πρόσβαση "φορέα" σε ένα προστατευμένο πόρο. Με αυτήν την έννοια, "φορέα" είναι οποιοδήποτε μέρος που μπορεί να παρουσιάζουν το διακριτικό. Αν και ένα πάρτι πρέπει να πρώτα τον έλεγχο ταυτότητας με Azure AD για να λάβετε το διακριτικό φορέα, εάν δεν έχουν ληφθεί τα απαραίτητα βήματα για την ασφάλιση το διακριτικό στο μετάδοση και το χώρο αποθήκευσης, μπορεί να υποκλοπής και να χρησιμοποιούνται από ένα ανεπιθύμητα μέρη. Ενώ ορισμένες διακριτικά ασφαλείας έχει ένα ενσωματωμένο μηχανισμό για την αποτροπή μη εξουσιοδοτημένα άτομα από τη χρήση τους, τα διακριτικά φορέα δεν έχουν αυτός ο μηχανισμός και πρέπει να μεταφέρονται σε ασφαλούς καναλιού όπως ασφάλεια επιπέδου μεταφοράς (HTTPS). Εάν ένα διακριτικό φορέα μεταδίδονται στο Απαλοιφή, μια Άντρας στο το μεσαίο επίθεση μπορεί να χρησιμοποιηθεί από ένα κακόβουλο μέρος για να αποκτήσετε το διακριτικό και να το χρησιμοποιήσετε για μια μη εξουσιοδοτημένη πρόσβαση σε ένα προστατευμένο πόρο. Τις ίδιες βασικές αρχές ασφαλείας εφαρμογή κατά την αποθήκευση ή την προσωρινή αποθήκευση διακριτικά φορέα για μελλοντική χρήση. Πάντα βεβαιωθείτε ότι η εφαρμογή σας μεταδίδει και αποθηκεύει τα διακριτικά φορέα με ασφαλή τρόπο. Για περισσότερες ζητήματα ασφαλείας στην διακριτικά φορέα, ανατρέξτε στο θέμα [RFC 6750 τμήμα 5](http://tools.ietf.org/html/rfc6750).

Πολλά από τα διακριτικά εκδοθεί από το τελικό σημείο v2.0 υλοποιούνται ως διακριτικά Web Json ή JWTs.  Ένα JWT είναι μια συμπαγή, διεύθυνση URL ασφαλείς μέσο μεταφορά πληροφοριών μεταξύ των δύο μέρη.  Οι πληροφορίες που περιέχονται στο JWTs είναι γνωστό ως "αξιώσεων" ή διεκδικήσεων των πληροφοριών σχετικά με τον φορέα και το θέμα του διακριτικού.  Το αξιώσεων στο JWTs είναι αντικείμενα JSON κωδικοποιημένη και σειριοποιηθεί για τη μετάδοση.  Επειδή το JWTs εκδοθεί από το τελικό σημείο v2.0 υπογραφή, αλλά δεν κρυπτογραφημένα, μπορείτε να ελέγξετε εύκολα τα περιεχόμενα ενός JWT για σκοπούς εντοπισμού σφαλμάτων. Για περισσότερες πληροφορίες σχετικά με JWTs, μπορείτε να αναφερθείτε με την [προδιαγραφή JWT](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html).

## <a name="idtokens"></a>Id_tokens

Id_tokens είναι μια φόρμα του διακριτικού ασφαλείας εισόδου που λαμβάνει την εφαρμογή σας κατά την εκτέλεση του ελέγχου ταυτότητας με χρήση της [Σύνδεσης OpenID](active-directory-v2-protocols.md#openid-connect-sign-in-flow).  Μπορούν παρουσιάζονται ως [JWTs](#types-of-tokens)και περιέχουν αξιώσεων που μπορείτε να χρησιμοποιήσετε για είσοδο στο χρήστη στην εφαρμογή σας.  Μπορείτε να χρησιμοποιήσετε το αξιώσεων σε μια id_token όπως βλέπετε ότι ταιριάζουν – συνήθως χρησιμοποιούνται για την εμφάνιση των πληροφοριών του λογαριασμού ή τη λήψη αποφάσεων ελέγχου πρόσβασης σε μια εφαρμογή.  Το τελικό σημείο v2.0 ζητήματα μόνο id_token, η οποία έχει ένα συνεπές σύνολο αξιώσεων ανεξάρτητα από τον τύπο του χρήστη που έχει συνδεθεί σε έναν τύπο.  Που είναι να πείτε ότι τη μορφή και το περιεχόμενο του το id_tokens θα είναι το ίδιο για οι δύο χρήστες προσωπικό λογαριασμό Microsoft που διαθέτετε και εταιρικό ή σχολικό τους λογαριασμούς.

Id_tokens υπογραφή, αλλά δεν κρυπτογραφημένα αυτήν τη στιγμή.  Όταν η εφαρμογή σας λαμβάνει μια id_token, πρέπει να [επικύρωση της υπογραφής](#validating-tokens) για να αποδείξετε το διακριτικό Αυθεντικότητας και επικύρωση μερικά αξιώσεων στο διακριτικό για να αποδείξετε ισχύος του πιστοποιητικού.  Το αξιώσεων επικυρώνονται από μια εφαρμογή ποικίλλουν ανάλογα με τις απαιτήσεις σενάριο, αλλά υπάρχουν ορισμένα [κοινά επικυρώσεων διεκδίκηση](#validating-tokens) που πρέπει να εκτελέσετε την εφαρμογή σας σε κάθε σενάριο.

Πλήρεις λεπτομέρειες σχετικά με το αξιώσεων στο id_tokens παρέχονται παρακάτω, καθώς και ένα δείγμα id_token.  Σημειώστε ότι η αξιώσεων στο id_tokens δεν επιστρέφονται με κάποια συγκεκριμένη σειρά.  Επιπλέον, νέα αξιώσεων μπορεί να εισαχθεί σε id_tokens σε οποιοδήποτε σημείο στο χρόνο - της εφαρμογής σας θα πρέπει να όχι αλλαγή ως νέα αξιώσεων εισάγονται.  Η παρακάτω λίστα περιλαμβάνει τις απαιτήσεις που την εφαρμογή σας μπορεί να ερμηνεύσει αξιόπιστα τη στιγμή της σύνταξης αυτού.  Εάν είναι απαραίτητο, μπορείτε να βρείτε ακόμα περισσότερες λεπτομέρειες στην [προδιαγραφή OpenID σύνδεση](http://openid.net/specs/openid-connect-core-1_0.html).

#### <a name="sample-idtoken"></a>Δείγμα id_token

```
eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ik1uQ19WWmNBVGZNNXBPWWlKSE1iYTlnb0VLWSJ9.eyJhdWQiOiI2NzMxZGU3Ni0xNGE2LTQ5YWUtOTdiYy02ZWJhNjkxNDM5MWUiLCJpc3MiOiJodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vYjk0MTk4MTgtMDlhZi00OWMyLWIwYzMtNjUzYWRjMWYzNzZlL3YyLjAiLCJpYXQiOjE0NTIyODUzMzEsIm5iZiI6MTQ1MjI4NTMzMSwiZXhwIjoxNDUyMjg5MjMxLCJuYW1lIjoiQmFiZSBSdXRoIiwibm9uY2UiOiIxMjM0NSIsIm9pZCI6ImExZGJkZGU4LWU0ZjktNDU3MS1hZDkzLTMwNTllMzc1MGQyMyIsInByZWZlcnJlZF91c2VybmFtZSI6InRoZWdyZWF0YmFtYmlub0BueXkub25taWNyb3NvZnQuY29tIiwic3ViIjoiTUY0Zi1nZ1dNRWppMTJLeW5KVU5RWnBoYVVUdkxjUXVnNWpkRjJubDAxUSIsInRpZCI6ImI5NDE5ODE4LTA5YWYtNDljMi1iMGMzLTY1M2FkYzFmMzc2ZSIsInZlciI6IjIuMCJ9.p_rYdrtJ1oCmgDBggNHB9O38KTnLCMGbMDODdirdmZbmJcTHiZDdtTc-hguu3krhbtOsoYM2HJeZM3Wsbp_YcfSKDY--X_NobMNsxbT7bqZHxDnA2jTMyrmt5v2EKUnEeVtSiJXyO3JWUq9R0dO-m4o9_8jGP6zHtR62zLaotTBYHmgeKpZgTFB9WtUq8DVdyMn_HSvQEfz-LWqckbcTwM_9RNKoGRVk38KChVJo4z5LkksYRarDo8QgQ7xEKmYmPvRr_I7gvM2bmlZQds2OeqWLB1NSNbFZqyFOCgYn3bAQ-nEQSKwBaA36jYGPOVG2r2Qv1uKcpSOxzxaQybzYpQ
```

> [AZURE.TIP] Για την πρακτική εξάσκηση, δοκιμάστε να έλεγχο των απαιτήσεων στο το δείγμα id_token από την επικόλλησή τους σε [calebb.net](https://calebb.net).

#### <a name="claims-in-idtokens"></a>Αξιώσεις στο id_tokens
| Όνομα | Διεκδίκηση | Παράδειγμα τιμής | Περιγραφή |
| ----------------------- | ------------------------------- | ------------ | --------------------------------- |
| Ακροατηρίου | `aud` | `6731de76-14a6-49ae-97bc-6eba6914391e` | Προσδιορίζει στον παραλήπτη που θέλετε από το διακριτικό.  Στο id_tokens, το κοινό είναι αναγνωριστικό εφαρμογής της εφαρμογής σας, όπως στους οποίους έχουν ανατεθεί την εφαρμογή σας στην πύλη καταχώρηση εφαρμογής.  Την εφαρμογή σας θα πρέπει να Επικυρώστε αυτήν την τιμή και να απορρίψετε το διακριτικό, εάν δεν ταιριάζει. |
| Εκδότης | `iss` | `https://login.microsoftonline.com/b9419818-09af-49c2-b0c3-653adc1f376e/v2.0 ` | Προσδιορίζει την υπηρεσία διακριτικού ασφαλείας (STS), το που κατασκευάζει και επιστρέφει το διακριτικό, καθώς και ο μισθωτής Azure AD με την οποία ο χρήστης έχει ελεγχθεί η ταυτότητα.  Εφαρμογή σας θα πρέπει να επικυρώσετε τη διεκδίκηση εκδότη για να βεβαιωθείτε ότι το διακριτικό προήλθε από το τελικό σημείο v2.0.  Επίσης, το πρέπει να χρησιμοποιήσετε το τμήμα guid την απαίτηση για να περιορίσετε το σύνολο των μισθωτές που επιτρέπεται να συνδεθώ στην εφαρμογή.  Το guid που υποδεικνύει το χρήστη είναι ένας χρήστης καταναλωτή από τη Microsoft, ο λογαριασμός είναι `9188040d-6c67-4c5b-b112-36a304b66dad`. |
| Εκδοθεί στο | `iat` | `1452285331` | Την ώρα κατά την οποία έχει εκδοθεί το διακριτικό, που αντιπροσωπεύονται σε χρονική σήμανση χρόνου. |
| Ώρα λήξης | `exp` | `1452289231` | Την ώρα κατά την οποία το διακριτικό μετατρέπεται σε μη έγκυρη, που αντιπροσωπεύονται σε χρονική σήμανση χρόνου.  Εφαρμογή σας πρέπει να χρησιμοποιήσετε το αίτημα για να επιβεβαιώσετε την εγκυρότητα της διάρκειας ζωής διακριτικού.  |
| Όχι πριν από | `nbf` | `1452285331` |  Την ώρα κατά την οποία το διακριτικό τίθεται σε ισχύ, που αντιπροσωπεύονται σε χρονική σήμανση χρόνου. Συνήθως είναι ίδια με την ώρα έκδοσης.  Εφαρμογή σας πρέπει να χρησιμοποιήσετε το αίτημα για να επιβεβαιώσετε την εγκυρότητα της διάρκειας ζωής διακριτικού.  |
| Έκδοση | `ver` | `2.0` | Η έκδοση του id_token, όπως ορίζεται από το Azure AD.  Για το τελικό σημείο v2.0, η τιμή θα είναι `2.0`. |
| Αναγνωριστικό μισθωτή | `tid` | `b9419818-09af-49c2-b0c3-653adc1f376e` | Guid που αντιπροσωπεύει το Azure AD μισθωτή που ο χρήστης είναι από.  Για λογαριασμούς εργασίας και σχολείου, το guid θα είναι το Αναγνωριστικό αμετάβλητες μισθωτή του οργανισμού στον οποίο ανήκει ο χρήστης.  Προσωπικοί λογαριασμοί, θα έχει την τιμή `9188040d-6c67-4c5b-b112-36a304b66dad`.  Το `profile` για τη λήψη αίτημα αυτό απαιτείται εύρος. |
| Κατακερματισμός κώδικα | `c_hash` | `SGCPtt01wxwfgnYZy2VJtQ` | Ο κατακερματισμός κώδικα συμπεριλαμβάνεται στο id_tokens μόνο όταν το id_token εκδίδεται μαζί με έναν κωδικό εξουσιοδότησης διακριτικό 2.0.  Μπορεί να χρησιμοποιηθεί για την επικύρωση της αυθεντικότητας έναν κωδικό εξουσιοδότησης.  Δείτε τη [σύνδεση OpenID προδιαγραφή](http://openid.net/specs/openid-connect-core-1_0.html) για περισσότερες λεπτομέρειες σχετικά με την εκτέλεση αυτή η επικύρωση. |
| Κατακερματισμός διακριτικό πρόσβασης | `at_hash` | `SGCPtt01wxwfgnYZy2VJtQ` | Ο κατακερματισμός διακριτικό πρόσβασης συμπεριλαμβάνεται στο id_tokens μόνο όταν το id_token εκδίδεται μαζί με ένα διακριτικό πρόσβασης OAuth 2.0.  Μπορεί να χρησιμοποιηθεί για την επικύρωση της αυθεντικότητας ένα διακριτικό πρόσβασης.  Δείτε τη [σύνδεση OpenID προδιαγραφή](http://openid.net/specs/openid-connect-core-1_0.html) για περισσότερες λεπτομέρειες σχετικά με την εκτέλεση αυτή η επικύρωση. |
| Nonce | `nonce` | `12345` | Το nonce είναι μια στρατηγική για διακοπής επιθέσεις διακριτικού αναπαραγωγής.  Εφαρμογή σας να καθορίσετε μια nonce σε μια πρόσκληση σε εξουσιοδότησης χρησιμοποιώντας το `nonce` ερώτημα παραμέτρων.  Η τιμή που παρέχετε στην πρόσκληση σε θα είναι που εκπέμπει στο το id_token `nonce` διεκδίκηση, χωρίς τροποποίηση.  Αυτό σας επιτρέπει την εφαρμογή σας για να επιβεβαιώσετε την τιμή έναντι της τιμής του που καθορίζεται στο την αίτηση, η οποία συσχετίζει την εφαρμογή περίοδο λειτουργίας με μια δεδομένη id_token.  Εφαρμογή σας θα πρέπει να εκτελεί αυτό επικύρωση κατά τη διαδικασία επικύρωσης id_token. |
| Όνομα | `name` | `Babe Ruth` | Το αίτημα όνομα παρέχει ανθρώπινο αναγνώσιμο τιμή που προσδιορίζει το θέμα του διακριτικού. Αυτή η τιμή δεν εγγυάται για να είναι μοναδικό, είναι μεταβλητά και έχει σχεδιαστεί για να χρησιμοποιούνται μόνο για σκοπούς εμφάνισης.  Το `profile` για τη λήψη αίτημα αυτό απαιτείται εύρος. |
| Μήνυμα ηλεκτρονικού ταχυδρομείου | `email` | `thegreatbambino@nyy.onmicrosoft.com` | Η κύρια διεύθυνση ηλεκτρονικού ταχυδρομείου που σχετίζονται με το λογαριασμό χρήστη, εάν υπάρχει.  Η τιμή είναι μεταβλητά και μπορεί να αλλάξει για έναν δεδομένο χρήστη μέσα στο χρόνο.  Το `email` για τη λήψη αίτημα αυτό απαιτείται εύρος. |
| Προτιμώμενη όνομα χρήστη | `preferred_username` | `thegreatbambino@nyy.onmicrosoft.com` | Το κύριο όνομα χρήστη που χρησιμοποιείται για να αντιπροσωπεύει το χρήστη στο το τελικό σημείο v2.0.  Αυτό θα μπορούσε να είναι μια διεύθυνση ηλεκτρονικού ταχυδρομείου, τον αριθμό τηλεφώνου ή ένα γενικό όνομα χρήστη χωρίς καθορισμένη μορφοποίηση.  Η τιμή είναι μεταβλητά και μπορεί να αλλάξει για έναν δεδομένο χρήστη μέσα στο χρόνο.  Το `profile` για τη λήψη αίτημα αυτό απαιτείται εύρος. |
| Θέμα | `sub` | `MF4f-ggWMEji12KynJUNQZphaUTvLcQug5jdF2nl01Q` | Το κεφάλαιο σχετικά με την οποία το διακριτικό διεκδικήσεις πληροφορίες, όπως ο χρήστης της εφαρμογής. Αυτή η τιμή είναι αμετάβλητες και δεν είναι δυνατό να εκχωρηθούν εκ νέου ή να τα χρησιμοποιήσετε πάλι, επομένως, μπορεί να χρησιμοποιηθεί για την εκτέλεση ελέγχων εξουσιοδότησης ασφαλής, όπως όταν το διακριτικό χρησιμοποιείται για να αποκτήσετε πρόσβαση σε έναν πόρο. Επειδή το θέμα βρίσκεται πάντα στο τα διακριτικά τα προβλήματα Azure AD, συνιστάται η χρήση αυτής της τιμής σε ένα σύστημα εξουσιοδότησης γενικής χρήσης. |
| ObjectId | `oid` | `a1dbdde8-e4f9-4571-ad93-3059e3750d23` | Το αντικείμενο αναγνωριστικό από το εταιρικό ή σχολικό λογαριασμό στο σύστημα του Azure AD.  Το αίτημα αυτό δεν θα εκδοθεί για προσωπικοί λογαριασμοί Microsoft.  Το `profile` για τη λήψη αίτημα αυτό απαιτείται εύρος. |


## <a name="access-tokens"></a>Διακριτικά πρόσβασης

Διακριτικά πρόσβασης εκδοθεί από το τελικό σημείο v2.0 είναι μόνο ΑΝΑΛΩΣΙΜΩΝ από τις υπηρεσίες Microsoft σε αυτό το σημείο στο φορά.  Οι εφαρμογές σας δεν θα πρέπει να χρειάζεται να εκτελέσετε οποιαδήποτε επικύρωση ή έλεγχο των κωδικών πρόσβασης για οποιαδήποτε από τα σενάρια που υποστηρίζονται αυτήν τη στιγμή.  Να διαχειρίζεστε διακριτικά πρόσβασης ως αδιαφανές - είναι απλώς συμβολοσειρές που μπορούν να μεταβιβάζουν την εφαρμογή σας στη Microsoft στο αιτήσεις HTTP.

Στο άμεσο μέλλον, το τελικό σημείο v2.0 θα προκαλέσει τη δυνατότητα για την εφαρμογή σας για να λαμβάνετε διακριτικά πρόσβασης από άλλα προγράμματα-πελάτες.  Εκείνη τη στιγμή, αυτές οι πληροφορίες θα ενημερωθεί με τις πληροφορίες της εφαρμογής σας πρέπει να εκτελέσετε επικύρωσης διακριτικό πρόσβασης και άλλα παρόμοιες εργασίες.

Όταν ζητήσετε ένα διακριτικό πρόσβασης από το τελικό σημείο v2.0, το τελικό σημείο v2.0 επιστρέφει επίσης ορισμένα μετα-δεδομένα σχετικά με το διακριτικό πρόσβασης για την κατανάλωση της εφαρμογής σας.  Αυτές οι πληροφορίες περιλαμβάνουν το χρόνο λήξης της το διακριτικό πρόσβασης και το εύρος για την οποία είναι έγκυρη.  Αυτό σας επιτρέπει την εφαρμογή σας για να εκτελέσετε έξυπνη προσωρινή αποθήκευση διακριτικά πρόσβασης χωρίς να χρειάζεται να ανάλυση ανοιχτό το διακριτικό πρόσβασης ίδια.

## <a name="refresh-tokens"></a>Ανανεώστε τα διακριτικά

Ανανεώστε τα διακριτικά είναι διακριτικά ασφάλειας που να χρησιμοποιήσετε την εφαρμογή σας για να αποκτήσετε νέο πρόσβαση διακριτικά σε μια ροή διακριτικό 2.0.  Σας επιτρέπει την εφαρμογή σας για να επιτύχετε μακροπρόθεσμες πρόσβασης σε πόρους εκ μέρους ενός χρήστη χωρίς να απαιτείται αλληλεπίδραση από το χρήστη.

Ανανέωση διακριτικά είναι πολλών πόρων.  Αυτό σημαίνει ότι ότι ενός διακριτικού ανανέωση που λαμβάνεται κατά τη διάρκεια αίτησης διακριτικού για έναν πόρο μπορεί να είναι εξαργυρώσατε για διακριτικά πρόσβασης σε μια εντελώς διαφορετική πόρο.

Για να λάβετε μια ανανέωση ενός διακριτικού απάντηση, την εφαρμογή σας πρέπει να ζητήσετε & σας έχει εκχωρηθεί το `offline_acesss` εύρος.   Για να μάθετε περισσότερα σχετικά με το `offline_access` εμβέλεια, ανατρέξτε στο [συγκατάθεση & εύρους άρθρο εδώ](active-directory-v2-scopes.md).

Ανανεώστε τα διακριτικά είναι και θα είναι πάντα, αδιαφανές για την εφαρμογή σας.  Αυτές εκδίδονται από το τελικό σημείο v2.0 Azure AD και να μόνο να ελεγχθεί & ερμηνεύεται από το τελικό σημείο v2.0.  Είναι μεγάλης διάρκειας, αλλά δεν πρέπει να γράφονται την εφαρμογή σας να περιμένει ότι ένα διακριτικό ανανέωση θα διαρκέσει οποιαδήποτε χρονική περίοδο.  Ανανέωση διακριτικά μπορεί να ακυρωθεί σε οποιαδήποτε χρονική στιγμή για διάφορους λόγους.  Ο μόνος τρόπος για να γνωρίζω αν ενός διακριτικού ανανέωση είναι έγκυρη εφαρμογή σας είναι να δοκιμάσετε να την εξαργύρωση, καθιστώντας αίτησης διακριτικού στο τελικό σημείο v2.0.

Κατά την εξαργύρωση ενός διακριτικού ανανέωσης για έναν νέο κωδικό πρόσβασης (και εάν την εφαρμογή σας έχει παραχωρηθεί τα `offline_access` εύρος), θα λάβετε έναν νέο κωδικό ανανέωση στην διακριτικού απάντηση.  Θα πρέπει να αποθηκεύσετε το διακριτικό που μόλις έχει εκδοθεί ανανέωσης, αντικαθιστώντας αυτό που χρησιμοποιείται στην αίτηση.  Αυτό θα εγγυάται ότι σας διακριτικά ανανέωση εξακολουθεί να ισχύει για το χρονικό διάστημα όσο το δυνατόν.

## <a name="validating-tokens"></a>Επικύρωση διακριτικά

Σε αυτό το σημείο στο φορά, την επικύρωση διακριτικού μόνο τις εφαρμογές σας θα πρέπει να πρέπει να εκτελέσετε την επικύρωση id_tokens.  Για να επικυρώσετε ένα id_token, την εφαρμογή σας θα πρέπει να επικύρωση υπογραφής του id_token και το αξιώσεων στο το id_token.

<!-- TODO: Link -->
Παρέχουμε βιβλιοθήκες & δείγματα κώδικα που δείχνουν τον τρόπο χειρισμού εύκολα διακριτικού επικύρωσης - το παρακάτω πληροφορίες απλώς παρέχεται για τα άτομα που θέλετε να κατανοήσετε το υποκείμενο διαδικασία.  Υπάρχουν επίσης πολλές βιβλιοθήκες Άνοιγμα αρχείου προέλευσης 3η πάρτι διαθέσιμα για επικύρωση JWT - υπάρχει τουλάχιστον μία επιλογή για σχεδόν κάθε πλατφόρμα & γλώσσα σμίκρυνση εκεί.

#### <a name="validating-the-signature"></a>Επικύρωση της υπογραφής
Μια JWT περιέχει τρία τμήματα, που διαχωρίζονται με το `.` χαρακτήρα.  Το πρώτο τμήμα είναι γνωστό ως **κεφαλίδα**, το δεύτερο ως **σώμα**και η τρίτη με την **υπογραφή**.  Στο τμήμα υπογραφής μπορεί να χρησιμοποιηθεί για την επικύρωση της αυθεντικότητας του id_token, έτσι ώστε να είναι αξιόπιστο από την εφαρμογή σας.

Id_Tokens έχετε εισέλθει με αλγόριθμους βασική ασύμμετρη κρυπτογράφηση κλάδο, όπως RSA 256. Στην κεφαλίδα της το id_token περιέχει πληροφορίες σχετικά με τη μέθοδο κλειδί και κρυπτογράφησης που χρησιμοποιείται για την είσοδο το διακριτικό:

```
{
  "typ": "JWT",
  "alg": "RS256",
  "kid": "MnC_VZcATfM5pOYiJHMba9goEKY"
}
```

Το `alg` διεκδίκηση υποδεικνύει τον αλγόριθμο που χρησιμοποιήθηκε για να πραγματοποιήσετε το διακριτικό, χωρίς την `kid` διεκδίκηση υποδεικνύει το συγκεκριμένο δημόσιο κλειδί που χρησιμοποιήθηκε για να πραγματοποιήσετε το διακριτικό.

Σε οποιαδήποτε δεδομένη χρονική στιγμή, το τελικό σημείο v2.0 μπορεί να συνδεθείτε μια id_token χρησιμοποιώντας οποιαδήποτε από ένα ορισμένο σύνολο ζεύγη δημόσιων-ιδιωτικών κλειδιών.  Το τελικό σημείο v2.0 Περιστρέφει το δυνατό σύνολο αριθμών-κλειδιών σε περιοδική βάση, ώστε να την εφαρμογή σας πρέπει να γράφονται χειρισμού αυτόματα αυτές τις βασικές αλλαγές.  Για να ελέγξετε για ενημερώσεις για τη δημόσια κλειδιά που χρησιμοποιούνται από το τελικό σημείο v2.0 λογικό συχνότητα είναι περίπου 24 ώρες.

Μπορείτε να αποκτήσετε το υπογραφής κλειδιού δεδομένων που είναι απαραίτητα για την επικύρωση της υπογραφής με χρήση του εγγράφου μετα-δεδομένων OpenID σύνδεση βρίσκεται στο:

```
https://login.microsoftonline.com/common/v2.0/.well-known/openid-configuration
```

> [AZURE.TIP] Δοκιμάστε αυτήν τη διεύθυνση URL σε ένα πρόγραμμα περιήγησης!

Αυτό το έγγραφο μετα-δεδομένων είναι ένα αντικείμενο JSON που περιέχει πολλές χρήσιμες τμήματα πληροφοριών, όπως η θέση της τα διάφορα τελικά σημεία που απαιτείται για την εκτέλεση του ελέγχου ταυτότητας που OpenID σύνδεση.  

Περιλαμβάνει επίσης μια `jwks_uri`, που παρέχει τη θέση του συνόλου των δημόσιων κλειδιών που χρησιμοποιείται για την είσοδο διακριτικά.  Το έγγραφο JSON βρίσκεται στο το `jwks_uri` περιέχει όλες τις πληροφορίες του κλειδιού δημόσια χρησιμοποιείται σε συγκεκριμένη συγκεκριμένη χρονική στιγμή.  Να χρησιμοποιήσετε την εφαρμογή σας το `kid` διεκδίκηση στην κεφαλίδα JWT για να επιλέξετε ποια δημόσιο κλειδί σε αυτό το έγγραφο έχει χρησιμοποιηθεί για την υπογραφή ενός συγκεκριμένου διακριτικού.  Στη συνέχεια, να μπορεί να εκτελέσει χρησιμοποιώντας το σωστό δημόσιο κλειδί και αλγόριθμο καθορισμένου επικύρωση της υπογραφής.

Εκτέλεση επικύρωση της υπογραφής βρίσκεται εκτός του αντικειμένου αυτού του εγγράφου - υπάρχουν πολλές βιβλιοθήκες Άνοιγμα αρχείου προέλευσης για βοηθώντας σας να το κάνετε εάν είναι απαραίτητο.

#### <a name="validating-the-claims"></a>Επικύρωση των απαιτήσεων
Κατά την εφαρμογή σας λαμβάνει μια id_token κατά την είσοδο στο χρήστη, αυτό πρέπει να λειτουργεί επίσης μερικά ελέγχων προς τις αντίστοιχες απαιτήσεις στα το id_token.  Αυτά περιλαμβάνουν, αλλά δεν είστε υποχρεωμένοι να:

- Το αίτημα **ακροατηρίου** - για να επιβεβαιώσετε ότι το id_token που περιμένατε να δοθεί για την εφαρμογή σας.
- Το **Όχι πριν από** και την **Ώρα λήξης** αξιώσεων - για να επιβεβαιώσετε ότι το id_token δεν έχει λήξει.
- Το αίτημα **εκδότη** - για να επιβεβαιώσετε ότι το διακριτικό στην πραγματικότητα έχει εκδοθεί για την εφαρμογή σας από το τελικό σημείο v2.0.
- Το **Nonce** - ως ένα μετριασμού επίθεση διακριτικού αναπαραγωγής.
- και ακόμη περισσότερα...

Για μια πλήρη λίστα των επικυρώσεων διεκδίκηση θα πρέπει να εκτελέσετε την εφαρμογή σας, ανατρέξτε στις [προδιαγραφές OpenID σύνδεση](http://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation).

Λεπτομέρειες τις αναμενόμενες τιμές για αυτές τις απαιτήσεις περιλαμβάνονται παραπάνω στην [ενότητα id_token](#id_tokens).


## <a name="token-lifetimes"></a>Η διάρκεια ζωής διακριτικού

Το παρακάτω διακριτικού διάρκεια ζωής παρέχονται καθαρά για την κατανόηση, όπως μπορούν να σας βοηθήσουν στην ανάπτυξη και τον εντοπισμό σφαλμάτων εφαρμογών.  Οι εφαρμογές σας δεν πρέπει να υπογράψει κάποιος πρέπει να περιμένουν οποιαδήποτε από αυτές τις διάρκεια ζωής να παραμένουν σταθερά - μπορούν να και θα αλλάξει σε οποιοδήποτε σημείο δεδομένη στιγμή.

| Διακριτικού | Διάρκεια ζωής | Περιγραφή |
| ----------------------- | ------------------------------- | ------------ |
| Id_Tokens (εταιρικό ή σχολικό λογαριασμοί) | 1 ώρα | Id_Tokens είναι συνήθως έγκυρες για κάθε ώρα.  Εφαρμογή web της μπορούν να χρησιμοποιούν το ίδιο διάρκεια ζωής σε διατηρώντας το δικό της περιόδου λειτουργίας με το χρήστη (συνιστάται) ή επιλέξτε μια διάρκεια ζωής εντελώς διαφορετική περίοδο λειτουργίας.  Εάν την εφαρμογή σας πρέπει να λάβετε μια νέα id_token, πρέπει απλώς να κάνετε μια νέα είσοδος αίτηση για το v2.0 εγκρίνετε τελικού σημείου.  Εάν ο χρήστης έχει μια περίοδο λειτουργίας περιήγησης έγκυρη με το τελικό σημείο v2.0, δεν μπορεί να απαιτείται για να εισαγάγετε ξανά τα διαπιστευτήριά τους. |
| Id_Tokens (προσωπικοί λογαριασμοί) | 24 ώρες | Id_Tokens για προσωπικοί λογαριασμοί είναι συνήθως έγκυρες 24 ώρες.  Εφαρμογή web της μπορούν να χρησιμοποιούν το ίδιο διάρκεια ζωής σε διατηρώντας το δικό της περιόδου λειτουργίας με το χρήστη (συνιστάται) ή επιλέξτε μια διάρκεια ζωής εντελώς διαφορετική περίοδο λειτουργίας.  Εάν την εφαρμογή σας πρέπει να λάβετε μια νέα id_token, πρέπει απλώς να κάνετε μια νέα είσοδος αίτηση για το v2.0 εγκρίνετε τελικού σημείου.  Εάν ο χρήστης έχει μια περίοδο λειτουργίας περιήγησης έγκυρη με το τελικό σημείο v2.0, δεν μπορεί να απαιτείται για να εισαγάγετε ξανά τα διαπιστευτήριά τους. |
| Διακριτικά πρόσβασης (εταιρικό ή σχολικό λογαριασμοί) | 1 ώρα | Υποδεικνύεται σε διακριτικού απαντήσεων ως μέρος του διακριτικού μετα-δεδομένων. |
| Διακριτικά πρόσβασης (προσωπικοί λογαριασμοί) | 1 ώρα | Υποδεικνύεται σε διακριτικού απαντήσεων ως μέρος του διακριτικού μετα-δεδομένων.  Access_tokens εκδοθεί εκ μέρους προσωπικοί λογαριασμοί μπορεί να ρυθμιστεί για μια διαφορετική χρονική διάρκεια, αλλά και μία ώρα είναι συνήθως πεζών και κεφαλαίων γραμμάτων. |
| Ανανεώστε τα διακριτικά (εταιρικό ή σχολικό λογαριασμό) | Έως και 14 ημέρες | Ένα μεμονωμένο ανανέωση διακριτικό ισχύει για έως και 14 ημέρες.  Ωστόσο, το διακριτικό ανανέωσης μπορεί να καταστούν μη έγκυροι οποιαδήποτε στιγμή για διάφορους λόγους, ώστε να την εφαρμογή σας θα πρέπει να συνεχίσετε να δοκιμάσετε και να χρησιμοποιήσετε ένα διακριτικό ανανέωση μέχρι να αποτύχει ή μέχρι την εφαρμογή σας αντικαθιστά με έναν νέο κωδικό ανανέωσης.  Ένα διακριτικό ανανέωση επίσης θα είναι έγκυρες αν έχουν περάσει 90 ημέρες δεδομένου ότι ο χρήστης έχει εισάγει τα διαπιστευτήριά τους. |
| Ανανεώστε τα διακριτικά (προσωπικοί λογαριασμοί) | Έως 1 έτος | Ένα μεμονωμένο ανανέωση διακριτικό ισχύει για έως ενός έτους.  Ωστόσο, το διακριτικό ανανέωσης μπορεί να καταστούν μη έγκυροι οποιαδήποτε στιγμή για διάφορους λόγους, ώστε να την εφαρμογή σας θα πρέπει να συνεχίσετε να δοκιμάσετε και να χρησιμοποιήσετε ένα διακριτικό ανανέωση μέχρι να αποτύχει. |
| Κωδικοί εξουσιοδότησης (εταιρικό ή σχολικό λογαριασμοί) | 10 λεπτά | Κώδικες εξουσιοδότησης είναι σκόπιμα θα είναι μικρής διάρκειας, ενώ θα πρέπει να είναι αμέσως εξαργυρώσατε για access_tokens και refresh_tokens κατά τη λήψη. |
| Κωδικοί εξουσιοδότησης (προσωπικοί λογαριασμοί) | 5 λεπτά | Κώδικες εξουσιοδότησης είναι σκόπιμα θα είναι μικρής διάρκειας, ενώ θα πρέπει να είναι αμέσως εξαργυρώσατε για access_tokens και refresh_tokens κατά τη λήψη.  Κωδικοί εξουσιοδότησης εκδοθεί εκ μέρους προσωπικοί λογαριασμοί είναι επίσης εφάπαξ χρήση. |

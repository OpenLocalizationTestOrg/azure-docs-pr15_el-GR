<properties
   pageTitle="Azure AD Connect: Σχεδίαση έννοιες | Microsoft Azure"
   description="Αυτό το θέμα "Λεπτομέρειες" ορισμένες περιοχές σχεδίαση εφαρμογής"
   services="active-directory"
   documentationCenter=""
   authors="billmath"
   manager="femila"
   editor=""/>

<tags
   ms.service="active-directory"
   ms.custom = "azure-ad-connect"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="Identity"
   ms.date="09/13/2016"
   ms.author="billmath"/>

# <a name="azure-ad-connect-design-concepts"></a>Azure AD Connect: Βασικές αρχές σχεδίασης
Είναι το σκοπό αυτού του θέματος που περιγράφουν τις περιοχές που πρέπει να θεωρηθεί και κατά τη διάρκεια της σχεδίασης υλοποίηση Azure AD Connect. Αυτό το θέμα είναι βαθύ κατάρρευση σε ορισμένες περιοχές και περιγράφει συνοπτικά περιγράφονται αυτά τα θέματα στα καθώς και άλλα θέματα.

## <a name="sourceanchor"></a>sourceAnchor
Το χαρακτηριστικό sourceAnchor έχει οριστεί ως *χαρακτηριστικό αμετάβλητες κατά τη διάρκεια ζωής ενός αντικειμένου*. Προσδιορίζει με μοναδικό τρόπο ένα αντικείμενο ως το ίδιο αντικείμενο εσωτερικής εγκατάστασης και στο Azure AD. Το χαρακτηριστικό ονομάζεται επίσης **immutableId** και τα δύο ονόματα χρησιμοποιούνται δυνατότητα εναλλαγής.

Το word αμετάβλητες, που είναι "δεν μπορεί να αλλάξει", είναι σημαντικό για αυτό το θέμα. Επειδή η τιμή του χαρακτηριστικού αυτό δεν μπορεί να αλλάξει αφού έχει οριστεί, είναι σημαντικό να επιλέξετε σχέδιο που υποστηρίζει το σενάριό σας.

Το χαρακτηριστικό χρησιμοποιείται για τα ακόλουθα σενάρια:

- Όταν ένα νέο διακομιστή μηχανισμού συγχρονισμού είναι ενσωματωμένη ή αναδημιουργείται μετά από ένα σενάριο αποκατάστασης από καταστροφή, αυτό το χαρακτηριστικό συνδέσεων υπάρχοντα αντικείμενα στο Azure AD με αντικείμενα εσωτερικής εγκατάστασης.
- Εάν μετακινήσετε από μια ταυτότητα μόνο στο cloud σε ένα μοντέλο συγχρονισμένη ταυτότητα, στη συνέχεια, αυτό το χαρακτηριστικό επιτρέπει σε υπάρχοντα αντικείμενα "Σκληρή match" Azure AD με αντικείμενα εσωτερικής εγκατάστασης.
- Εάν χρησιμοποιείτε το ομοσπονδίας, τότε αυτό το χαρακτηριστικό μαζί με το **userPrincipalName** χρησιμοποιείται στη το αίτημα για να προσδιορίσει μοναδικά ένα χρήστη.

Αυτό το θέμα ακρόασης μόνο σχετικά με sourceAnchor που αφορά τους χρήστες. Τους ίδιους κανόνες ισχύουν για όλους τους τύπους αντικειμένου, αλλά είναι μόνο για τους χρήστες σε αυτό το πρόβλημα, συνήθως, είναι ένα πρόβλημα.

### <a name="selecting-a-good-sourceanchor-attribute"></a>Επιλέγοντας ένα χαρακτηριστικό καλή sourceAnchor
Η τιμή του χαρακτηριστικού πρέπει να ακολουθήσετε τους παρακάτω κανόνες:

- Είναι μικρότερη από 60 χαρακτήρες
    - Οι χαρακτήρες που δεν είναι a-z, A-Ω ή 0-9 κωδικοποιούνται και υπολογίζονται ως 3 χαρακτήρες
- Δεν περιέχει έναν ειδικό χαρακτήρα: & #92;! # $ % & * + / = ? ^ & #96; { } | ~ (< >) '; : , [ ] " @ _
- Πρέπει να είναι μοναδικό καθολικά
- Πρέπει να είναι μια συμβολοσειρά, ακέραιος ή δυαδικό
- Δεν θα πρέπει να βασίζεται στο όνομα του χρήστη, αυτές οι αλλαγές
- Δεν θα πρέπει να είναι διάκριση πεζών-κεφαλαίων και να αποφύγετε τις τιμές που μπορεί να διαφέρουν από πεζών-κεφαλαίων
- Θα πρέπει να ανατεθούν όταν δημιουργείται το αντικείμενο

Εάν η επιλεγμένη sourceAnchor δεν είναι τύπου συμβολοσειράς, στη συνέχεια, Base64Encode σύνδεση Azure AD η τιμή του χαρακτηριστικού για να βεβαιωθείτε ότι δεν υπάρχει ειδικούς χαρακτήρες εμφανίζονται. Εάν χρησιμοποιείτε άλλο διακομιστή ομοσπονδίας από ADFS, βεβαιωθείτε ότι ο διακομιστής επίσης να Base64Encode το χαρακτηριστικό.

Το χαρακτηριστικό sourceAnchor διάκριση πεζών-κεφαλαίων. Η τιμή "JohnDoe" δεν είναι ίδια με "johndoe". Αλλά δεν θα πρέπει να έχετε δύο διαφορετικά αντικείμενα με διαφορά μόνο σε περίπτωση.

Εάν έχετε ένα μεμονωμένο δάσος εσωτερικής εγκατάστασης, στη συνέχεια, το χαρακτηριστικό που πρέπει να χρησιμοποιήσετε είναι **objectGUID**. Αυτό είναι επίσης η ιδιότητα χρησιμοποιείται κατά τη χρήση του express ρυθμίσεις στο Azure AD Connect και επίσης το χαρακτηριστικό που χρησιμοποιείται από το DirSync.

Εάν έχετε πολλαπλές δομές και όχι μετακίνηση χρηστών μεταξύ συμπλεγμάτων δομών και των τομέων, στη συνέχεια, **objectGUID** είναι ένα καλό χαρακτηριστικό για να χρησιμοποιήσετε ακόμη και σε αυτήν την περίπτωση.

Εάν μετακινήσετε χρήστες μεταξύ συμπλεγμάτων δομών και των τομέων, στη συνέχεια, που πρέπει να βρείτε ένα χαρακτηριστικό που δεν αλλάζει ή μπορεί να μετακινηθεί με τους χρήστες κατά τη μετακίνηση. Μια προτεινόμενη προσέγγιση είναι να εισαγάγει ένα χαρακτηριστικό σύνθετων. Ένα χαρακτηριστικό που μπορεί να περιέχει κάτι που να μοιάζει σαν ένα GUID θα είναι κατάλληλο. Κατά τη δημιουργία αντικειμένου, δημιουργείται ένα νέο GUID και σήμανση στον χρήστη. Ένας κανόνας προσαρμοσμένο συγχρονισμού μπορούν να δημιουργηθούν σε διακομιστή μηχανισμού συγχρονισμού για να δημιουργήσετε αυτήν την τιμή με βάση το **objectGUID** και να ενημερώσετε το επιλεγμένο χαρακτηριστικό στο ΠΡΟΣΘΈΤΕΙ. Όταν μετακινείτε το αντικείμενο, βεβαιωθείτε ότι επίσης να αντιγράψετε το περιεχόμενο αυτής της τιμής.

Μια άλλη λύση είναι να επιλέξετε ένα υπάρχον χαρακτηριστικό γνωρίζετε ότι δεν αλλάζει. Τα χαρακτηριστικά που χρησιμοποιείται συχνά περιλαμβάνουν **employeeID**. Εάν θεωρείτε ότι ένα χαρακτηριστικό που περιέχει γράμματα, βεβαιωθείτε ότι υπάρχει χωρίς δυνατότητα πεζών και κεφαλαίων γραμμάτων (κεφαλαία ή πεζά) μπορούν να αλλάξουν για το χαρακτηριστικό τιμή. Εσφαλμένες τα χαρακτηριστικά που δεν πρέπει να χρησιμοποιούνται περιλαμβάνουν αυτά τα χαρακτηριστικά με το όνομα του χρήστη. Σε μια γάμου ή διαζύγιο, αναμένεται το όνομα για να αλλάξετε, που δεν επιτρέπεται για αυτό το χαρακτηριστικό. Αυτό είναι επίσης ένας λόγος για ποιο λόγο δεν είναι επίσης τη δυνατότητα να επιλέξετε στον Οδηγό εγκατάστασης Azure AD Connect χαρακτηριστικά όπως **userPrincipalName**, **Αλληλογραφία**και **targetAddress** . Αυτά τα χαρακτηριστικά επίσης να περιέχει το @-character, που δεν επιτρέπεται στο το sourceAnchor.

### <a name="changing-the-sourceanchor-attribute"></a>Αλλάζοντας το χαρακτηριστικό sourceAnchor
Η τιμή του χαρακτηριστικού sourceAnchor δεν μπορεί να αλλάξει αφού το αντικείμενο έχει δημιουργηθεί στο Azure AD και συγχρονίζεται την ταυτότητα.

Για αυτόν το λόγο, οι παρακάτω περιορισμοί ισχύουν για Azure AD Connect:

- Το χαρακτηριστικό sourceAnchor μπορεί να οριστεί μόνο κατά την αρχική εγκατάσταση. Εάν επιστρέψετε στον Οδηγό εγκατάστασης, αυτή η επιλογή είναι μόνο για ανάγνωση. Εάν θέλετε να αλλάξετε αυτήν τη ρύθμιση, στη συνέχεια, πρέπει να καταργήσετε την εγκατάσταση του και επαναλάβετε την εγκατάσταση.
- Εάν εγκαταστήσετε μια άλλη διακομιστής Azure AD Connect, στη συνέχεια, πρέπει να επιλέξετε το ίδιο χαρακτηριστικό sourceAnchor χρησιμοποιηθεί ως προηγουμένως. Εάν έχετε προηγουμένως χρησιμοποιώντας DirSync και μετακίνηση Azure AD Connect, στη συνέχεια, πρέπει να χρησιμοποιήσετε **objectGUID** δεδομένου ότι αυτό είναι το χαρακτηριστικό που χρησιμοποιείται από το DirSync.
- Εάν η τιμή για το sourceAnchor έχει αλλάξει μετά το αντικείμενο έχει εξαχθεί Azure AD, στη συνέχεια, Azure AD Connect συγχρονισμός παρουσιάσει σφάλμα και δεν επιτρέπει τη περισσότερες αλλαγές σε ότι αντικείμενο πριν από το ζήτημα έχει καθοριστεί και το sourceAnchor αλλάζει ξανά στον κατάλογο προέλευσης.

## <a name="azure-ad-sign-in"></a>Azure AD εισόδου
Κατά την ενοποίηση καταλόγου σας εσωτερικής εγκατάστασης με το Azure AD, είναι σημαντικό να κατανοήσετε τον τρόπο τις ρυθμίσεις συγχρονισμού μπορεί να επηρεάζουν τον τρόπο με τον οποίο χρήστη πραγματοποιεί έλεγχο ταυτότητας. Azure AD χρησιμοποιεί userPrincipalName (UPN) για τον έλεγχο ταυτότητας χρήστη. Ωστόσο, όταν συγχρονίζετε τους χρήστες σας, πρέπει να επιλέξετε το χαρακτηριστικό που θα χρησιμοποιηθεί για την τιμή του χαρακτηριστικού userPrincipalName προσεκτικά.

### <a name="choosing-the-attribute-for-userprincipalname"></a>Επιλέγοντας το χαρακτηριστικό userPrincipalName
Όταν επιλέγετε το χαρακτηριστικό για την παροχή θα πρέπει να βεβαιωθείτε ότι η τιμή του UPN για χρήση σε μία Azure

- Οι τιμές χαρακτηριστικού συμφωνούν με τη σύνταξη UPN (RFC 822), που θα πρέπει να είναι της μορφήςusername@domain
- Ταιριάζει με το επίθημα στις τιμές σε ένα από τα επαληθευτεί προσαρμοσμένων τομέων στο Azure AD

Στις ρυθμίσεις του express, η υποθετική επιλογή για το χαρακτηριστικό είναι userPrincipalName. Εάν το χαρακτηριστικό userPrincipalName δεν περιέχει την τιμή θέλετε οι χρήστες να πραγματοποιήσουν είσοδο στην Azure και, στη συνέχεια, πρέπει να επιλέξετε **Προσαρμοσμένη εγκατάσταση**.

### <a name="custom-domain-state-and-upn"></a>Κατάσταση προσαρμοσμένο τομέα και UPN
Είναι σημαντικό για να βεβαιωθείτε ότι έχει επαληθευτεί τομέα για το επίθημα UPN.

Γιάννης είναι ένας χρήστης στο contoso.com. Θέλετε John για να χρησιμοποιήσετε το UPN εσωτερικής john@contoso.com για να εισέλθετε στο Azure αφού που έχετε συγχρονίσει τους χρήστες με το contoso.onmicrosoft.com καταλόγου Azure AD. Για να κάνετε αυτό, πρέπει να προσθέσετε και να επαληθεύσετε contoso.com ως έναν προσαρμοσμένο τομέα στο Azure AD να μπορέσετε να ξεκινήσετε συγχρονισμό τους χρήστες. Εάν το επίθημα UPN Γιάννης, για παράδειγμα contoso.com, δεν συμφωνούν επαληθευτεί τομέα στο Azure AD, στη συνέχεια, Azure AD αντικαθιστά το επίθημα UPN με το contoso.onmicrosoft.com.

### <a name="non-routable-on-premises-domains-and-upn-for-azure-ad"></a>Δυνατότητα δρομολόγησης μη εσωτερικής εγκατάστασης τομέων και UPN για Azure AD
Ορισμένες εταιρείες έχουν δεν υποστηρίζει δρομολόγηση τομείς, όπως contoso.local ή απλό Μονή ετικέτα τομείς, όπως contoso. Δεν είναι δυνατή η επαλήθευση τομέα δεν υποστηρίζει δρομολόγηση στο Azure AD. Azure AD Connect να συγχρονίσετε μόνο σε επαληθευτεί τομέα στο Azure AD. Όταν δημιουργείτε μια καταλόγου Azure AD, δημιουργεί μια δυνατότητα δρομολόγησης τομέα που γίνεται προεπιλεγμένο τομέα για το Azure AD για παράδειγμα, το contoso.onmicrosoft.com. Επομένως, γίνεται είναι απαραίτητο για να επαληθεύσετε οποιονδήποτε άλλο δυνατότητα δρομολόγησης τομέα σε ένα τέτοιο σενάριο, σε περίπτωση που δεν θέλετε να συγχρονίσετε με τον προεπιλεγμένο τομέα onmicrosoft.com.

Διαβάστε την [Προσθήκη το προσαρμοσμένο όνομα τομέα για να Azure Active Directory](active-directory-add-domain.md) για περισσότερες πληροφορίες για προσθήκη και επαλήθευση τομέων.

Azure AD Connect εντοπίζει εάν χρησιμοποιείτε τα σε ένα περιβάλλον τομέα δεν υποστηρίζει δρομολόγηση και θα σωστά σας ειδοποιήσει από μεταβαίνοντας στο μέλλον με ρητή ρυθμίσεις. Εάν εργάζεστε σε έναν τομέα που δεν υποστηρίζει δρομολόγηση, στη συνέχεια, είναι πιθανό ότι το UPN των χρηστών έχουν δεν υποστηρίζει δρομολόγηση επιθήματος πολύ. Για παράδειγμα, εάν χρησιμοποιείτε στην περιοχή contoso.local, Azure AD Connect προτείνει να χρησιμοποιήσετε προσαρμοσμένες ρυθμίσεις και όχι με ρητή ρυθμίσεις. Χρησιμοποιώντας προσαρμοσμένες ρυθμίσεις, θα μπορείτε να καθορίσετε το χαρακτηριστικό που πρέπει να χρησιμοποιηθεί ως UPN για να εισέλθετε στο Azure αφού τους χρήστες είναι συγχρονισμένο με το Azure AD.

## <a name="next-steps"></a>Επόμενα βήματα
Μάθετε περισσότερα σχετικά με την [ενσωμάτωση του ταυτοτήτων εσωτερικής εγκατάστασης με Azure Active Directory](active-directory-aadconnect.md).

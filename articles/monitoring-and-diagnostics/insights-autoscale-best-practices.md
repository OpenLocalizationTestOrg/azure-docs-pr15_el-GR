<properties
    pageTitle="Βέλτιστες πρακτικές για autoscaling Azure οθόνη. | Microsoft Azure"
    description="Μάθετε αρχές για την αποτελεσματική χρήση autoscaling στην Εποπτεία Azure."
    authors="kamathashwin"
    manager="carolz"
    editor=""
    services="monitoring-and-diagnostics"
    documentationCenter="monitoring-and-diagnostics"/>

<tags
    ms.service="monitoring-and-diagnostics"
    ms.workload="na"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/20/2016"
    ms.author="ashwink"/>

# <a name="best-practices-for-azure-monitor-autoscaling"></a>Βέλτιστες πρακτικές για autoscaling οθόνη Azure

Οι παρακάτω ενότητες σε αυτό το έγγραφο θα σας βοηθήσουν να κατανοήσετε τις βέλτιστες πρακτικές για autoscale στο Azure. Μετά την αναθεώρηση αυτές τις πληροφορίες, θα καλύτερα μπορείτε να χρησιμοποιήσετε αποτελεσματικά autoscale Azure υποδομής σας.

## <a name="autoscale-concepts"></a>Έννοιες Autoscale

- Ένας πόρος μπορεί να έχει μόνο *μία* ρύθμιση autoscale
- Μια ρύθμιση autoscale μπορούν να έχουν ένα ή περισσότερα προφίλ και κάθε προφίλ μπορούν να έχουν ένα ή περισσότερα autoscale κανόνων.
- Μια ρύθμιση autoscale κλίμακες παρουσίες οριζόντια, που είναι *εκτός* , αυξάνοντας *το παρουσίες και* μειώνοντας τον αριθμό των εμφανίσεων.
 Μια ρύθμιση autoscale έχει μια μέγιστη ελάχιστη και προεπιλεγμένη τιμή των παρουσιών.
- Μια εργασία autoscale διαβάζει πάντα το σχετικό μετρικό για να κλιμακωθεί με, ο έλεγχος αν το έχει τέμνονται υπέρβαση του ορίου για κλιμάκωσης ή την κλίμακα του. Μπορείτε να προβάλετε μια λίστα μετρικών autoscale που μπορεί να περιορίσετε το μέγεθος των από στην [οθόνη Azure autoscaling κοινές μετρικά](insights-autoscale-common-metrics.md).
- Όλα τα όρια υπολογίζονται σε ένα επίπεδο παρουσία. Για παράδειγμα, "κλίμακα κατά 1 παρουσία όταν μέσος όρος CPU > 80% κατά την παρουσία μέτρηση είναι 2", σημαίνει ότι κλιμάκωσης όταν η μέση CPU σε όλες τις εμφανίσεις είναι μεγαλύτερη από 80%.
- Μπορείτε πάντα να λαμβάνετε ειδοποιήσεις αποτυχία μέσω ηλεκτρονικού ταχυδρομείου. Συγκεκριμένα, η κάτοχο συμβολής και οι αναγνώστες του πόρου προορισμού λαμβάνει μηνύματα ηλεκτρονικού ταχυδρομείου. Λαμβάνετε επίσης πάντα μια διεύθυνση ηλεκτρονικού ταχυδρομείου *αποκατάστασης* όταν autoscale ανακτά από αποτυχία και αρχίσει να λειτουργεί κανονικά.
- Μπορείτε να επιλέξετε στο για να λάβετε μια ειδοποίηση ενέργεια επιτυχής κλίμακα μέσω ηλεκτρονικού ταχυδρομείου και webhooks.

## <a name="autoscale-best-practices"></a>Βέλτιστες πρακτικές Autoscale

Χρησιμοποιήστε τις ακόλουθες βέλτιστες πρακτικές όταν χρησιμοποιείτε autoscale.

### <a name="ensure-the-maximum-and-minimum-values-are-different-and-have-an-adequate-margin-between-them"></a>Βεβαιωθείτε ότι η μέγιστη και την ελάχιστη τιμή διαφέρουν και έχουν μια επαρκής περιθώριο μεταξύ τους
Εάν έχετε μια ρύθμιση που διαθέτει τουλάχιστον = 2, μέγιστο = 2 και την τρέχουσα παρουσία μέτρηση είναι 2, μπορεί να προκύψουν καμία ενέργεια κλίμακα. Διατηρήστε ένα κατάλληλο περιθώριο μεταξύ τις μετρήσεις μέγιστη και την ελάχιστη παρουσία, που είναι κλειστό. Autoscale κλίμακες πάντα ανάμεσα σε αυτά τα όρια.

### <a name="manual-scaling-is-reset-by-autoscale-min-and-max"></a>Μη αυτόματη κλιμάκωση γίνεται επαναφορά autoscale ελάχιστο και μέγιστο
Εάν ενημερώσετε με μη αυτόματο τρόπο το πλήθος παρουσία της τιμής ενός επάνω ή κάτω από τη μέγιστη τιμή, ο μηχανισμός autoscale αυτόματη αλλαγή της κλίμακας πίσω για να το ελάχιστο (εάν είναι πιο κάτω) ή το μέγιστο όριο (εάν παραπάνω). Για παράδειγμα, μπορείτε να ορίσετε την περιοχή μεταξύ 3 και 6. Εάν έχετε μία παρουσία εκτελείται, ο μηχανισμός autoscale κλίμακες 3 παρουσίες στην επόμενη εκτέλεσή. Παρομοίως, αυτό θα κλίμακα του 8 παρουσιών Επιστροφή στην επόμενη εκτέλεσή 6.  Μη αυτόματη κλιμάκωση είναι πολύ προσωρινή, εκτός εάν επαναφορά καθώς και τους κανόνες autoscale.

### <a name="always-use-a-scale-out-and-scale-in-rule-combination-that-performs-an-increase-and-decrease"></a>Πάντα να χρησιμοποιήσετε ένα συνδυασμό κλιμάκωσης και κλίμακα του κανόνα που εκτελεί μια αύξηση και μείωση
Εάν χρησιμοποιείτε μόνο ένα τμήμα του συνδυασμού, autoscale κλίμακα του που μονό ανάληψη ή μεταβίβαση μέχρι το μέγιστο ή ελάχιστο, πρόγραμμα φτάσει.

### <a name="do-not-switch-between-the-azure-portal-and-the-azure-classic-portal-when-managing-autoscale"></a>Δεν εναλλαγή μεταξύ Azure πύλη και το Azure κλασική πύλης κατά τη Διαχείριση Autoscale
Για τις υπηρεσίες Cloud και εφαρμογή υπηρεσιών (εφαρμογές Web), χρησιμοποιήστε την πύλη του Azure (portal.azure.com) για να δημιουργήσετε και να διαχειριστείτε τις ρυθμίσεις autoscale. Για τα σύνολα κλίμακα εικονική μηχανή Χρησιμοποιήστε PoSH, CLI ή REST API για να δημιουργήσετε και να διαχειριστείτε τη ρύθμιση autoscale. Δεν εναλλαγή μεταξύ Azure κλασική πύλη (manage.windowsazure.com) και την πύλη του Azure (portal.azure.com) κατά τη Διαχείριση autoscale ρυθμίσεις παραμέτρων. Πύλη του Azure κλασική και τα υποκείμενα παρασκηνίου έχει περιορισμούς. Μετακίνηση στην πύλη του Azure για τη Διαχείριση autoscale χρησιμοποιώντας ένα περιβάλλον εργασίας χρήστη. Οι επιλογές είναι να χρησιμοποιήσετε το autoscale PowerShell, CLI ή REST API (μέσω Explorer πόρων Azure).

### <a name="choose-the-appropriate-statistic-for-your-diagnostics-metric"></a>Επιλέξτε την κατάλληλη στατιστική τιμή για το μετρικό Διαγνωστικά
Για τα Διαγνωστικά μετρικά, μπορείτε να επιλέξετε μεταξύ των *μέσος όρος*, *ελάχιστο*, *μέγιστο* και *σύνολο* ως ένα μετρικό για να κλιμακωθεί με. Τα πιο συνηθισμένα στατιστική τιμή είναι *μέση*.

### <a name="choose-the-thresholds-carefully-for-all-metric-types"></a>Επιλέξτε τα όρια προσεκτικά για όλους τους τύπους μετρικό
Συνιστάται να επιλέξετε προσεκτικά διαφορετικά όρια για το κλιμάκωσης και κλίμακας που βασίζεται σε πρακτικές περιπτώσεις.

Θα σας *δεν συνιστάται* autoscale ρυθμίσεις, όπως τα παραδείγματα κάτω από το στοιχείο με την ίδια ή παρόμοια οριακές τιμές για ανάληψη και υπό όρους:

- Αύξηση παρουσίες κατά 1 μέτρηση πότε νήματος Count < = 600
- Μείωση παρουσίες κατά 1 μέτρηση πότε νήματος Count > = 600

Ας δούμε ένα παράδειγμα του τι μπορεί να οδηγήσει σε μια συμπεριφορά που μπορεί να προκαλέσει σύγχυση. Cosider την ακόλουθη σειρά.

1. Θεωρείται ότι δεν υπάρχουν 2 παρουσίες να και, στη συνέχεια, ο μέσος όρος των νήματα ανά παρουσία μεγαλώνει σε 625.
2. Autoscale κλίμακες ανάληψη προσθέτοντας μια 3η περίοδος λειτουργίας.
3. Στη συνέχεια, ας υποθέσουμε ότι το πλήθος average νήματος σε παρουσία εμπίπτουν σε 575.
4. Πριν από την κλίμακα προς τα κάτω, autoscale προσπαθεί να υπολογίσετε τι την τελική κατάσταση θα εάν την κλιμάκωση σε. Για παράδειγμα, 575 x 3 (τρέχουσα παρουσία μέτρηση) = 1,725 / 2 (τελική αριθμός των παρουσιών όταν κλιμάκωση προς τα κάτω) = 862.5 νήματα. Αυτό σημαίνει ότι autoscale θα πρέπει να αμέσως κλίμακα ανάληψης ξανά ακόμη και μετά την κλιμάκωση, εάν το πλήθος average νήματος παραμένει ίδια ή ακόμα και εμπίπτουν μόνο ένα μικρό τμήμα. Ωστόσο, εάν το κλιμάκωση προς τα επάνω, ολόκληρη η διαδικασία να επαναλάβετε, αποτέλεσμα μιας συνεχούς επανάληψης.
5. Για να αποφύγετε αυτήν την κατάσταση (ονομάζονται "flapping"), autoscale δεν κλίμακα προς τα κάτω σε όλα. Αντί για αυτό, παραλείπει και reevaluates τη συνθήκη ξανά την επόμενη φορά που εκτελεί την εργασία στην υπηρεσία. Αυτό θα μπορούσε να συγχέετε πολλά άτομα, επειδή δεν θα εμφανίζονται autoscale ώστε να λειτουργεί όταν το πλήθος average νήματος ήταν 575.

Εκτίμηση κατά τη διάρκεια μιας κλίμακας στο προορίζεται για να αποφύγετε την "flappy" περιπτώσεις. Θα πρέπει να διατηρήσετε αυτήν τη συμπεριφορά υπόψη όταν επιλέγετε την ίδια όρια για ανάληψη κλίμακα και στο.

Συνιστάται να επιλέξετε μια επαρκής περιθώριο μεταξύ την κλίμακα ανάληψη και όρια. Ως παράδειγμα, λάβετε υπόψη το εξής καλύτερη συνδυασμό κανόνα.

- Αύξηση παρουσίες κατά 1 μέτρηση πότε CPU % > = 80
- Μείωση παρουσίες κατά 1 μέτρηση πότε CPU % < = 60

Σε αυτήν την περίπτωση  

1. Θεωρείται ότι υπάρχουν για να ξεκινήσετε με το 2 παρουσιών.
2. Εάν η μέση CPU % όλων των παρουσιών οδηγεί σε 80, autoscale κλίμακες ανάληψη προσθέτοντας ένα τρίτο παρουσία.
3. Τώρα λαμβάνεται ως δεδομένο ότι σταδιακά το ποσοστό της CPU εμπίπτουν σε 60.
4. Autoscale της κλίμακας του κανόνα υπολογίζει την τελική κατάσταση αν αυτό κλίμακα του. Για παράδειγμα, 60 x 3 (τρέχουσα παρουσία μέτρηση) = 180 / 2 (τελική αριθμός των παρουσιών όταν κλιμάκωση προς τα κάτω) = 90. Επομένως, autoscale δεν κλίμακα στο επειδή θα έπρεπε να κλίμακα ανάληψης ξανά αμέσως. Αντί για αυτό, παραλείπει κλίμακας προς τα κάτω.
5. Την επόμενη φορά autoscale ελέγχει, της CPU εξακολουθεί να κυμαίνεται έως 50. Υπολογίζει ξανά - 50 x 3 παρουσία = 150 / 2 παρουσίες = 75, που βρίσκεται κάτω από το όριο κλιμάκωσης 80, ώστε το κλίμακες στο με επιτυχία σε παρουσίες των 2.

### <a name="considerations-for-scaling-threshold-values-for-special-metrics"></a>Ζητήματα για κλιμάκωση οριακές τιμές για ειδική μετρικά
 Για ειδική μετρικά όπως χώρο αποθήκευσης ή υπηρεσία Bus ουρά μετρικό μήκους, το όριο είναι ο μέσος όρος των μηνυμάτων που είναι διαθέσιμα ανά αριθμό της τρέχουσας των παρουσιών. Επιλέξτε προσεκτικά επιλογή το όριο για αυτό το μετρικό.

Ας απεικόνιση του με ένα παράδειγμα για να βεβαιωθείτε ότι μπορείτε να κατανοήσετε καλύτερα τη συμπεριφορά.

- Αύξηση παρουσίες κατά 1 καταμέτρησης όταν ουρά αποθήκευσης μήνυμα count > = 50
- Μείωση παρουσίες κατά 1 καταμέτρηση όταν ουρά αποθήκευσης μήνυμα count < = 10

Εξετάστε την ακόλουθη σειρά:

1. Υπάρχουν περιπτώσεις ουρά 2 χώρου αποθήκευσης.
2. Διατήρηση σύντομα μηνύματα και όταν αναθεωρείτε ουρά χώρου αποθήκευσης, το συνολικό πλήθος διαβάζει 50. Ενδέχεται να θεωρείται ότι autoscale που θα πρέπει να ξεκινήσει μια ενέργεια κλιμάκωσης. Ωστόσο, σημειώστε ότι εξακολουθεί να είναι 50/2 = 25 μηνύματα ανά παρουσία. Επομένως, κλιμάκωσης δεν εμφανίζεται. Για την πρώτη κλίμακα ανάληψη να συμβεί, το συνολικό αριθμό μηνυμάτων στην ουρά του χώρου αποθήκευσης πρέπει να είναι 100.
3. Στη συνέχεια, ας υποθέσουμε ότι το συνολικό αριθμό μηνυμάτων φτάσει 100.
4. Προστίθεται μια τρίτη παρουσία ουρά χώρου αποθήκευσης εξαιτίας μιας ενέργειας κλιμάκωσης.  Η επόμενη ενέργεια κλιμάκωσης δεν θα συμβεί μέχρι το συνολικό αριθμό μηνυμάτων στην ουρά φτάσει 150 επειδή 150/3 = 50.
5. Τώρα, τον αριθμό των μηνυμάτων στην ουρά λαμβάνει μικρότερο μέγεθος. Με 3 περιπτώσεις, την πρώτη ενέργεια κλίμακα συμβαίνει, όταν το σύνολο μηνυμάτων σε όλες τις ουρές προσθέσετε έως 30 επειδή 30/3 = 10 μηνυμάτων ανά παρουσία, η οποία είναι το όριο σε κλίμακα.

### <a name="considerations-for-scaling-when-multiple-profiles-are-configured-in-an-autoscale-setting"></a>Ζητήματα για την κλιμάκωση κατά πολλών προφίλ έχουν ρυθμιστεί οι παράμετροι σε μια ρύθμιση autoscale

Σε μια ρύθμιση autoscale, μπορείτε να επιλέξετε ένα προεπιλεγμένο προφίλ, το οποίο εφαρμόζεται πάντα χωρίς οποιαδήποτε εξάρτηση σε χρονοδιάγραμμα ή την ώρα, ή μπορείτε να επιλέξετε μια επαναλαμβανόμενη προφίλ ή ένα προφίλ για μια καθορισμένη περίοδο με μια περιοχή ημερομηνίας και ώρας.

Όταν η υπηρεσία autoscale επεξεργάζεται τους, ελέγχει πάντα με την εξής σειρά:

1. Σταθερή ημερομηνία προφίλ
2. Περιοδική προφίλ
3. Προεπιλεγμένη προφίλ ("πάντα")

Αν ικανοποιείται μια συνθήκη προφίλ, autoscale δεν ελέγχει τη συνθήκη επόμενη προφίλ κάτω από αυτό. Autoscale επεξεργάζεται μόνο ένα προφίλ κάθε φορά. Αυτό σημαίνει ότι εάν θέλετε να συμπεριλάβετε επίσης μια συνθήκη επεξεργασίας από ένα επίπεδο κάτω προφίλ, πρέπει να συμπεριλάβετε αυτούς τους κανόνες καθώς και στο τρέχον προφίλ.

Ας Διαβάστε αυτό χρησιμοποιώντας ένα παράδειγμα:

Η παρακάτω εικόνα δείχνει μια ρύθμιση autoscale με ενός προεπιλεγμένου προφίλ του ελάχιστου παρουσίες = 2 και το μέγιστο παρουσίες = 10. Σε αυτό το παράδειγμα, κανόνες έχουν ρυθμιστεί για την εξερχόμενη κλίμακα όταν το πλήθος μηνύματος στην ουρά είναι μεγαλύτερη από 10 και κλίμακας στο όταν η μέτρηση μηνύματος στην ουρά είναι μικρότερη από 3. Τώρα ο πόρος μπορεί να κλιμακωθεί μεταξύ παρουσιών 2 έως 10.

Επιπλέον, υπάρχει μια επαναλαμβανόμενη προφίλ για τη Δευτέρα. Έχει οριστεί για το ελάχιστο παρουσίες = 2 και το μέγιστο παρουσίες = 12. Αυτό σημαίνει ότι τη Δευτέρα, την πρώτη φορά autoscale ελέγχει για αυτήν την κατάσταση, εάν το πλήθος παρουσία είναι 2, το κλίμακες στο νέο ελάχιστο του 3. Με την προϋπόθεση ότι autoscale εξακολουθεί να βρείτε αυτή η συνθήκη του προφίλ αντιστοιχιστεί (Δευτέρα), μόνο επεξεργάζεται το CPU κανόνες με βάση το κλίμακα ανάληψης/στη ρύθμιση των παραμέτρων για αυτό το προφίλ. Προς το παρόν, το δεν ελέγχει για το μήκος ουράς. Ωστόσο, εάν θέλετε επίσης τη συνθήκη μήκος ουρά να γίνει μεταβίβαση ελέγχου, που θα πρέπει να συμπεριλάβετε αυτούς τους κανόνες από το προεπιλεγμένο προφίλ καθώς και στο προφίλ σας Δευτέρα.

Ομοίως, όταν autoscale επιστρέφει στην κατάσταση του προεπιλεγμένου προφίλ, πρώτα ελέγχει αν πληρούνται οι συνθήκες ελάχιστο και μέγιστο. Εάν ο αριθμός των παρουσιών τη στιγμή είναι 12, κλίμακες στο σε 10, το μέγιστο επιτρεπόμενο για το προεπιλεγμένο προφίλ.

![ρυθμίσεις Autoscale](./media/insights-autoscale-best-practices/insights-autoscale-best-practices.png)

### <a name="considerations-for-scaling-when-multiple-rules-are-configured-in-a-profile"></a>Ζητήματα για την κλιμάκωση κατά πολλούς κανόνες έχουν ρυθμιστεί στο προφίλ
Υπάρχουν περιπτώσεις όπου ίσως χρειαστεί να ορίσετε πολλούς κανόνες σε ένα προφίλ. Το παρακάτω σύνολο των κανόνων autoscale που χρησιμοποιούνται με τη χρήση υπηρεσιών όταν έχουν οριστεί από πολλούς κανόνες.

Σε *κλίμακα ανάληψη*, autoscale εκτελείται αν ικανοποιείται οποιονδήποτε κανόνα.
Σε *κλίμακα του*, autoscale απαιτούν όλοι οι κανόνες για να τερματιστεί.

Για την απεικόνιση, λαμβάνεται ως δεδομένο ότι έχετε τους παρακάτω κανόνες autoscale 4:

- Εάν CPU < 30%, κλίμακα στο από 1
- Εάν μνήμης < 50%, κλίμακα στο από 1
- Εάν CPU > 75%, κλίμακα-εκτός από 1
- Εάν μνήμης > 75%, κλίμακα-εκτός από 1

Στη συνέχεια, παρουσιάζεται παρακολούθηση:

- Εάν 76% είναι CPU και μνήμης είναι 50%, θα σας κλίμακα ελέγχου.
- Εάν το 50% είναι CPU και μνήμης είναι 76% θα σας κλίμακα ελέγχου.

Από την άλλη πλευρά, εάν 25% είναι CPU και μνήμης autoscale 51% κάνει **δεν** κλίμακα στο. Για να κλίμακα του, CPU πρέπει να είναι 29% και μνήμης 49%.

### <a name="always-select-a-safe-default-instance-count"></a>Πρέπει πάντα να επιλέγετε ένα πλήθος παρουσία ασφαλή προεπιλεγμένη
Το πλήθος παρουσία προεπιλογή είναι σημαντικό autoscale κλίμακες της υπηρεσίας σε συγκεκριμένη υπολογίζονται κατά μετρικά δεν είναι διαθέσιμες. Γι ' αυτό, επιλέξτε μια καταμέτρηση παρουσία προεπιλεγμένη που είναι ασφαλείς για το φόρτο εργασίας.

### <a name="configure-autoscale-notifications"></a>Ρύθμιση παραμέτρων ειδοποιήσεων autoscale
Autoscale ειδοποιεί το διαχειριστές και οι συνεργάτες του πόρου μέσω ηλεκτρονικού ταχυδρομείου, εάν παρουσιαστεί κάποιο από τα εξής:

- υπηρεσία Autoscale δεν μπορεί να διαρκέσει μια ενέργεια.
- Μετρικά δεν είναι διαθέσιμες για την υπηρεσία autoscale για να κάνετε μια κλίμακα απόφασης.
- Μετρικά είναι διαθέσιμη (αποκατάστασης) ξανά για να κάνετε μια κλίμακα απόφασης.
Εκτός από τους παραπάνω όρους, μπορείτε να ρυθμίσετε ειδοποιήσεις ηλεκτρονικού ταχυδρομείου ή webhook για να ενημερώνεστε για επιτυχή κλίμακα ενέργειες.

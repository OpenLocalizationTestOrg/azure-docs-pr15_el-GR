<properties
    pageTitle="Γρήγορα αποτελέσματα με τους ρόλους, δικαιώματα και την ασφάλεια με την εποπτεία Azure | Microsoft Azure"
    description="Μάθετε πώς μπορείτε να χρησιμοποιήσετε ενσωματωμένα ρόλων και δικαιωμάτων Azure της οθόνης για να περιορίσετε την πρόσβαση σε παρακολούθηση πόρων."
    authors="johnkemnetz"
    manager="rboucher"
    editor=""
    services="monitoring-and-diagnostics"
    documentationCenter="monitoring-and-diagnostics"/>

<tags
    ms.service="monitoring-and-diagnostics"
    ms.workload="na"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/26/2016"
    ms.author="johnkem"/>

# <a name="get-started-with-roles-permissions-and-security-with-azure-monitor"></a>Γρήγορα αποτελέσματα με τους ρόλους, δικαιώματα και την ασφάλεια με την εποπτεία Azure

Πολλές ομάδες πρέπει να αυστηρά την πρόσβαση στα δεδομένα και ρυθμίσεις παρακολούθησης. Για παράδειγμα, εάν έχετε τα μέλη της ομάδας που εργάζονται σε αποκλειστική χρήση παρακολούθησης (μηχανικοί υποστήριξης, οι μηχανικοί devops) ή εάν χρησιμοποιείτε μια διαχειριζόμενη υπηρεσία παροχής, μπορεί να θέλετε να τους εκχωρήσετε πρόσβαση σε δεδομένα παρακολούθησης μόνο ενώ περιορίζετε τη δυνατότητα για τη δημιουργία, τροποποίηση ή διαγραφή τους πόρους. Σε αυτό το άρθρο παρουσιάζει τον τρόπο για να εφαρμόσετε ένα ενσωματωμένο παρακολούθησης RBAC ρόλο σε ένα χρήστη στο Azure ή να δημιουργήσετε το δικό σας προσαρμοσμένο ρόλο για ένα χρήστη που χρειάζεται περιορισμένα δικαιώματα παρακολούθησης. Στη συνέχεια, ασχολείται με ζητήματα ασφαλείας σχετικά με τους πόρους που σχετίζονται με το Azure οθόνη σας και πώς μπορείτε να περιορίσετε την πρόσβαση στα δεδομένα που περιέχουν.

## <a name="built-in-monitoring-roles"></a>Ενσωματωμένη παρακολούθηση ρόλων

Ενσωματωμένη ρόλους Azure οθόνη έχουν σχεδιαστεί για να περιορίσετε την πρόσβαση σε πόρων σε μια συνδρομή, ενώ θα εξακολουθήσετε εκείνα που είναι υπεύθυνα για την παρακολούθηση υποδομή για να αποκτήσετε και να ρυθμίσετε τα δεδομένα που χρειάζονται. Οθόνη Azure παρέχει δύο εκτός του πλαισίου ρόλους: A παρακολούθηση ανάγνωσης και ένα συνεργάτη παρακολούθησης.

### <a name="monitoring-reader"></a>Παρακολούθηση ανάγνωσης

Άτομα που έχει εκχωρηθεί ο ρόλος παρακολούθηση πρόγραμμα ανάγνωσης μπορεί να προβολή όλων των δεδομένων παρακολούθησης σε μια συνδρομή, αλλά δεν είναι δυνατό να τροποποιήσετε οποιαδήποτε πόρων ή να επεξεργαστείτε τις ρυθμίσεις που σχετίζονται με την παρακολούθηση πόρων. Ο ρόλος αυτός είναι κατάλληλη για τους χρήστες σε μια εταιρεία, όπως οι μηχανικοί υποστήριξης ή λειτουργίες, που πρέπει να έχετε τη δυνατότητα να:

- Προβολή πινάκων εργαλείων παρακολούθησης στην πύλη και δημιουργήστε τις δικές τους πίνακες εργαλείων ιδιωτικό παρακολούθησης.
- Ερώτημα για μετρικά χρησιμοποιώντας το [Azure οθόνη REST API](https://msdn.microsoft.com/library/azure/dn931930.aspx), [cmdlet του PowerShell](insights-powershell-samples.md)ή [CLI πλατφόρμες](insights-cli-samples.md).
- Ερώτημα το αρχείο καταγραφής δραστηριότητας χρησιμοποιώντας την πύλη, Azure οθόνη REST API, cmdlet του PowerShell ή CLI πλατφόρμες.
- Προβολή [διαγνωστικών ρυθμίσεων](monitoring-overview-of-diagnostic-logs.md#diagnostic-settings) για έναν πόρο.
- Προβάλετε το [προφίλ καταγραφής](monitoring-overview-activity-logs.md#export-the-activity-log-with-log-profiles) για μια συνδρομή.
- Προβολή ρυθμίσεων autoscale.
- Προβολή ειδοποίησης δραστηριότητας και τις ρυθμίσεις.
- Πρόσβαση σε δεδομένα εφαρμογής ιδέες και την προβολή δεδομένων στην ανάλυση AI.
- Αναζήτηση δεδομένων χώρου εργασίας ανάλυσης καταγραφής (OMS), συμπεριλαμβανομένων των δεδομένων χρήσης για το χώρο εργασίας.
- Προβολή αναλυτικών στοιχείων καταγραφής (OMS) διαχείρισης ομάδων.
- Ανάκτηση του σχήματος αναζήτησης ανάλυσης καταγραφής (OMS).
- Λίστα πακέτα πληροφοριών ανάλυσης καταγραφής (OMS).
- Ανάκτηση και εκτέλεση ανάλυσης καταγραφής (OMS) αποθηκευμένες αναζητήσεις.
- Ανακτήστε τη ρύθμιση παραμέτρων του χώρου αποθήκευσης ανάλυσης καταγραφής (OMS).

> [AZURE.NOTE] Αυτός ο ρόλος δεν σας παρέχει πρόσβαση για ανάγνωση σε δεδομένα του αρχείου καταγραφής που έχει ροής με ένα διανομέα συμβάν ή είναι αποθηκευμένα σε ένα λογαριασμό του χώρου αποθήκευσης. [Δείτε παρακάτω](#security-considerations-for-monitoring-data) για πληροφορίες σχετικά με τη ρύθμιση πρόσβασης σε αυτούς τους πόρους.

### <a name="monitoring-contributor"></a>Παρακολούθηση συμβολής

Προβολή όλων των δεδομένων παρακολούθησης σε μια συνδρομή από άτομα που έχει εκχωρηθεί ο ρόλος συμβολής παρακολούθησης και δημιουργία ή τροποποίηση των ρυθμίσεων εποπτείας, αλλά δεν είναι δυνατή η τροποποίηση τυχόν άλλους πόρους. Ο ρόλος αυτός είναι ένα υπερσύνολο του ρόλου Reader παρακολούθησης και είναι κατάλληλο για τα μέλη της ομάδας παρακολούθησης του οργανισμού ή υπηρεσίες παροχής υπηρεσίας διαχειριζόμενων ποιος, εκτός από τα δικαιώματα παραπάνω, πρέπει επίσης να μπορούν να:

- Δημοσίευση παρακολούθησης πίνακες εργαλείων ως κοινόχρηστο πίνακα εργαλείων.
- Ρύθμιση [διαγνωστικών ρυθμίσεων](monitoring-overview-of-diagnostic-logs.md#diagnostic-settings) για μια resource.*
- Ρύθμιση του [προφίλ καταγραφής](monitoring-overview-activity-logs.md#export-the-activity-log-with-log-profiles) για μια subscription.*
- Ορισμός ειδοποίησης δραστηριότητας και ρυθμίσεις.
- Δημιουργία δοκιμές ιδέες εφαρμογής web και των στοιχείων.
- Λίστα ανάλυσης καταγραφής (OMS) χώρου εργασίας σε κοινή χρήση αριθμών-κλειδιών.
- Ενεργοποίηση ή απενεργοποίηση πακέτα πληροφοριών ανάλυσης καταγραφής (OMS).
- Δημιουργία και διαγραφή και εκτέλεση ανάλυσης καταγραφής (OMS) αποθηκευμένες αναζητήσεις.
- Δημιουργία και διαγραφή τη ρύθμιση παραμέτρων του χώρου αποθήκευσης ανάλυσης καταγραφής (OMS).

* χρήστης πρέπει να έχει επίσης ξεχωριστά ListKeys δικαίωμα για τον πόρο προορισμού (χώρος αποθήκευσης λογαριασμού ή ένα συμβάν διανομέα χώρος ονομάτων) για να ορίσετε ένα αρχείο καταγραφής προφίλ ή διαγνωστικών ρύθμιση.

> [AZURE.NOTE] Αυτός ο ρόλος δεν σας παρέχει πρόσβαση για ανάγνωση σε δεδομένα του αρχείου καταγραφής που έχει ροής με ένα διανομέα συμβάν ή είναι αποθηκευμένα σε ένα λογαριασμό του χώρου αποθήκευσης. [Δείτε παρακάτω](#security-considerations-for-monitoring-data) για πληροφορίες σχετικά με τη ρύθμιση πρόσβασης σε αυτούς τους πόρους.

## <a name="monitoring-permissions-and-custom-rbac-roles"></a>Παρακολούθηση δικαιώματα και τους ρόλους προσαρμοσμένο RBAC
Εάν οι παραπάνω ενσωματωμένη ρόλοι δεν πληροί τις ακριβείς ανάγκες της ομάδας σας, μπορείτε να [δημιουργήσετε ένα προσαρμοσμένο ρόλο RBAC](../active-directory/role-based-access-control-custom-roles.md) με πιο λεπτομερές δικαιώματα. Παρακάτω υπάρχουν τις κοινές λειτουργίες Azure οθόνη RBAC με τις περιγραφές τους.

| Η λειτουργία                                                   | Περιγραφή                                                                                                                                               |
|-------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Διαγραφή Microsoft.Insights/AlertRules/[Read, εγγραφής]         | Ανάγνωση/εγγραφή/Διαγραφή ειδοποίησης κανόνες.                                                                                                                            |
| Microsoft.Insights/AlertRules/Incidents/Read                | Λίστα περιστατικά (ιστορικό του ειδοποίησης κανόνα που ενεργοποίησε) για κανόνες ειδοποίησης. Αυτό ισχύει μόνο για την πύλη.                                              |
| Διαγραφή Microsoft.Insights/AutoscaleSettings/[Read, εγγραφής]  | Ρυθμίσεις autoscale ανάγνωσης/εγγραφής/διαγραφή.                                                                                                                     |
| Διαγραφή Microsoft.Insights/DiagnosticSettings/[Read, εγγραφής] | Ρυθμίσεις διαγνωστικών ανάγνωσης/εγγραφής/διαγραφή.                                                                                                                    |
| Microsoft.Insights/eventtypes/digestevents/Read             | Αυτό το δικαίωμα είναι απαραίτητο για τους χρήστες που χρειάζονται πρόσβαση σε αρχεία καταγραφής δραστηριότητας μέσω της πύλης.                                                                   |
| Microsoft.Insights/eventtypes/values/Read                   | Λίστα δραστηριότητα καταγραφής συμβάντων (διαχείρισης συμβάντων) σε μια συνδρομή. Αυτό το δικαίωμα ισχύει για το προγραμματισμού και πύλης πρόσβασης για το αρχείο καταγραφής της δραστηριότητας. |
| Microsoft.Insights/LogDefinitions/Read                      | Αυτό το δικαίωμα είναι απαραίτητο για τους χρήστες που χρειάζονται πρόσβαση σε αρχεία καταγραφής δραστηριότητας μέσω της πύλης.                                                                   |
| Microsoft.Insights/MetricDefinitions/Read                   | Διαβάστε μετρικό ορισμών (λίστα μετρικό τους διαθέσιμους τύπους για έναν πόρο).                                                                                  |
| Microsoft.Insights/Metrics/Read                             | Διαβάστε μετρήσεις για έναν πόρο.                                                                                                                              |

> [AZURE.NOTE] Πρόσβαση σε ειδοποιήσεις, ρυθμίσεις διαγνωστικών και μετρήσεις για έναν πόρο απαιτεί ότι ο χρήστης έχει πρόσβαση για ανάγνωση για τον τύπο πόρου και το εύρος αυτού του πόρου. Δημιουργία ("Εγγραφή") ένα διαγνωστικών ρύθμιση ή το αρχείο καταγραφής προφίλ που αρχειοθετεί σε ένα λογαριασμό του χώρου αποθήκευσης ή ροών διανομείς συμβάν απαιτεί από το χρήστη να έχουν επίσης το δικαίωμα ListKeys στον πόρο προορισμού.

Για παράδειγμα, χρησιμοποιώντας τον παραπάνω πίνακα, θα μπορούσατε να δημιουργήσετε ένα προσαρμοσμένο ρόλο RBAC μια "δραστηριότητα καταγραφής πρόγραμμα ανάγνωσης" ως εξής:

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Activity Log Reader"
$role.Description = "Can view activity logs."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Insights/eventtypes/*")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription")
New-AzureRmRoleDefinition -Role $role 
```

## <a name="security-considerations-for-monitoring-data"></a>Ζητήματα ασφαλείας για παρακολούθηση δεδομένων
Παρακολούθηση δεδομένων — ιδιαίτερα αρχεία καταγραφής — μπορεί να περιέχει ευαίσθητες πληροφορίες, όπως ονόματα χρηστών ή διευθύνσεις IP. Παρακολούθηση δεδομένων από το Azure εμφανίζεται σε τρεις βασικές μορφές:
1. Το αρχείο καταγραφής δραστηριοτήτων, που περιγράφει όλες οι ενέργειες ελέγχου επίπεδο στη συνδρομή σας στο Azure.
2. Αρχεία καταγραφής διαγνωστικών, που είναι αρχεία καταγραφής που εκπέμπει από έναν πόρο.
3. Μετρήσεις, το οποίο είναι που εκπέμπει από τους πόρους.

Οι τρεις από αυτούς τους τύπους δεδομένων μπορεί να είναι αποθηκευμένα σε ένα λογαριασμό του χώρου αποθήκευσης ή να ροής σε συμβάν διανομέα, οι οποίες είναι γενικής χρήσης Azure πόρους. Επειδή αυτές είναι γενικής χρήσης πόρων, τη δημιουργία, διαγραφή και πρόσβαση σε αυτά είναι μια λειτουργία Προνομιούχους συνήθως δεσμευμένα για ένα διαχειριστή. Προτείνουμε να χρησιμοποιήσετε τις ακόλουθες πρακτικές για παρακολούθηση που σχετίζονται με τους πόρους ώστε να μην γίνεται εσφαλμένη χρήση:

- Χρησιμοποιήστε ένα λογαριασμό μεμονωμένο, αποκλειστικό χώρου αποθήκευσης για παρακολούθηση δεδομένων. Εάν χρειάζεστε για να διαχωρίσετε παρακολούθησης δεδομένων σε πολλούς λογαριασμούς χώρου αποθήκευσης, ποτέ κοινή χρήση χρήση ενός λογαριασμού χώρου αποθήκευσης μεταξύ παρακολούθηση και μη παρακολούθηση δεδομένων, ως εξής μπορεί να δώσει κατά λάθος όσους χρειάζονται μόνο πρόσβαση παρακολούθηση δεδομένων (π.χ. μια SIEM τρίτων κατασκευαστών) πρόσβαση σε μη παρακολούθηση δεδομένων.
- Χρησιμοποιήστε ένα μεμονωμένο, αποκλειστικό Bus υπηρεσία ή το συμβάν διανομέα χώρο ονομάτων σε όλες τις ρυθμίσεις διαγνωστικών για τον ίδιο λόγο όπως παραπάνω.
- Περιορίσετε την πρόσβαση σε λογαριασμούς παρακολούθησης που σχετίζονται με το χώρο αποθήκευσης ή συμβάν διανομείς, διατηρώντας τα σε μια ομάδα ξεχωριστή πόρων και [Χρησιμοποιήστε εύρος](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) σας παρακολούθησης τους ρόλους για να περιορίσετε την πρόσβαση μόνο η ομάδα πόρων.
- Ποτέ εκχωρήσει το δικαίωμα ListKeys για λογαριασμούς χώρου αποθήκευσης ή διανομείς συμβάν στο εύρος συνδρομή, όταν ο χρήστης πρέπει να μόνο πρόσβαση σε δεδομένα παρακολούθησης. Αντί για αυτό, δώστε αυτά τα δικαιώματα για το χρήστη σε έναν πόρο ή μια ομάδα πόρων (Εάν έχετε μια αποκλειστική παρακολούθησης ομάδα πόρων) εύρος.

### <a name="limiting-access-to-monitoring-related-storage-accounts"></a>Περιορισμός πρόσβασης σε λογαριασμούς παρακολούθησης που σχετίζονται με το χώρο αποθήκευσης
Όταν ένα χρήστη ή μια εφαρμογή χρειάζεται πρόσβαση σε δεδομένα σε ένα λογαριασμό του χώρου αποθήκευσης παρακολούθησης, θα πρέπει να [δημιουργήσει ένα λογαριασμό συσχετισμών Ασφαλείας](https://msdn.microsoft.com/library/azure/mt584140.aspx) για το λογαριασμό χώρου αποθήκευσης που περιέχει τα δεδομένα παρακολούθησης με πρόσβαση μόνο για ανάγνωση υπηρεσίας επιπέδου με το χώρο αποθήκευσης αντικειμένων blob. Στο PowerShell, αυτό μπορεί να μοιάζει με:

```powershell
$context = New-AzureStorageContext -ConnectionString "[connection string for your monitoring Storage Account]"
$token = New-AzureStorageAccountSASToken -ResourceType Service -Service Blob -Permission "rl" -Context $context
```

Στη συνέχεια, μπορείτε να δώσετε το διακριτικό στην οντότητα που πρέπει να διαβάσετε από αυτόν το χώρο αποθήκευσης λογαριασμό και το μπορεί να λίστα και ανάγνωση από όλων των BLOB σε αυτόν το λογαριασμό χώρου αποθήκευσης.

Εναλλακτικά, εάν πρέπει να ελέγξετε αυτό το δικαίωμα με RBAC, μπορείτε να εκχωρήσετε αυτή η οντότητα το δικαίωμα Microsoft.Storage/storageAccounts/listkeys/action σε αυτόν το χώρο αποθήκευσης στο συγκεκριμένο λογαριασμό. Αυτό είναι απαραίτητο για τους χρήστες που πρέπει να έχετε τη δυνατότητα να ορίσετε ρυθμίσεις διαγνωστικών ή συνδεθείτε προφίλ για να αρχειοθετήσετε ένα λογαριασμό του χώρου αποθήκευσης. Για παράδειγμα, μπορείτε να δημιουργήσετε τον ακόλουθο προσαρμοσμένο ρόλο RBAC για ένα χρήστη ή την εφαρμογή που χρειάζεται μόνο για ανάγνωση από ένα λογαριασμό χώρου αποθήκευσης:

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Monitoring Storage Account Reader"
$role.Description = "Can get the storage account keys for a monitoring storage account."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Storage/storageAccounts/listkeys/action")
$role.Actions.Add("Microsoft.Storage/storageAccounts/Read")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/myMonitoringStorageAccount")
New-AzureRmRoleDefinition -Role $role 
```

> [AZURE.WARNING] Το δικαίωμα ListKeys επιτρέπει στο χρήστη να παρουσιάζουν τα πλήκτρα λογαριασμό κύριας και δευτερεύουσας χώρου αποθήκευσης. Τα πλήκτρα Παραχωρήστε στο χρήστη όλα τα υπογεγραμμένα δικαιώματα (ανάγνωση, εγγραφή, δημιουργία αντικείμενα blob, διαγραφή αντικειμένων blob, κ.λπ.) σε όλους πραγματοποιήσει υπηρεσιών (blob, ουρά, πίνακα, αρχείο) σε αυτόν το λογαριασμό χώρου αποθήκευσης. Συνιστάται να χρησιμοποιείτε ένα συσχετισμών Ασφαλείας λογαριασμού που περιγράφεται παραπάνω, όταν είναι δυνατό.

### <a name="limiting-access-to-monitoring-related-event-hubs"></a>Περιορισμός πρόσβασης σε διανομείς παρακολούθησης που σχετίζονται με το συμβάν
Μπορείτε να ακολουθήσετε ένα μοτίβο παρόμοια με διανομείς συμβάντος, αλλά πρέπει πρώτα να δημιουργήσετε μια αποκλειστική κανόνας εξουσιοδότησης ακρόαση. Εάν θέλετε να εκχωρήσετε πρόσβαση σε μια εφαρμογή που το μόνο που χρειάζεται για να ακούσετε διανομείς παρακολούθησης που σχετίζονται με το συμβάν, κάντε τα εξής:

1. Δημιουργία πολιτικής κοινόχρηστη πρόσβαση σε το συμβάν hub(s) που έχουν δημιουργηθεί για τη ροή δεδομένων παρακολούθησης με μόνο ακρόαση αξιώσεων. Αυτό μπορεί να γίνει στην πύλη. Για παράδειγμα, μπορεί να καλείτε "monitoringReadOnly." Εάν είναι δυνατόν, θα θέλετε να δώσετε σε αυτό το πλήκτρο απευθείας σε καταναλωτή και μεταβείτε στο επόμενο βήμα.
2. Εάν ο καταναλωτής πρέπει να είναι δυνατή η λήψη του κλειδιού ad-hoc, παραχωρήστε στο χρήστη την ενέργεια ListKeys σε αυτόν το διανομέα συμβάν. Αυτό είναι επίσης για τους χρήστες που πρέπει να έχετε τη δυνατότητα να ορίσετε ρυθμίσεις διαγνωστικών ή συνδεθείτε προφίλ ροής με διανομείς συμβάν. Για παράδειγμα, μπορείτε να δημιουργήσετε έναν κανόνα RBAC:

   ```powershell
   $role = Get-AzureRmRoleDefinition "Reader"
   $role.Id = $null
   $role.Name = "Monitoring Event Hub Listener"
   $role.Description = "Can get the key to listen to an event hub streaming monitoring data."
   $role.Actions.Clear()
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/authorizationrules/listkeys/action")
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/Read")
   $role.AssignableScopes.Clear()
   $role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.ServiceBus/namespaces/mySBNameSpace")
   New-AzureRmRoleDefinition -Role $role 
   ```


## <a name="next-steps"></a>Επόμενα βήματα
- [Διαβάστε σχετικά με τις RBAC και τα δικαιώματα στη Διαχείριση πόρων](../active-directory/role-based-access-control-what-is.md)
- [Διαβάστε την επισκόπηση της παρακολούθησης στο Azure](monitoring-overview.md)

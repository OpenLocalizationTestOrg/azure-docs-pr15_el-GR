<properties 
    pageTitle="Υπηρεσία Bus ασύγχρονης μηνυμάτων | Microsoft Azure"
    description="Περιγραφή υπηρεσίας Bus ασύγχρονης μηνυμάτων."
    services="service-bus"
    documentationCenter="na"
    authors="sethmanheim"
    manager="timlt"
    editor="" /> 
<tags 
    ms.service="service-bus"
    ms.devlang="na"
    ms.topic="article"
    ms.tgt_pltfrm="na"
    ms.workload="na"
    ms.date="10/04/2016"
    ms.author="sethm" />

# <a name="asynchronous-messaging-patterns-and-high-availability"></a>Ασύγχρονη μοτίβα ανταλλαγής μηνυμάτων και υψηλή διαθεσιμότητα

Ασύγχρονη ανταλλαγή μηνυμάτων μπορεί να υλοποιηθεί με πολλούς διαφορετικούς τρόπους. Με ουρές, θέματα και συνδρομές, Azure Service Bus υποστηρίζει asynchrony μέσω ενός χώρου αποθήκευσης και προς τα εμπρός μηχανισμό. Στην κανονική λειτουργία (σύγχρονη), αποστολή μηνυμάτων σε ουρές και τα θέματα και λαμβάνετε μηνύματα από ουρές και συνδρομών. Εφαρμογές γράφετε εξαρτώνται από αυτά τα πάντα είναι διαθέσιμα οντοτήτων. Όταν αλλάξει την εύρυθμη λειτουργία οντότητα, οφείλεται σε διάφορες περιπτώσεις, χρειάζεστε έναν τρόπο για την παροχή μια οντότητα μειωμένη δυνατότητα που να πληρούν περισσότερες ανάγκες.

Εφαρμογές χρησιμοποιούν συνήθως ασύγχρονης μοτίβα ανταλλαγής μηνυμάτων για να ενεργοποιήσετε έναν αριθμό σενάρια επικοινωνίας. Μπορείτε να δημιουργήσετε εφαρμογές στην οποία οι υπολογιστές-πελάτες να στείλετε μηνύματα σε υπηρεσίες, ακόμα και όταν δεν εκτελείται η υπηρεσία. Για τις εφαρμογές που μπορούν να σας βοηθήσουν καταιγισμό των επικοινωνιών, μια ουρά εμπειρία επίπεδο η φόρτωση, παρέχοντας ένα σημείο για επικοινωνία buffer. Τέλος, μπορείτε να λάβετε μια μονάδα εξισορρόπησης φόρτου απλά, ωστόσο αποτελεσματικά για τη διανομή μηνυμάτων σε πολλούς υπολογιστές.

Για να διατηρήσετε τη διαθεσιμότητα των οποιαδήποτε από αυτές τις οντοτήτων, εξετάστε το ενδεχόμενο διαφορετικούς τρόπους με την οποία μπορούν να εμφανίζονται διαθέσιμες για διαρκή σύστημα ανταλλαγής μηνυμάτων αυτών των οντοτήτων. Σε γενικές γραμμές, μπορούμε να δούμε η οντότητα δεν είναι διαθέσιμα στις εφαρμογές μας γράψετε με τους ακόλουθους διαφορετικούς τρόπους:

- Δεν είναι δυνατή η αποστολή μηνυμάτων.

- Δεν είναι δυνατή η λήψη μηνυμάτων.

- Δεν είναι δυνατή η διαχείριση οντοτήτων (δημιουργία, ανάκτηση, ενημέρωση ή διαγραφή οντοτήτων).

- Δεν είναι δυνατή η επικοινωνία με την υπηρεσία.

Για κάθε μία από αυτές τις αποτυχίες, διαφορετικά αποτυχία λειτουργίες υπάρχει με δυνατότητα μια εφαρμογή για να συνεχίσετε να εκτελούν μια εργασία σε ορισμένες επίπεδο μειωμένη τη δυνατότητα. Για παράδειγμα, ένα σύστημα που μπορούν να στέλνουν μηνύματα, αλλά δεν λαμβάνετε τα εξακολουθούν να μπορούν να λαμβάνουν παραγγελίες από πελάτες, αλλά δεν μπορεί να επεξεργαστεί αυτές τις παραγγελίες. Αυτό το θέμα περιγράφει πιθανά ζητήματα που μπορεί να προκύψουν και πώς είναι μετριάζεται αυτά τα θέματα. Υπηρεσία Bus παρουσίασε μετριασμούς που πρέπει να επιλέγουν εάν σε έναν αριθμό και αυτό το θέμα περιγράφει επίσης τους κανόνες που διέπουν τη χρήση του αυτές τις μετριασμούς επιλογή.

## <a name="reliability-in-service-bus"></a>Αξιοπιστία σε Bus υπηρεσίας

Υπάρχουν πολλοί τρόποι για να χειριστείτε θέματα μήνυμα και οντότητα και υπάρχουν που διέπουν την κατάλληλη χρήση του μετριασμούς αυτές τις οδηγίες. Για να κατανοήσετε τις κατευθυντήριες γραμμές, πρέπει πρώτα να κατανοήσετε τι μπορεί να αποτύχει στην υπηρεσία Bus. Λόγω της σχεδίασης της Azure συστήματα, όλα αυτά τα θέματα είναι συνήθως μικρής διάρκειας. Σε υψηλό επίπεδο, οι διαφορετικές αιτίες μη διαθεσιμότητα εμφανίζεται ως εξής:

-   Από ένα εξωτερικό σύστημα από τις οποίες εξαρτάται η υπηρεσία Bus περιορισμού. Περιορισμού που προκύπτει από τις αλληλεπιδράσεις με το χώρο αποθήκευσης και υπολογισμού πόρους.

-   Το ζήτημα για ένα σύστημα από την οποία εξαρτάται Bus υπηρεσίας. Για παράδειγμα, μια δεδομένη μέρος του χώρου αποθήκευσης μπορεί να αντιμετωπίσετε προβλήματα.

-   Αποτυχία της υπηρεσίας Bus σε μία μόνο υποσυστήματος. Σε αυτήν την περίπτωση, μια κόμβος μπορούν να μεταβούν σε ασυνέπεια και πρέπει να επανεκκινήσετε το ίδιο, προκαλεί όλα οντοτήτων εξυπηρετεί για τη φόρτωση υπολοίπου σε άλλους κόμβους. Αυτό με τη σειρά μπορεί να προκαλέσει μια σύντομη περίοδο επεξεργασίας αργή μηνυμάτων.

-   Αποτυχία της υπηρεσίας Bus μέσα σε ένα κέντρο δεδομένων του Azure. Αυτή είναι μια "καταστροφική αποτυχία" κατά την οποία είναι δυνατή η πρόσβαση στο σύστημα για πολλά λεπτά ή μερικές ώρες.

> [AZURE.NOTE] **Χώρου αποθήκευσης** όρων μπορεί να σημαίνουν αποθήκευσης Azure και SQL Azure.

Υπηρεσία Bus περιέχει έναν αριθμό μετριασμούς για αυτά τα θέματα. Οι παρακάτω ενότητες περιγράφουν κάθε θέμα και τα αντίστοιχα μετριασμούς.

### <a name="throttling"></a>Περιορισμού

Με την υπηρεσία Bus, περιορισμού δίνει τη δυνατότητα διαχείρισης χρεώσεων συνεργασίας μήνυμα. Κάθε μεμονωμένα κόμβο Bus υπηρεσίας φιλοξενεί πολλά οντοτήτων. Κάθε μία από αυτές τις οντοτήτων κάνει απαιτήσεις του συστήματος όσον αφορά CPU, μνήμη, χώρος αποθήκευσης και άλλες όψεις. Όταν οποιαδήποτε από αυτές τις όψεις εντοπίσει χρήση που υπερβαίνει τα καθορισμένα όρια, Bus υπηρεσίας για να απορρίψετε μια αίτηση που δίνεται. Ο καλών λαμβάνει μια [ServerBusyException][] και επαναλήψεις μετά από 10 δευτερόλεπτα.

Ως ένα μετριασμού, τον κωδικό πρέπει να διαβάσει το σφάλμα και διακοπή οποιαδήποτε επαναλήψεων του μηνύματος για τουλάχιστον 10 δευτερόλεπτα. Επειδή το σφάλμα μπορεί να συμβεί σε τμήματα της εφαρμογής πελάτη, αναμένεται ότι κάθε τμήμα εκτελείται ανεξάρτητα της λογικής "Επανάληψη". Ο κώδικας να μειώσετε την πιθανότητα να επιβραδύνει ενεργοποιώντας διαμερισμάτων σε ουρά ή το θέμα.

### <a name="issue-for-an-azure-dependency"></a>Το ζήτημα για μια εξάρτηση Azure

Άλλα στοιχεία μέσα σε Azure μερικές φορές μπορεί να έχει ζητήματα υπηρεσίας. Για παράδειγμα, όταν ένα σύστημα που χρησιμοποιεί υπηρεσία Bus αναβαθμίζεται, σύστημα που μπορεί να αντιμετωπίσετε προσωρινά μειωμένη δυνατότητες. Για να επιλύσετε αυτούς τους τύπους ζητημάτων, υπηρεσία Bus τακτικά διερευνάται και υλοποιεί μετριασμούς. Εμφανίζονται ανεπιθύμητα αποτελέσματα από αυτές τις μετριασμούς. Για παράδειγμα, για να χειριστείτε μεταβατικές θέματα με το χώρο αποθήκευσης, υπηρεσία Bus εφαρμόζει ένα σύστημα που επιτρέπει λειτουργίες αποστολής μηνύματος για να εργαστείτε με συνέπεια. Λόγω της φύσης του μετριασμού, απεσταλμένο μήνυμα μπορεί να διαρκέσει έως 15 λεπτά για να εμφανίζονται στην ουρά που επηρεάζεται ή τη συνδρομή και θα είστε έτοιμοι για μια λειτουργία παραλαβής. Σε γενικές γραμμές, οι περισσότερες οντοτήτων δεν θα αντιμετωπίσετε αυτό το ζήτημα. Ωστόσο, δεδομένου του αριθμού των οντοτήτων στην υπηρεσία Bus εντός Azure, αυτού του μετριασμού μερικές φορές χρειάζεται για ένα μικρό υποσύνολο Bus εξυπηρέτησης πελατών.

### <a name="service-bus-failure-on-a-single-subsystem"></a>Αποτυχία υπηρεσίας Bus σε ένα μεμονωμένο υποσυστήματος

Με οποιαδήποτε εφαρμογή του, συνθήκες μπορεί να προκαλέσει μια εσωτερική στοιχείο της υπηρεσίας Bus ασυνέπεια. Όταν η υπηρεσία Bus εντοπίσει αυτό, συλλέγει δεδομένα από την εφαρμογή για να βοηθήσει στη διάγνωση τι συνέβη. Όταν τα δεδομένα που συλλέγονται, επανεκκίνηση της εφαρμογής σε μια προσπάθεια να επαναφέρετε μια συνεπή κατάσταση. Αυτή η διαδικασία γίνεται αρκετά γρήγορα και αποτελέσματα σε μια οντότητα που εμφανίζεται να μην είναι διαθέσιμη για έως και μερικά λεπτά, αν και τυπικές προς τα κάτω φορές είναι μικρότερος.

Σε αυτές τις περιπτώσεις, η εφαρμογή-πελάτης δημιουργεί μια εξαίρεση [System.TimeoutException][] ή [MessagingException][] . Υπηρεσία Bus περιέχει ένα μετριασμού για αυτό το ζήτημα με τη μορφή της λογικής αυτόματης προγράμματος-πελάτη "Επανάληψη". Όταν είναι των αποθεμάτων της περιόδου "Επανάληψη" και δεν είναι παράδοση του μηνύματος, μπορείτε να εξερευνήσετε με χρήση άλλων δυνατοτήτων όπως [ζεύγη οι χώροι ονομάτων][]. Ζεύγη οι χώροι ονομάτων έχουν άλλες προειδοποιήσεις που περιγράφονται σε αυτό το άρθρο.

### <a name="failure-of-service-bus-within-an-azure-datacenter"></a>Αποτυχία της υπηρεσίας Bus μέσα σε ένα κέντρο δεδομένων του Azure

Η πιο πιθανή αιτία της αποτυχίας σε ένα κέντρο δεδομένων του Azure είναι μια αποτυχίας αναβάθμισης ανάπτυξη της υπηρεσίας Bus ή εξαρτώμενα σύστημα. Καθώς παλαίωσής την πλατφόρμα, έχει μειώνεται το μέγεθός της πιθανότητας αυτόν τον τύπο αποτυχία. Αποτυχία κέντρο δεδομένων επίσης μπορεί να συμβεί για λόγους που περιλαμβάνουν τα εξής:

-   Διακοπή ηλεκτρικού ρεύματος (παροχή ενέργειας και παραγωγής ενέργειας εξαφανιστούν).
-   Συνδεσιμότητα (internet αλλαγής μεταξύ σας προγράμματα-πελάτες και του Azure).

Και στις δύο περιπτώσεις, μια φυσική ή ανθρωπογενείς καταστροφή προκάλεσαν το ζήτημα. Για να αντιμετωπίσετε αυτό και βεβαιωθείτε ότι μπορείτε ακόμα να στείλετε μηνύματα, μπορείτε να χρησιμοποιήσετε [ζεύγη οι χώροι ονομάτων][] για να ενεργοποιήσετε τα μηνύματα που θα σταλεί σε μια δεύτερη θέση κατά τη διάρκεια στην κύρια θέση είναι σε καλή κατάσταση ξανά. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [βέλτιστες πρακτικές για μονωτικά εφαρμογές σε σχέση με την υπηρεσία Bus διακοπές και καταστροφές][].

## <a name="paired-namespaces"></a>Ζεύγη οι χώροι ονομάτων

Η δυνατότητα [ζεύγη οι χώροι ονομάτων][] υποστηρίζει σενάρια στο οποίο μια υπηρεσία Bus οντότητα ή ανάπτυξη μέσα σε ένα κέντρο δεδομένων δεν είναι διαθέσιμη. Ενώ εκτελείται συχνά αυτό το συμβάν, κατανεμημένα συστήματα εξακολουθεί να πρέπει να προετοιμαστείτε για να χειριστείτε σενάριο χειρότερης περίπτωσης σενάρια. Συνήθως, αυτό το συμβάν συμβαίνει επειδή το στοιχείο ορισμένες από τις οποίες εξαρτάται η υπηρεσία Bus αντιμετωπίζει κάποιο πρόβλημα μικρής διάρκειας. Για να διατηρήσετε διαθεσιμότητα εφαρμογών κατά τη διάρκεια μιας μη διαθεσιμότητα, υπηρεσία Bus χρήστες να χρησιμοποιήσετε δύο ξεχωριστά πεδία ονομάτων, κατά προτίμηση σε κέντρα δεδομένων ξεχωριστά, για τη φιλοξενία τους ανταλλαγής μηνυμάτων οντοτήτων. Το υπόλοιπο αυτής της ενότητας χρησιμοποιεί την εξής ορολογία:

-   Κύρια χώρος ονομάτων: το χώρο ονομάτων με τον οποίο αλληλεπιδρά, για αποστολή και λήψη λειτουργίες της εφαρμογής σας.

-   Χώρος ονομάτων δευτερεύοντα: το χώρο ονομάτων που λειτουργεί ως αντίγραφο ασφαλείας για το πρωτεύον χώρο ονομάτων. Λογική εφαρμογών δεν αλληλεπιδρά με αυτόν το χώρο ονομάτων.

-   Διάστημα ανακατεύθυνσης: το χρονικό διάστημα για να αποδεχτείτε την κανονική αποτυχίες πριν από την εφαρμογή αλλάζει από το κύριο χώρο ονομάτων σε δευτερεύοντα χώρου ονομάτων.

Σύζευξη πεδία ονομάτων υποστήριξη *Αποστολή διαθεσιμότητας*. Αποστολή διαθεσιμότητας διατηρεί τη δυνατότητα για την αποστολή μηνυμάτων. Για να χρησιμοποιήσετε αποστολή διαθεσιμότητας, η εφαρμογή σας πρέπει να ικανοποιεί τις ακόλουθες απαιτήσεις:

1.  Λήψη μόνο των μηνυμάτων από το κύριο χώρο ονομάτων.

2.  Τα μηνύματα που αποστέλλονται σε μια δεδομένη ουρά ή το θέμα μπορεί να παραδίδεται εκτός σειράς.

3.  Εάν η εφαρμογή σας χρησιμοποιεί περίοδοι λειτουργίας, ενδέχεται να άφιξη εκτός σειράς μηνυμάτων μέσα σε μια περίοδο λειτουργίας. Αυτή είναι μια αλλαγή από την κανονική λειτουργία των περιόδων λειτουργίας. Αυτό σημαίνει ότι η εφαρμογή σας χρησιμοποιεί περιόδους λειτουργίας για να ομαδοποιείτε λογικά τα μηνύματα. Κατάσταση περιόδου λειτουργίας διατηρείται μόνο στην κύρια χώρου ονομάτων.

4.  Μηνύματα μέσα σε μια περίοδο λειτουργίας μπορεί να φτάνουν εκτός σειράς. Αυτή είναι μια αλλαγή από την κανονική λειτουργία των περιόδων λειτουργίας. Αυτό σημαίνει ότι η εφαρμογή σας χρησιμοποιεί περιόδους λειτουργίας για να ομαδοποιείτε λογικά τα μηνύματα.

5.  Κατάσταση περιόδου λειτουργίας διατηρείται μόνο στην κύρια χώρου ονομάτων.

6.  Κύρια ουρά μπορεί να προέρχονται online και ξεκινήστε Αποδοχή μηνυμάτων πριν από την δευτερεύουσα ουρά παραδίδει όλα τα μηνύματα σε κύρια ουρά.

Οι παρακάτω ενότητες περιγράφουν τα API, πώς τα API σχετικά με την εφαρμογή και εμφανίζει δείγμα κώδικα που χρησιμοποιεί τη δυνατότητα. Σημειώστε ότι υπάρχουν χρεώσεων συνέπειες που σχετίζεται με αυτήν τη δυνατότητα.

### <a name="the-messagingfactorypairnamespaceasync-api"></a>Το API MessagingFactory.PairNamespaceAsync

Η δυνατότητα ζεύγη οι χώροι ονομάτων περιλαμβάνει τη μέθοδο [PairNamespaceAsync][] στην τάξη [Microsoft.ServiceBus.Messaging.MessagingFactory][] :

```
public Task PairNamespaceAsync(PairedNamespaceOptions options);
```

Όταν ολοκληρωθεί η εργασία, το χώρο ονομάτων σύζευξη είναι επίσης ολοκλήρωσης και είστε έτοιμοι για εκτέλεση ενεργειών σε για οποιαδήποτε [MessageReceiver][], [QueueClient][], ή [TopicClient][] που δημιουργήθηκαν με την παρουσία [MessagingFactory][] . [Microsoft.ServiceBus.Messaging.PairedNamespaceOptions][] είναι η βασική κλάση για τους διαφορετικούς τύπους σύζευξη που είναι διαθέσιμες με ένα αντικείμενο [MessagingFactory][] . Προς το παρόν, μόνο κλάση που προκύπτει είναι ένα συγκεκριμένο [SendAvailabilityPairedNamespaceOptions][], που εφαρμόζει τις απαιτήσεις διαθεσιμότητα αποστολή. [SendAvailabilityPairedNamespaceOptions][] έχει ένα σύνολο υπερφόρτωσης κατασκευής που δομούνται μεταξύ τους. Εξετάζοντας κατασκευή με τις περισσότερες παραμέτρους, μπορείτε να κατανοήσετε τη συμπεριφορά του υπερφόρτωσης κατασκευής.

```
public SendAvailabilityPairedNamespaceOptions(
    NamespaceManager secondaryNamespaceManager,
    MessagingFactory messagingFactory,
    int backlogQueueCount,
    TimeSpan failoverInterval,
    bool enableSyphon)
```

Αυτές οι παράμετροι έχουν την εξής σημασία:

-   *secondaryNamespaceManager*: προετοιμασία [NamespaceManager][] παρουσίας για το χώρο ονομάτων δευτερεύον που να χρησιμοποιήσετε τη μέθοδο [PairNamespaceAsync][] για να ρυθμίσετε το δευτερεύοντα χώρο ονομάτων. Ο διαχειριστής του χώρου ονομάτων χρησιμοποιείται για να λάβει τη λίστα των ουρές στο χώρο ονομάτων και να βεβαιωθείτε ότι υπάρχει τις απαιτούμενες λίστας εκκρεμοτήτων ουρές. Εάν δεν υπάρχουν αυτές τις ουρές, δημιουργούνται. [NamespaceManager][] απαιτεί τη δυνατότητα για τη δημιουργία ενός διακριτικού με το αίτημα **Διαχείριση** .

-   *messagingFactory*: Η παρουσία [MessagingFactory][] για το δευτερεύον χώρο ονομάτων. Το αντικείμενο [MessagingFactory][] χρησιμοποιείται για την αποστολή και, εάν η ιδιότητα [EnableSyphon][] έχει οριστεί στην **τιμή true**, λήψη μηνυμάτων από τη λίστα εκκρεμοτήτων ουρές.

-   *backlogQueueCount*: Ο αριθμός των λίστας εκκρεμοτήτων ουρές για να δημιουργήσετε. Αυτή η τιμή πρέπει να είναι τουλάχιστον 1. Κατά την αποστολή μηνυμάτων για τη λίστα εκκρεμοτήτων, μία από αυτές τις ουρές επιλέγεται τυχαία. Εάν ορίσετε την τιμή σε 1, στη συνέχεια, μόνο μία ουρά μπορεί ποτέ να χρησιμοποιηθεί. Όταν συμβαίνει αυτό και ουρά μία λίστα εκκρεμοτήτων δημιουργεί σφάλματα, το πρόγραμμα-πελάτη είναι δεν είναι δυνατό να δοκιμάσετε μια διαφορετική λίστα εκκρεμοτήτων ουρά και ενδέχεται να αποτύχει για να στείλετε το μήνυμά σας. Συνιστάται να ορίζοντας αυτή την τιμή σε ορισμένες μεγαλύτερη τιμή και προεπιλεγμένη τιμή 10. Μπορείτε να το αλλάξετε σε τιμή μεγαλύτερη ή μικρότερη, ανάλογα με τον όγκο δεδομένων στέλνει την εφαρμογή σας ανά ημέρα. Κάθε ουρά λίστας εκκρεμοτήτων μπορεί να περιέχει έως και 5 GB των μηνυμάτων.

-   *failoverInterval*: το χρονικό διάστημα κατά το οποίο θα αποδέχεστε αποτυχίες στην κύρια χώρου ονομάτων πριν από την αλλαγή οποιοδήποτε μεμονωμένο οντότητα επάνω από τα δευτερεύοντα χώρο ονομάτων. Ανακατευθύνσεις προκύψουν σε βάση οντότητα, οντότητα. Οντοτήτων σε ένα μεμονωμένο πεδίο ονομάτων live συχνά σε διαφορετική κόμβους μέσα Bus υπηρεσίας. Αποτυχία σε μία οντότητα δεν συνεπάγεται αποτυχία σε ένα άλλο. Μπορείτε να ορίσετε αυτήν την τιμή για να [System.TimeSpan.Zero][] ανακατεύθυνση στο δευτερεύον αμέσως μετά την πρώτη, μη μεταβατική αποτυχία. Αποτυχίες που ενεργοποιεί το χρονόμετρο της ανακατεύθυνσης είναι οποιαδήποτε [MessagingException][] με την οποία η ιδιότητα [IsTransient][] είναι false ή μια [System.TimeoutException][]. Άλλες εξαιρέσεις, όπως [UnauthorizedAccessException][] δεν προκαλούν ανακατεύθυνση, επειδή υποδεικνύουν ότι ο υπολογιστής-πελάτης δεν έχει ρυθμιστεί σωστά. Ένα [ServerBusyException][] δεν προκαλούν ανακατεύθυνσης επειδή το σωστό μοτίβο είναι να περιμένετε 10 δευτερόλεπτα, στη συνέχεια, στείλτε ξανά το μήνυμα.

-   *enableSyphon*: υποδεικνύει ότι η αυτό συγκεκριμένο σύζευξη θα πρέπει να syphon επίσης μηνύματα από το δευτερεύοντα χώρο ονομάτων πίσω στην κύρια χώρου ονομάτων. Σε γενικές γραμμές, τις εφαρμογές που στέλνουν μηνύματα πρέπει να ορίσετε αυτήν την τιμή σε **false**; εφαρμογές που λαμβάνετε μηνύματα πρέπει να ορίσετε αυτήν την τιμή σε **true**. Ο λόγος για αυτό είναι ότι συχνά, υπάρχουν λιγότερες δέκτες μηνυμάτων από αποστολείς μηνυμάτων. Ανάλογα με τον αριθμό των δέκτες, μπορείτε να επιλέξετε να έχετε μια μεμονωμένη εφαρμογή παρουσία χειρισμού των καθηκόντων syphon. Χρήση πολλών δέκτες έχει χρεώσεων συνέπειες για κάθε ουρά λίστας εκκρεμοτήτων.

Για να χρησιμοποιήσετε τον κώδικα, δημιουργήστε μια κύρια παρουσία [MessagingFactory][] , μια δευτερεύουσα παρουσία [MessagingFactory][] , μια δευτερεύουσα παρουσία [NamespaceManager][] και μια παρουσία [SendAvailabilityPairedNamespaceOptions][] . Η κλήση μπορεί να είναι τόσο απλή όσο τα εξής:

```
SendAvailabilityPairedNamespaceOptions sendAvailabilityOptions = new SendAvailabilityPairedNamespaceOptions(secondaryNamespaceManager, secondary);
primary.PairNamespaceAsync(sendAvailabilityOptions).Wait();
```

Όταν ολοκληρωθεί η εργασία που επιστρέφονται από τη μέθοδο [PairNamespaceAsync][] , όλα τα στοιχεία έχει ρυθμιστεί και είστε έτοιμοι να χρησιμοποιήσετε. Πριν από την εργασία επιστρέφεται, ίσως δεν έχετε ολοκληρώσει όλες τις εργασίες φόντου είναι απαραίτητο για τη ζεύξη εργασίας προς τα δεξιά. Ως αποτέλεσμα, θα πρέπει να μην ξεκινάτε στέλνει μηνύματα μέχρι να επιστρέφει την εργασία. Εάν προκύψουν αποτυχίες, όπως τα διαπιστευτήρια εσφαλμένες ή θα αποτύχει για να δημιουργήσετε τη λίστα εκκρεμοτήτων ουρές, αυτές οι εξαιρέσεις θα προέκυψε μόλις ολοκληρωθεί η εργασία. Όταν η συνάρτηση επιστρέφει την εργασία, βεβαιωθείτε ότι τις ουρές έχουν βρέθηκε ή δημιουργήθηκε εξετάζοντας την ιδιότητα [BacklogQueueCount][] στην περίοδο λειτουργίας του [SendAvailabilityPairedNamespaceOptions][] . Για τον παραπάνω κώδικα, αυτή η λειτουργία εμφανίζεται ως εξής:

```
if (sendAvailabilityOptions.BacklogQueueCount < 1)
{
    // Handle case where no queues were created.
}
```

## <a name="next-steps"></a>Επόμενα βήματα

Τώρα που μάθατε τα βασικά στοιχεία του ασύγχρονης μηνυμάτων στην υπηρεσία Bus, διαβάστε περισσότερες λεπτομέρειες σχετικά με τα [ζεύγη οι χώροι ονομάτων][].

  [ServerBusyException]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.serverbusyexception.aspx
  [System.TimeoutException]: https://msdn.microsoft.com/library/system.timeoutexception.aspx
  [MessagingException]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingexception.aspx
  [Βέλτιστες πρακτικές για μονωτικό εφαρμογές σε σχέση με την υπηρεσία Bus διακοπές και καταστροφές]: service-bus-outages-disasters.md
  [Microsoft.ServiceBus.Messaging.MessagingFactory]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingfactory.aspx
  [MessageReceiver]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagereceiver.aspx
  [QueueClient]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.queueclient.aspx
  [TopicClient]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.topicclient.aspx
  [Microsoft.ServiceBus.Messaging.PairedNamespaceOptions]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.pairednamespaceoptions.aspx
  [MessagingFactory]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingfactory.aspx
  [SendAvailabilityPairedNamespaceOptions]:https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions.aspx
  [NamespaceManager]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.namespacemanager.aspx
  [PairNamespaceAsync]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingfactory.pairnamespaceasync.aspx
  [EnableSyphon]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions.enablesyphon.aspx
  [System.TimeSpan.Zero]: https://msdn.microsoft.com/library/azure/system.timespan.zero.aspx
  [IsTransient]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.messagingexception.istransient.aspx
  [UnauthorizedAccessException]: https://msdn.microsoft.com/library/azure/system.unauthorizedaccessexception.aspx
  [BacklogQueueCount]: https://msdn.microsoft.com/library/azure/microsoft.servicebus.messaging.sendavailabilitypairednamespaceoptions.backlogqueuecount.aspx
  [ζεύγη οι χώροι ονομάτων]: service-bus-paired-namespaces.md
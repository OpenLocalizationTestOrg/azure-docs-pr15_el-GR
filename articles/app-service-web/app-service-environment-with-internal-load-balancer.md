<properties
    pageTitle="Δημιουργία και χρήση μιας εσωτερικής εξισορρόπηση φόρτου με εφαρμογή υπηρεσίας περιβάλλον | Microsoft Azure"
    description="Δημιουργία και χρήση ενός ASE με μια ILB"
    services="app-service"
    documentationCenter=""
    authors="ccompy"
    manager="stefsch"
    editor=""/>

<tags
    ms.service="app-service"
    ms.workload="na"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/17/2016"
    ms.author="ccompy"/>

# <a name="using-an-internal-load-balancer-with-an-app-service-environment"></a>Χρήση μιας εσωτερικής εξισορρόπηση φόρτου με ένα περιβάλλον εφαρμογής υπηρεσίας #

Η δυνατότητα εφαρμογής υπηρεσίας Environments(ASE) είναι μια επιλογή υπηρεσίας Premium Azure εφαρμογής υπηρεσίας που προσφέρει μια δυνατότητα Βελτιωμένη ρύθμιση παραμέτρων που δεν είναι διαθέσιμη στο η σημάνσεις πολλών μισθωτή.  Η δυνατότητα ASE αναπτύσσει ουσιαστικά το Azure εφαρμογής υπηρεσίας στο σας Network(VNet) εικονικού Azure.  Για να αποκτήσετε μια καλύτερη κατανόηση των δυνατοτήτων που παρέχεται από την εφαρμογή υπηρεσίας περιβάλλοντα, διαβάστε το [Τι είναι το περιβάλλον εφαρμογής υπηρεσίας] [ WhatisASE] τεκμηρίωση.  Εάν δεν γνωρίζετε τα οφέλη της λειτουργούν σε ένα VNet Διαβάστε [Συνήθεις Ερωτήσεις Azure εικονικού δικτύου][virtualnetwork].  


## <a name="overview"></a>Επισκόπηση ##


Μια ASE μπορούν να αναπτυχθούν με ένα τελικό σημείο προσβάσιμες στο internet ή με μια διεύθυνση IP στο VNet σας.  Για να ορίσετε τη διεύθυνση IP σε μια διεύθυνση VNet πρέπει να αναπτύξετε το ASE με μια εσωτερική Balancer(ILB) φόρτωση.  Όταν σας ASE έχει ρυθμιστεί με έναν ILB που παρέχουν:

- το δικό σας τομέα ή υποτομέα.  Για να διευκολύνετε, αυτό το έγγραφο προϋποθέτει ο δευτερεύων τομέας, αλλά μπορείτε να ρυθμίσετε τις παραμέτρους του με οποιονδήποτε τρόπο.  
- το πιστοποιητικό που χρησιμοποιείται για το HTTPS
- Διαχείριση DNS για τον υποτομέα.  


Σε επιστροφές, μπορείτε να εκτελέσετε ενέργειες όπως:

- εφαρμογές intranet του κεντρικού υπολογιστή, όπως επιχειρησιακές εφαρμογές, με ασφάλεια στο cloud που μπορείτε να αποκτήσετε πρόσβαση σε μια τοποθεσία στην τοποθεσία ή ExpressRoute VPN
- εφαρμογές κεντρικού υπολογιστή στο cloud που δεν παρατίθενται στο δημόσιο διακομιστές DNS
- Δημιουργήστε εφαρμογές παρασκηνίου internet απομονωμένες που τις εφαρμογές του υπολογιστή-πελάτη με ασφαλή τρόπο να ενοποιήσετε με


#### <a name="disabled-functionality"></a>Απενεργοποιημένα λειτουργικότητα ####

Υπάρχουν ορισμένα πράγματα που δεν μπορείτε να κάνετε κατά τη χρήση μιας ASE ILB.  Αυτά τα στοιχεία περιλαμβάνουν τα εξής:

- χρήση IPSSL
- εκχώρηση διευθύνσεων IP για συγκεκριμένες εφαρμογές
- αγορά και χρήση ένα πιστοποιητικό με μια εφαρμογή μέσω της πύλης.  Φυσικά εξακολουθείτε να μπορείτε να αποκτήσετε πιστοποιητικά απευθείας με μια αρχή έκδοσης πιστοποιητικών και να το χρησιμοποιήσετε με τις εφαρμογές σας, απλώς δεν μέσω της πύλης Azure.


## <a name="creating-an-ilb-ase"></a>Δημιουργία μιας ASE ILB ##

Δημιουργία μιας ASE ILB δεν είναι πολύ διαφορετικό από τη δημιουργία μιας ASE κανονικά.  Για περαιτέρω συζήτηση σχετικά με τη δημιουργία μιας ASE Διαβάστε [πώς μπορείτε να δημιουργήσετε ένα περιβάλλον εφαρμογής υπηρεσίας][HowtoCreateASE].  Η διαδικασία δημιουργίας ενός ASE ILB είναι η ίδια μεταξύ τη δημιουργία ενός VNet κατά τη δημιουργία ASE ή επιλέγοντας ένα προ-υπαρχόντων VNet.  Για να δημιουργήσετε ένα ASE ILB: 

1.  Στην πύλη του Azure, επιλέξτε **Δημιουργία -> Web + Mobile -> περιβάλλον εφαρμογής υπηρεσίας**
2.  Επιλέξτε τη συνδρομή σας
3.  Επιλέξτε ή δημιουργήστε μια ομάδα πόρων
4.  Επιλέξτε ή δημιουργήστε ένα VNet
5.  Δημιουργήστε ένα υποδίκτυο εάν επιλέγοντας ένα VNet
6.  Επιλέξτε **εικονικού δικτύου/θέση-> Ρύθμιση παραμέτρων VNet** και ορίστε τον τύπο VIP σε εσωτερικά
7.  Παροχή ονόματος δευτερεύοντος τομέα (θα είναι ο δευτερεύων τομέας που χρησιμοποιείται για τις εφαρμογές που έχουν δημιουργηθεί με αυτό ASE)
8.  Επιλέξτε Ok και, στη συνέχεια, δημιουργία


![][1]


Εντός του blade εικονικού δικτύου υπάρχει μια επιλογή VNet ρύθμισης παραμέτρων.  Σας επιτρέπει να επιλέξετε ανάμεσα σε μια εξωτερική VIP ή εσωτερικό VIP.  Η προεπιλογή είναι εξωτερικός.  Εάν έχετε οριστεί σε εξωτερικές σας ASE θα χρησιμοποιήσει ένα VIP προσβάσιμες στο internet.  Εάν επιλέξετε εσωτερικού, ASE σας θα ρυθμιστεί με έναν ILB σε μια διεύθυνση IP εντός του VNet.  


Αφού επιλέξετε εσωτερικού, καταργείται η δυνατότητα για να προσθέσετε περισσότερες διευθύνσεις IP σας ASE και αντί για αυτό πρέπει να παρέχουν ο δευτερεύων τομέας από το ASE.  Σε ένα ASE με μια εξωτερική VIP χρησιμοποιείται το όνομα του το ASE στο ο δευτερεύων τομέας για τις εφαρμογές που έχουν δημιουργηθεί με συγκεκριμένο ASE.  
Εάν σας ASE ονομαζόταν ***contosotest*** και την εφαρμογή σας σε που ονομαζόταν ASE ***mytest*** , στη συνέχεια, ο δευτερεύων τομέας θα έχει τη μορφή ***contosotest.p.azurewebsites.net*** και τη διεύθυνση URL για την εφαρμογή που θα ήταν ***mytest.contosotest.p.azurewebsites.net***.  
Εάν ο τύπος VIP με εσωτερικές, το όνομα ASE δεν χρησιμοποιείται σε ο δευτερεύων τομέας για το ASE.  Καθορίστε ρητά ο δευτερεύων τομέας.  Εάν σας ο δευτερεύων τομέας ήταν ***contoso.corp.net*** και κάνατε εφαρμογής σε που ASE με το όνομα ***timereporting*** , στη συνέχεια, τη διεύθυνση URL για την εφαρμογή που θα ***timereporting.contoso.corp.net***.


## <a name="apps-in-an-ilb-ase"></a>Εφαρμογές σε μια ASE ILB ##

Δημιουργία μιας εφαρμογής σε μια ASE ILB είναι ίδια με τη δημιουργία μιας εφαρμογής σε μια ASE κανονικά.  

1. Στην πύλη του Azure, επιλέξτε **Δημιουργία -> Web + Mobile -> Web** ή **κινητό** ή **Εφαρμογή API**
2. Πληκτρολογήστε το όνομα της εφαρμογής
2. Επιλέξτε τη συνδρομή
3. Επιλέξτε ή δημιουργήστε ομάδα πόρων
4. Επιλογή ή δημιουργία εφαρμογής υπηρεσίας Plan(ASP).  Εάν τη δημιουργία ενός νέου ASP επιλέξτε σας ASE ανάλογα με τη θέση και, στη συνέχεια, επιλέξτε την ομάδα εργασίας που θέλετε σας ASP να δημιουργηθούν σε.  Όταν δημιουργείτε την ASP μπορείτε να επιλέξετε το ASE ως τη θέση και την ομάδα εργασίας.  Όταν καθορίζετε το όνομα της εφαρμογής θα δείτε ότι ο δευτερεύων τομέας κάτω από το όνομα εφαρμογής αντικαθίσταται από ο δευτερεύων τομέας για τον ASE.   
5. Επιλέξτε Δημιουργία.  Εάν θέλετε η εφαρμογή να εμφανίζονται στον πίνακα εργαλείων σας, θα πρέπει να επιλέγετε το πλαίσιο ελέγχου **Pin στον πίνακα εργαλείων** .  

![][2]


Κάτω από το όνομα εφαρμογής του ονόματος δευτερεύοντος τομέα ενημερώνεται ώστε να αντικατοπτρίζει ο δευτερεύων τομέας του ASE σας.  


## <a name="post-ilb-ase-creation-validation"></a>Δημοσίευση ILB ASE δημιουργίας επικύρωσης ##

Μια ASE ILB είναι λίγο διαφορετικά από τα μη - ILB ASE.  Όπως ήδη σημειωθεί που χρειάζεστε για να διαχειριστείτε τις δικές σας DNS και θα πρέπει επίσης να δώσετε το δικό σας πιστοποιητικό για συνδέσεις HTTPS.  


Αφού δημιουργήσετε το ASE θα παρατηρήσετε ότι ο δευτερεύων τομέας εμφανίζει ο δευτερεύων τομέας που καθορίσατε και δεν υπάρχει ένα νέο στοιχείο στο μενού **Ρύθμιση** ονομάζεται **ILB πιστοποιητικό**.  Το ASE δημιουργείται με ένα αυτο-υπογεγραμμένο πιστοποιητικό το οποίο διευκολύνει την δοκιμή HTTPS.  Πύλη θα σας ενημερώσει ότι πρέπει να παρέχετε το δικό σας πιστοποιητικό για HTTPS αλλά πρόκειται να καθοδηγήσετε να έχετε ένα πιστοποιητικό που συνοδεύει τον υποτομέα.  

![][3]


Εάν απλώς δοκιμάζετε στοιχεία και δεν γνωρίζετε πώς μπορείτε να δημιουργήσετε ένα πιστοποιητικό, μπορείτε να χρησιμοποιήσετε την εφαρμογή κονσόλας MMC των υπηρεσιών IIS για να δημιουργήσετε ένα πιστοποιητικό αυτόματης υπογραφής.  Αφού δημιουργηθεί μπορείτε να εξαγάγετε ως αρχείο .pfx και, στη συνέχεια, στείλτε το στο περιβάλλον εργασίας Χρήστη του ILB πιστοποιητικού. Κατά την πρόσβαση σε μια τοποθεσία ασφαλές με ένα πιστοποιητικό αυτόματης υπογραφής, το πρόγραμμα περιήγησης θα σας δώσει μια προειδοποίηση ότι δεν είναι ασφαλής λόγω αδυναμία για να επικυρώσει το πιστοποιητικό της τοποθεσίας να αποκτούν πρόσβαση.  Εάν θέλετε να αποφύγετε την προειδοποίηση που χρειάζεστε ένα πιστοποιητικό υπογραφής σωστά που ταιριάζει με τον υποτομέα και διαθέτει μια αλυσίδα αξιοπιστίας που αναγνωρίζεται από το πρόγραμμα περιήγησης.

![][6]

Εάν θέλετε να δοκιμάσετε τη ροή με τα δικά σας πιστοποιητικά και να ελέγξετε HTTP και HTTPS πρόσβαση ASE σας:

1.  Μεταβείτε στις επιλογές ASE περιβάλλοντος εργασίας Χρήστη, αφού δημιουργηθεί ASE **ASE -> Ρυθμίσεις -> πιστοποιητικά ILB**
2.  Ορίστε ILB πιστοποιητικού, επιλέγοντας αρχείο πιστοποιητικού pfx και δώστε τον κωδικό πρόσβασης.  Αυτό το βήμα λαμβάνει κάποιος χρόνος για την επεξεργασία και θα εμφανίζεται το μήνυμα που έχει μια λειτουργία βρίσκεται σε εξέλιξη.
3.  Λάβετε τη διεύθυνση ILB για το ASE (**ASE -> Ιδιότητες -> εικονική διεύθυνση IP**)
4.  Δημιουργία εφαρμογής web σε ASE μετά τη δημιουργία 
5.  Δημιουργήστε μια Εικονική, εάν δεν έχετε σε συγκεκριμένη VNET (όχι στο ίδιο υποδίκτυο με την αλλαγή ASE ή στοιχεία)
6.  Ορίστε DNS για τον υποτομέα.  Μπορείτε να χρησιμοποιήσετε ένα χαρακτήρα μπαλαντέρ με τον υποτομέα στο DNS ή να εάν θέλετε να κάνετε ορισμένες απλές δοκιμές, επεξεργαστείτε το αρχείο hosts στο σας Εικονική για να ορίσετε όνομα εφαρμογής web με διεύθυνση VIP IP.  Εάν το όνομα του δευτερεύοντος τομέα είχε σας ASE. ilbase.com που κάνατε και το mytestapp εφαρμογής web έτσι, ώστε το θα είναι απαντήσει στο mytestapp.ilbase.com στη συνέχεια, ορίστε που στο αρχείο hosts.  (Σε Windows το αρχείο hosts είναι στο C:\Windows\System32\drivers\etc\)
7.  Χρησιμοποιήστε ένα πρόγραμμα περιήγησης στη συγκεκριμένη Εικονική και μεταβείτε στο http://mytestapp.ilbase.com (ή ό, τι είναι το όνομα του web app, με τον υποτομέα)
8.  Χρησιμοποιήστε ένα πρόγραμμα περιήγησης στη συγκεκριμένη Εικονική και μεταβείτε στο https://mytestapp.ilbase.com, θα πρέπει να αποδεχτείτε την έλλειψη ασφαλείας, εάν χρησιμοποιείτε ένα αυτο-υπογεγραμμένο πιστοποιητικό.  


Τη διεύθυνση IP για το ILB εμφανίζεται στις ιδιότητες σας ως η εικονική διεύθυνση IP

![][4]


## <a name="using-an-ilb-ase"></a>Χρήση μιας ASE ILB ##

#### <a name="network-security-groups"></a>Ομάδες ασφαλείας δικτύου ####

Μια ASE ILB επιτρέπει απομόνωσης δικτύου για τις εφαρμογές σας όπως των εφαρμογών δεν είναι προσβάσιμη ή ακόμα και γνωστά από το internet.  Αυτό είναι εξαιρετικό για τη φιλοξενία τοποθεσιών intranet όπως επιχειρησιακές εφαρμογές.  Όταν πρέπει να περιορίσετε την πρόσβαση ακόμα και περαιτέρω μπορείτε να χρησιμοποιήσετε Groups(NSGs) ασφαλείας δικτύου για να ελέγχετε την πρόσβαση στο επίπεδο δικτύου. 


Εάν θέλετε να χρησιμοποιήσετε NSGs για να περιορίσετε περαιτέρω την πρόσβαση, στη συνέχεια, πρέπει να βεβαιωθείτε ότι δεν διακόπτετε επικοινωνίας που χρειάζεται το ASE για να λειτουργήσει.  Παρόλο που η πρόσβαση HTTP/HTTPS είναι μόνο μέσω του ILB που χρησιμοποιούνται από το ASE το ASE εξακολουθεί να εξαρτάται πόρων εκτός του VNet.  Για να δείτε ποιες πρόσβαση στο δίκτυο εξακολουθεί να είναι απαραίτητη αναζητήστε τις πληροφορίες στο έγγραφο σε [Έλεγχος εισερχομένων κίνηση σε ένα περιβάλλον εφαρμογής υπηρεσίας] [ ControlInbound] και το έγγραφο στη [Σελίδα λεπτομέρειες ρύθμισης παραμέτρων δικτύου για εφαρμογή υπηρεσίας περιβάλλοντα με ExpressRoute][ExpressRoute].  


Για να ρυθμίσετε τις παραμέτρους του NSGs πρέπει να γνωρίζετε τη διεύθυνση IP που χρησιμοποιείται από Azure για τη διαχείριση του ASE.  Αυτήν τη διεύθυνση IP είναι επίσης η διεύθυνση IP εξερχομένων από τις ASE εάν βγάζει αιτήσεις στο internet.  Για να βρείτε αυτό IP διεύθυνση μεταβείτε στις **Ρυθμίσεις -> Ιδιότητες** και να βρείτε τη **Διεύθυνση IP του εξερχομένων**.  

![][5]


#### <a name="general-ilb-ase-management"></a>Διαχείριση ILB ASE Γενικά ####

Διαχείριση ενός ASE ILB σε μεγάλο βαθμό είναι ίδια με τη διαχείριση μιας ASE κανονικά.  Πρέπει να κλιμάκωσης σας χώρους συγκέντρωσης εργασίας για τη φιλοξενία περισσότερες παρουσίες ASP και κλιμάκωσης διακομιστών προσκηνίου χειρισμού αυξημένη ποσότητες κίνηση HTTP/HTTPS.  Για γενικές πληροφορίες σχετικά με τη Διαχείριση τη ρύθμιση παραμέτρων του ένα ASE, ανάγνωση του εγγράφου σχετικά με [τη ρύθμιση περιβάλλον εφαρμογής υπηρεσίας][ASEConfig].  


Τα στοιχεία διαχείρισης επιπλέον είναι διαχείριση πιστοποιητικών και διαχείριση DNS.  Πρέπει να αποκτήσετε και αποστείλετε το πιστοποιητικό που χρησιμοποιείται για το HTTPS μετά τη δημιουργία ILB ASE και να τον αντικαταστήσετε πριν από τη λήξη.  Επειδή το Azure είναι ο κάτοχος του τομέα βάσης μπορούν να παρέχουμε πιστοποιητικά για ASEs με μια εξωτερική VIP.  Επειδή ο δευτερεύων τομέας που χρησιμοποιείται από ένα ASE ILB μπορεί να είναι οτιδήποτε, πρέπει να παρέχετε το δικό σας πιστοποιητικό για HTTPS. 


#### <a name="dns-configuration"></a>Ρύθμιση παραμέτρων του DNS ####

Όταν χρησιμοποιείτε ένα εξωτερικό VIP το DNS γίνεται από Azure.  Οποιαδήποτε εφαρμογή που έχουν δημιουργηθεί με το ASE προστίθεται αυτόματα DNS Azure που είναι μια δημόσια DNS.  Σε ένα ASE ILB πρέπει να διαχειριστείτε τις δικές σας DNS.  Για μια δεδομένη δευτερεύοντος τομέα όπως contoso.corp.net πρέπει να δημιουργήσετε τις εγγραφές που οδηγεί στη διεύθυνση ILB για DNS A:

    * 
    δημοσίευση *.SCM ftp 


## <a name="getting-started"></a>Γρήγορα αποτελέσματα
Όλα τα άρθρα και με ποιον τρόπο-για να του για εφαρμογή υπηρεσίας περιβάλλοντα είναι διαθέσιμες στο το [αρχείο README για περιβάλλοντα εφαρμογών υπηρεσίας](../app-service/app-service-app-service-environments-readme.md).

Για να ξεκινήσετε με εφαρμογή υπηρεσίας περιβάλλοντα, ανατρέξτε στο θέμα [Εισαγωγή στα περιβάλλοντα εφαρμογής υπηρεσίας][WhatisASE]

Για περισσότερες πληροφορίες σχετικά με την πλατφόρμα Azure εφαρμογής υπηρεσίας, ανατρέξτε στο θέμα [Azure εφαρμογής υπηρεσίας][AzureAppService].

[AZURE.INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[AZURE.INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]
 

<!--Image references-->
[1]: ./media/app-service-environment-with-internal-load-balancer/ilbase-createilbase.png
[2]: ./media/app-service-environment-with-internal-load-balancer/ilbase-createapp.png
[3]: ./media/app-service-environment-with-internal-load-balancer/ilbase-newase.png
[4]: ./media/app-service-environment-with-internal-load-balancer/ilbase-vip.png
[5]: ./media/app-service-environment-with-internal-load-balancer/ilbase-externalvip.png
[6]: ./media/app-service-environment-with-internal-load-balancer/ilbase-ilbcertificate.png

<!--Links-->
[WhatisASE]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[HowtoCreateASE]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[ControlInbound]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-control-inbound-traffic/
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[AppServicePricing]: http://azure.microsoft.com/pricing/details/app-service/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[ASEAutoscale]: http://azure.microsoft.com/documentation/articles/app-service-environment-auto-scale/
[ExpressRoute]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-network-configuration-expressroute/
[vnetnsgs]: http://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[ASEConfig]: http://azure.microsoft.com/documentation/articles/app-service-web-configure-an-app-service-environment/

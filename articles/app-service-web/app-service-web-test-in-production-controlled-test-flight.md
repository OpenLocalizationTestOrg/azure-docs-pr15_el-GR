<properties
    pageTitle="Flighting ανάπτυξης (δοκιμή της έκδοσης beta) στο Azure εφαρμογής υπηρεσίας"
    description="Μάθετε πώς να ιπτάμενου νέες δυνατότητες στην εφαρμογή ή έκδοσης beta έλεγχος τις ενημερώσεις σας σε αυτό το πρόγραμμα εκμάθησης-τελικών. Συγκεντρώνει εφαρμογής υπηρεσίας δυνατότητες όπως συνεχής δημοσίευσης, υποδοχές, κίνηση δρομολόγηση και ενοποίηση εφαρμογής ιδέες."
    services="app-service\web"
    documentationCenter=""
    authors="cephalin"
    manager="wpickett"
    editor=""/>

<tags
    ms.service="app-service-web"
    ms.workload="web"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="02/02/2016"
    ms.author="cephalin"/>
# <a name="flighting-deployment-beta-testing-in-azure-app-service"></a>Flighting ανάπτυξης (δοκιμή της έκδοσης beta) στο Azure εφαρμογής υπηρεσίας

Αυτό το πρόγραμμα εκμάθησης δείχνει πώς μπορείτε να κάνετε *flighting αναπτύξεις* μέσω της ενοποίησης τις διάφορες δυνατότητες του [Azure εφαρμογής υπηρεσίας](http://go.microsoft.com/fwlink/?LinkId=529714) και τις [Ιδέες εφαρμογή Azure](/services/application-insights/). 

*Flighting* είναι μια διαδικασία ανάπτυξης που επικυρώσει μια νέα δυνατότητα ή να αλλάξετε με περιορισμένο αριθμό πραγματικό πελάτες και είναι ένα μεγάλο δοκιμές σε σενάριο παραγωγής. Είναι παρόμοια με την έκδοση beta δοκιμές και είναι γνωστό ως "ελεγχόμενο δοκιμής πτήσεων". Πολλές μεγάλες επιχειρήσεις με μια παρουσία στο web Χρησιμοποιήστε αυτήν την προσέγγιση για να λάβετε πρώιμη επικύρωσης στο οι ενημερώσεις εφαρμογής στην πράξη τους [ευέλικτη](https://en.wikipedia.org/wiki/Agile_software_development)ανάπτυξης. Azure εφαρμογής υπηρεσίας σάς επιτρέπει να ενοποίηση δοκιμής παραγωγή με συνεχής δημοσίευσης και της εφαρμογής ιδέες για την υλοποίηση του ίδιου σεναρίου DevOps. Πλεονεκτήματα αυτής της προσέγγισης είναι:

- **Ενίσχυση ενημερώσεις _πριν από την_ πραγματική σχόλια έχουν κυκλοφορήσει για την παραγωγή** - το μόνο πράγμα που είναι καλύτερη από να αποκτούν σχολίων Μόλις αφήσετε να αποκτήσουν σχόλια πριν να αφήσετε. Μπορείτε να ελέγξετε ενημερώσεις με κίνηση του πραγματικού χρήστη και συμπεριφορές ως πρώιμη που επιθυμείτε κύκλου ζωής του προϊόντος.
- **Βελτίωση [συνεχής βάσει δοκιμή ανάπτυξης (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development) ** - μέσω της ενοποίησης δοκιμής παραγωγή με συνεχή ενοποίηση και οργάνων με εφαρμογή ιδέες, επικύρωσης χρήστη συμβαίνει πρώιμη και αυτόματα στο κύκλου ζωής του προϊόντος. Αυτό σας βοηθά να μειώσετε επενδύσεις χρόνου εκτέλεσης μη αυτόματο έλεγχο.
- **Βελτιστοποίηση δοκιμή ροής εργασίας** - χάρη στην αυτοματοποίηση δοκιμής παραγωγή με συνεχούς παρακολούθησης οργάνων, μπορείτε να ενδεχομένως επιτύχετε τους στόχους της διάφορα είδη δοκιμές σε μία μόνο διεργασία, όπως [ενοποίηση](https://en.wikipedia.org/wiki/Integration_testing), [παλινδρόμησης](https://en.wikipedia.org/wiki/Regression_testing), [χρηστικότητας](https://en.wikipedia.org/wiki/Usability_testing), προσβασιμότητας, μετάφρασης, [επιδόσεων](https://en.wikipedia.org/wiki/Software_performance_testing), [ασφάλεια](https://en.wikipedia.org/wiki/Security_testing)και [Αποδοχή](https://en.wikipedia.org/wiki/Acceptance_testing).

Μια ανάπτυξη του flighting δεν σχεδόν τη δρομολόγηση ζωντανή κίνηση. Σε μια τέτοια ανάπτυξη που θέλετε να αποκτήσει πληροφορίες για όσο το δυνατόν πιο γρήγορα, αν είναι ένα μη αναμενόμενο σφάλμα, υποβάθμιση επιδόσεων, θεμάτων εμπειρία χρήστη. Να θυμάστε, που σας ενδιαφέρει πραγματικό πελάτες. Επομένως, να το κάνετε δεξιά, πρέπει να βεβαιωθείτε ότι έχετε ορίσει την ανάπτυξη flighting να συγκεντρώσετε όλα τα δεδομένα που χρειάζεστε για να κάνετε μια ενήμεροι απόφαση για το επόμενο βήμα. Αυτό το πρόγραμμα εκμάθησης σας δείχνει πώς μπορείτε να συλλέξετε δεδομένα με εφαρμογή ιδέες, αλλά μπορείτε να χρησιμοποιήσετε νέα Relic ή άλλες τεχνολογίες που σας εξυπηρετεί το σενάριό σας. 

## <a name="what-you-will-do"></a>Τι θα κάνετε

Σε αυτό το πρόγραμμα εκμάθησης, θα μάθετε πώς μπορείτε να επαναφέρετε τα ακόλουθα σενάρια μαζί, για να ελέγξετε την εφαρμογή σας εφαρμογής υπηρεσίας στο παραγωγής:

- [Δρομολόγηση παραγωγής κίνηση](app-service-web-test-in-production-get-start.md) σε εφαρμογή βήτα
- Για να αποκτήσετε χρήσιμες μετρικά [instrument την εφαρμογή σας](../application-insights/app-insights-web-track-usage.md)
- Ανάπτυξη της εφαρμογής σας βήτα συνεχώς και την παρακολούθηση μετρικά ζωντανή εφαρμογής
- Σύγκριση μετρήσεων μεταξύ της εφαρμογής παραγωγής και την εφαρμογή beta για να δείτε πώς αλλαγών κώδικα μετάφραση αποτελέσματα

## <a name="what-you-will-need"></a>Τι θα χρειαστείτε

-   Azure λογαριασμού
-   Ένα λογαριασμό [GitHub](https://github.com/)
- Visual Studio 2015 - μπορείτε να κάνετε λήψη της [Κοινότητας edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).
-   Κέλυφος Git (εγκαθίσταται με το [GitHub για Windows](https://windows.github.com/)) - αυτό σας επιτρέπει να εκτελέσετε το Git και το PowerShell εντολές κατά την ίδια περίοδο λειτουργίας
-   Πιο πρόσφατη bits [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi)
-   Βασική κατανόηση από τα εξής:
    -   Ανάπτυξη προτύπου [Για τη διαχείριση πόρων Azure](../azure-resource-manager/resource-group-overview.md) (ανατρέξτε στο θέμα [Ανάπτυξη μια σύνθετη εφαρμογή προβλέψιμα στο Azure](app-service-deploy-complex-application-predictably.md))
    -   [Git](http://git-scm.com/documentation)
    -   [PowerShell](https://technet.microsoft.com/library/bb978526.aspx)

> [AZURE.NOTE] Χρειάζεστε ένα λογαριασμό Azure για να ολοκληρώσετε αυτό το πρόγραμμα εκμάθησης:
> + Μπορείτε να [ανοίξετε ένα λογαριασμό Azure δωρεάν](/pricing/free-trial/) - λάβετε πιστώσεων μπορείτε να χρησιμοποιήσετε για να δοκιμάσετε την πληρωμή Azure υπηρεσιών και ακόμα και αν χρησιμοποιούνται προς τα επάνω μπορείτε να διατηρήσετε το λογαριασμό και χρήση δωρεάν Azure υπηρεσίες, όπως εφαρμογές Web.
> + Μπορείτε να [ενεργοποιήσετε το Visual Studio συνδρομητών πλεονεκτήματα](/pricing/member-offers/msdn-benefits-details/) - τη συνδρομή σας Visual Studio παρέχει πιστώσεων κάθε μήνα που μπορείτε να χρησιμοποιήσετε για τις υπηρεσίες του Azure επί πληρωμή.
>
> Εάν θέλετε να γρήγορα αποτελέσματα με το Azure εφαρμογής υπηρεσίας πριν από την εγγραφή για λογαριασμό Azure, μεταβείτε στο [Δοκιμάστε εφαρμογής υπηρεσίας](http://go.microsoft.com/fwlink/?LinkId=523751), όπου μπορείτε να αμέσως δημιουργήσετε μια εφαρμογή web μικρής διάρκειας starter στην εφαρμογή υπηρεσίας. Δεν υπάρχει πιστωτικές κάρτες υποχρεωτικό, χωρίς δεσμεύσεις.

## <a name="set-up-your-production-web-app"></a>Ρυθμίστε την εφαρμογή web της παραγωγής

>[AZURE.NOTE] Η δέσμη ενεργειών που χρησιμοποιούνται σε αυτό το πρόγραμμα εκμάθησης θα ρυθμίσει αυτόματα λόγω των συνεχών δημοσίευση από το χώρο αποθήκευσης GitHub. Αυτό προϋποθέτει ότι τα διαπιστευτήριά σας GitHub είναι ήδη αποθηκευμένο στη Azure, διαφορετικά θα αποτύχει η ανάπτυξη από δέσμη ενεργειών κατά την προσπάθεια για τη ρύθμιση παραμέτρων ρυθμίσεων των στοιχείων ελέγχου προέλευσης για τις εφαρμογές web.
>
>Για να αποθηκεύσετε τα διαπιστευτήριά σας GitHub στο Azure, δημιουργήστε μια εφαρμογή web στην [Πύλη του Azure](https://portal.azure.com/) και [ρυθμίσετε τις παραμέτρους GitHub ανάπτυξης](app-service-continuous-deployment.md#Step7). Πρέπει να το κάνετε αυτό μία φορά.

Σε ένα τυπικό σενάριο DevOps, έχετε μια εφαρμογή που εκτελεί live στο Azure και θέλετε να κάνετε αλλαγές σε αυτό μέσω συνεχούς δημοσίευσης. Σε αυτό το σενάριο, θα αναπτύξετε παραγωγή ένα πρότυπο που έχετε αναπτύξει και ελεγχθεί.

1.  Δημιουργήστε το δικό σας διακλάδωσης του αποθετηρίου [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) . Για πληροφορίες σχετικά με τη δημιουργία σας διακλάδωσης, ανατρέξτε στο θέμα [διακλάδωσης μια Repo](https://help.github.com/articles/fork-a-repo/). Αφού δημιουργηθεί το διακλάδωσης, μπορείτε να το δείτε στο πρόγραμμα περιήγησης.

    ![](./media/app-service-agile-software-development/production-1-private-repo.png)

2.  Ανοίξτε μια περίοδο λειτουργίας κελύφους Git. Εάν δεν έχετε ακόμη Git κελύφους, εγκατάσταση τώρα [GitHub για Windows](https://windows.github.com/) .
3.  Δημιουργήστε ένα τοπικό κλωνοποίηση της διακλάδωσης σας εκτελώντας την ακόλουθη εντολή:

        git clone https://github.com/<your_fork>/ToDoApp.git

4.  Όταν έχετε ολοκληρώσει τον τοπικό κλωνοποίηση, μεταβείτε στο * &lt;repository_root >*\ARMTemplates και εκτελέστε το deploy.ps1 δέσμης ενεργειών με ένα μοναδικό επίθημα, όπως φαίνεται παρακάτω:

        .\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix>

4.  Όταν σας ζητηθεί, πληκτρολογήστε το επιθυμητό όνομα χρήστη και τον κωδικό πρόσβασης για πρόσβαση στη βάση δεδομένων. Να θυμάστε ότι τα διαπιστευτήριά σας βάση δεδομένων, επειδή θα χρειαστεί να τα καθορίσετε ξανά κατά την ενημέρωση της ομάδας πόρων.

    Θα πρέπει να μπορείτε να δείτε την πρόοδο παροχής διάφορες Azure πόρων. Όταν ολοκληρωθεί η ανάπτυξη, τη δέσμη ενεργειών θα εκκίνηση της εφαρμογής στο πρόγραμμα περιήγησης και θα σας δώσει μια φιλική ηχητικό σήμα.
    ![](./media/app-service-web-test-in-production-controlled-test-flight/00.1-app-in-browser.png)

6.  Επιστροφή στην περίοδο λειτουργίας σας Git κέλυφος, εκτελέστε:

        .\swap –Name ToDoApp<your_suffix>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/00.2-swap-to-production.png)

7.  Όταν ολοκληρωθεί η δέσμη ενεργειών, μετάβαση προς τα πίσω για να μεταβείτε στη διεύθυνση του frontend (http://ToDoApp*&lt;your_suffix >*.azurewebsites.net/) για να δείτε την εφαρμογή που εκτελείται στο παραγωγής.
5.  Συνδεθείτε με την [Πύλη Azure](https://portal.azure.com/) και Ρίξτε μια ματιά στο τι έχει δημιουργηθεί.

    Θα πρέπει να μπορούν να βλέπουν δύο εφαρμογών web στην ίδια ομάδα πόρων, μία με το `Api` επίθημα στο όνομά της. Αν κοιτάξετε στην προβολή ομάδας πόρων, θα δείτε επίσης τη βάση δεδομένων SQL και διακομιστή, το πρόγραμμα εφαρμογής υπηρεσίας και τις υποδοχές ενδιάμεσου σταδίου για τις εφαρμογές web. Περιηγηθείτε σε διαφορετικές τους πόρους και συγκρίνετε με * &lt;repository_root >*\ARMTemplates\ProdAndStage.json για να δείτε τον τρόπο ρύθμισης των παραμέτρων τους στο πρότυπο.

    ![](./media/app-service-web-test-in-production-controlled-test-flight/00.3-resource-group-view.png)

Έχετε ορίσει την εφαρμογή παραγωγής.  Τώρα, ας φανταστείτε ότι λαμβάνετε σχόλια ότι χρηστικότητας είναι κακή για την εφαρμογή. Ώστε να αποφασίσετε να διερευνήσουμε. Πρόκειται να μέσου την εφαρμογή σας για να δώσετε σχόλια.

## <a name="investigate-instrument-your-client-app-for-monitoringmetrics"></a>Διερεύνηση: Μέσου την εφαρμογή υπολογιστή-πελάτη για παρακολούθηση μετρικά

5. Άνοιγμα * &lt;repository_root >*\src\MultiChannelToDo.sln στο Visual Studio.
6. Επαναφορά όλων των πακέτων Nuget κάνοντας δεξί κλικ σε λύση > **Διαχείριση πακέτων NuGet για λύση** > **Επαναφορά**.
6. Κάντε δεξί κλικ **MultiChannelToDo.Web** > **Τηλεμετρίας ιδέες Προσθήκη εφαρμογής** > **Διαμόρφωση παραμέτρων ρυθμίσεων** > Αλλαγή ομάδα πόρων για ToDoApp*&lt;your_suffix >* > **Προσθήκη εφαρμογής ιδέες για το έργο**.
7. Στην πύλη του Azure, ανοίξτε το blade για τον πόρο **MultiChannelToDo.Web** πληροφορίες για την εφαρμογή. Στη συνέχεια, στο τμήμα **εφαρμογής εύρυθμης λειτουργίας** , κάντε κλικ στην επιλογή **Μάθετε πώς μπορείτε να συλλέξετε δεδομένων φόρτωση σελίδας του προγράμματος περιήγησης** > Αντιγραφή κώδικα.
7. Προσθέστε το αντιγραμμένο JS οργάνων κώδικα, * &lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, ακριβώς πριν από το κλείσιμο `<heading>` ετικέτα. Θα πρέπει να περιέχει το κλειδί μοναδικό οργάνων του πόρου πληροφορίες για την εφαρμογή.

        <script type="text/javascript">
        var appInsights=window.appInsights||function(config){
            function s(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},r=document,f=window,e="script",o=r.createElement(e),i,u;for(o.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",r.getElementsByTagName(e)[0].parentNode.appendChild(o),t.cookie=r.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)s("track"+i.pop());return config.disableExceptionTracking||(i="onerror",s("_"+i),u=f[i],f[i]=function(config,r,f,e,o){var s=u&&u(config,r,f,e,o);return s!==!0&&t["_"+i](config,r,f,e,o),s}),t
        }({
            instrumentationKey:"<your_unique_instrumentation_key>"
        });

        window.appInsights=appInsights;
        appInsights.trackPageView();
        </script>

11. Αποστολή προσαρμοσμένα συμβάντα σε εφαρμογή ιδέες για το ποντίκι μόνο κλικ, προσθέτοντας τον παρακάτω κώδικα στο κάτω μέρος του σώματος:

        <script>
            $(document.body).find("*").click(function(event) {

                appInsights.trackEvent(event.target.tagName + ": " + event.target.className);
            });
        </script>

    Σε αυτό το τμήμα κώδικα JavaScript στέλνει ένα προσαρμοσμένο συμβάν σε εφαρμογή ιδέες κάθε φορά που κάποιος χρήστης κάνει κλικ σε οποιοδήποτε σημείο στο web app.

12. Στο κέλυφος Git, ολοκλήρωση και push τις αλλαγές σας για να σας διακλάδωσης σε GitHub. Στη συνέχεια, περιμένετε για προγράμματα-πελάτες για την ανανέωση του προγράμματος περιήγησης.

        git add -A :/
        git commit -m "add AI configuration for client app"
        git push origin master

6.  Εναλλαγή τις αλλαγές ανάπτυξη εφαρμογών για την παραγωγή:

        .\swap –Name ToDoApp<your_suffix>

13. Αναζητήστε τον πόρο ιδέες εφαρμογής που έχετε ρυθμίσει τις παραμέτρους. Κάντε κλικ στην επιλογή προσαρμοσμένη συμβάντα.

    ![](./media/app-service-web-test-in-production-controlled-test-flight/01-custom-events.png)

    Εάν δεν βλέπετε μετρήσεις για προσαρμοσμένα συμβάντα, περιμένετε λίγα λεπτά και κάντε κλικ στην επιλογή **Ανανέωση**.

Ας υποθέσουμε ότι μπορείτε να δείτε ένα γράφημα όπως παρακάτω:

![](./media/app-service-web-test-in-production-controlled-test-flight/02-custom-events-chart-view.png)

Και το πλέγμα συμβάν κάτω από αυτό:

![](./media/app-service-web-test-in-production-controlled-test-flight/03-custom-event-grid-view.png)

Σύμφωνα με κώδικα της εφαρμογής σας ToDoApp, το **ΚΟΥΜΠΊ** συμβάν αντιστοιχεί στο κουμπί "Υποβολή" και το συμβάν **ΕΙΣΌΔΟΥ** που αντιστοιχεί στο πλαίσιο κειμένου. Μέχρι στιγμής, πράγματα είναι σωστές. Ωστόσο, φαίνεται ότι υπάρχει ένα καλό χρονικό κλικ και πολύ λίγα μόνο κλικ στα στοιχεία εκκρεμών εργασιών (τα συμβάντα **ΣΑΝ** ).

Με βάση αυτό, φόρμα που σας υπόθεση που ορισμένοι χρήστες είναι συγχέονται ποιο τμήμα του περιβάλλοντος εργασίας Χρήστη του έχει δυνατότητα επιλογής και αυτό συμβαίνει επειδή το δρομέα είναι μορφοποιημένο για επιλογή κειμένου όταν βρίσκεται πάνω στην τα στοιχεία της λίστας και τα εικονίδιά τους.

![](./media/app-service-web-test-in-production-controlled-test-flight/04-to-do-list-item-ui.png)

Αυτό μπορεί να είναι ένα παράδειγμα contrived. Ωστόσο, πρόκειται να κάνετε βελτίωση της εφαρμογής σας και, στη συνέχεια, εκτελέστε μια flighting ανάπτυξης για τη λήψη χρηστικότητας σχολίων από πελάτες live.

### <a name="instrument-your-server-app-for-monitoringmetrics"></a>Εφαρμογή σας διακομιστή για παρακολούθηση μετρικά μέσου
Αυτή είναι μια εφαπτομένη εφόσον το σενάριο που παρουσιάζεται στο παρόν πρόγραμμα εκμάθησης ασχολείται μόνο με την εφαρμογή υπολογιστή-πελάτη. Ωστόσο, για πληρότητα μπορείτε να ορίσετε την εφαρμογή διακομιστή.

6. Κάντε δεξί κλικ **MultiChannelToDo** > **Τηλεμετρίας ιδέες Προσθήκη εφαρμογής** > **Διαμόρφωση παραμέτρων ρυθμίσεων** > Αλλαγή ομάδα πόρων για ToDoApp*&lt;your_suffix >* > **Προσθήκη εφαρμογής ιδέες για το έργο**.
12. Στο κέλυφος Git, ολοκλήρωση και push τις αλλαγές σας για να σας διακλάδωσης σε GitHub. Στη συνέχεια, περιμένετε για προγράμματα-πελάτες για την ανανέωση του προγράμματος περιήγησης.

        git add -A :/
        git commit -m "add AI configuration for server app"
        git push origin master

6.  Εναλλαγή τις αλλαγές ανάπτυξη εφαρμογών για την παραγωγή:

        .\swap –Name ToDoApp<your_suffix>

Αυτό είναι!

## <a name="investigate-add-slot-specific-tags-to-your-client-app-metrics"></a>Διερεύνηση: Προσθήκη ετικετών υποδιαίρεση ειδικά για να σας μετρικά εφαρμογή προγράμματος-πελάτη

Σε αυτήν την ενότητα, θα μπορείτε να ρυθμίσετε τις υποδοχές διαφορετικό ανάπτυξης για να στείλετε υποδιαίρεση συγκεκριμένο τηλεμετρίας με τον ίδιο πόρο εφαρμογής ιδέες. Με αυτόν τον τρόπο, μπορείτε να συγκρίνετε δεδομένα τηλεμετρίας μεταξύ της κυκλοφορίας από διαφορετικούς υποδοχές (περιβάλλοντα ανάπτυξης) για να βλέπετε εύκολα το αποτέλεσμα των αλλαγών σας εφαρμογή. Την ίδια στιγμή, μπορείτε να διαχωρίσετε την κυκλοφορία παραγωγής από τα υπόλοιπα, ώστε να μπορείτε να συνεχίσετε για την παρακολούθηση της εφαρμογής σας παραγωγής σύμφωνα με τις ανάγκες.

Αφού τη συγκέντρωση δεδομένων για συμπεριφορά του προγράμματος-πελάτη, που θα [προσθέσετε ένα σύνολο αρχικών τιμών τηλεμετρίας για να σας κώδικα JavaScript](../application-insights/app-insights-api-custom-events-metrics.md#js-initializer) σε index.cshtml. Εάν θέλετε να ελέγξετε απόδοση διακομιστή, για παράδειγμα, μπορείτε επίσης να κάνετε ομοίως στον κώδικα διακομιστή (ανατρέξτε στο θέμα [Εφαρμογή ιδέες API για προσαρμοσμένες συμβάντων και μετρήσεις](../application-insights/app-insights-api-custom-events-metrics.md).

1. Πρώτα, προσθέστε το κώδικα bewteen δύο `//` σχόλια κάτω από το JavaScript αποκλεισμός που έχετε προσθέσει στο το `<heading>` Προσθήκη ετικετών σε παλαιότερη έκδοση.

        window.appInsights = appInsights;

        // Begin new code
        appInsights.queue.push(function () {
            appInsights.context.addTelemetryInitializer(function (envelope) {
                var telemetryItem = envelope.data.baseData;
                telemetryItem.properties = telemetryItem.properties || {};
                telemetryItem.properties["Environment"] = "@System.Configuration.ConfigurationManager.AppSettings["environment"]";
            });
        });
        // End new code

        appInsights.trackPageView();

    Αυτός ο κωδικός προετοιμασία έχει ως αποτέλεσμα το `appInsights` αντικειμένου για να προσθέσετε το που ονομάζεται μια προσαρμοσμένη ιδιότητα `Environment` σε κάθε τμήμα τηλεμετρίας στέλνει.

2. Στη συνέχεια, προσθέστε αυτήν την προσαρμοσμένη ιδιότητα ως μια [Υποδοχή ρύθμιση](web-sites-staged-publishing.md#AboutConfiguration) για την εφαρμογή web σας στο Azure. Για να το κάνετε αυτό, εκτελέστε τις ακόλουθες εντολές στην περίοδο λειτουργίας σας στο κέλυφος Git.

        $app = Get-AzureWebsite -Name todoapp<your_suffix> -Slot production
        $app.AppSettings.Add("environment", "Production")
        $app.SlotStickyAppSettingNames.Add("environment")
        $app | Set-AzureWebsite -Name todoapp<your_suffix> -Slot production

    Το αρχείο Web.config στο έργο σας ήδη ορίζει το `environment` ρύθμιση app. Με αυτήν τη ρύθμιση, κατά τη δοκιμή της εφαρμογής τοπικά, τις μετρήσεις θα φέρουν ετικέτα με `VS Debugger`. Ωστόσο, όταν πατήσετε τις αλλαγές σας να Azure, Azure θα βρείτε και να χρησιμοποιήσετε το `environment` εφαρμογή τη ρύθμιση στη ρύθμιση παραμέτρων του web app και τις μετρήσεις θα φέρουν ετικέτα με `Production`.

3. Ολοκλήρωση και push τις αλλαγές σας κώδικα για να σας διακλάδωσης σε GitHub και, στη συνέχεια, περιμένετε για τους χρήστες σας να χρησιμοποιήσετε τη νέα εφαρμογή (χρειάζεται να ανανεώσετε το πρόγραμμα περιήγησης). Χρειάζονται περίπου 15 λεπτά για τη νέα ιδιότητα που θα εμφανίζονται στο τις ιδέες σας εφαρμογή `MultiChannelToDo.Web` πόρων.

        git add -A :/
        git commit -m "add environment property to AI events for client app"
        git push origin master

4. Τώρα, μεταβείτε ξανά τα **προσαρμοσμένα συμβάντα** blade και φιλτράρετε τα μετρικά `Environment=Production`. Τώρα θα πρέπει να μπορείτε να δείτε όλα τα συμβάντα προσαρμοσμένο νέα στην υποδοχή παραγωγής με αυτό το φίλτρο.

    ![](./media/app-service-web-test-in-production-controlled-test-flight/05-filter-on-production-environment.png)

5. Κάντε κλικ στο κουμπί **"Αγαπημένα"** για να αποθηκεύσετε τις τρέχουσες ρυθμίσεις Explorer μετρικά κάτι τέτοιο **προσαρμοσμένα συμβάντα: παραγωγής**. Μπορείτε να εύκολα εναλλαγή μεταξύ αυτής της προβολής και μια προβολή υποδιαίρεση ανάπτυξης αργότερα.

    > [AZURE.TIP] Για ακόμα πιο ισχυρή ανάλυση, εξετάστε το ενδεχόμενο [ενοποίηση του πόρου ιδέες εφαρμογή με το Power BI](../application-insights/app-insights-export-power-bi.md).

### <a name="add-slot-specific-tags-to-your-server-app-metrics"></a>Προσθήκη ετικετών υποδιαίρεση ειδικά για να σας μετρικά εφαρμογή διακομιστή
Ξανά, για πληρότητα μπορείτε να ορίσετε την εφαρμογή διακομιστή. Σε αντίθεση με την εφαρμογή υπολογιστή-πελάτη που διαθέτει όργανα της JavaScript, ετικέτες που αφορούν το υποδιαίρεση για την εφαρμογή server διαθέτει όργανα με κωδικό .NET.

1. Άνοιγμα * &lt;repository_root >*\src\MultiChannelToDo\Global.asax.cs. Προσθήκη μπλοκ κώδικα παρακάτω, ακριβώς πριν από το κλείσιμο άγκιστρο χώρο ονομάτων.

        namespace MultiChannelToDo
        {
                ...

                // Begin new code
            public class ConfigInitializer
            : ITelemetryInitializer
            {
                void ITelemetryInitializer.Initialize(ITelemetry telemetry)
                {
                    telemetry.Context.Properties["Environment"] = System.Configuration.ConfigurationManager.AppSettings["environment"];
                }
            }
                // End new code
        }

2. Διόρθωση των σφαλμάτων ανάλυση ονόματος, προσθέτοντας την `using` δηλώσεις κάτω από την αρχή του αρχείου:

        using Microsoft.ApplicationInsights.Channel;
        using Microsoft.ApplicationInsights.Extensibility;

3. Προσθήκη του κώδικα κάτω από την αρχή του το `Application_Start()` μέθοδο:

        TelemetryConfiguration.Active.TelemetryInitializers.Add(new ConfigInitializer());

3. Ολοκλήρωση και push τις αλλαγές σας κώδικα για να σας διακλάδωσης σε GitHub και, στη συνέχεια, περιμένετε για τους χρήστες σας να χρησιμοποιήσετε τη νέα εφαρμογή (χρειάζεται να ανανεώσετε το πρόγραμμα περιήγησης). Χρειάζονται περίπου 15 λεπτά για τη νέα ιδιότητα που θα εμφανίζονται στο τις ιδέες σας εφαρμογή `MultiChannelToDo` πόρων.

        git add -A :/
        git commit -m "add environment property to AI events for server app"
        git push origin master

## <a name="update-set-up-your-beta-branch"></a>Ενημερωμένη έκδοση του: Ρύθμιση του κλάδου βήτα

2. Άνοιγμα * &lt;repository_root >*\ARMTemplates\ProdAndStagetest.json και βρείτε το `appsettings` πόρους (Αναζήτηση για `"name": "appsettings"`). Υπάρχουν 4 από αυτά, μία για κάθε υποδιαίρεση. 

2. Για κάθε `appsettings` πόρων, προσθέστε μια `"environment": "[parameters('slotName')]"` ρύθμιση app μέχρι το τέλος της το `properties` πίνακα. Μην ξεχάσετε να τερματίσετε την προηγούμενη γραμμή με κόμμα.

    ![](./media/app-service-web-test-in-production-controlled-test-flight/06-arm-app-setting-with-slot-name.png)
    
    Που μόλις προσθέσατε το `environment` ρύθμιση εφαρμογή σε όλα τα εσοχές στο πρότυπο.
    
2. Στο ίδιο αρχείο, βρείτε το `slotconfignames` πόρους (Αναζήτηση για `"name": "slotconfignames"`). Υπάρχουν 2 από αυτά, μία για κάθε εφαρμογή.

2. Για κάθε `slotconfignames` πόρων, προσθήκη `"environment"` έως το τέλος του `appSettingNames` πίνακα. Μην ξεχάσετε να τερματίσετε την προηγούμενη γραμμή με κόμμα.

    Που μόλις δημιουργήσατε το `environment` εφαρμογή ρύθμιση στικ για την υποδοχή του αντίστοιχα ανάπτυξης για τις εφαρμογές και τις δύο.  

3. Στο κέλυφος Git την περίοδο λειτουργίας σας, εκτελέστε τις ακόλουθες εντολές με το ίδιο επίθημα ομάδα πόρων που είχατε χρησιμοποιήσει προηγουμένως.

        git checkout -b beta
        git push origin beta
        .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch beta

4. Όταν σας ζητηθεί, καθορίστε το ίδιο SQL διαπιστευτήρια βάσης δεδομένων ως πριν από. Στη συνέχεια, όταν σας ζητηθεί να ενημερώσετε την ομάδα των πόρων, πληκτρολογήστε `Y`, στη συνέχεια, `ENTER`.

    Μόλις ολοκληρωθεί η δέσμη ενεργειών, όλους τους πόρους σας στην αρχική ομάδα πόρων διατηρούνται, αλλά μια νέα υποδοχή με το όνομα "βήτα" δημιουργείται σε αυτήν με την ίδια ρύθμιση παραμέτρων με την "Οργάνωση" υποδοχή που δημιουργήθηκε με την αρχή.

    >[AZURE.NOTE] Αυτή η μέθοδος δημιουργίας ανάπτυξη διαφορετικά περιβάλλοντα είναι διαφορετική από τη μέθοδο στην [Ανάπτυξη ευέλικτη λογισμικού με Azure εφαρμογής υπηρεσίας](app-service-agile-software-development.md). Εδώ, μπορείτε να δημιουργήσετε περιβάλλοντα ανάπτυξης με υποδοχές ανάπτυξης, όπου που υπάρχουν δημιουργείτε ανάπτυξη περιβάλλοντα με ομάδες πόρων. Διαχείριση ανάπτυξης περιβάλλοντα με ομάδες πόρων σάς επιτρέπει να διατηρήσετε το περιβάλλον παραγωγής off-limits για τους προγραμματιστές, αλλά δεν είναι εύκολο να κάνετε δοκιμές στο παραγωγής, το οποίο μπορείτε να κάνετε εύκολα με υποδοχές.

Εάν θέλετε, μπορείτε επίσης να δημιουργήσετε μια εφαρμογή της άλφα, εκτελώντας

    git checkout -b alpha
    git push origin alpha
    .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch alpha

Για αυτό το πρόγραμμα εκμάθησης, που θα απλώς συνεχίσετε να χρησιμοποιείτε την εφαρμογή βήτα.

## <a name="update-push-your-updates-to-the-beta-app"></a>Ενημερωμένη έκδοση του: Push τις ενημερώσεις σας στην εφαρμογή βήτα

Επιστροφή στην εφαρμογή σας που θέλετε να βελτιώσετε.

1. Βεβαιωθείτε ότι είστε πλέον του κλάδου βήτα

        git checkout beta

2. Στο * &lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, βρείτε το `<li>` ετικέτα και προσθέστε το `style="cursor:pointer"` χαρακτηριστικό, όπως φαίνεται παρακάτω.

    ![](./media/app-service-web-test-in-production-controlled-test-flight/07-change-cursor-style-on-li.png)

3. Ολοκλήρωση και push για Azure.

4. Επαλήθευση ότι η αλλαγή τώρα ενημερώνεται στην υποδοχή beta, μεταβαίνοντας http://todoapp*&lt;your_suffix >*-beta.azurewebsites.net/. Εάν δεν βλέπετε την αλλαγή ακόμα, ανανεώστε το πρόγραμμα περιήγησης για να λάβετε τον νέο κώδικα javascript.

    ![](./media/app-service-web-test-in-production-controlled-test-flight/08-verify-change-in-beta-site.png)

Τώρα που έχετε για την αλλαγή που εκτελείται στην υποδοχή beta, είστε έτοιμοι για την εκτέλεση μιας flighting ανάπτυξης.

## <a name="validate-route-traffic-to-the-beta-app"></a>Επικύρωση: Δρομολόγηση κίνηση στην εφαρμογή βήτα

Σε αυτήν την ενότητα, που θα δρομολογείτε την κίνηση στην εφαρμογή βήτα. For sake of σαφήνεια της επίδειξης, πρόκειται να δρομολογήσετε ένα σημαντικό τμήμα της κυκλοφορίας χρήστη σε αυτήν. Στην πραγματικότητα, το ποσό που θέλετε να δρομολογήσετε την κυκλοφορία θα εξαρτώνται από συγκεκριμένες περίπτωσή σας. Για παράδειγμα, εάν την τοποθεσία σας βρίσκεται στη της κλίμακας του microsoft.com, στη συνέχεια, ίσως χρειαστεί λιγότερο από 1% των συνολικό κυκλοφορία σας προκειμένου να αποκτήσει χρήσιμα δεδομένα.

1. Στο κέλυφος Git την περίοδο λειτουργίας σας, εκτελέστε τις ακόλουθες εντολές για τη δρομολόγηση ήμισυ της κυκλοφορίας παραγωγής στο διάστημα beta:

        $siteName = "ToDoApp<your suffix>"
        $rule = New-Object Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.RampUpRule
        $rule.ActionHostName = "$siteName-beta.azurewebsites.net"
        $rule.ReroutePercentage = 50
        $rule.Name = "beta"
        Set-AzureWebsite $siteName -Slot Production -RoutingRules $rule

  Το `ReroutePercentage=50` ιδιότητα καθορίζει ότι θα δρομολογούνται 50% της κυκλοφορίας παραγωγής διεύθυνση URL της εφαρμογής του βήτα (καθορίζονται από το `ActionHostName` ιδιότητα).

2. Τώρα μεταβείτε http://ToDoApp*&lt;your_suffix >*. azurewebsites.net. 50% της κυκλοφορίας τώρα θα πρέπει να ανακατευθύνονται την υποδοχή βήτα.

3. Στο τον πόρο εφαρμογής ιδέες, να φιλτράρετε τα μετρικά από το περιβάλλον = "βήτα".

    > [AZURE.NOTE] Εάν αποθηκεύσετε αυτήν την φιλτραρισμένη προβολή ως άλλο Αγαπημένα, στη συνέχεια, μπορείτε να εύκολα αναστρέψετε τις προβολές μετρικό explorer μεταξύ της παραγωγής και προβολές βήτα.

Ας υποθέσουμε ότι στην εφαρμογή ιδέες, θα δείτε κάτι παρόμοιο με το εξής:

![](./media/app-service-web-test-in-production-controlled-test-flight/09-test-beta-site-in-production.png)

Όχι μόνο αυτό που δείχνει ότι δεν υπάρχουν πολλές περισσότερες κάνει κλικ σε το `<li>` ετικέτες, αλλά φαίνεται να είναι ένα αύξησης των κάνει κλικ σε `<li>` ετικέτες. Μπορείτε, στη συνέχεια, να διαπιστώσετε ότι οι χρήστες έχουν εντόπισε το νέο `<li>` ετικετών είναι με δυνατότητα επιλογής και τώρα Απαλοιφή όλων προηγουμένως ολοκληρωμένες εργασίες τους στην εφαρμογή.

Με βάση τα δεδομένα σας flighting ανάπτυξης, αποφασίσετε ότι το νέο περιβάλλον εργασίας Χρήστη είναι έτοιμη για την παραγωγή.

## <a name="go-live-move-your-new-code-into-production"></a>Μεταβείτε ζωντανή: Μετακινήστε τον νέο κωδικό σε παραγωγής

Τώρα είστε έτοιμοι να μετακινήσετε την ενημέρωση παραγωγής. Τι είναι ιδανική είναι ότι τώρα που γνωρίζετε ότι η ενημέρωση σας έχει ήδη επικυρωμένο _πριν από_ την προωθείται παραγωγής. Τώρα μπορείτε να αναπτύξετε το. Εφόσον έχετε κάνει μια ενημέρωση της εφαρμογής υπολογιστή-πελάτη AngularJS, μόνο επικυρωθεί ο κωδικός πλευρά του προγράμματος-πελάτη. Εάν θέλετε να κάνετε αλλαγές στην εφαρμογή Web API παρασκηνίου, μπορεί να μπορείτε να επαληθεύσετε τις αλλαγές σας ομοίως και εύκολα.

1. Στο κέλυφος Git, καταργήστε τον κανόνα δρομολόγησης κυκλοφορίας, εκτελώντας την ακόλουθη εντολή:

        Set-AzureWebsite $siteName -Slot Production -RoutingRules @()

2. Εκτελέστε τις εντολές Git:

        git checkout master
        git pull origin master
        git merge beta
        git push origin master

2. Περιμένετε μερικά λεπτά για το νέο κωδικό για να αναπτυχθούν στο ενδιάμεσου σταδίου διάστημα και, στη συνέχεια, εκκίνηση http://ToDoApp*&lt;your_suffix >*-staging.azurewebsites.net για να επαληθεύσετε ότι τη νέα ενημερωμένη έκδοση είναι προθερμαίνονται στην υποδοχή ενδιάμεσου σταδίου. Να θυμάστε ότι η κύρια κλάδο σας διακλάδωσης είναι συνδεδεμένο με το ενδιάμεσου σταδίου υποδιαίρεση της εφαρμογής.

3. Τώρα, εναλλαγή ενδιάμεσου σταδίου υποδοχή σε παραγωγής

        cd <ROOT>\ToDoApp\ARMTemplates
        .\swap.ps1 -Name todoapp<your_suffix>

## <a name="summary"></a>Σύνοψη ##

Azure εφαρμογής υπηρεσίας διευκολύνει για μικρές-μεσαίες επιχειρήσεις για να ελέγξετε τις εφαρμογές άμεσα προσβάσιμη από πελάτη σε παραγωγής, κάτι που έχει γίνει παραδοσιακά σε μεγάλες επιχειρήσεις. Ευτυχώς, αυτό το πρόγραμμα εκμάθησης σας εκχώρησε τις γνώσεις που πρέπει να συνδυάζουν εφαρμογής υπηρεσίας και τις ιδέες εφαρμογής για να κάνετε πιθανές flighting ανάπτυξης και, ακόμη και άλλα σενάρια δοκιμής-σε-παραγωγή, στον κόσμο του DevOps. 

## <a name="more-resources"></a>Περισσότεροι πόροι ##

-   [Ανάπτυξη ευέλικτη λογισμικού με Azure εφαρμογής υπηρεσίας](app-service-agile-software-development.md)
-   [Ρύθμιση του ενδιάμεσου περιβάλλοντα για τις εφαρμογές web στο Azure εφαρμογής υπηρεσίας](web-sites-staged-publishing.md)
-   [Ανάπτυξη μιας σύνθετης εφαρμογής προβλέψιμα στο Azure](app-service-deploy-complex-application-predictably.md)
-   [Σύνταξη από κοινού Azure πρότυπα διαχείρισης πόρων](../resource-group-authoring-templates.md)
-   [JSONLint - η εφαρμογή επικύρωσης JSON](http://jsonlint.com/)
-   [Διακλάδωση Git – βασικές διακλάδωσης και συγχώνευση](http://www.git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)
-   [Azure PowerShell](../powershell-install-configure.md)
-   [Wiki Kudu έργου](https://github.com/projectkudu/kudu/wiki)

<properties
    pageTitle="Δημιουργία και φόρτωση δεδομένων σε πίνακες Hive από χώρο αποθήκευσης αντικειμένων Blob | Microsoft Azure"
    description="Δημιουργία ομάδας πινάκων και φόρτωση δεδομένων στο blob σε ομάδας πινάκων"
    services="machine-learning,storage"
    documentationCenter=""
    authors="bradsev"
    manager="jhubbard"
    editor="cgronlun" />

<tags
    ms.service="machine-learning"
    ms.workload="data-services"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/14/2016"
    ms.author="bradsev" />


#<a name="create-and-load-data-into-hive-tables-from-azure-blob-storage"></a>Δημιουργία και φόρτωση δεδομένων σε πίνακες Hive από χώρο αποθήκευσης αντικειμένων blob του Azure

Αυτό το θέμα παρουσιάζει γενικής χρήσης ερωτήματα Hive που Δημιουργία ομάδας πινάκων και φόρτωση δεδομένων από το χώρο αποθήκευσης αντικειμένων blob του Azure. Ορισμένες οδηγίες παρέχεται επίσης στην ομάδα πίνακες διαμερισμάτων και σχετικά με τη χρήση του βελτιστοποιημένη γραμμή σε στήλες (ORC) μορφοποίησης για βελτίωση της απόδοσης του ερωτήματος.

Το **μενού** συνδέσεις σε θέματα τα οποία περιγράφουν τον τρόπο ingest δεδομένων σε περιβάλλοντα προορισμού όπου τα δεδομένα μπορεί να αποθηκευτεί και να υποβάλλονται σε επεξεργασία κατά τη διάρκεια της διεργασίας Science δεδομένων ομάδας (TDSP).

[AZURE.INCLUDE [cap-ingest-data-selector](../../includes/cap-ingest-data-selector.md)]


## <a name="prerequisites"></a>Προαπαιτούμενα στοιχεία
Σε αυτό το άρθρο προϋποθέτει ότι έχετε:

* Δημιουργία λογαριασμού Azure χώρου αποθήκευσης. Εάν χρειάζεστε οδηγίες, ανατρέξτε στο θέμα [σχετικά με το Azure λογαριασμοί χώρου αποθήκευσης](../storage/storage-create-storage-account.md). 
* Προμήθεια ένα προσαρμοσμένο σύμπλεγμα Hadoop με την υπηρεσία HDInsight.  Εάν χρειάζεστε οδηγίες, ανατρέξτε στο θέμα [Προσαρμογή Azure HDInsight Hadoop συμπλεγμάτων για προηγμένη ανάλυση](machine-learning-data-science-customize-hadoop-cluster.md).
* Με δυνατότητα απομακρυσμένης πρόσβασης στο σύμπλεγμα, συνδεδεμένος και ανοίγει κονσόλα γραμμής εντολών Hadoop. Εάν χρειάζεστε οδηγίες, ανατρέξτε στο θέμα [πρόσβαση κεφαλή κόμβο του Hadoop συμπλέγματος](machine-learning-data-science-customize-hadoop-cluster.md#headnode).

## <a name="upload-data-to-azure-blob-storage"></a>Αποστολή δεδομένων στο χώρο αποθήκευσης αντικειμένων blob του Azure
Εάν έχετε δημιουργήσει μια εικονική μηχανή Azure, ακολουθώντας τις οδηγίες που παρέχονται στη [Ρύθμιση μια εικονική μηχανή Azure για προηγμένη ανάλυση](machine-learning-data-science-setup-virtual-machine.md), αυτό το αρχείο δέσμης ενεργειών πρέπει να έχουν ληφθεί από το *C:\\χρήστες\\\<όνομα χρήστη\>\\έγγραφα\\δέσμες ενεργειών Science δεδομένων* καταλόγου στον υπολογιστή εικονική. Αυτά τα ερωτήματα Hive απαιτούν μόνο ότι έχετε συνδέσει το δικό σας σχήμα δεδομένων και τη ρύθμιση παραμέτρων χώρο αποθήκευσης αντικειμένων blob του Azure στα κατάλληλα πεδία για να είστε έτοιμοι για την υποβολή.

Θα σας προϋποθέτουν ότι τα δεδομένα για ομάδα πίνακες είναι σε μορφή **αρχεία μη συμπιεσμένων** σε μορφή πίνακα και ότι τα δεδομένα έχει αποσταλεί στην προεπιλεγμένη (ή σε μια πρόσθετη) κοντέινερ του λογαριασμού χώρου αποθήκευσης που χρησιμοποιείται από το σύμπλεγμα Hadoop.

Εάν θέλετε να εξασκηθείτε στη **Νέα ΥΌΡΚΗ ταξί ταξιδιού δεδομένων**, πρέπει να:

- τα αρχεία [Δεδομένων ταξιδιού ταξί νέα ΥΌΡΚΗ](http://www.andresmh.com/nyctaxitrips) **κάντε λήψη** του 24 (12 αρχεία ταξιδιού και 12 ναύλο αρχεία),
- **αποσυμπιέστε** όλα τα αρχεία σε αρχεία .csv, και, στη συνέχεια,
- **Αποστολή** να την προεπιλεγμένη (ή στο κατάλληλο κοντέινερ) του λογαριασμού Azure χώρου αποθήκευσης που έχει δημιουργηθεί με τη διαδικασία που περιγράφεται στο θέμα [Προσαρμογή Azure HDInsight Hadoop συμπλεγμάτων για σύνθετη ανάλυση διαδικασία και τεχνολογία](machine-learning-data-science-customize-hadoop-cluster.md) . Μπορείτε να βρείτε τη διαδικασία για να αποστείλετε τα αρχεία .csv στο κοντέινερ προεπιλογή για το λογαριασμό χώρου αποθήκευσης σε αυτήν τη [σελίδα](machine-learning-data-science-process-hive-walkthrough.md#upload).


## <a name="submit"></a>Τον τρόπο υποβολής ερωτημάτων ομάδας

Τα ερωτήματα της ομάδας μπορούν να υποβληθούν με τη χρήση:

1. [Υποβολή ερωτημάτων Hive μέσω της γραμμής εντολών Hadoop στο headnode Hadoop συμπλέγματος](#headnode)
2. [Υποβολή ερωτημάτων ομάδα με το πρόγραμμα επεξεργασίας ομάδας](#hive-editor)
3. [Υποβολή ερωτημάτων Hive με τις εντολές του PowerShell Azure](#ps)

Τα ερωτήματα Hive είναι μοιάζει με SQL. Εάν είστε εξοικειωμένοι με την SQL, που μπορεί να εντοπίσει το [Hive για φύλλο πλήκτρα χρήστες SQL](http://hortonworks.com/wp-content/uploads/2013/05/hql_cheat_sheet.pdf) χρήσιμες.

Κατά την υποβολή ερωτήματος Hive, μπορείτε επίσης να ελέγξετε τον προορισμό της εξόδου από ομάδα ερωτήματα, είτε πρόκειται για στην οθόνη ή σε ένα τοπικό αρχείο στον κόμβο κεφαλής ή σε μια αντικειμένων blob του Azure.


###<a name="headnode"></a>1. υποβολή ερωτημάτων Hive μέσω της γραμμής εντολών Hadoop στο headnode Hadoop συμπλέγματος

Εάν το ερώτημα Hive είναι περίπλοκο, υποβάλετε απευθείας στον κόμβο της κεφαλίδας της το Hadoop σύμπλεγμα συνήθως υποψήφιων πελατών για να ενεργοποιήσετε πιο γρήγορα από την υποβολή τους με μια ομάδα επεξεργασίας ή Azure PowerShell δέσμες ενεργειών.

Συνδεθείτε με το κεφαλής κόμβο του συμπλέγματος Hadoop, ανοίξτε τη γραμμή εντολών Hadoop στην επιφάνεια εργασίας του κόμβου κεφαλίδας και πληκτρολογήστε εντολή `cd %hive_home%\bin`.

Υπάρχουν τρεις τρόποι για την υποβολή ερωτημάτων Hive στο Hadoop γραμμή εντολών:

* απευθείας
* χρήση των αρχείων .hql
* με την κονσόλα εντολών ομάδας

#### <a name="submit-hive-queries-directly-in-hadoop-command-line"></a>Υποβολή ερωτημάτων Hive απευθείας στο Hadoop γραμμή εντολών.

Μπορείτε να εκτελέσετε εντολή όπως `hive -e "<your hive query>;` για να υποβάλετε απλά Hive ερωτήματα απευθείας στο Hadoop γραμμή εντολών. Ακολουθεί ένα παράδειγμα, όπου το κόκκινο πλαίσιο περιγράφει την εντολή που υποβάλλει το ερώτημα Hive και του πράσινου πλαισίου περιγράφει την έξοδο από το ερώτημα ομάδας.

![Δημιουργία χώρου εργασίας](./media/machine-learning-data-science-move-hive-tables/run-hive-queries-1.png)

#### <a name="submit-hive-queries-in-hql-files"></a>Υποβολή ερωτημάτων Hive σε αρχεία .hql

Όταν το ερώτημα Hive είναι πιο σύνθετη και έχει πολλές γραμμές, επεξεργασία ερωτημάτων στη γραμμή εντολών ή κονσόλα εντολών Hive δεν είναι πρακτική. Εναλλακτική λύση είναι να χρησιμοποιήσετε ένα πρόγραμμα επεξεργασίας κειμένου στον κεφαλής κόμβο του συμπλέγματος Hadoop για να αποθηκεύσετε τα ερωτήματα ομάδας σε ένα αρχείο .hql σε έναν τοπικό κατάλογο του κεφαλής κόμβου. Στη συνέχεια, το ερώτημα ομάδας στο αρχείο .hql μπορούν να υποβληθούν, χρησιμοποιώντας το `-f` όρισμα ως εξής:

    hive -f "<path to the .hql file>"

![Δημιουργία χώρου εργασίας](./media/machine-learning-data-science-move-hive-tables/run-hive-queries-3.png)


**Απόκρυψη εκτύπωσης οθόνης κατάσταση προόδου Hive ερωτημάτων**

Από προεπιλογή, μετά την υποβολή ερωτήματος Hive στο Hadoop γραμμή εντολών, την πρόοδο της εργασίας χάρτη/μείωση θα εκτυπωθεί στην οθόνη. Για να αποκρύψετε την εκτύπωση οθόνης της προόδου εργασίας χάρτη/μείωση, μπορείτε να χρησιμοποιήσετε ένα όρισμα `-S` ("S" με κεφαλαία γράμματα) στην εντολή γραμμή ως εξής:

    hive -S -f "<path to the .hql file>"
    hive -S -e "<Hive queries>"

#### <a name="submit-hive-queries-in-hive-command-console"></a>Υποβολή ερωτημάτων Hive στην κονσόλα εντολών της ομάδας.

Μπορείτε να εισαγάγετε επίσης πρώτα την κονσόλα εντολών Hive με την εκτέλεση εντολής `hive` στο Hadoop γραμμή εντολών, και, στη συνέχεια, υποβολή ερωτημάτων Hive στην κονσόλα εντολών της ομάδας. Ακολουθεί ένα παράδειγμα. Σε αυτό το παράδειγμα, τα δύο πλαίσια κόκκινο επισημάνετε τις εντολές που χρησιμοποιούνται για την εισαγωγή την κονσόλα εντολών της ομάδας και το ερώτημα Hive που υποβάλλεται στην κονσόλα Hive εντολής, αντίστοιχα. Το πράσινο πλαίσιο επισημαίνει την έξοδο από το ερώτημα ομάδας.

![Δημιουργία χώρου εργασίας](./media/machine-learning-data-science-move-hive-tables/run-hive-queries-2.png)

Το προηγούμενο παράδειγμα εξόδου απευθείας τα αποτελέσματα του ερωτήματος Hive στην οθόνη. Μπορείτε επίσης να συντάξετε το αποτέλεσμα σε ένα τοπικό αρχείο στον κόμβο κεφαλής ή σε μια αντικειμένων blob του Azure. Στη συνέχεια, μπορείτε να χρησιμοποιήσετε άλλα εργαλεία για να αναλύσετε περαιτέρω το αποτέλεσμα Hive ερωτημάτων.

**Εξόδου Hive αποτελέσματα ερωτήματος σε ένα τοπικό αρχείο.**

Για να εξαγάγετε Hive αποτελέσματα ερωτήματος σε έναν τοπικό κατάλογο στον κόμβο κεφαλίδας, πρέπει να υποβάλετε ερώτημα Hive στο Hadoop γραμμή εντολών ως εξής:

    hive -e "<hive query>" > <local path in the head node>

Στο παρακάτω παράδειγμα, το αποτέλεσμα του ερωτήματος Hive είναι γραμμένο σε ένα αρχείο `hivequeryoutput.txt` στον κατάλογο `C:\apps\temp`.

![Δημιουργία χώρου εργασίας](./media/machine-learning-data-science-move-hive-tables/output-hive-results-1.png)

**Αποτελέσματα ερωτήματος Hive εξόδου σε μια αντικειμένων blob του Azure**

Μπορείτε επίσης να εξαγάγετε τα αποτελέσματα του ερωτήματος ομάδας σε μια αντικειμένων blob του Azure, μέσα στο κοντέινερ προεπιλεγμένη του συμπλέγματος Hadoop. Το ερώτημα Hive για αυτό είναι ως εξής:

    insert overwrite directory wasb:///<directory within the default container> <select clause from ...>

Στο παρακάτω παράδειγμα, το αποτέλεσμα του ερωτήματος Hive είναι γραμμένο σε έναν κατάλογο blob `queryoutputdir` μέσα στο κοντέινερ προεπιλεγμένη του συμπλέγματος Hadoop. Εδώ, μόνο πρέπει να παρέχετε το όνομα του καταλόγου, χωρίς το όνομα blob. Ένα σφάλμα εάν, παρέχετε καταλόγου και αντικειμένων blob ονομάτων, όπως είναι οι `wasb:///queryoutputdir/queryoutput.txt`.

![Δημιουργία χώρου εργασίας](./media/machine-learning-data-science-move-hive-tables/output-hive-results-2.png)

Εάν ανοίξετε το προεπιλεγμένο κοντέινερ του συμπλέγματος Hadoop, χρησιμοποιώντας την Εξερεύνηση χώρου αποθήκευσης Azure, μπορείτε να δείτε το αποτέλεσμα του ερωτήματος Hive όπως φαίνεται στην παρακάτω εικόνα. Μπορείτε να εφαρμόσετε το φίλτρο (επισημαίνεται με κόκκινο πλαίσιο) για να ανακτήσετε μόνο το αντικείμενο blob με καθορισμένο γράμματα σε ονόματα.

![Δημιουργία χώρου εργασίας](./media/machine-learning-data-science-move-hive-tables/output-hive-results-3.png)

###<a name="hive-editor"></a>2. υποβολή ερωτημάτων ομάδα με το πρόγραμμα επεξεργασίας ομάδας

Μπορείτε επίσης να χρησιμοποιήσετε την κονσόλα ερωτήματος (επεξεργαστή Hive), πληκτρολογώντας μια διεύθυνση URL της φόρμας *https://&#60; Όνομα συμπλέγματος Hadoop >.azurehdinsight.net/Home/HiveEditor* σε ένα πρόγραμμα περιήγησης web. Πρέπει να πραγματοποιήσει είσοδο δείτε αυτήν την κονσόλα και επομένως, χρειάζεστε τα διαπιστευτήρια σύμπλεγμα Hadoop εδώ.

###<a name="ps"></a>3. υποβολή ερωτημάτων Hive με τις εντολές του PowerShell Azure

Μπορείτε επίσης να χρησιμοποιήσετε το PowerShell για την υποβολή ερωτημάτων ομάδας. Για οδηγίες, ανατρέξτε στο θέμα [Υποβολή Hive εργασίες με χρήση του PowerShell](../hdinsight/hdinsight-submit-hadoop-jobs-programmatically.md#hive-powershell).


## <a name="create-tables"></a>Δημιουργία βάσης δεδομένων της ομάδας και πινάκων

Τα ερωτήματα Hive χρησιμοποιούνται από κοινού στο [αποθετήριο δεδομένων Github](https://github.com/Azure/Azure-MachineLearning-DataScience/tree/master/Misc/DataScienceProcess/DataScienceScripts/sample_hive_create_db_tbls_load_data_generic.hql) και μπορούν να ληφθούν από εκεί.

Παρακάτω θα δείτε το ερώτημα Hive που δημιουργεί έναν πίνακα ομάδα.

    create database if not exists <database name>;
    CREATE EXTERNAL TABLE if not exists <database name>.<table name>
    (
        field1 string,
        field2 int,
        field3 float,
        field4 double,
        ...,
        fieldN string
    )
    ROW FORMAT DELIMITED FIELDS TERMINATED BY '<field separator>' lines terminated by '<line separator>'
    STORED AS TEXTFILE LOCATION '<storage location>' TBLPROPERTIES("skip.header.line.count"="1");

Εδώ θα βρείτε τις περιγραφές των πεδίων που χρειάζεστε για να συνδεθείτε και άλλες ρυθμίσεις παραμέτρων:

- **& #60, όνομα βάσης δεδομένων >**: το όνομα της βάσης δεδομένων που θέλετε να δημιουργήσετε. Εάν θέλετε απλώς να χρησιμοποιήσετε την προεπιλεγμένη βάση δεδομένων, η *Δημιουργία βάσης δεδομένων...* ερωτήματος μπορεί να παραλειφθούν.
- **& #60; όνομα πίνακα >**: το όνομα του πίνακα στον οποίο θέλετε να δημιουργήσετε μέσα σε καθορισμένη βάση δεδομένων. Εάν θέλετε να χρησιμοποιήσετε την προεπιλεγμένη βάση δεδομένων, ο πίνακας μπορεί να γίνει αναφορά απευθείας από *& #60; όνομα πίνακα >* χωρίς & #60, όνομα βάσης δεδομένων >.
- **& #60, το διαχωριστικό πεδίων >**: το διαχωριστικό που οριοθετεί πεδία στο αρχείο δεδομένων να αποσταλεί στον πίνακα της ομάδας.
- **& #60; διαχωριστικό γραμμής >**: το διαχωριστικό που οριοθετεί γραμμές στο αρχείο δεδομένων.
- **& #60; θέση αποθήκευσης >**: η θέση αποθήκευσης Azure για να αποθηκεύσετε τα δεδομένα των πινάκων της ομάδας. Εάν δεν καθορίσετε *ΘΈΣΗ & #60; θέση αποθήκευσης >*, τη βάση δεδομένων και τους πίνακες που είναι αποθηκευμένα σε *hive/αποθήκης/* καταλόγου στο προεπιλεγμένο κοντέινερ του συμπλέγματος Hive από προεπιλογή. Εάν θέλετε να καθορίσετε τη θέση αποθήκευσης, τη θέση αποθήκευσης πρέπει να είναι μέσα στο κοντέινερ προεπιλογή για τη βάση δεδομένων και τους πίνακες. Αυτήν τη θέση πρέπει να είναι που αναφέρονται ως θέση σε σχέση με το προεπιλεγμένο κοντέινερ του συμπλέγματος στο πλαίσιο μορφή *' wasb: / / / & #60; καταλόγου 1 > /'* ή *' wasb: / / / & #60; καταλόγου 1 > / & #60; καταλόγου 2 > /'*, κ.λπ. Μετά την εκτέλεση του ερωτήματος, τη σχετική κατάλογοι δημιουργούνται μέσα στο κοντέινερ προεπιλογή.
- **TBLPROPERTIES("Skip.Header.line.Count"="1")**: Εάν το αρχείο δεδομένων έχει μια γραμμή κεφαλίδας, πρέπει να προσθέσετε αυτήν την ιδιότητα **στο τέλος** του ερωτήματος *δημιουργίας πίνακα* . Διαφορετικά, της γραμμής κεφαλίδων φορτώνεται ως εγγραφή στον πίνακα. Εάν το αρχείο δεδομένων δεν έχει μια γραμμή κεφαλίδας, μπορεί να παραλειφθεί, αυτή η ρύθμιση παραμέτρων στο ερώτημα.

## <a name="load-data"></a>Φόρτωση των δεδομένων σε πίνακες ομάδας
Παρακάτω θα δείτε το ερώτημα Hive που φορτώνει δεδομένων σε πίνακα της ομάδας.

    LOAD DATA INPATH '<path to blob data>' INTO TABLE <database name>.<table name>;

- **& #60; διαδρομή προς δεδομένα blob >**: Εάν το αρχείο blob να αποσταλεί στον πίνακα ομάδα στο προεπιλεγμένο κοντέινερ του συμπλέγματος HDInsight Hadoop, το *& #60; διαδρομή προς δεδομένα blob >* πρέπει να είναι σε μορφή *' wasb: / / / & #60; καταλόγου σε αυτό το κοντέινερ > / & #60; blob όνομα αρχείου >'*. Το αρχείο blob μπορεί επίσης να σε ένα πρόσθετο κοντέινερ του συμπλέγματος HDInsight Hadoop. Σε αυτήν την περίπτωση, *& #60; διαδρομή προς δεδομένα blob >* πρέπει να είναι σε μορφή *' wasb: / / & #60; κοντέινερ name>@&#60;storage όνομα λογαριασμού >.blob.core.windows.net/ & #60; blob όνομα αρχείου >'*.

    >[AZURE.NOTE] Τα δεδομένα blob να αποσταλεί σε ομάδα πίνακα πρέπει να είναι στην προεπιλεγμένη ή επιπλέον κοντέινερ του λογαριασμού χώρου αποθήκευσης για το σύμπλεγμα Hadoop. Διαφορετικά, το ερώτημα *ΔΕΔΟΜΈΝΩΝ ΦΌΡΤΩΣΗΣ* αποτυγχάνει παραπονούμενοι ότι δεν έχουν πρόσβαση στα δεδομένα.


## <a name="partition-orc"></a>Θέματα για προχωρημένους: διαμερίσματα πίνακα και αποθήκευσης Hive δεδομένα σε μορφή ORC

Εάν τα δεδομένα είναι μεγάλο, διαμερισμάτων του πίνακα είναι χρήσιμη για τα ερωτήματα που θα πρέπει να σαρώσετε μερικά τα διαμερίσματα του πίνακα. Για παράδειγμα, είναι λογικό να διαμερισμάτων τα δεδομένα του αρχείου καταγραφής της τοποθεσίας web με ημερομηνίες.

Εκτός από διαμερισμάτων ομάδα πίνακες, επίσης, είναι καλό να αποθηκεύσετε τα δεδομένα της ομάδας στη μορφή βελτιστοποιημένη σε στήλες γραμμής (ORC). Για περισσότερες πληροφορίες σχετικά με τη μορφοποίηση ORC, ανατρέξτε στο θέμα <a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+ORC#LanguageManualORC-ORCFiles" target="_blank">Χρήση ORC αρχεία βελτιώνει τις επιδόσεις όταν Hive ανάγνωση, εγγραφή, και επεξεργασία δεδομένων</a>.

### <a name="partitioned-table"></a>Διαμερίσματα πίνακα
Παρακάτω θα δείτε το ερώτημα Hive που δημιουργεί ένα διαμερίσματα πίνακα και φορτώνει δεδομένων σε αυτήν.

    CREATE EXTERNAL TABLE IF NOT EXISTS <database name>.<table name>
    (field1 string,
    ...
    fieldN string
    )
    PARTITIONED BY (<partitionfieldname> vartype) ROW FORMAT DELIMITED FIELDS TERMINATED BY '<field separator>'
         lines terminated by '<line separator>' TBLPROPERTIES("skip.header.line.count"="1");
    LOAD DATA INPATH '<path to the source file>' INTO TABLE <database name>.<partitioned table name>
        PARTITION (<partitionfieldname>=<partitionfieldvalue>);

Κατά την υποβολή ερωτήματος διαμερίσματα πίνακες, καλό είναι να προσθέσετε τη συνθήκη διαμερίσματα στην **αρχή** του το `where` όρος ως αυτό βελτιώνει την αποτελεσματικότητα της αναζήτησης σημαντικά.

    select
        field1, field2, ..., fieldN
    from <database name>.<partitioned table name>
    where <partitionfieldname>=<partitionfieldvalue> and ...;

### <a name="orc"></a>Αποθηκεύστε τα δεδομένα της ομάδας σε μορφή ORC

Δεν μπορείτε απευθείας να φορτώσετε δεδομένα από το χώρο αποθήκευσης αντικειμένων blob σε ομάδα πίνακες που είναι αποθηκευμένα σε μορφή ORC. Ακολουθούν τα βήματα που το πρέπει να ακολουθήσετε για να φορτώσετε δεδομένα από το Azure BLOB σε ομάδα πίνακες που είναι αποθηκευμένα σε μορφή ORC.

Δημιουργήστε ένα εξωτερικό πίνακα **ΑΠΟΘΗΚΕΥΜΈΝΟ TEXTFILE AS** και φόρτωση δεδομένων από το χώρο αποθήκευσης αντικειμένων blob στον πίνακα.

        CREATE EXTERNAL TABLE IF NOT EXISTS <database name>.<external textfile table name>
        (
            field1 string,
            field2 int,
            ...
            fieldN date
        )
        ROW FORMAT DELIMITED FIELDS TERMINATED BY '<field separator>'
            lines terminated by '<line separator>' STORED AS TEXTFILE
            LOCATION 'wasb:///<directory in Azure blob>' TBLPROPERTIES("skip.header.line.count"="1");

        LOAD DATA INPATH '<path to the source file>' INTO TABLE <database name>.<table name>;

Δημιουργία ενός πίνακα του εσωτερικού με το ίδιο σχήμα ως τον εξωτερικό πίνακα στο βήμα 1, με τον ίδιο οριοθέτη πεδίων και αποθηκεύστε τα δεδομένα της ομάδας στη μορφή ORC.

        CREATE TABLE IF NOT EXISTS <database name>.<ORC table name>
        (
            field1 string,
            field2 int,
            ...
            fieldN date
        )
        ROW FORMAT DELIMITED FIELDS TERMINATED BY '<field separator>' STORED AS ORC;

Επιλογή δεδομένων από το εξωτερικό πίνακα στο βήμα 1 και εισαγωγή στον πίνακα ORC

        INSERT OVERWRITE TABLE <database name>.<ORC table name>
            SELECT * FROM <database name>.<external textfile table name>;

>[AZURE.NOTE] Εάν ο πίνακας TEXTFILE *& #60, όνομα βάσης δεδομένων >. & #60; όνομα πίνακα εξωτερικών textfile >* έχει διαμερίσματα, στο ΒΉΜΑ 3, το `SELECT * FROM <database name>.<external textfile table name>` εντολή επιλέγει τη μεταβλητή διαμερίσματα ως πεδίου σε το επιστρεφόμενο σύνολο δεδομένων. Εισαγάγετε το *& #60, όνομα βάσης δεδομένων >. & #60; όνομα πίνακα ORC >* αποτυγχάνει από *& #60, όνομα βάσης δεδομένων >. & #60; ORC όνομα πίνακα >* δεν έχει τη μεταβλητή διαμερίσματα ως πεδίο στη διάταξη πίνακα. Σε αυτήν την περίπτωση, πρέπει να επιλέξετε συγκεκριμένα τα πεδία που θα εισαχθεί *& #60, όνομα βάσης δεδομένων >. & #60; όνομα πίνακα ORC >* ως εξής:

        INSERT OVERWRITE TABLE <database name>.<ORC table name> PARTITION (<partition variable>=<partition value>)
           SELECT field1, field2, ..., fieldN
           FROM <database name>.<external textfile table name>
           WHERE <partition variable>=<partition value>;

Είναι ασφαλή για να απορρίψετε την *& #60; όνομα πίνακα εξωτερικών textfile >* όταν χρησιμοποιείτε το ακόλουθο ερώτημα μετά από όλα τα δεδομένα που έχει εισαχθεί σε *& #60, όνομα βάσης δεδομένων >. & #60; όνομα πίνακα ORC >*:

        DROP TABLE IF EXISTS <database name>.<external textfile table name>;

Αφού ακολουθήσετε αυτήν τη διαδικασία, πρέπει να έχετε έναν πίνακα με τα δεδομένα στη μορφή ORC έτοιμη για χρήση.  

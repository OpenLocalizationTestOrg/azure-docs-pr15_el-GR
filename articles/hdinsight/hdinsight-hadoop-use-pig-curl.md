<properties
   pageTitle="Χρήση Hadoop γουρούνι με καμπύλη στο HDInsight | Microsoft Azure"
   description="Μάθετε πώς μπορείτε να χρησιμοποιήσετε καμπύλη για να εκτελέσετε εργασίες Λατινικά γουρούνι σε ένα σύμπλεγμα Hadoop στο Azure HDInsight."
   services="hdinsight"
   documentationCenter=""
   authors="Blackmist"
   manager="jhubbard"
   editor="cgronlun"
    tags="azure-portal"/>

<tags
   ms.service="hdinsight"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="big-data"
   ms.date="08/23/2016"
   ms.author="larryfr"/>

#<a name="run-pig-jobs-with-hadoop-on-hdinsight-by-using-curl"></a>Εκτελέστε εργασίες γουρούνι με Hadoop σε HDInsight χρησιμοποιώντας καμπύλη

[AZURE.INCLUDE [pig-selector](../../includes/hdinsight-selector-use-pig.md)]

Σε αυτό το έγγραφο, θα μάθετε πώς μπορείτε να χρησιμοποιήσετε καμπύλη για να εκτελέσετε εργασίες Λατινικά γουρούνι σε ένα σύμπλεγμα Azure HDInsight. Η γλώσσα προγραμματισμού Λατινικά γουρούνι σάς επιτρέπει να περιγράψετε μετασχηματισμοί που έχουν εφαρμοστεί τα δεδομένα εισόδου για την παραγωγή το επιθυμητό αποτέλεσμα.

Καμπύλη χρησιμοποιείται για να δείχνουν πώς μπορείτε να αλληλεπιδράσετε με HDInsight, χρησιμοποιώντας ανεπεξέργαστο αιτήσεις HTTP για να εκτελέσετε, παρακολούθηση και ανάκτησης των αποτελεσμάτων των εργασιών γουρούνι. Αυτό λειτουργεί, χρησιμοποιώντας το WebHCat REST API (παλαιότερα γνωστό ως Templeton) που παρέχεται από το σύμπλεγμά σας HDInsight.

> [AZURE.NOTE] Εάν είστε ήδη εξοικειωμένοι με τη χρήση των διακομιστών βάσει Linux Hadoop, αλλά είστε εξοικειωμένοι με το HDInsight, ανατρέξτε στο θέμα [Βάσει Linux συμβουλές HDInsight](hdinsight-hadoop-linux-information.md).

##<a id="prereq"></a>Προαπαιτούμενα στοιχεία

Για να ολοκληρώσετε τα βήματα σε αυτό το άρθρο, θα χρειαστείτε τα εξής:

* Ένα σύμπλεγμα Azure HDInsight (Hadoop σε HDInsight) (βάσει Linux ή βασίζεται στα Windows)

* [Καμπύλη](http://curl.haxx.se/)

* [jq](http://stedolan.github.io/jq/)

##<a id="curl"></a>Εκτέλεση εργασιών γουρούνι με τη χρήση καμπύλη

> [AZURE.NOTE] Όταν χρησιμοποιείτε καμπύλη ή οποιοδήποτε άλλο ΥΠΌΛΟΙΠΟ επικοινωνίας με WebHCat, πρέπει να τον έλεγχο ταυτότητας των αιτήσεων, παρέχοντας το όνομα χρήστη του διαχειριστή και τον κωδικό πρόσβασης για το σύμπλεγμα HDInsight. Μπορείτε, επίσης, πρέπει να χρησιμοποιήσετε το όνομα του συμπλέγματος ως μέρος της το ενιαίο αναγνωριστικό πόρου (URI) που χρησιμοποιείται για να στείλετε τις αιτήσεις στο διακομιστή.
>
> Για τις εντολές σε αυτήν την ενότητα, αντικαταστήστε το **όνομα ΧΡΉΣΤΗ** με το χρήστη για τον έλεγχο ταυτότητας στο σύμπλεγμα και αντικαταστήστε **τον κωδικό ΠΡΌΣΒΑΣΗΣ** με τον κωδικό πρόσβασης για το λογαριασμό χρήστη. Αντικαταστήστε **CLUSTERNAME** με το όνομα του συμπλέγματος.
>
> Το REST API προστατεύεται μέσω του [ελέγχου ταυτότητας βασικές πρόσβασης](http://en.wikipedia.org/wiki/Basic_access_authentication). Θα πρέπει να κάνετε πάντα αιτήσεις με τη χρήση ασφαλούς HTTP (HTTPS) για να εξασφαλίσετε ότι τα διαπιστευτήριά σας αποστέλλονται με ασφάλεια στο διακομιστή.

1. Από τη γραμμή εντολών, χρησιμοποιήστε την ακόλουθη εντολή για να επιβεβαιώσετε ότι μπορείτε να συνδεθείτε με το σύμπλεγμά σας HDInsight:

        curl -u USERNAME:PASSWORD -G https://CLUSTERNAME.azurehdinsight.net/templeton/v1/status

    Θα πρέπει να λαμβάνετε μια απάντηση παρόμοια με τα εξής:

        {"status":"ok","version":"v1"}

    Οι παράμετροι χρησιμοποιούνται σε αυτήν την εντολή είναι ως εξής:

    * **-u**: το όνομα χρήστη και κωδικό πρόσβασης που χρησιμοποιείται για τον έλεγχο ταυτότητας της αίτησης
    * **-G**: υποδεικνύει ότι αυτό είναι ένα αίτημα GET

    Αρχή της διεύθυνσης URL, **https://CLUSTERNAME.azurehdinsight.net/templeton/v1**, θα είναι το ίδιο για όλες τις αιτήσεις. Τη διαδρομή, **/status/status**, υποδεικνύει ότι η αίτηση είναι για να επαναφέρετε την κατάσταση της WebHCat (γνωστό και ως Templeton) για το διακομιστή.

2. Χρησιμοποιήστε τον ακόλουθο κώδικα για την υποβολή μιας εργασίας Λατινικά γουρούνι στο σύμπλεγμα:

        curl -u USERNAME:PASSWORD -d user.name=USERNAME -d execute="LOGS=LOAD+'wasbs:///example/data/sample.log';LEVELS=foreach+LOGS+generate+REGEX_EXTRACT($0,'(TRACE|DEBUG|INFO|WARN|ERROR|FATAL)',1)+as+LOGLEVEL;FILTEREDLEVELS=FILTER+LEVELS+by+LOGLEVEL+is+not+null;GROUPEDLEVELS=GROUP+FILTEREDLEVELS+by+LOGLEVEL;FREQUENCIES=foreach+GROUPEDLEVELS+generate+group+as+LOGLEVEL,COUNT(FILTEREDLEVELS.LOGLEVEL)+as+count;RESULT=order+FREQUENCIES+by+COUNT+desc;DUMP+RESULT;" -d statusdir="wasbs:///example/pigcurl" https://CLUSTERNAME.azurehdinsight.net/templeton/v1/pig

    Οι παράμετροι χρησιμοποιούνται σε αυτήν την εντολή είναι ως εξής:

    * **-d**: επειδή `-G` δεν χρησιμοποιείται, την αίτηση προεπιλογών για τη μέθοδο POST. `-d`Καθορίζει τις τιμές των δεδομένων που έχουν αποσταλεί με την αίτηση.

        * **User.Name**: Ο χρήστης που εκτελεί την εντολή
        * **Εκτέλεση**: το γουρούνι Λατινικά προτάσεων για εκτέλεση
        * **statusdir**: Ο κατάλογος που θα εγγραφούν την κατάσταση για αυτό το έργο

    > [AZURE.NOTE] Παρατηρήστε ότι τα κενά διαστήματα στο δηλώσεις Λατινικά γουρούνι αντικαθίστανται από το `+` χαρακτήρας όταν χρησιμοποιείται με καμπύλη.

    Αυτή η εντολή πρέπει να επιστρέψει ένα Αναγνωριστικό εργασίας που μπορούν να χρησιμοποιηθούν για να ελέγξετε την κατάσταση της εργασίας, για παράδειγμα:

        {"id":"job_1415651640909_0026"}

3. Για να ελέγξετε την κατάσταση της εργασίας, χρησιμοποιήστε την ακόλουθη εντολή. Αντικαταστήστε **JOBID** με την τιμή που επιστρέφεται στο προηγούμενο βήμα. Για παράδειγμα, εάν η τιμή επιστροφής ήταν `{"id":"job_1415651640909_0026"}`, στη συνέχεια, θα ήταν **JOBID** `job_1415651640909_0026`.

        curl -G -u USERNAME:PASSWORD -d user.name=USERNAME https://CLUSTERNAME.azurehdinsight.net/templeton/v1/jobs/JOBID | jq .status.state

    Εάν η εργασία έχει ολοκληρωθεί, η κατάσταση θα **ολοκληρώθηκε με**.

    > [AZURE.NOTE] Αυτή η αίτηση καμπύλη επιστρέφει ένα έγγραφο σημειογραφίας αντικειμένων JavaScript (JSON) με πληροφορίες σχετικά με την εργασία και jq χρησιμοποιείται για να ανακτήσετε μόνο την τιμή κατάσταση.

##<a id="results"></a>Προβολή αποτελεσμάτων

Όταν η κατάσταση της εργασίας έχει αλλάξει **ολοκληρώθηκε με**, μπορείτε να ανακτήσετε τα αποτελέσματα της εργασίας από το χώρο αποθήκευσης αντικειμένων Blob του Azure. Το `statusdir` παράμετρος που μεταβιβάστηκε με το ερώτημα περιέχει στη θέση του το αρχείο εξόδου. σε αυτήν την περίπτωση, **wasbs: / / / παράδειγμα/pigcurl**. Αυτή η διεύθυνση αποθηκεύει το αποτέλεσμα του έργου στον κατάλογο **παράδειγμα/pigcurl** στην το προεπιλεγμένο κοντέινερ χώρου αποθήκευσης που χρησιμοποιείται από το σύμπλεγμά σας HDInsight.

Μπορείτε να λίστα και να κάνετε λήψη αυτών των αρχείων, χρησιμοποιώντας το [Azure CLI](../xplat-cli-install.md). Για παράδειγμα, σε λίστα αρχεία στο **παράδειγμα/pigcurl**, χρησιμοποιήστε την ακόλουθη εντολή:

    azure storage blob list <container-name> example/pigcurl

Για να κάνετε λήψη ενός αρχείου, χρησιμοποιήστε τα εξής:

    azure storage blob download <container-name> <blob-name> <destination-file>

> [AZURE.NOTE] Πρέπει να καθορίσετε το όνομα του λογαριασμού χώρου αποθήκευσης που περιέχει το αντικείμενο blob, χρησιμοποιώντας το `-a` και `-k` παράμετροι ή ρύθμιση του **AZURE\_χώρου ΑΠΟΘΉΚΕΥΣΗΣ\_ΛΟΓΑΡΙΑΣΜΟΎ** και **AZURE\_χώρου ΑΠΟΘΉΚΕΥΣΗΣ\_ACCESS\_αριθμού-ΚΛΕΙΔΙΟΎ** μεταβλητές περιβάλλοντος.

##<a id="summary"></a>Σύνοψη

Όπως φαίνεται σε αυτό το έγγραφο, μπορείτε να χρησιμοποιήσετε μια αίτηση HTTP ανεπεξέργαστα για εκτέλεση, παρακολούθηση και προβολή των αποτελεσμάτων των εργασιών γουρούνι στην το σύμπλεγμά σας HDInsight.

Για περισσότερες πληροφορίες σχετικά με το περιβάλλον εργασίας ΥΠΌΛΟΙΠΟ που χρησιμοποιούνται σε αυτό το άρθρο, ανατρέξτε στο άρθρο [Αναφορά WebHCat](https://cwiki.apache.org/confluence/display/Hive/WebHCat+Reference).

##<a id="nextsteps"></a>Επόμενα βήματα

Για γενικές πληροφορίες σχετικά με γουρούνι στο HDInsight:

* [Χρήση γουρούνι με Hadoop σε HDInsight](hdinsight-use-pig.md)

Για πληροφορίες σχετικά με άλλους τρόπους μπορείτε να εργαστείτε με Hadoop σε HDInsight:

* [Χρήση της ομάδας με Hadoop σε HDInsight](hdinsight-use-hive.md)

* [Χρήση MapReduce με Hadoop σε HDInsight](hdinsight-use-mapreduce.md)

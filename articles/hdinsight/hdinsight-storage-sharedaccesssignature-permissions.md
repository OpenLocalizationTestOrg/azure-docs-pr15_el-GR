<properties
pageTitle="Περιορισμός πρόσβασης HDInsight δεδομένων με τη χρήση υπογραφών πρόσβασης σε κοινή χρήση"
description="Μάθετε πώς μπορείτε να χρησιμοποιήσετε κοινόχρηστα υπογραφές πρόσβασης για να περιορίσετε την HDInsight πρόσβαση σε δεδομένα που είναι αποθηκευμένα στο Azure χώρο αποθήκευσης αντικειμένων blob."
services="hdinsight"
documentationCenter=""
authors="Blackmist"
manager="jhubbard"
editor="cgronlun"/>

<tags
ms.service="hdinsight"
ms.devlang="na"
ms.topic="article"
ms.tgt_pltfrm="na"
ms.workload="big-data"
ms.date="10/11/2016"
ms.author="larryfr"/>

#<a name="use-azure-storage-shared-access-signatures-to-restrict-access-to-data-with-hdinsight"></a>Χρήση υπογραφών σε κοινή χρήση πρόσβασης του Azure χώρου αποθήκευσης για να περιορίσετε την πρόσβαση σε δεδομένα με HDInsight

HDInsight χρησιμοποιεί Azure χώρο αποθήκευσης αντικειμένων blob για την αποθήκευση δεδομένων. Ενώ HDInsight πρέπει να έχετε πλήρη πρόσβαση στις το αντικείμενο blob χρησιμοποιείται ως προεπιλεγμένο αποθήκευσης για το σύμπλεγμα, μπορείτε να περιορίσετε τα δικαιώματα για δεδομένα που είναι αποθηκευμένα σε άλλα αντικείμενα BLOB που χρησιμοποιούνται από το σύμπλεγμα. Για παράδειγμα, μπορεί να θέλετε να κάνετε ορισμένα δεδομένα μόνο για ανάγνωση. Μπορείτε να το κάνετε χρήση υπογραφών πρόσβασης σε κοινή χρήση.

Συσχετίσεις κοινόχρηστο Access υπογραφές (Ασφαλείας) είναι μια δυνατότητα λογαριασμών Azure χώρου αποθήκευσης που σας επιτρέπει να περιορίσετε την πρόσβαση σε δεδομένα. Για παράδειγμα, παρέχοντας πρόσβαση μόνο για ανάγνωση στα δεδομένα. Σε αυτό το έγγραφο, θα μάθετε πώς μπορείτε να χρησιμοποιήσετε συσχετισμών Ασφαλείας για να ενεργοποιήσετε την πρόσβαση μόνο για λίστα ανάγνωσης και σε ένα κοντέινερ αντικειμένων blob από το HDInsight.

##<a name="requirements"></a>Απαιτήσεις

* Μια συνδρομή του Azure

* C# ή Python. Παράδειγμα κώδικα C# παρέχεται ως λύση Visual Studio.

    * Visual Studio πρέπει να είναι έκδοσης 2013 ή του 2015
    
    * Python πρέπει να είναι έκδοσης 2.7 ή νεότερη έκδοση

* Μια HDInsight βάσει Linux συμπλέγματος ή [Azure PowerShell] [ powershell] -εάν έχετε ένα υπάρχον σύμπλεγμα βάσει Linux, μπορείτε να χρησιμοποιήσετε Ambari για να προσθέσετε μια υπογραφή πρόσβασης σε κοινή χρήση στο σύμπλεγμα. Εάν όχι, μπορείτε να χρησιμοποιήσετε Azure PowerShell για να δημιουργήσετε ένα νέο σύμπλεγμα και προσθήκη υπογραφής σε κοινή χρήση πρόσβασης κατά τη δημιουργία συμπλέγματος.

* Τα αρχεία παράδειγμα από [https://github.com/Azure-Samples/hdinsight-dotnet-python-azure-storage-shared-access-signature](https://github.com/Azure-Samples/hdinsight-dotnet-python-azure-storage-shared-access-signature). Αυτό το αποθετήριο δεδομένων περιλαμβάνει τα εξής:

    * Ένα έργο Visual Studio που μπορεί να δημιουργήσει ένα κοντέινερ χώρου αποθήκευσης, αποθηκευμένες πολιτικής και συσχετισμούς Ασφαλείας για χρήση με το HDInsight
    
    * Μια δέσμη ενεργειών Python που μπορεί να δημιουργήσει ένα κοντέινερ χώρου αποθήκευσης, αποθηκευμένες πολιτικής και συσχετισμούς Ασφαλείας για χρήση με το HDInsight
    
    * Μια δέσμη ενεργειών του PowerShell που να δημιουργήσετε ένα νέο σύμπλεγμα HDInsight και ρυθμίστε τις παραμέτρους του για να χρησιμοποιήσετε τις συσχετίσεις Ασφαλείας.

##<a name="shared-access-signatures"></a>Κοινόχρηστη πρόσβαση υπογραφών

Υπάρχουν δύο μορφές θέσει σε κοινή χρήση υπογραφών Access:

* Ad hoc: την ώρα έναρξης, η ώρα λήξης και δικαιώματα για τους συσχετισμούς Ασφαλείας είναι όλα καθορισμένο στο URI συσχετισμών Ασφαλείας (ή σιωπηρή, στην περίπτωση όπου παραλείπεται το όρισμα ώρα έναρξης).

* Αποθηκευμένα πολιτική πρόσβασης: μια πολιτική αποθηκευμένες πρόσβασης έχει οριστεί σε ένα κοντέινερ πόρων - blob κοντέινερ, πίνακα, ουρά ή κοινή χρήση αρχείου - και μπορεί να χρησιμοποιηθεί για τη Διαχείριση περιορισμούς για μία ή περισσότερες υπογραφές κοινόχρηστη πρόσβαση. Όταν μπορείτε να συσχετίσετε ένα συσχετισμών Ασφαλείας με μια πολιτική αποθηκευμένες πρόσβασης, τις συσχετίσεις Ασφαλείας μεταβιβάζονται τους περιορισμούς - την ώρα έναρξης, η ώρα λήξης και - ορισμός δικαιωμάτων για την πολιτική αποθηκευμένες πρόσβασης.

Η διαφορά μεταξύ των δύο φορμών είναι σημαντικό για ένα σενάριο κλειδιού: ανάκλησης. Μια συσχετισμών Ασφαλείας είναι μια διεύθυνση URL, ώστε όλα τα άτομα που λαμβάνει τις συσχετίσεις Ασφαλείας να το χρησιμοποιήσετε, ανεξάρτητα από το που ζητήθηκε να. Εάν μια συσχετισμών Ασφαλείας δημοσιεύεται στο κοινό, μπορεί να χρησιμοποιηθεί από οποιονδήποτε χρήστη στον κόσμο. Μια συσχετισμών Ασφαλείας που έχει διανεμηθεί από είναι έγκυρη μέχρι να συμβαίνει ένα από τα τέσσερα στοιχεία:

1. Την ώρα λήξης που καθορίζεται στη τις συσχετίσεις Ασφαλείας έχει φτάσει.

2. Την ώρα λήξης που καθορίζεται στην πολιτική αποθηκευμένες πρόσβασης στα οποία γίνεται αναφορά από τις συσχετίσεις Ασφαλείας έχει φτάσει (Εάν μια πολιτική αποθηκευμένες πρόσβασης γίνεται αναφορά και εάν καθορίζει μια ώρα λήξης). Αυτό μπορεί να συμβεί είτε επειδή περάσει το διάστημα, είτε επειδή έχετε τροποποιήσει την πολιτική αποθηκευμένες πρόσβασης για να έχετε μια ώρα λήξης στο παρελθόν, η οποία είναι ένας τρόπος για να ανακαλέσετε τις συσχετίσεις Ασφαλείας.

3. Η πολιτική αποθηκευμένες πρόσβασης στα οποία γίνεται αναφορά από τις συσχετίσεις Ασφαλείας διαγράφεται, που είναι ένας άλλος τρόπος για να ανακαλέσετε τις συσχετίσεις Ασφαλείας. Σημειώστε ότι, αν αναδημιουργήσετε την πολιτική αποθηκευμένες πρόσβασης με ακριβώς το ίδιο όνομα, όλα τα διακριτικά υπάρχοντα συσχετισμών Ασφαλείας θα ξανά είναι έγκυρη σύμφωνα με τα δικαιώματα που σχετίζονται με αυτό πολιτική αποθηκευμένες πρόσβασης (αν υποθέσουμε ότι που το χρόνο λήξης στην τις συσχετίσεις Ασφαλείας δεν έχει περάσει). Εάν σκοπεύετε να ανακαλέσετε τις συσχετίσεις Ασφαλείας, φροντίστε να χρησιμοποιήσετε ένα διαφορετικό όνομα εάν αναδημιουργήσει στην πολιτική πρόσβασης με μια ώρα λήξης στο μέλλον.

4. Το κλειδί λογαριασμού που χρησιμοποιήθηκε για να δημιουργήσετε τις συσχετίσεις Ασφαλείας αναδημιουργείται. Σημειώστε ότι αυτή η ενέργεια θα προκαλέσει όλα τα στοιχεία εφαρμογής χρησιμοποιώντας αυτό το κλειδί λογαριασμού αποτυχία για τον έλεγχο ταυτότητας μέχρι την ενημέρωσή τους για να χρησιμοποιήσετε το άλλο πλήκτρο έγκυρο λογαριασμό ή το κλειδί που μόλις έχει δημιουργηθεί ξανά το λογαριασμό.

> [AZURE.IMPORTANT] Μια υπογραφή κοινόχρηστη πρόσβαση URI είναι συσχετισμένη με το κλειδί λογαριασμού που χρησιμοποιούνται για τη δημιουργία της υπογραφής και συσχετισμένου αποθηκεύονται πολιτική πρόσβασης (εάν υπάρχουν). Εάν δεν υπάρχει πολιτική αποθηκευμένες πρόσβασης έχει οριστεί, είναι ο μόνος τρόπος για να ανακαλέσετε μια υπογραφή κοινόχρηστη πρόσβαση για να αλλάξετε τον αριθμό-κλειδί λογαριασμού. 

Συνιστάται να πάντα χρησιμοποιήσετε πολιτικές πρόσβασης αποθηκευμένες, ώστε να μπορείτε να ανακαλέσετε υπογραφές ή να επεκτείνετε την ημερομηνία λήξης, όπως απαιτείται. Τα βήματα σε αυτό το έγγραφο, χρησιμοποιήστε αποθηκεύονται πολιτικές πρόσβασης για τη δημιουργία συσχετισμών Ασφαλείας.

Για περισσότερες πληροφορίες σχετικά με την κοινή χρήση υπογραφών πρόσβασης, ανατρέξτε στο θέμα [Κατανόηση του μοντέλου συσχετισμών Ασφαλείας](../storage/storage-dotnet-shared-access-signature-part-1.md).

##<a name="create-a-stored-policy-and-generate-a-sas"></a>Δημιουργία πολιτικής αποθηκευμένες και δημιουργούν ένα συσχετισμών Ασφαλείας

Προς το παρόν πρέπει να δημιουργήσετε μια αποθηκευμένη πολιτική μέσω προγραμματισμού. Μπορείτε να βρείτε τα C# και τη δημιουργία μιας αποθηκευμένης πολιτικής και συσχετισμούς Ασφαλείας σε [https://github.com/Azure-Samples/hdinsight-dotnet-python-azure-storage-shared-access-signature](https://github.com/Azure-Samples/hdinsight-dotnet-python-azure-storage-shared-access-signature)παράδειγμα Python.

###<a name="create-a-stored-policy-and-sas-using-c"></a>Δημιουργία μιας αποθηκευμένης πολιτικής και συσχετισμούς Ασφαλείας χρησιμοποιώντας C\#

1. Άνοιγμα της λύσης στο Visual Studio.

2. Στην Εξερεύνηση λύσεων, κάντε δεξί κλικ στο έργο __SASToken__ και επιλέξτε __Ιδιότητες__.

3. Επιλέξτε __Ρυθμίσεις__ και να προσθέσετε τιμές για τις ακόλουθες καταχωρήσεις:

    * StorageConnectionString: Τη συμβολοσειρά σύνδεσης για το λογαριασμό χώρου αποθήκευσης που θέλετε να δημιουργήσετε μια αποθηκευμένη πολιτικής και συσχετισμούς Ασφαλείας για. Θα πρέπει να είναι η μορφή `DefaultEndpointsProtocol=https;AccountName=myaccount;AccountKey=mykey` όπου `myaccount` είναι το όνομα του λογαριασμού σας χώρου αποθήκευσης και `mykey` είναι το κλειδί για το λογαριασμό χώρου αποθήκευσης.
    
    * ContainerName: Το κοντέινερ στο χώρο αποθήκευσης στο λογαριασμό που θέλετε να περιορίσετε την πρόσβαση σε.
    
    * SASPolicyName: Το όνομα που θα χρησιμοποιηθεί για την αποθηκευμένη πολιτική που θα δημιουργηθεί.
    
    * FileToUpload: Η διαδρομή προς ένα αρχείο που θα αποσταλεί στο κοντέινερ.
    
4. Εκτελέστε το έργο. Θα εμφανιστεί ένα παράθυρο κονσόλας και θα εμφανίζονται πληροφορίες που είναι παρόμοιο με το ακόλουθο αφού έχει δημιουργηθεί τις συσχετίσεις Ασφαλείας:

        Container SAS token using stored access policy: sr=c&si=policyname&sig=dOAi8CXuz5Fm15EjRUu5dHlOzYNtcK3Afp1xqxniEps%3D&sv=2014-02-14
        
    Αποθηκεύστε το διακριτικό πολιτικής συσχετισμών Ασφαλείας, όπως θα χρειαστεί αυτό όταν συσχετίζοντας το λογαριασμό χώρου αποθήκευσης με το σύμπλεγμά σας HDInsight. Θα πρέπει επίσης το όνομα του λογαριασμού χώρου αποθήκευσης και το όνομα του κοντέινερ.
    
###<a name="create-a-stored-policy-and-sas-using-python"></a>Δημιουργία πολιτικής αποθηκευμένες και χρησιμοποιώντας Python συσχετισμών Ασφαλείας

1. Ανοίξτε το αρχείο SASToken.py και αλλάξτε τις ακόλουθες τιμές:

    * πολιτική\_όνομα: το όνομα που θα χρησιμοποιηθεί για την αποθηκευμένη πολιτική που θα δημιουργηθεί.
    
    * χώρος αποθήκευσης\_λογαριασμού\_όνομα: το όνομα του λογαριασμού χώρου αποθήκευσης.
    
    * χώρος αποθήκευσης\_λογαριασμού\_κλειδί: το κλειδί για το λογαριασμό χώρου αποθήκευσης.
    
    * χώρος αποθήκευσης\_κοντέινερ\_όνομα: το κοντέινερ στο χώρο αποθήκευσης στο λογαριασμό που θέλετε να περιορίσετε την πρόσβαση σε.
    
    * παράδειγμα\_αρχείο\_διαδρομή: τη διαδρομή προς ένα αρχείο που θα αποσταλεί στο κοντέινερ

2. Εκτελέστε τη δέσμη ενεργειών. Όταν ολοκληρωθεί η δέσμη ενεργειών θα εμφανίσει το διακριτικό συσχετισμών Ασφαλείας παρόμοιο με το εξής:

        sr=c&si=policyname&sig=dOAi8CXuz5Fm15EjRUu5dHlOzYNtcK3Afp1xqxniEps%3D&sv=2014-02-14
    
    Αποθηκεύστε το διακριτικό πολιτικής συσχετισμών Ασφαλείας, όπως θα χρειαστεί αυτό όταν συσχετίζοντας το λογαριασμό χώρου αποθήκευσης με το σύμπλεγμά σας HDInsight. Θα πρέπει επίσης το όνομα του λογαριασμού χώρου αποθήκευσης και το όνομα του κοντέινερ.
    
##<a name="use-the-sas-with-hdinsight"></a>Χρησιμοποιήστε τις συσχετίσεις Ασφαλείας με HDInsight

Όταν δημιουργείτε ένα σύμπλεγμα HDInsight, πρέπει να καθορίσετε ένα λογαριασμό πρωτεύοντος χώρου αποθήκευσης και μπορείτε προαιρετικά να καθορίσετε τους λογαριασμούς επιπλέον χώρο αποθήκευσης. Και τα δύο από τις παρακάτω μεθόδους προσθήκης χώρου αποθήκευσης απαιτούν πλήρη πρόσβαση στους λογαριασμούς χώρου αποθήκευσης και κοντέινερ που χρησιμοποιούνται.

Για να χρησιμοποιήσετε μια υπογραφή πρόσβασης σε κοινή χρήση για να περιορίσετε την πρόσβαση σε ένα κοντέινερ, πρέπει να προσθέσετε μια προσαρμοσμένη καταχώρηση στη ρύθμιση παραμέτρων __πυρήνα τοποθεσίας__ για το σύμπλεγμα.

* Για συμπλεγμάτων που __βασίζεται σε Windows__ ή __Linux βάσει__ HDInsight, μπορείτε να κάνετε αυτό κατά τη δημιουργία συμπλέγματος με χρήση του PowerShell.

* Για __βάσει Linux__ συμπλεγμάτων HDInsight, μπορείτε να αλλάξετε τη ρύθμιση παραμέτρων μετά τη δημιουργία συμπλέγματος χρησιμοποιώντας Ambari.

###<a name="create-a-new-cluster-that-uses-the-sas"></a>Δημιουργήστε ένα νέο σύμπλεγμα που χρησιμοποιεί τις συσχετίσεις Ασφαλείας

Ένα παράδειγμα της δημιουργίας ένα σύμπλεγμα HDInsight που χρησιμοποιεί τις συσχετίσεις Ασφαλείας συμπεριλαμβάνεται στο το `CreateCluster` καταλόγου του αποθετηρίου. Για να το χρησιμοποιήσετε, χρησιμοποιήστε τα παρακάτω βήματα:

1. Άνοιγμα του `CreateCluster\HDInsightSAS.ps1` αρχείου σε έναν επεξεργαστή κειμένου και τροποποιήστε τις παρακάτω τιμές στην αρχή του εγγράφου.

        # Replace 'mycluster' with the name of the cluster to be created
        $clusterName = 'mycluster'
        # Valid values are 'Linux' and 'Windows'
        $osType = 'Linux'
        # Replace 'myresourcegroup' with the name of the group to be created
        $resourceGroupName = 'myresourcegroup'
        # Replace with the Azure data center you want to the cluster to live in
        $location = 'North Europe'
        # Replace with the name of the default storage account to be created
        $defaultStorageAccountName = 'mystorageaccount'
        # Replace with the name of the SAS container created earlier
        $SASContainerName = 'sascontainer'
        # Replace with the name of the SAS storage account created earlier
        $SASStorageAccountName = 'sasaccount'
        # Replace with the SAS token generated earlier
        $SASToken = 'sastoken'
        # Set the number of worker nodes in the cluster
        $clusterSizeInNodes = 2
        
    Για παράδειγμα, να αλλάξετε `'mycluster'` στο όνομα του συμπλέγματος που θέλετε να δημιουργήσετε. Οι τιμές συσχετισμών Ασφαλείας θα πρέπει να ταιριάζουν με τις τιμές από τα προηγούμενα βήματα κατά τη δημιουργία ενός λογαριασμού χώρου αποθήκευσης και το διακριτικό συσχετισμών Ασφαλείας.
    
    Αφού έχετε αλλάξει τις τιμές, αποθηκεύστε το αρχείο.

1. Ανοίξτε ένα νέο μήνυμα Azure PowerShell. Εάν είστε εξοικειωμένοι με το Azure PowerShell, ή δεν έχετε εγκαταστήσει, ανατρέξτε στο θέμα [εγκατάσταση και ρύθμιση παραμέτρων του PowerShell Azure][powershell].

2. Από τη γραμμή εντολών, χρησιμοποιήστε τα ακόλουθα για τον έλεγχο ταυτότητας Azure τη συνδρομή σας:

        Login-AzureRmAccount
    
    Όταν σας ζητηθεί, συνδεθείτε με το λογαριασμό για τη συνδρομή σας Azure.
    
    Εάν η σύνδεσή σας είναι συσχετισμένη με πολλές συνδρομές Azure, ίσως χρειαστεί να χρησιμοποιήσετε `Select-AzureRmSubscription` για να επιλέξετε τη συνδρομή που θέλετε να χρησιμοποιήσετε.

2. Από τη γραμμή εντολών, αλλάξτε τον κατάλογο για να το `CreateCluster` καταλόγου που περιέχει το αρχείο HDInsightSAS.ps1. Στη συνέχεια, χρησιμοποιήστε τα ακόλουθα για να εκτελέσετε τη δέσμη ενεργειών
        
        .\HDInsightSAS.ps1
    
    Καθώς η δέσμη ενεργειών εκτελείται, θα καταγράψει εξόδου στη γραμμή εντολών του PowerShell όπως που δημιουργεί ο πόρος λογαριασμούς ομάδας και χώρου αποθήκευσης. Αυτό θα, στη συνέχεια, σας ζητηθεί να εισαγάγετε το HTTP χρήστη για το σύμπλεγμα HDInsight. Αυτός είναι ο λογαριασμός χρήστη που χρησιμοποιείται για την ασφαλή πρόσβαση HTTP/s σε σύμπλεγμα.
    
    Εάν θέλετε να δημιουργήσετε ένα σύμπλεγμα βάσει Linux, επίσης θα σας ζητηθεί για ένα όνομα λογαριασμού χρήστη SSH και τον κωδικό πρόσβασης. Χρησιμοποιείται σε απομακρυσμένα σύνδεση στο σύμπλεγμα.
    
    > [AZURE.IMPORTANT] Όταν σας ζητηθεί για το HTTP/s ή SSH όνομα χρήστη και κωδικό πρόσβασης, πρέπει να δώσετε έναν κωδικό πρόσβασης που ικανοποιεί τα ακόλουθα κριτήρια:
    >
    > - Πρέπει να έχει μήκος τουλάχιστον 10 χαρακτήρες
    > - Πρέπει να περιέχει τουλάχιστον ένα ψηφίο
    > - Πρέπει να περιέχει τουλάχιστον μία μη αλφαριθμητικό χαρακτήρα
    > - Πρέπει να περιέχει τουλάχιστον μία επάνω ή κάτω κεφαλαίο γράμμα


Θα χρειαστεί κάποιος χρόνος για αυτήν τη δέσμη ενεργειών για να ολοκληρώσετε, συνήθως είναι περίπου 15 λεπτά. Όταν ολοκληρωθεί η δέσμη ενεργειών χωρίς σφάλματα, αφού δημιουργηθεί το σύμπλεγμα.

###<a name="update-an-existing-cluster-to-use-the-sas"></a>Ενημερώστε ένα υπάρχον σύμπλεγμα για να χρησιμοποιήσετε τις συσχετίσεις Ασφαλείας

Εάν έχετε ένα υπάρχον σύμπλεγμα βάσει Linux, μπορείτε να προσθέσετε τις συσχετίσεις Ασφαλείας στη ρύθμιση παραμέτρων __πυρήνα τοποθεσίας__ , χρησιμοποιώντας τα ακόλουθα βήματα:

1. Ανοίξτε το web Ambari περιβάλλοντος εργασίας Χρήστη για το σύμπλεγμά σας. Η διεύθυνση για αυτήν τη σελίδα είναι https://YOURCLUSTERNAME.azurehdinsight.net. Όταν σας ζητηθεί, τον έλεγχο ταυτότητας στο σύμπλεγμα χρησιμοποιώντας το όνομα διαχειριστή (διαχειριστές) και τον κωδικό πρόσβασης που χρησιμοποιήσατε κατά τη δημιουργία του συμπλέγματος.

2. Από την αριστερή πλευρά της τοποθεσίας web Ambari περιβάλλοντος εργασίας Χρήστη, επιλέξτε __HDFS__ και, στη συνέχεια, επιλέξτε την καρτέλα __διαμορφώσεων__ στο μέσο της σελίδας.

3. Επιλέξτε την καρτέλα __για προχωρημένους__ και, στη συνέχεια, κάντε κύλιση μέχρι να βρείτε την ενότητα __προσαρμοσμένο μέγεθος των κύριων-τοποθεσία__ .

4. Αναπτύξτε την ενότητα __προσαρμοσμένο μέγεθος των κύριων-τοποθεσίας__ , στη συνέχεια, κάντε κύλιση στο τέλος και επιλέξτε τη σύνδεση __Προσθήκη ιδιοτήτων...__ . Χρησιμοποιήστε τις παρακάτω τιμές για τα πεδία __κλειδί__ και __τιμή__ :

    * __Πλήκτρο__: fs.azure.sas.CONTAINERNAME.STORAGEACCOUNTNAME.blob.core.windows.net
    
    * __Τιμή__: το συσχετισμών Ασφαλείας που επιστρέφονται από την εφαρμογή C# ή Python εκτελέσατε προηγουμένως
    
    Αντικατάσταση __CONTAINERNAME__ με το όνομα του κοντέινερ που χρησιμοποιούνται με το C# ή εφαρμογή συσχετισμών Ασφαλείας. Αντικαταστήστε __STORAGEACCOUNTNAME__ με το όνομα του λογαριασμού χώρου αποθήκευσης που χρησιμοποιήσατε.

5. Κάντε κλικ στο κουμπί __Προσθήκη__ για να αποθηκεύσετε αυτό το κλειδί και τιμή και, στη συνέχεια, κάντε κλικ στο κουμπί __Αποθήκευση__ για να αποθηκεύσετε τις αλλαγές ρύθμισης παραμέτρων. Όταν σας ζητηθεί, προσθέστε μια περιγραφή για την αλλαγή ("Προσθήκη συσχετισμών Ασφαλείας αποθήκευσης access" για παράδειγμα) και, στη συνέχεια, κάντε κλικ στην επιλογή __Αποθήκευση__.

    Όταν τις αλλαγές που έχουν ολοκληρωθεί, κάντε κλικ στο __κουμπί OK__ .

    > [AZURE.IMPORTANT] Αυτό αποθηκεύει τις αλλαγές ρύθμισης παραμέτρων, αλλά η αλλαγή τίθεται σε ισχύ, πρέπει να επανεκκινήσετε διάφορες υπηρεσίες.

6. Στην τοποθεσία web Ambari περιβάλλοντος εργασίας Χρήστη, επιλέξτε __HDFS__ από τη λίστα στα αριστερά και, στη συνέχεια, επιλέξτε __Επανεκκινήστε όλα__ από την __Υπηρεσία ενέργειες__ αναπτυσσόμενη λίστα στα δεξιά. Όταν σας ζητηθεί, επιλέξτε __Ενεργοποίηση λειτουργίας συντήρηση__ και, στη συνέχεια, επιλέξτε __Conform επανεκκινήστε όλα".

    Επαναλάβετε αυτήν τη διαδικασία για τις καταχωρήσεις MapReduce2 και ΝΉΜΑΤΑ από τη λίστα στην αριστερή πλευρά της σελίδας.

7. Μόλις αυτές έχουν επανεκκίνηση του, επιλέξτε κάθε μία και απενεργοποίηση της λειτουργίας συντήρησης από τις __Ενέργειες υπηρεσίας__ αναπτυσσόμενη λίστα.

##<a name="test-restricted-access"></a>Δοκιμή περιορισμένης πρόσβασης

Για να επαληθεύσετε ότι έχουν περιορισμένη πρόσβαση, χρησιμοποιήστε τις ακόλουθες μεθόδους:

* Για συμπλεγμάτων HDInsight που __βασίζεται στα Windows__ , χρησιμοποιήστε απομακρυσμένης επιφάνειας εργασίας για να συνδεθείτε με το σύμπλεγμα. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Connecto με χρήση RDP HDInsight](hdinsight-administer-use-management-portal.md#connect-to-clusters-using-rdp) .

    Μόλις συνδεθεί, χρησιμοποιήστε το εικονίδιο __γραμμής εντολών Hadoop__ στην επιφάνεια εργασίας, για να ανοίξετε μια γραμμή εντολών.

* Για __βάσει Linux__ συμπλεγμάτων HDInsight, χρησιμοποιήστε SSH για να συνδεθείτε με το σύμπλεγμα. Δείτε ένα από τα εξής για πληροφορίες σχετικά με τη χρήση SSH με Linux βάσει συμπλεγμάτων:

    * [Χρήση SSH με βάσει Linux Hadoop σε HDInsight από Linux, το λειτουργικό σύστημα OS X και Unix](hdinsight-hadoop-linux-use-ssh-unix.md)
    * [Χρήση SSH με βάσει Linux Hadoop σε HDInsight από το Windows](hdinsight-hadoop-linux-use-ssh-windows.md)
    
Μετά τη σύνδεση στο σύμπλεγμα, χρησιμοποιήστε τα ακόλουθα βήματα για να επαληθεύσετε ότι μπορείτε να κάνετε μόνο ανάγνωση και λίστα στοιχείων του λογαριασμού χώρου αποθήκευσης συσχετισμών Ασφαλείας:

1. Από τη γραμμή εντολών, πληκτρολογήστε τα εξής. Αντικατάσταση __SASCONTAINER__ με το όνομα του κοντέινερ δημιουργήθηκε για το λογαριασμό χώρου αποθήκευσης συσχετισμών Ασφαλείας. Αντικαταστήστε το __SASACCOUNTNAME__ με το όνομα του λογαριασμού χώρου αποθήκευσης που χρησιμοποιείται για την συσχετισμούς Ασφαλείας:

        hdfs dfs -ls wasbs://SASCONTAINER@SASACCOUNTNAME.blob.core.windows.net/
    
    Αυτό θα εμφανιστούν τα περιεχόμενα από το κοντέινερ, η οποία πρέπει να περιλαμβάνουν το αρχείο που έχει αποσταλεί κατά την οποία δημιουργήθηκε η κοντέινερ και συσχετισμούς Ασφαλείας.
    
2. Χρησιμοποιήστε τα ακόλουθα για να επιβεβαιώσετε ότι μπορείτε να διαβάσετε τα περιεχόμενα του αρχείου. Αντικαταστήστε το __SASCONTAINER__ και __SASACCOUNTNAME__ όπως στο προηγούμενο βήμα. Αντικαταστήστε το __όνομα του ΑΡΧΕΊΟΥ__ με το όνομα του αρχείου εμφανίζεται στην προηγούμενη εντολή:

        hdfs dfs -text wasbs://SASCONTAINER@SASACCOUNTNAME.blob.core.windows.net/FILENAME
        
    Αυτό θα εμφανιστούν τα περιεχόμενα του αρχείου.
    
3. Χρησιμοποιήστε τα ακόλουθα για να κάνετε λήψη του αρχείου για το τοπικό σύστημα αρχείων:

        hdfs dfs -get wasbs://SASCONTAINER@SASACCOUNTNAME.blob.core.windows.net/FILENAME testfile.txt
    
    Αυτό θα κάνει λήψη του αρχείου σε ένα τοπικό αρχείο με το όνομα __testfile.txt__.

4. Χρησιμοποιήστε τα ακόλουθα για να αποστείλετε το τοπικό αρχείο σε ένα νέο αρχείο με το όνομα __testupload.txt__ στον χώρο αποθήκευσης συσχετισμών Ασφαλείας:

        hdfs dfs -put testfile.txt wasbs://SASCONTAINER@SASACCOUNTNAME.blob.core.windows.net/testupload.txt
    
    Θα λάβετε ένα μήνυμα παρόμοιο με το εξής:
    
        put: java.io.IOException
        
    Αυτό το σφάλμα παρουσιάζεται επειδή η θέση αποθήκευσης είναι ανάγνωσης + λίστα μόνο. Χρησιμοποιήστε τα ακόλουθα για να τοποθετήσετε τα δεδομένα στον προεπιλεγμένο χώρο αποθήκευσης για το σύμπλεγμα, η οποία είναι μόνο για ανάγνωση:
    
        hdfs dfs -put testfile.txt wasbs:///testupload.txt
        
    Αυτήν τη στιγμή, η λειτουργία πρέπει να ολοκληρωθεί με επιτυχία.
    
##<a name="troubleshooting"></a>Αντιμετώπιση προβλημάτων

###<a name="a-task-was-canceled"></a>Ακυρώθηκε μια εργασία

__Συμπτώματα__: Όταν δημιουργείτε ένα σύμπλεγμα χρησιμοποιώντας τη δέσμη ενεργειών PowerShell, που μπορεί να λάβετε το ακόλουθο μήνυμα σφάλματος:

    New-AzureRmHDInsightCluster : A task was canceled.
    At C:\Users\larryfr\Documents\GitHub\hdinsight-azure-storage-sas\CreateCluster\HDInsightSAS.ps1:62 char:5
    +     New-AzureRmHDInsightCluster `
    +     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        + CategoryInfo          : NotSpecified: (:) [New-AzureRmHDInsightCluster], CloudException
        + FullyQualifiedErrorId : Hyak.Common.CloudException,Microsoft.Azure.Commands.HDInsight.NewAzureHDInsightClusterCommand

__Αιτία__: αυτό το σφάλμα μπορεί να προκύψει εάν χρησιμοποιείτε έναν κωδικό πρόσβασης για το χρήστη διαχείρισης/HTTP για το σύμπλεγμα ή (για Linux βάσει συμπλεγμάτων,) ο χρήστης SSH.

__Ανάλυση__: Χρησιμοποιήστε έναν κωδικό πρόσβασης που ικανοποιεί τα ακόλουθα κριτήρια:

- Πρέπει να έχει μήκος τουλάχιστον 10 χαρακτήρες
- Πρέπει να περιέχει τουλάχιστον ένα ψηφίο
- Πρέπει να περιέχει τουλάχιστον μία μη αλφαριθμητικό χαρακτήρα
- Πρέπει να περιέχει τουλάχιστον μία επάνω ή κάτω κεφαλαίο γράμμα

##<a name="next-steps"></a>Επόμενα βήματα

Τώρα που μάθατε πώς μπορείτε να προσθέσετε χώρο αποθήκευσης περιορισμένης πρόσβασης για να το σύμπλεγμά σας HDInsight, μάθετε άλλους τρόπους για να εργαστείτε με δεδομένα σε το σύμπλεγμά σας:

* [Χρήση της ομάδας με το HDInsight](hdinsight-use-hive.md)

* [Χρήση γουρούνι με HDInsight](hdinsight-use-pig.md)

* [Χρήση MapReduce με HDInsight](hdinsight-use-mapreduce.md)

[powershell]: ../powershell-install-configure.md

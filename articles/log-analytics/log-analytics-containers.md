<properties
    pageTitle="Λύση κοντέινερ στο αρχείο καταγραφής ανάλυσης | Microsoft Azure"
    description="Η λύση κοντέινερ στο αρχείο καταγραφής αναλυτικών στοιχείων σας βοηθά να προβάλετε και να διαχειριστείτε τους κεντρικούς υπολογιστές του κοντέινερ Docker σε μία μόνο θέση."
    services="log-analytics"
    documentationCenter=""
    authors="bandersmsft"
    manager="jwhit"
    editor=""/>

<tags
    ms.service="log-analytics"
    ms.workload="na"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/10/2016"
    ms.author="banders"/>



# <a name="containers-preview-solution-log-analytics"></a>Λύση κοντέινερ (έκδοση Preview) ανάλυσης αρχείου καταγραφής

Σε αυτό το άρθρο περιγράφει τον τρόπο για να ρυθμίσετε και να χρησιμοποιήσετε τη λύση κοντέινερ στο αρχείο καταγραφής ανάλυση, που σας βοηθά να προβάλετε και να διαχειριστείτε τους κεντρικούς υπολογιστές του κοντέινερ Docker σε μία μόνο θέση. Docker είναι ένα σύστημα virtualization λογισμικό που χρησιμοποιείται για τη δημιουργία κοντέινερ που αυτοματοποίηση ανάπτυξης λογισμικού για να τους την υποδομή των τμημάτων.

Με τη λύση, μπορείτε να δείτε ποια κοντέινερ εκτελούνται σε σας κεντρικούς υπολογιστές του κοντέινερ και τι εικόνες που εκτελούνται σε το κοντέινερ. Μπορείτε να προβάλετε λεπτομερείς πληροφορίες ελέγχου που εμφανίζει εντολές που χρησιμοποιούνται με το κοντέινερ. Και, μπορείτε να αντιμετωπίσετε τα κοντέινερ μέσω της προβολής και αναζήτηση αρχεία καταγραφής από την κεντρική χωρίς να χρειάζεται να απομακρυσμένης προβολής Docker hosts. Μπορείτε να βρείτε τα κοντέινερ που μπορεί να είναι θόρυβο και καταναλώνει πόρους πλεονάζουσας σε ένα κεντρικό υπολογιστή. Και, μπορείτε να προβάλετε κεντρική CPU, μνήμη, χώρος αποθήκευσης και πληροφορίες χρήσης και επιδόσεων δικτύου για κοντέινερ.

## <a name="installing-and-configuring-the-solution"></a>Εγκατάσταση και ρύθμιση παραμέτρων της λύσης

Χρησιμοποιήστε τις ακόλουθες πληροφορίες για να εγκαταστήσετε και να ρυθμίσετε τις παραμέτρους της λύσης.

Προσθήκη της λύσης κοντέινερ στο χώρο εργασίας σας OMS χρησιμοποιώντας τη διαδικασία που περιγράφεται στις [λύσεις Προσθήκη αρχείου καταγραφής ανάλυση από τη συλλογή λύσεων](log-analytics-add-solutions.md).

Υπάρχουν δύο τρόποι για να εγκαταστήσετε και να χρησιμοποιήσετε Docker με OMS:

- Σε υποστηριζόμενα λειτουργικά συστήματα Linux, εγκατάσταση και εκτέλεση Docker και, στη συνέχεια, εγκατάσταση και ρύθμιση παραμέτρων OMS παράγοντας για Linux
- Στην CoreOS, εγκατάσταση και εκτέλεση Docker και, στη συνέχεια, ρύθμιση παραμέτρων του OMSAgent για να εκτελέσετε μέσα σε ένα κοντέινερ

Αναθεωρήστε τις υποστηριζόμενες εκδόσεις Docker και Linux λειτουργικό σύστημα για τον κεντρικό υπολογιστή κοντέινερ στην [GitHub](https://github.com/Microsoft/OMS-docker).

>[AZURE.IMPORTANT] Docker πρέπει να εκτελείται **πριν από την** εγκατάσταση τον [Παράγοντα OMS για Linux](log-analytics-linux-agents.md) σε τους κεντρικούς υπολογιστές του κοντέινερ. Εάν έχετε ήδη εγκαταστήσει τον παράγοντα πριν από την εγκατάσταση Docker, θα χρειαστεί να εγκαταστήσετε ξανά τον παράγοντα OMS για Linux. Για περισσότερες πληροφορίες σχετικά με το Docker, ανατρέξτε στο θέμα την [τοποθεσία Web Docker](https://www.docker.com).

Χρειάζεστε τις ακόλουθες ρυθμίσεις που ρυθμίσατε στο σας hosts κοντέινερ πριν μπορείτε να παρακολουθείτε κοντέινερ.

## <a name="configure-settings-for-the-linux-container-host"></a>Ρύθμιση παραμέτρων για τον κεντρικό υπολογιστή του κοντέινερ Linux

Αφού εγκαταστήσετε το Docker, χρησιμοποιήστε τις παρακάτω ρυθμίσεις για τον κεντρικό υπολογιστή του κοντέινερ για να ρυθμίσετε τον παράγοντα για χρήση με Docker. CoreOS δεν υποστηρίζει αυτή τη μέθοδο ρύθμισης.

### <a name="to-configure-settings-for-the-container-host---systemd-suse-opensuse-centos-7x-rhel-7x-and-ubuntu-15x-and-higher"></a>Για να ρυθμίσετε τις παραμέτρους για τον κεντρικό υπολογιστή του κοντέινερ - systemd (SUSE, openSUSE, CentOS 7.x, RHEL 7.x και Ubuntu 15.x και νεότερη έκδοση)

1. Επεξεργασία docker.service για να προσθέσετε τα εξής:

    ```
    [Service]
    ...
    Environment="DOCKER_OPTS=--log-driver=fluentd --log-opt fluentd-address=localhost:25225"
    ...
    ```

2. Προσθήκη $DOCKER\_ΕΠΙΛΈΞΕΙ στο &quot;μονού = / χρήστης/bin/docker ExecStart&quot; στο αρχείο σας docker.service. Χρησιμοποιώντας το παρακάτω παράδειγμα.

    ```
    [Service]
    Environment="DOCKER_OPTS=--log-driver=fluentd --log-opt fluentd-address=localhost:25225"
    ExecStart=/usr/bin/docker daemon -H fd:// $DOCKER_OPTS
    ```

3. Επανεκκινήστε την υπηρεσία Docker. Για παράδειγμα:

    ```
    sudo systemctl restart docker.service
    ```

### <a name="to-configure-settings-for-the-container-host---upstart-ubuntu-14x"></a>Για να ρυθμίσετε τις παραμέτρους για τον κεντρικό υπολογιστή του κοντέινερ - Upstart (Ubuntu 14.x)

1. Επεξεργασία /etc/default/docker και προσθέστε τα εξής:

    ```
    DOCKER_OPTS="--log-driver=fluentd --log-opt fluentd-address=localhost:25225"
    ```

2. Αποθηκεύστε το αρχείο και, στη συνέχεια, επανεκκινήστε το Docker και OMS τις υπηρεσίες.

    ```
    sudo service docker restart
    ```

### <a name="to-configure-settings-for-the-container-host---amazon-linux"></a>Για να ρυθμίσετε τις παραμέτρους για τον κεντρικό υπολογιστή του κοντέινερ - Amazon Linux

1. Επεξεργασία /etc/sysconfig/docker και προσθέστε τα εξής:

    ```
    OPTIONS="--log-driver=fluentd --log-opt fluentd-address=localhost:25225"
    ```

2. Αποθηκεύστε το αρχείο και, στη συνέχεια, επανεκκινήστε την υπηρεσία Docker.

    ```
    sudo service docker restart
    ```

## <a name="configure-settings-for-coreos-containers"></a>Ρύθμιση παραμέτρων για CoreOS κοντέινερ

Αφού εγκαταστήσετε το Docker, χρησιμοποιήστε τις παρακάτω ρυθμίσεις για CoreOS για να εκτελέσετε Docker και να δημιουργήσετε ένα κοντέινερ. Μπορείτε να χρησιμοποιήσετε οποιαδήποτε υποστηριζόμενη έκδοση του Linux — συμπεριλαμβανομένων CoreOS, με αυτή τη μέθοδο ρύθμισης. Θα χρειαστεί το [Αναγνωριστικό OMS χώρου εργασίας και το κλειδί](log-analytics-linux-agents.md).

### <a name="to-use-oms-for-all-containers-with-coreos"></a>Για να χρησιμοποιήσετε OMS για όλα τα κοντέινερ με CoreOS

- Ξεκινήστε το κοντέινερ OMS που θέλετε να παρακολουθήσετε. Τροποποίηση και χρησιμοποιήστε το παρακάτω παράδειγμα.

  ```
sudo docker run --privileged -d -v /var/run/docker.sock:/var/run/docker.sock -e WSID="your workspace id" -e KEY="your key" -h=`hostname` -p 127.0.0.1:25224:25224/udp -p 127.0.0.1:25225:25225 --name="omsagent" --log-driver=none --restart=always microsoft/oms
```

### <a name="switching-from-using-an-installed-agent-to-one-in-a-container"></a>Μετάβαση από το χρησιμοποιώντας έναν παράγοντα εγκατεστημένο σε ένα κοντέινερ

Εάν προηγουμένως χρησιμοποιήσει τον παράγοντα άμεσα-εγκατεστημένο και θέλετε να χρησιμοποιήσετε αντί για αυτό παράγοντας εκτελείται σε ένα κοντέινερ, πρέπει πρώτα να καταργήσετε OMSAgent. Δείτε [τα βήματα για να εγκαταστήσετε τον παράγοντα OMS για Linux](https://github.com/Microsoft/OMS-Agent-for-Linux/blob/master/docs/OMS-Agent-for-Linux.md).

## <a name="containers-data-collection-details"></a>Κοντέινερ λεπτομέρειες συλλογής δεδομένων

Η λύση κοντέινερ συλλέγει διάφορες μετρήσεις και καταγραφής δεδομένων για τις επιδόσεις από κοντέινερ hosts και κοντέινερ με τους παράγοντες OMS για Linux που έχετε ενεργοποιήσει και από OMSAgent εκτελούνται στο κοντέινερ.

Ο παρακάτω πίνακας εμφανίζει μεθόδους συλλογής δεδομένων και άλλες λεπτομέρειες σχετικά με τον τρόπο που συλλέγονται δεδομένα για κοντέινερ.

| πλατφόρμα | Παράγοντας OMS για Linux | Παράγοντας SCOM | Azure χώρου αποθήκευσης | SCOM απαιτείται; | SCOM παράγοντας δεδομένων που αποστέλλονται μέσω ομάδας διαχείρισης | συχνότητα συλλογής |
|---|---|---|---|---|---|---|
|Linux|![Ναι](./media/log-analytics-containers/oms-bullet-green.png)|![Όχι](./media/log-analytics-containers/oms-bullet-red.png)|![Όχι](./media/log-analytics-containers/oms-bullet-red.png)|            ![Όχι](./media/log-analytics-containers/oms-bullet-red.png)|![Όχι](./media/log-analytics-containers/oms-bullet-red.png)| κάθε 3 λεπτά|


Στον παρακάτω πίνακα εμφανίζονται παραδείγματα των τύπων δεδομένων που συλλέγονται από τη λύση κοντέινερ:

| Τύπος δεδομένων | Πεδία |
| --- | --- |
| Απόδοση για κεντρικούς υπολογιστές και κοντέινερ | Υπολογιστής, όνομα αντικειμένου, το Όνομα_μετρητή και #40, % χρόνος επεξεργασίας, δίσκου διαβάζει MB, οι δίσκου συντάσσει MB, MB χρήση μνήμης, byte λήψης δικτύου, δικτύου αποστολή byte, επεξεργαστής χρήση sec, #41 & δικτύου; CounterValue, TimeGenerated, Διαδρομή_μετρητή, SourceSystem |
| Απόθεμα κοντέινερ | TimeGenerated, τον υπολογιστή, το όνομα του κοντέινερ, ContainerHostname, εικόνα, ImageTag, ContinerState, ExitCode, EnvironmentVar, εντολή, CreatedTime, StartedTime, FinishedTime, SourceSystem, ContainerID, ImageID |
| Απόθεμα εικόνα κοντέινερ | TimeGenerated, υπολογιστής, εικόνα, ImageTag, ImageSize, VirtualSize, εκτέλεση, παύση, διακοπεί, απέτυχε, SourceSystem, ImageID, TotalContainer |
| Αρχείο καταγραφής κοντέινερ | TimeGenerated, υπολογιστής, Αναγνωριστικό εικόνας, το όνομα του κοντέινερ, LogEntrySource, LogEntry, SourceSystem, ContainerID |
| Αρχείο καταγραφής της υπηρεσίας κοντέινερ | TimeGenerated, υπολογιστής, TimeOfCommand, εικόνα, εντολή, SourceSystem, ContainerID |

## <a name="monitor-containers"></a>Οθόνη κοντέινερ

Αφού έχετε τη λύση με δυνατότητα στην πύλη του OMS, θα δείτε το πλακίδιο **κοντέινερ** που εμφανίζει συνοπτικές πληροφορίες σχετικά με τους κεντρικούς υπολογιστές του κοντέινερ και το κοντέινερ εκτελείται στο κεντρικών υπολογιστών.

![Κοντέινερ πλακιδίων](./media/log-analytics-containers/containers-title.png)

Το πλακίδιο εμφανίζει μια επισκόπηση των πόσες κοντέινερ που έχετε στο περιβάλλον και αν βρίσκεστε απέτυχε, εκτελείται, ή έχει διακοπεί.

### <a name="using-the-containers-dashboard"></a>Χρήση του πίνακα εργαλείων του κοντέινερ

Κάντε κλικ στο πλακίδιο **κοντέινερ** . Από εκεί θα δείτε προβολές οργανωμένες ανά:

- Κοντέινερ συμβάντα
- Σφάλματα
- Κατάσταση κοντέινερ
- Απόθεμα εικόνα κοντέινερ
- Χρήση της CPU και μνήμης επιδόσεων

Κάθε παράθυρο στον πίνακα εργαλείων είναι μια οπτική αναπαράσταση μιας αναζήτησης που εκτελείται στο δεδομένα που έχουν συλλεχθεί.

![Πίνακας εργαλείων κοντέινερ](./media/log-analytics-containers/containers-dash01.png)

![Πίνακας εργαλείων κοντέινερ](./media/log-analytics-containers/containers-dash02.png)

Στο το blade **Κοντέινερ κατάστασης** , κάντε κλικ επάνω περιοχή, όπως φαίνεται παρακάτω.

![Κατάσταση κοντέινερ](./media/log-analytics-containers/containers-status.png)

Αναζήτηση αρχείου καταγραφής ανοίγει το οποίο εμφανίζει πληροφορίες σχετικά με το hosts και κοντέινερ που εκτελούνται σε αυτά.

![Αναζήτηση αρχείου καταγραφής για κοντέινερ](./media/log-analytics-containers/containers-log-search.png)

Από εδώ, μπορείτε να επεξεργαστείτε το ερώτημα αναζήτησης για να το τροποποιήσετε για να βρείτε τις συγκεκριμένες πληροφορίες που σας ενδιαφέρει. Για περισσότερες πληροφορίες σχετικά με το αρχείο καταγραφής αναζητήσεις, ανατρέξτε στο θέμα [αρχείο καταγραφής αναζητήσεις στο αρχείο καταγραφής ανάλυσης](log-analytics-log-searches.md).

Για παράδειγμα, μπορείτε να τροποποιήσετε το ερώτημα αναζήτησης, ώστε να εμφανίζει όλα τα σταμάτησε δοχεία αντί για το τρέχον κοντέινερ, αλλάζοντας **εκτελείται** σε **Διακοπή** στο ερώτημα αναζήτησης.

## <a name="troubleshoot-by-finding-a-failed-container"></a>Αντιμετώπιση προβλημάτων με την εύρεση ενός κοντέινερ απέτυχε

OMS επισημαίνει ένα κοντέινερ ως **απέτυχε** εάν έχει βγει από με έναν κωδικό εξόδου μηδέν. Μπορείτε να δείτε μια επισκόπηση των σφαλμάτων και αποτυχίες στο περιβάλλον σε blade το **Κοντέινερ απέτυχε** .

### <a name="to-find-failed-containers"></a>Για να βρείτε απέτυχε κοντέινερ

1. Κάντε κλικ στην επιλογή το blade **Συμβάντα κοντέινερ** .  
  ![κοντέινερ συμβάντα](./media/log-analytics-containers/containers-events.png)
2. Αναζήτηση αρχείου καταγραφής ανοίγει το οποίο εμφανίζει την κατάσταση του κοντέινερ, παρόμοια με τα εξής.  
  ![κατάσταση κοντέινερ](./media/log-analytics-containers/containers-container-state.png)
3. Στη συνέχεια, κάντε κλικ στην αποτυχίας τιμή για να προβάλετε πρόσθετες πληροφορίες όπως το μέγεθος της εικόνας και αριθμός των αποτυχημένων διακοπεί και οι εικόνες. Αναπτύξτε το στοιχείο **Εμφάνιση περισσότερων** για να προβάλετε το αναγνωριστικό της εικόνας.  
  ![Αποτυχία κοντέινερ](./media/log-analytics-containers/containers-state-failed.png)
4. Στη συνέχεια, βρείτε το κοντέινερ που εκτελείται αυτή η εικόνα. Πληκτρολογήστε τα εξής στο ερώτημα αναζήτησης.
  `Type=ContainerInventory <ImageID>`Εμφανίζει τα αρχεία καταγραφής. Μπορείτε να κάνετε κύλιση για να δείτε το κοντέινερ απέτυχε.  
  ![Αποτυχία κοντέινερ](./media/log-analytics-containers/containers-failed04.png)


## <a name="search-logs-for-container-data"></a>Αρχεία καταγραφής από την αναζήτηση για τα δεδομένα κοντέινερ

Όταν αντιμετώπιση προβλημάτων σε ένα συγκεκριμένο σφάλμα, μπορεί να σας βοηθήσει να δείτε όπου εκτελείται στο περιβάλλον σας. Οι παρακάτω τύποι καταγραφής θα σας βοηθήσει να δημιουργήσετε ερωτήματα για να λάβετε τις πληροφορίες που θέλετε.

- **ContainerInventory** -Χρησιμοποιήστε αυτόν τον τύπο όταν θέλετε πληροφορίες σχετικά με τη θέση του κοντέινερ, τι είναι τα ονόματά τους και τι εικόνες που εκτελούν.
- **ContainerImageInventory** -Χρησιμοποιήστε αυτόν τον τύπο όταν προσπαθείτε να βρείτε πληροφορίες οργανωμένοι με εικόνα και να προβάλετε πληροφορίες εικόνας όπως εικόνα αναγνωριστικά ή μεγέθη.
- **ContainerLog** -Χρησιμοποιήστε αυτόν τον τύπο όταν θέλετε να βρείτε συγκεκριμένες πληροφορίες αρχείου καταγραφής και καταχωρήσεις.
- **ContainerServiceLog** -Χρησιμοποιήστε αυτόν τον τύπο όταν προσπαθείτε να βρείτε πληροφορίες διαδρομής ελέγχου για το μονού Docker, όπως η έναρξη, διακοπή, διαγραφή ή ελκυστική εντολές.

### <a name="to-search-logs-for-container-data"></a>Για να πραγματοποιήσετε αναζήτηση στα αρχεία καταγραφής για κοντέινερ δεδομένων

- Επιλέξτε μια εικόνα που μπορείτε να γνωρίζετε απέτυχε πρόσφατα και να βρείτε τα αρχεία καταγραφής σφαλμάτων για αυτήν. Ξεκινήστε με την εύρεση ενός ονόματος κοντέινερ που εκτελεί αυτήν την εικόνα με μια αναζήτηση **ContainerInventory** . Για παράδειγμα, αναζήτηση`Type=ContainerInventory ubuntu Failed`  
    ![Αναζήτηση για Ubuntu κοντέινερ](./media/log-analytics-containers/search-ubuntu.png)

  Σημειώστε το όνομα του κοντέινερ δίπλα στο **όνομα**και αναζητήστε αυτά τα αρχεία καταγραφής. Σε αυτό το παράδειγμα, είναι `Type=ContainerLog adoring_meitner`.

**Προβολή πληροφοριών για τις επιδόσεις**

Όταν αρχή για να δημιουργήσετε ερωτήματα, μπορεί να σας βοηθήσει για να δείτε τι πιθανές πρώτα. Για παράδειγμα, για να δείτε όλα τα δεδομένα επιδόσεων, δοκιμάστε ένα ευρύ ερώτημα, πληκτρολογώντας το ακόλουθο ερώτημα αναζήτησης.

```
Type=Perf
```

![κοντέινερ επιδόσεων](./media/log-analytics-containers/containers-perf01.png)



Μπορείτε να δείτε αυτό σε μια φόρμα πιο γραφικών, όταν κάνετε κλικ στη λέξη **μετρικά** στα αποτελέσματα.

![κοντέινερ επιδόσεων](./media/log-analytics-containers/containers-perf02.png)



Μπορείτε να εμβέλεια των δεδομένων επιδόσεων που εμφανίζεται σε ένα συγκεκριμένο κοντέινερ, πληκτρολογώντας το όνομα της προς τα δεξιά του ερωτήματός σας.

```
Type=Perf <containerName>
```

Που εμφανίζει τη λίστα των μετρικών απόδοσης που έχουν συλλεχθεί για ένα μεμονωμένο κοντέινερ.

![κοντέινερ επιδόσεων](./media/log-analytics-containers/containers-perf03.png)

## <a name="example-log-search-queries"></a>Παράδειγμα ερωτήματα αναζήτησης αρχείου καταγραφής

Συχνά είναι χρήσιμο για τη δημιουργία ερωτημάτων, ξεκινώντας με ένα παράδειγμα ή δύο και, στη συνέχεια, τροποποιώντας τους για να χωρέσει το περιβάλλον σας. Ως σημείο εκκίνησης, μπορείτε να πειραματιστείτε με τα **Ερωτήματα αξιοσημείωτες** blade για να σας βοηθήσει να δημιουργήσετε πιο σύνθετων ερωτημάτων.

![Ερωτήματα κοντέινερ](./media/log-analytics-containers/containers-queries.png)

## <a name="saving-log-search-queries"></a>Αποθήκευση αρχείου καταγραφής ερωτήματα αναζήτησης

Αποθήκευση ερωτημάτων είναι μια τυπική δυνατότητα καταγραφής ανάλυσης. Με αποθήκευσή τους, θα έχετε αυτές που βρήκατε χρήσιμες χρήσιμα για μελλοντική χρήση.

Αφού δημιουργήσετε ένα ερώτημα το οποίο μπορείτε να βρείτε χρήσιμες, αποθηκεύστε το κάνοντας κλικ στην επιλογή **"Αγαπημένα"** στο επάνω μέρος της σελίδας αναζήτησης αρχείου καταγραφής. Στη συνέχεια, έχετε εύκολη πρόσβαση σε αυτό αργότερα από τη σελίδα **Μου πίνακα εργαλείων** .

## <a name="next-steps"></a>Επόμενα βήματα

- [Αρχεία καταγραφής από την αναζήτηση](log-analytics-log-searches.md) για να προβάλετε λεπτομερείς κοντέινερ εγγραφές δεδομένων.

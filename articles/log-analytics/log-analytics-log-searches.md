<properties
    pageTitle="Σύνδεση αναζητήσεις στο αρχείο καταγραφής ανάλυσης | Microsoft Azure"
    description="Αναζητήσεις log σας επιτρέπει να συνδυάσετε και ο συσχετισμός υπολογιστή δεδομένα από πολλές προελεύσεις εντός του περιβάλλοντος του."
    services="log-analytics"
    documentationCenter=""
    authors="bandersmsft"
    manager="jwhit"
    editor=""/>

<tags
    ms.service="log-analytics"
    ms.workload="na"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="10/10/2016"
    ms.author="banders"/>

# <a name="log-searches-in-log-analytics"></a>Αρχείο καταγραφής αναζητήσεις στο αρχείο καταγραφής ανάλυσης

Στον πυρήνα των αναλυτικών στοιχείων καταγραφής είναι η δυνατότητα αναζήτησης καταγραφής που σας επιτρέπει να συνδυάσετε και ο συσχετισμός υπολογιστή δεδομένα από πολλές προελεύσεις εντός του περιβάλλοντος του. Λύσεις είναι επίσης υποστηρίζεται από αρχείο καταγραφής αναζήτησης για να μεταφέρετε που μετρικά περιστρεφόμενη γύρω από μια περιοχή συγκεκριμένου προβλήματος.

Στη σελίδα αναζήτησης, μπορείτε να δημιουργήσετε ένα ερώτημα και, στη συνέχεια, όταν κάνετε αναζήτηση, μπορείτε να φιλτράρετε τα αποτελέσματα με τη χρήση στοιχείων ελέγχου όψη. Μπορείτε επίσης να δημιουργήσετε σύνθετα ερωτήματα για να μετασχηματισμός, να φιλτράρετε και αναφορά σε τα αποτελέσματα.

Κοινά ερωτήματα αναζήτησης καταγραφής εμφανίζονται στις περισσότερες σελίδες λύση. Σε ολόκληρη την κονσόλα OMS, μπορείτε να κάντε κλικ στην επιλογή πλακίδια ή λεπτομερής σε άλλα στοιχεία του για να προβάλετε λεπτομέρειες σχετικά με το στοιχείο χρησιμοποιώντας την αναζήτηση του αρχείου καταγραφής.

Σε αυτό το πρόγραμμα εκμάθησης, θα σας καθοδηγήσουμε μέσω παραδείγματα για να καλύψετε όλα τα βασικά στοιχεία κατά τη χρήση του αρχείου καταγραφής αναζήτησης.

Θα σας θα ξεκινούν με απλή, πρακτική παραδείγματα και, στη συνέχεια, δομούνται τους, έτσι ώστε να μπορείτε να λάβετε την κατανόηση των περιπτώσεων χρήσης πρακτική σχετικά με το πώς μπορείτε να χρησιμοποιήσετε τη σύνταξη για να εξαγάγετε τα στοιχεία που θέλετε από τα δεδομένα.

Αφού έχετε εξοικειωθεί τεχνικές αναζήτησης, μπορείτε να δείτε την [ανάλυση καταγραφής σύνδεση αναφοράς αναζήτησης](log-analytics-search-reference.md).

## <a name="use-basic-filters"></a>Χρησιμοποιήστε βασικά φίλτρα

Είναι το πρώτο πράγμα που πρέπει να γνωρίζετε ότι το πρώτο μέρος μιας αναζήτησης ερωτήματος, πριν από οποιαδήποτε "|" Κατακόρυφη διοχέτευση χαρακτήρα, είναι πάντα ένα *φίλτρο*. Μπορείτε να θεωρήσετε το ως μια πρόταση WHERE στο TSQL--καθορίζει *το* υποσύνολο των δεδομένων για να αποσπάσετε από το χώρο αποθήκευσης δεδομένων OMS. Αναζήτηση στο χώρο αποθήκευσης δεδομένων είναι σε μεγάλο βαθμό σχετικά με τον καθορισμό των χαρακτηριστικών των δεδομένων που θέλετε να εξαγάγετε, ώστε να είναι φυσική που θα ξεκινήσετε ένα ερώτημα με τον όρο WHERE.

Τα πιο βασικές φίλτρα που μπορείτε να χρησιμοποιήσετε είναι *λέξεις-κλειδιά*, όπως 'error' ή 'χρονικό όριο' ή ένα όνομα υπολογιστή. Αυτοί οι τύποι απλά ερωτήματα επιστρέφουν γενικά σχήματα διάφορων τύπων δεδομένων μέσα στο ίδιο σύνολο αποτελεσμάτων. Αυτό συμβαίνει επειδή ανάλυση καταγραφής έχει διαφορετικούς *τύπους* δεδομένων του συστήματος.


### <a name="to-conduct-a-simple-search"></a>Για να εκτελέσετε μια απλή αναζήτηση
1. Στην πύλη του OMS, κάντε κλικ στο **Αρχείο καταγραφής αναζήτησης**.  
    ![πλακίδιο αναζήτησης](./media/log-analytics-log-searches/oms-overview-log-search.png)
2. Στο πεδίο ερωτήματος, πληκτρολογήστε `error` και, στη συνέχεια, κάντε κλικ στο κουμπί **Αναζήτηση**.  
    ![Σφάλμα αναζήτησης](./media/log-analytics-log-searches/oms-search-error.png)  
    Για παράδειγμα, το ερώτημα για `error` στην παρακάτω εικόνα επιστρέφονται 100.000 εγγραφές **συμβάντων** (που συλλέγονται από τη Διαχείριση Log), 18 **ConfigurationAlert** εγγραφές (που δημιουργείται από την αξιολόγηση ρύθμισης παραμέτρων) και 12 **ConfigurationChange** εγγραφές (καταγράφονται από την παρακολούθηση αλλαγών).   
    ![αποτελέσματα αναζήτησης](./media/log-analytics-log-searches/oms-search-results01.png)  

Αυτά τα φίλτρα δεν είναι πραγματικά τύποι/κλάσεων αντικειμένων. *Ο τύπος* είναι απλώς μια ετικέτα, ή μια ιδιότητα ή μια συμβολοσειρά/όνομα/κατηγορία, που είναι συνημμένα σε ένα τμήμα των δεδομένων. Ορισμένα έγγραφα στο σύστημα έχουν tag ως **Τύπο: ConfigurationAlert** και ορισμένα έχουν tag ως **Τύπο: επιδόσεων**ή **Πληκτρολογήστε: συμβάντος**και ούτω καθεξής. Κάθε αποτέλεσμα αναζήτησης, εγγράφου, εγγραφή ή καταχώρηση εμφανίζει όλα τα ανεπεξέργαστα ιδιότητες και τις τιμές τους για κάθε ένα από αυτά τα στοιχεία δεδομένων και μπορείτε να χρησιμοποιήσετε αυτά τα ονόματα πεδίων, για να καθορίσετε στο φίλτρο, όταν θέλετε να ανακτήσετε μόνο τις εγγραφές όπου το πεδίο έχει που δεδομένη τιμή.

*Ο τύπος* είναι πραγματικά μόνο ένα πεδίο που έχουν όλες τις εγγραφές, δεν είναι διαφορετικό από οποιοδήποτε άλλο πεδίο. Αυτό καθορίστηκε με βάση την τιμή του πεδίου "Τύπος". Αυτή η εγγραφή θα έχει μια διαφορετική μορφή ή σχήμα. Παρεμπιπτόντως, **Τύπος = επιδόσεων**, ή **Τύπος = συμβάν** είναι επίσης τη σύνταξη που χρειάζεστε για να μάθετε πώς να ερωτήματος για δεδομένα επιδόσεων ή συμβάντα.

Μπορείτε να χρησιμοποιήσετε μια άνω και κάτω τελεία (:) ή ένα σύμβολο ισότητας (=) μετά το όνομα του πεδίου και πριν από την τιμή. **Τύπος: συμβάντων** και **Τύπος = συμβάν** είναι ισοδύναμο στο σημασία, μπορείτε να επιλέξετε το στυλ που προτιμάτε.

Ναι, εάν ο τύπος = επιδόσεων εγγραφές έχουν ένα πεδίο που ονομάζεται 'Το Όνομα_μετρητή' και, στη συνέχεια, μπορείτε να συντάξετε ένα ερώτημα που μοιάζουν με `Type=Perf CounterName="% Processor Time"`.

Αυτό θα σας δώσει μόνο τα δεδομένα επιδόσεων όπου το όνομα του μετρητή επιδόσεων είναι "% Χρόνος επεξεργασίας".

### <a name="to-search-for-processor-time-performance-data"></a>Για να αναζητήσετε δεδομένα επιδόσεων ώρα επεξεργαστής
- Στο πεδίο ερωτήματος αναζήτησης, πληκτρολογήστε`Type=Perf CounterName="% Processor Time"`

Μπορείτε επίσης να είναι πιο συγκεκριμένες και να χρησιμοποιήσετε **όνομα_παρουσίας = _ 'Σύνολο'** στο ερώτημα, το οποίο είναι ένα μετρητή επιδόσεων των Windows. Μπορείτε επίσης να επιλέξετε μια όψη και μια άλλη **: η τιμή του πεδίου**. Το φίλτρο προστίθεται αυτόματα στο φίλτρο σας στη γραμμή του ερωτήματος. Μπορείτε να το δείτε στην παρακάτω εικόνα. Σας δείχνει πού μπορείτε να κάνετε κλικ για να προσθέσετε **όνομα_παρουσίας: '_Σύνολο'** στο ερώτημα χωρίς να πληκτρολογήσετε τίποτε.

![Αναζήτηση όψη](./media/log-analytics-log-searches/oms-search-facet.png)

Γίνεται τώρα το ερώτημά σας`Type=Perf CounterName="% Processor Time" InstanceName="_Total"`

Σε αυτό το παράδειγμα, δεν χρειάζεται να καθορίσετε **Τύπος = επιδόσεων** για να μεταβείτε σε αυτό το αποτέλεσμα. Επειδή τα πεδία το Όνομα_μετρητή και όνομα_παρουσίας υπάρχει μόνο για τις εγγραφές του τύπου = επιδόσεων, το ερώτημα είναι συγκεκριμένες για να λάβετε τα ίδια αποτελέσματα με περισσότερο, την προηγούμενη αυτό:
```
CounterName="% Processor Time" InstanceName="_Total"
```

Αυτό συμβαίνει επειδή όλα τα φίλτρα στο ερώτημα αξιολογούνται ως που έχει τεθεί σε *AND* μεταξύ τους. Αποτελεσματική, τα περισσότερα πεδία προσθέτετε τα κριτήρια, μπορείτε να λάβετε μικρότερη, πιο συγκεκριμένες και Εκλεπτυσμένη αποτελέσματα.

Για παράδειγμα, το ερώτημα `Type=Event EventLog="Windows PowerShell"` είναι ίδιο με `Type=Event AND EventLog="Windows PowerShell"`. Επιστρέφει όλα τα συμβάντα που έχουν πραγματοποιήσει είσοδο και να συγκεντρώσει από το αρχείο καταγραφής συμβάντων των Windows PowerShell. Εάν προσθέσετε ένα φίλτρο πολλές φορές επιλέγοντας επανειλημμένα την ίδια όψη, τότε το ζήτημα είναι καθαρά καλλυντικά--αυτό μπορεί να συσσωρεύονται γραμμή αναζήτησης, αλλά εξακολουθείτε να επιστρέφει τα ίδια αποτελέσματα επειδή τον τελεστή έμμεσα είναι πάντα εκεί.

Μπορείτε να αναιρέσετε εύκολα τον τελεστή έμμεσα χρησιμοποιώντας έναν τελεστή NOT ρητά. Για παράδειγμα:

`Type:Event NOT(EventLog:"Windows PowerShell")`ή ένα ισοδύναμο `Type=Event EventLog!="Windows PowerShell"` επιστροφή όλα τα συμβάντα από όλα άλλα αρχεία καταγραφής που δεν είναι το αρχείο καταγραφής του Windows PowerShell.

Ή, μπορείτε να χρησιμοποιήσετε άλλες τελεστής Boolean όπως 'OR'. Το παρακάτω ερώτημα επιστρέφει τις εγγραφές για την οποία το αρχείο καταγραφής συμβάντων είναι είτε εφαρμογή ή το σύστημα.

```
EventLog=Application OR EventLog=System
```

Χρησιμοποιώντας το παραπάνω ερώτημα, θα λάβετε καταχωρήσεις για τα δύο αρχεία καταγραφής στο ίδιο σύνολο αποτελεσμάτων.

Ωστόσο, εάν καταργήσετε την ή αφήνοντας την μη ρητή και στη θέση, στη συνέχεια, το ακόλουθο ερώτημα δεν θα δημιουργήσουν κανένα αποτέλεσμα επειδή δεν υπάρχει μια καταχώρηση αρχείου καταγραφής συμβάντων που ανήκει σε ΔΎΟ αρχεία καταγραφής. Κάθε καταχώρηση αρχείο καταγραφής συμβάντων έχει συνταχθεί σε ένα μόνο από τα δύο αρχεία καταγραφής.

```
EventLog=Application EventLog=System
```


## <a name="use-additional-filters"></a>Χρήση πρόσθετων φίλτρων

Το παρακάτω ερώτημα επιστρέφει τις εγγραφές για 2 αρχεία καταγραφής συμβάντων για όλους τους υπολογιστές που έχετε αποστείλει δεδομένων.

```
EventLog=Application OR EventLog=System
```

![αποτελέσματα αναζήτησης](./media/log-analytics-log-searches/oms-search-results03.png)

Επιλέγοντας ένα από τα πεδία ή φίλτρα θα περιορίσετε το ερώτημα σε έναν συγκεκριμένο υπολογιστή, εκτός από όλα τα άλλα από αυτές. Το ερώτημα που προκύπτει θα μοιάζει με την παρακάτω.

```
EventLog=Application OR EventLog=System Computer=SERVER1.contoso.com
```

Που είναι ισοδύναμη με τις ακόλουθες, λόγω την μη ρητή AND.

```
EventLog=Application OR EventLog=System AND Computer=SERVER1.contoso.com
```

Κάθε ερώτημα αξιολογείται με την εξής σειρά ρητή. Σημείωση στις παρενθέσεις.

```
(EventLog=Application OR EventLog=System) AND Computer=SERVER1.contoso.com
```

Όπως το πεδίο αρχείο καταγραφής συμβάντων, μπορείτε να ανακτήσετε δεδομένα μόνο για ένα σύνολο συγκεκριμένους υπολογιστές, προσθέτοντας ή. Για παράδειγμα:

```
(EventLog=Application OR EventLog=System) AND (Computer=SERVER1.contoso.com OR Computer=SERVER2.contoso.com OR Computer=SERVER3.contoso.com)
```

Ομοίως, αυτό το ακόλουθο ερώτημα επιστρέφει **% CPU χρόνου** για την επιλεγμένη δύο υπολογιστές μόνο.

```
CounterName="% Processor Time"  AND InstanceName="_Total" AND (Computer=SERVER1.contoso.com OR Computer=SERVER2.contoso.com)
```


### <a name="boolean-operators"></a>Οι τελεστές Boolean
Με ημερομηνίας/ώρας και αριθμητικά πεδία, μπορείτε να κάνετε αναζήτηση τιμών με τη χρήση *μεγαλύτερο*, *μικρότερο από*, και *μικρότερο ή ίσο*. Μπορείτε να χρησιμοποιήσετε απλό τελεστές όπως >, <>, =, < =,! = στη γραμμή ερωτήματος αναζήτησης.


Μπορείτε να υποβάλετε ερώτημα σε ένα συγκεκριμένο αρχείο καταγραφής συμβάντων για μια συγκεκριμένη χρονική περίοδο. Για παράδειγμα, τις τελευταίες 24 ώρες, εκφράζονται με την ακόλουθη παράσταση μνημονικό.

```
EventLog=System TimeGenerated>NOW-24HOURS
```


#### <a name="to-search-using-a-boolean-operator"></a>Για να πραγματοποιήσετε αναζήτηση χρησιμοποιώντας έναν τελεστή boolean
- Στο πεδίο ερωτήματος αναζήτησης, πληκτρολογήστε`EventLog=System TimeGenerated>NOW-24HOURS"`  
    ![Αναζήτηση με δυαδική τιμή](./media/log-analytics-log-searches/oms-search-boolean.png)

Παρόλο που μπορείτε να ελέγχετε το χρονικό διάστημα γραφικά και οι περισσότερες φορές ενδέχεται να θέλετε να το κάνετε, υπάρχουν πλεονεκτήματα, συμπεριλαμβανομένων των φίλτρο χρόνου απευθείας στο ερώτημα. Για παράδειγμα, αυτή είναι η ιδανική με τους πίνακες εργαλείων όπου μπορείτε να παρακάμψετε την ώρα για κάθε πλακίδιο, ανεξάρτητα από το επιλογέα *καθολικού* χρόνου στη σελίδα πίνακα εργαλείων. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Θέματα ώρα στον πίνακα εργαλείων](http://cloudadministrator.wordpress.com/2014/10/19/system-center-advisor-restarted-time-matters-in-dashboard-part-6/).

Όταν φιλτράρισμα με βάση το χρόνο, έχετε υπόψη ότι λαμβάνετε αποτελέσματα για το *σημείο τομής* των δύο χρονικές περιόδους: αυτόν που καθορίζεται στην πύλη του OMS (S1) και αυτόν που καθορίζεται στο ερώτημα (S2).

![σημείο τομής](./media/log-analytics-log-searches/oms-search-intersection.png)

Αυτό σημαίνει ότι, εάν τα χρονικά διαστήματα δεν τέμνονται, για παράδειγμα στην πύλη του OMS όπου μπορείτε να επιλέξετε **αυτήν την εβδομάδα** και στο ερώτημα όπου μπορείτε να καθορίσετε **προηγούμενη εβδομάδα**, στη συνέχεια, υπάρχει Διασταύρωση και δεν θα λαμβάνετε κανένα αποτέλεσμα.

Τελεστές σύγκρισης που χρησιμοποιείται για το πεδίο TimeGenerated είναι επίσης χρήσιμο σε άλλες περιπτώσεις. Για παράδειγμα, με τα αριθμητικά πεδία.

Για παράδειγμα, δεδομένο ότι εκτίμηση της ρύθμισης παραμέτρων ειδοποιήσεων έχουν τις παρακάτω τιμές της σοβαρότητας:

- 0 = πληροφορίες
- 1 = Προειδοποίηση
- 2 = κρίσιμη

Μπορείτε να ερώτημα για τις ειδοποιήσεις και προειδοποίηση και κρίσιμες και να εξαιρέσετε επίσης ενημερωτικό από αυτές με το ακόλουθο ερώτημα:

```
Type=ConfigurationAlert  Severity>=1
```


Μπορείτε επίσης να χρησιμοποιήσετε ερωτήματα περιοχή. Αυτό σημαίνει ότι μπορείτε να παρέχετε την περιοχή αρχή και στο τέλος των τιμών σε μια ακολουθία. Για παράδειγμα, εάν θέλετε τα συμβάντα από το αρχείο καταγραφής συμβάντων Operations Manager όπου το EventID είναι μεγαλύτερο από ή ίσο με 2100 αλλά δεν είναι μεγαλύτερο από 2199, στη συνέχεια, το ακόλουθο ερώτημα θα επιστρέψει τους.

```
Type=Event EventLog="Operations Manager" EventID:[2100..2199]
```


>[AZURE.NOTE] Η σύνταξη περιοχή πρέπει να χρησιμοποιήσετε είναι το διαχωριστικό άνω και κάτω τελεία (:): η τιμή του πεδίου και *όχι* το σύμβολο ίσον (=). Περικλείστε το τέλος άνω και κάτω από την περιοχή σε αγκύλες και διαχωρίστε τις με δύο τελείες (.).

## <a name="manipulate-search-results"></a>Διαχειριστείτε τα αποτελέσματα αναζήτησης

Όταν κάνετε αναζήτηση για τα δεδομένα, που θα θέλετε να Περιορίστε την αναζήτηση και να έχετε μια καλή επίπεδο ελέγχετε περισσότερο τα αποτελέσματα. Όταν γίνεται ανάκτηση των αποτελεσμάτων, μπορείτε να εφαρμόσετε εντολές για τη μετατροπή τους.

Εντολές στο αρχείο καταγραφής ανάλυσης αναζητήσεις *πρέπει να* ακολουθήσετε μετά το χαρακτήρα κατακόρυφη καθέτου (||). Ένα φίλτρο πρέπει να είναι πάντα το πρώτο μέρος από μια συμβολοσειρά ερωτήματος. Το Καθορίζει το σύνολο δεδομένων εργάζεστε με και, στη συνέχεια, "σωλήνες" αυτά τα αποτελέσματα σε μια εντολή. Στη συνέχεια, μπορείτε να χρησιμοποιήσετε την κατακόρυφη γραμμή για να προσθέσετε πρόσθετες εντολές. Αυτό είναι γενικά παρόμοια με τη διαδικασία του Windows PowerShell.

Σε γενικές γραμμές, τη γλώσσα αναζήτησης καταγραφής ανάλυσης προσπαθεί να ακολουθήσετε PowerShell στυλ και οδηγίες για να είναι παρόμοια με την οι επαγγελματίες τεχνολογιών πληροφορικής και για να διευκολύνετε την καμπύλη εκμάθησης.

Εντολές έχουν ονόματα ρημάτων, ώστε να μπορείτε εύκολα να καταλάβετε τι κάνουν.  

### <a name="sort"></a>Ταξινόμηση

Η εντολή ταξινόμηση σάς επιτρέπει να ορίσετε τη σειρά ταξινόμησης από ένα ή πολλά πεδία. Ακόμα και εάν δεν χρησιμοποιείτε, από προεπιλογή, μια ώρα φθίνουσα σειρά τίθεται σε ισχύ. Τα πιο πρόσφατα αποτελέσματα είναι πάντα στο επάνω μέρος των αποτελεσμάτων αναζήτησης. Αυτό σημαίνει ότι, όταν εκτελείτε μια αναζήτηση, με `Type=Event EventID=1234` τι πραγματικά εκτελείται για εσάς είναι:

```
Type=Event EventID=1234 **| Sort TimeGenerated desc**
```

Αυτό συμβαίνει επειδή πρόκειται για τον τύπο της εμπειρίας με τις οποίες είστε εξοικειωμένοι με στα αρχεία καταγραφής. Για παράδειγμα, στο πρόγραμμα προβολής συμβάντων των Windows.

Μπορείτε να χρησιμοποιήσετε ταξινόμησης για να αλλάξετε τον τρόπο τα αποτελέσματα επιστρέφονται. Τα παρακάτω παραδείγματα δείχνουν πώς λειτουργεί.

```
Type=Event EventID=1234 | Sort TimeGenerated asc
```

```
Type=Event EventID=1234 | Sort Computer asc
```

```
Type=Event EventID=1234 | Sort Computer asc,TimeGenerated desc
```


Τα παραπάνω απλό παραδείγματα που δείχνουν πώς λειτουργούν οι εντολές--μπορεί να αλλάξει το σχήμα των αποτελεσμάτων που επιστρέφονται από το φίλτρο.

### <a name="limit-and-top"></a>Όριο και επάνω
Ένα άλλο λιγότερο γνωστά εντολή είναι το ΌΡΙΟ. Το όριο είναι ένα Ρηματικές μοιάζει με PowerShell. Όριο λειτουργικά είναι ίδιο στην εντολή "ΕΠΆΝΩ". Τα ακόλουθα ερωτήματα επιστρέφουν τα ίδια αποτελέσματα.

```
Type=Event EventID=600 | Limit 1
```

```
Type=Event EventID=600 | Top 1
```


#### <a name="to-search-using-top"></a>Για να πραγματοποιήσετε αναζήτηση χρησιμοποιώντας επάνω
- Στο πεδίο ερωτήματος αναζήτησης, πληκτρολογήστε`Type=Event EventID=600 | Top 1`   
    ![αρχή της αναζήτησης](./media/log-analytics-log-searches/oms-search-top.png)

Στην παραπάνω εικόνα, υπάρχουν χιλιάδες 358 εγγραφές με EventID = 600. Τα πεδία, όψεις και φίλτρα στην αριστερή πλευρά εμφανίζονται πάντα πληροφορίες σχετικά με τα αποτελέσματα επιστρέφονται *από το τμήμα φίλτρου* από το ερώτημα, το οποίο είναι το τμήμα πριν από κάθε χαρακτήρα καθέτου. Παράθυρο **αποτελεσμάτων** επιστρέφει μόνο το πιο πρόσφατο αποτέλεσμα 1, επειδή το παράδειγμα εντολής σε σχήμα και μετασχηματισμό τα αποτελέσματα.

### <a name="select"></a>Επιλέξτε

ΕΠΙΛΈΞΤΕ την εντολή συμπεριφέρεται όπως επιλογή αντικειμένου σε PowerShell. Επιστρέφει φιλτραρισμένα αποτελέσματα που δεν έχουν όλες τις αρχικές ιδιότητες. Αντί για αυτό, επιλέγει μόνο τις ιδιότητες που καθορίζετε.

#### <a name="to-run-a-search-using-the-select-command"></a>Για να εκτελέσετε μια αναζήτηση χρησιμοποιώντας την εντολή "επιλογή"

1. Στο πλαίσιο αναζήτησης, πληκτρολογήστε `Type=Event` και, στη συνέχεια, κάντε κλικ στο κουμπί **Αναζήτηση**.
2. Κάντε κλικ στο κουμπί **+ Εμφάνιση περισσότερων** σε ένα από τα αποτελέσματα για να προβάλετε όλες τις ιδιότητες που έχουν τα αποτελέσματα.
3. Επιλέξτε ρητά ορισμένες από αυτές και αλλάζει το ερώτημα σε `Type=Event | Select Computer,EventID,RenderedDescription`.  
    ![Επιλέξτε αναζήτηση](./media/log-analytics-log-searches/oms-search-select.png)

Αυτή είναι η εντολή ιδιαίτερα χρήσιμη όταν θέλετε να ελέγξετε αποτέλεσμα αναζήτησης και επιλέξτε μόνο τα τμήματα των δεδομένων που πραγματικά έχει σημασία για την Εξερεύνηση, η οποία συχνά δεν είναι η πλήρης εγγραφή. Αυτό είναι επίσης χρήσιμο όταν εγγραφές από διαφορετικούς τύπους έχουν *ορισμένες* κοινές ιδιότητες, αλλά όχι σε *όλες* τις ιδιότητες είναι κοινές. Μπορείτε να παράγει αποτέλεσμα που εμφανίζεται πιο φυσικά ως πίνακα ή να λειτουργούν σωστά κατά την εξαγωγή σε αρχείο CSV και, στη συνέχεια, massaged στο Excel.



## <a name="use-the-measure-command"></a>Χρησιμοποιήστε την εντολή μέτρησης

ΜΈΤΡΗΣΗ είναι μία από τις πιο ευέλικτη εντολές στις αναζητήσεις καταγραφής ανάλυσης. Σας επιτρέπει να εφαρμόσετε στατιστικές *συναρτήσεις* των δεδομένων και συγκεντρωτικών αποτελεσμάτων ομαδοποιημένα κατά ένα συγκεκριμένο πεδίο. Υπάρχουν πολλές στατιστικές συναρτήσεις που υποστηρίζει μονάδα μέτρησης.

### <a name="measure-count"></a>Count() μέτρησης

Η πρώτη στατιστική συνάρτηση να λειτουργεί με το και από ο πιο εύκολος τρόπος για να κατανοήσετε είναι η συνάρτηση *count()* .

Αποτελέσματα από οποιοδήποτε ερώτημα αναζήτησης όπως `Type=Event`, εμφανίζονται τα φίλτρα που ονομάζεται επίσης όψεις στην αριστερή πλευρά των αποτελεσμάτων αναζήτησης. Τα φίλτρα εμφανίζουν μια κατανομή των τιμών από ένα συγκεκριμένο πεδίο για τα αποτελέσματα στο πλαίσιο Αναζήτηση εκτελεστεί.

![Καταμέτρηση μέτρηση αναζήτησης](./media/log-analytics-log-searches/oms-search-measure-count01.png)

Για παράδειγμα, στην παραπάνω εικόνα, θα δείτε το πεδίο **υπολογιστή** και παρουσιάζει ότι μέσα σε τα συμβάντα σχεδόν 739 χιλιάδας στα αποτελέσματα, υπάρχουν 68 μοναδικό και διακριτές τιμές για το πεδίο **υπολογιστή** αυτών των εγγραφών. Το πλακίδιο μόνο δείχνει τα 5 πρώτα, ποιες είναι οι πιο συνηθισμένες 5 τιμές που είναι γραμμένες σε τα πεδία **υπολογιστή** ), ταξινομημένες κατά τον αριθμό των εγγράφων που περιέχουν αυτή τη συγκεκριμένη τιμή σε αυτό το πεδίο. Στην εικόνα, μπορείτε να δείτε ότι – ανάμεσα σε αυτά τα συμβάντα σχεδόν 369 χιλιάδας – 90 χιλιάδας προέρχονται από τον υπολογιστή OpsInsights04.contoso.com, 83 χιλιάδας από τον υπολογιστή DB03.contoso.com, και ούτω καθεξής.


Τι γίνεται εάν θέλετε να δείτε όλες τις τιμές, επειδή το πλακίδιο εμφανίζει μόνο μόνο των πρώτων 5;

Που είναι τι να κάνετε την εντολή μέτρησης με τη συνάρτηση count(). Αυτή η συνάρτηση δεν χρησιμοποιεί οποιεσδήποτε παραμέτρους. Μόνο, μπορείτε να καθορίσετε το πεδίο σύμφωνα με τις οποίες θέλετε να ομαδοποιήσετε κατά – το πεδίο **υπολογιστή** σε αυτήν την περίπτωση:

`Type=Event | Measure count() by Computer`

![Καταμέτρηση μέτρηση αναζήτησης](./media/log-analytics-log-searches/oms-search-measure-count-computer.png)

Ωστόσο, **ο υπολογιστής** είναι απλώς ένα πεδίο που χρησιμοποιείται *σε* κάθε τμήμα δεδομένων – δεν υπάρχουν σχεσιακές βάσεις δεδομένων που περιλαμβάνονται και δεν υπάρχει ξεχωριστό **υπολογιστή** αντικείμενο οπουδήποτε. Μόνο το τιμές *στο* τα δεδομένα να Περιγράψτε την οντότητα που δημιουργούνται από τους, καθώς και κάποια άλλα χαρακτηριστικά και πτυχές των δεδομένων – ως εκ τούτου το όρων *όψη*. Ωστόσο, μπορείτε απλώς καθώς και να ομαδοποιήσετε από άλλα πεδία. Επειδή τα αρχικά αποτελέσματα σχεδόν 739 χιλιάδας συμβάντα που είναι διοχετεύεται σε την εντολή μέτρηση έχει επίσης ένα πεδίο που ονομάζεται **EventID**, μπορείτε να εφαρμόσετε την ίδια τεχνική για να ομαδοποιήσετε με αυτό το πεδίο και έχετε μια καταμέτρηση του συμβάντα από EventID:

```
Type=Event | Measure count() by EventID
```

Εάν δεν σας ενδιαφέρει το πλήθος πραγματική εγγραφών που περιέχουν μια συγκεκριμένη τιμή, αλλά αντί για αυτό εάν θέλετε μόνο μια λίστα με τις τιμές τους, μπορείτε να προσθέσετε μια εντολή *Select* στο τέλος της και απλώς επιλέξτε την πρώτη στήλη:

```
Type=Event | Measure count() by EventID | Select EventID
```

Στη συνέχεια, μπορείτε να λάβετε πιο περίπλοκα και πριν από την ταξινόμηση των αποτελεσμάτων του ερωτήματος, ή μπορείτε να επιλέξετε τις στήλες στο πλέγμα, απλώς πολύ.

```
Type=Event | Measure count() by EventID | Select EventID | Sort EventID asc
```

#### <a name="to-search-using-measure-count"></a>Για να πραγματοποιήσετε αναζήτηση με τη μέτρηση μέτρησης

- Στο πεδίο ερωτήματος αναζήτησης, πληκτρολογήστε`Type=Event | Measure count() by EventID`
- Προσάρτηση `| Select EventID` μέχρι το τέλος του ερωτήματος.
- Τέλος, Προσάρτηση `| Sort EventID asc` μέχρι το τέλος του ερωτήματος.


Υπάρχουν μερικά σημαντικά σημεία για να παρατηρήσετε και να δώσετε έμφαση σε:

Αρχικά, τα αποτελέσματα που εμφανίζονται δεν είναι το αρχικό ανεπεξέργαστα αποτελέσματα πλέον. Αντί για αυτό, είναι συγκεντρωτική αποτελέσματα – ουσιαστικά ομάδες των αποτελεσμάτων. Αυτό δεν είναι ένα πρόβλημα, αλλά θα πρέπει να γνωρίζετε ότι αλληλεπίδραση με πολύ διαφορετικό σχήμα δεδομένων που διαφέρει από το αρχικό σχήμα ανεπεξέργαστα που λαμβάνει δημιουργήσει δυναμική ως αποτέλεσμα της συνάρτησης συνάθροισης/στατιστικές.

Δεύτερον, **μέτρηση count** επιστρέφει τη συγκεκριμένη στιγμή μόνο των πρώτων 100 διακριτές αποτελεσμάτων. Αυτό το όριο δεν ισχύει για τις στατιστικές συναρτήσεις. Επομένως, συνήθως θα πρέπει να χρησιμοποιήσετε ένα πιο ακριβή φίλτρο πρώτα για να αναζητήσετε συγκεκριμένα στοιχεία πριν από την εφαρμογή count() μέτρησης.

## <a name="use-the-max-and-min-functions-with-the-measure-command"></a>Χρησιμοποιήστε τις συναρτήσεις max και min με την εντολή μέτρησης

Υπάρχουν διάφορα σενάρια όπου **Max() μέτρησης** και **Min() μέτρηση** είναι χρήσιμη. Ωστόσο, επειδή κάθε συνάρτηση είναι απέναντι από την άλλη, θα σας θα απεικονίζουν Max() και μπορείτε να πειραματιστείτε με Min() μόνοι σας.

Εάν εκτελέσετε το ερώτημα για συμβάντα ασφαλείας, έχουν μια ιδιότητα **επιπέδου** που μπορεί να διαφέρει. Για παράδειγμα:

```
Type=SecurityEvent
```

![Έναρξη count μέτρηση αναζήτησης](./media/log-analytics-log-searches/oms-search-measure-max01.png)

Εάν θέλετε να προβάλετε την υψηλότερη τιμή για όλα τα ασφαλείας συμβάντα δεδομένο κοινές υπολογιστή, την ομάδα, το πεδίο, μπορείτε να χρησιμοποιήσετε

```
Type=ConfigurationAlert | Measure Max(Level) by Computer
```

![Μέγιστος αριθμός υπολογιστή μέτρηση αναζήτησης](./media/log-analytics-log-searches/oms-search-measure-max02.png)

Αυτό θα εμφάνισης ότι για τους υπολογιστές που είχαν **επιπέδου** εγγραφών, οι περισσότερες από αυτές έχουν τουλάχιστον το επίπεδο 8, πολλές είχατε ένα επίπεδο 16.

```
Type=ConfigurationAlert | Measure Max(Severity) by Computer
```

![μέγιστο χρόνο μέτρηση αναζήτησης που δημιουργούνται από τον υπολογιστή](./media/log-analytics-log-searches/oms-search-measure-max03.png)

Αυτή η συνάρτηση λειτουργεί καλά με αριθμούς, αλλά λειτουργεί επίσης με πεδία ημερομηνίας/ώρας. Είναι χρήσιμο για να ελέγξετε την τελευταία ή την πιο πρόσφατη χρονικής σήμανσης για οποιοδήποτε τμήμα των δεδομένων σε ευρετήριο για κάθε υπολογιστή. Για παράδειγμα: όταν αναφέρθηκε το πιο πρόσφατο συμβάντος ασφαλείας για κάθε υπολογιστή;

```
Type=ConfigurationChange | Measure Max(TimeGenerated) by Computer
```

## <a name="use-the-avg-function-with-the-measure-command"></a>Χρησιμοποιήστε τη συνάρτηση avg με την εντολή μέτρησης

Η συνάρτηση στατιστικής Avg() χρησιμοποιείται με τη μονάδα μέτρησης σάς επιτρέπει να υπολογίσετε τον μέσο όρο ορισμένες πεδίο και ομαδοποίηση των αποτελεσμάτων κατά το ίδιο ή σε άλλο πεδίο. Αυτό είναι χρήσιμη σε διάφορες περιπτώσεις, όπως δεδομένων για τις επιδόσεις.

Ας ξεκινήσουμε με δεδομένα επιδόσεων. Σημειώστε ότι OMS συλλέγει αυτήν τη στιγμή μετρητές επιδόσεων για τα Windows και Linux μηχανές.

Για να αναζητήσετε *όλα* τα δεδομένα επιδόσεων, το ερώτημα πιο βασικές είναι:

```
Type=Perf
```

![Έναρξη αναζήτησης avg](./media/log-analytics-log-searches/oms-search-avg01.png)

Είναι το πρώτο πράγμα που θα παρατηρήσετε ότι καταγραφής ανάλυση δείχνει τρεις προοπτικές: λίστα, που δείχνει που εμφανίζει τις πραγματικές εγγραφές πίσω από τα γραφήματα. Πίνακα, η οποία εμφανίζει μια προβολή σε μορφή πίνακα των δεδομένων μετρητή επιδόσεων. και μετρήσεις, η οποία εμφανίζει γραφήματα για τους μετρητές επιδόσεων.

Στην παραπάνω εικόνα, υπάρχουν δύο σύνολα πεδία που είναι σημειωμένα που υποδεικνύουν τα εξής:

- Το πρώτο σύνολο προσδιορίζει όνομα μετρητή επιδόσεων των Windows, το όνομα του αντικειμένου και όνομα της παρουσίας στο φίλτρο ερωτήματος. Αυτά είναι τα πεδία που πιθανότατα θα πιο συχνά χρησιμοποιήσετε ως όψεις/φίλτρα
- **CounterValue** είναι η πραγματική τιμή του μετρητή. Σε αυτό το παράδειγμα, η τιμή είναι *75*.
- **TimeGenerated** είναι 12:51, με τη μορφή ώρας 24 ωρών.

Παρακάτω θα δείτε μια προβολή των μετρικών σε ένα γράφημα.

![Έναρξη αναζήτησης avg](./media/log-analytics-log-searches/oms-search-avg02.png)

Μετά την ανάγνωση σχετικά με το σχήμα εγγραφής επιδόσεων και αντιμετωπίζετε Διαβάστε σχετικά με τις άλλες τεχνικές αναζήτησης, μπορείτε να χρησιμοποιήσετε μέτρηση Avg() για να συγκεντρώσετε αυτόν τον τύπο αριθμητικά δεδομένα.

Ακολουθεί ένα απλό παράδειγμα:

```
Type=Perf  ObjectName:Processor  InstanceName:_Total  CounterName:"% Processor Time" | Measure Avg(CounterValue) by Computer
```

![Αναζήτηση avg samplevalue](./media/log-analytics-log-searches/oms-search-avg03.png)

Σε αυτό το παράδειγμα, μπορείτε να επιλέξετε τις επιδόσεις συνολικός χρόνος CPU μετρητή και μέσος όρος από τον υπολογιστή. Εάν θέλετε να περιορίσετε τα αποτελέσματα σε μόνο τις τελευταίες 6 ώρες, μπορείτε είτε να χρησιμοποιήσετε το στοιχείο ελέγχου του φίλτρου χρόνου είτε να καθορίσετε στο ερώτημά σας ως εξής:

```
Type=Perf  ObjectName:Processor  InstanceName:_Total  CounterName:"% Processor Time" TimeGenerated>NOW-6HOURS | Measure Avg(CounterValue) by Computer
```

### <a name="to-search-using-the-avg-function-with-the-measure-command"></a>Για να πραγματοποιήσετε αναζήτηση χρησιμοποιώντας τη συνάρτηση avg με την εντολή μέτρησης
- Στο πλαίσιο ερωτήματος αναζήτησης, πληκτρολογήστε `Type=Perf  ObjectName:Processor  InstanceName:_Total  CounterName:"% Processor Time" TimeGenerated>NOW-6HOURS | Measure Avg(CounterValue) by Computer`.


Μπορείτε να συγκεντρώσετε και να συσχετισμός δεδομένων *σε* υπολογιστές. Για παράδειγμα, ας υποθέσουμε ότι έχετε ένα σύνολο κεντρικών υπολογιστών σε ορισμένες ταξινόμηση της συστοιχίας όπου κάθε κόμβο είναι ίσο με οποιοδήποτε άλλο ένα και μόνο όλες τις ίδιες πληκτρολογούν της εργασίας και θα πρέπει να είναι περίπου εξισορρόπηση φόρτωση. Μπορείτε να επιτύχετε τους μετρητές όλα σε έναν μεταβείτε με το ακόλουθο ερώτημα και να λάβετε μέσων όρων για ολόκληρο το σύμπλεγμα. Μπορείτε να ξεκινήσετε, επιλέγοντας τους υπολογιστές με το ακόλουθο παράδειγμα:

```
Type=Perf AND (Computer="AzureMktg01" OR Computer="AzureMktg02" OR Computer="AzureMktg03")
```

Τώρα που έχετε τους υπολογιστές, θέλετε επίσης μόνο για να επιλέξετε δύο βασικοί δείκτες απόδοσης (KPI): χρήση της CPU και % ελεύθερος χώρος στο δίσκο. Επομένως, γίνεται αυτό το τμήμα του ερωτήματος:

```
Type=Perf InstanceName:_Total  ((ObjectName:Processor AND CounterName:"% Processor Time") OR (ObjectName="LogicalDisk" AND CounterName="% Free Space")) AND TimeGenerated>NOW-4HOURS
```

Τώρα μπορείτε να προσθέσετε υπολογιστές και μετρητών με το ακόλουθο παράδειγμα:

```
Type=Perf InstanceName:_Total  ((ObjectName:Processor AND CounterName:"% Processor Time") OR (ObjectName="LogicalDisk" AND CounterName="% Free Space")) AND TimeGenerated>NOW-4HOURS AND (Computer="AzureMktg01" OR Computer="AzureMktg02" OR Computer="AzureMktg03")
```

Επειδή έχετε πολύ συγκεκριμένη επιλογή, η εντολή **μέτρηση Avg()** να επιστρέψετε το μέσο όρο δεν από τον υπολογιστή, αλλά στη συστοιχία, απλώς ομαδοποίηση κατά το Όνομα_μετρητή. Για παράδειγμα:

```
Type=Perf  InstanceName:_Total  ((ObjectName:Processor AND CounterName:"% Processor Time") OR (ObjectName="LogicalDisk" AND CounterName="% Free Space")) AND TimeGenerated>NOW-4HOURS AND (Computer="AzureMktg01" OR Computer="AzureMktg02" OR Computer="AzureMktg03") | Measure Avg(CounterValue) by CounterName
```

Αυτό σας δίνει μια χρήσιμη συμπαγής προβολή δύο KPI το περιβάλλον.

![Ομαδοποίηση avg αναζήτησης](./media/log-analytics-log-searches/oms-search-avg04.png)


Μπορείτε εύκολα να χρησιμοποιήσετε το ερώτημα αναζήτησης σε έναν πίνακα εργαλείων. Για παράδειγμα, που θα μπορούσε να αποθηκεύσετε το ερώτημα αναζήτησης και δημιουργίας ενός πίνακα εργαλείων από αυτό που ονομάζεται *Web συστοιχία KPI*. Για να μάθετε περισσότερα σχετικά με τη χρήση πινάκων εργαλείων, ανατρέξτε στο θέμα [Δημιουργία προσαρμοσμένου πίνακα εργαλείων στην ανάλυση καταγραφής](log-analytics-dashboards.md).

![Πίνακας εργαλείων avg αναζήτησης](./media/log-analytics-log-searches/oms-search-avg05.png)

### <a name="use-the-sum-function-with-the-measure-command"></a>Χρησιμοποιήστε τη συνάρτηση sum με την εντολή μέτρησης

Η συνάρτηση sum είναι παρόμοια με άλλες συναρτήσεις της εντολής μέτρηση. Μπορείτε να δείτε ένα παράδειγμα σχετικά με τον τρόπο χρήσης της συνάρτησης sum στην [Αναζήτηση αρχεία καταγραφής των υπηρεσιών IIS W3C στο Microsoft Azure λειτουργικές ιδέες](http://blogs.msdn.com/b/dmuscett/archive/2014/09/20/w3c-iis-logs-search-in-system-center-advisor-limited-preview.aspx).

Μπορείτε να χρησιμοποιήσετε Max() και Min() με αριθμούς, ημερομηνίες και οι ώρες και συμβολοσειρές κειμένου. Με συμβολοσειρές κειμένου, ταξινομούνται με αλφαβητική σειρά και λαμβάνετε πρώτα ή τελευταία.

Ωστόσο, δεν μπορείτε να χρησιμοποιήσετε Sum() με όλα τα στοιχεία εκτός από τα αριθμητικά πεδία. Αυτό ισχύει επίσης για Avg().

### <a name="use-the-percentile-function-with-the-measure-command"></a>Χρησιμοποιήστε τη συνάρτηση percentile με την εντολή μέτρησης

Η συνάρτηση percentile είναι παρόμοια με Avg() και Sum() σε που μπορείτε να το χρησιμοποιήσετε μόνο για αριθμητικά πεδία. Μπορείτε να χρησιμοποιήσετε οποιαδήποτε εκατοστημόριο μεταξύ 1 έως 99 σε ένα αριθμητικό πεδίο. Μπορείτε επίσης να χρησιμοποιήσετε εντολές **εκατοστημόριο** και **pct** . Ακολουθούν μερικά παραδείγματα:  

```
Type:Perf CounterName:"DiskTransers/sec" |measure percentile95(CurrentValue) by Computer
```
```
Type:Perf ObjectName=LogicalDisk CounterName="Current Disk Queue Length" Computer="MyComputerName" | measure pct65(CurrentValue) by InstanceName
```

## <a name="use-the-where-command"></a>Χρησιμοποιήστε το σημείο όπου εντολή

Το όπου εντολή λειτουργεί όπως ένα φίλτρο, αλλά μπορεί να εφαρμοστεί στη διοχέτευση για περαιτέρω φιλτράρισμα συγκεντρωτική αποτελέσματα που έχουν παραχθεί από μια εντολή μέτρηση – σε αντίθεση με τα ανεπεξέργαστα αποτελεσμάτων που έχουν φιλτραριστεί στην αρχή ενός ερωτήματος.

Για παράδειγμα:

```
Type=Perf  CounterName="% Processor Time"  InstanceName="_Total" | Measure Avg(CounterValue) as AVGCPU by Computer
```

Μπορείτε να προσθέσετε ένα άλλο διοχέτευση "|" χαρακτήρα και το σημείο όπου εντολή για να λάβετε μόνο υπολογιστές των οποίων average CPU είναι μεγαλύτερη από 80%, με το ακόλουθο παράδειγμα:

```
Type=Perf  CounterName="% Processor Time"  InstanceName="_Total" | Measure Avg(CounterValue) as AVGCPU by Computer | Where AVGCPU>80
```

Εάν είστε εξοικειωμένοι με το κέντρο του συστήματος Microsoft - Operations Manager, μπορείτε να θεωρήσετε το σημείο όπου εντολή στο πακέτο όρους τη διαχείρισης. Εάν το παράδειγμα ενός κανόνα, το πρώτο μέρος του ερωτήματος θα είναι το αρχείο προέλευσης δεδομένων και το σημείο όπου εντολή θα είναι ο εντοπισμός συνθήκη.

Μπορείτε να χρησιμοποιήσετε το ερώτημα ως πλακίδιο στον **Πίνακα εργαλείων μου**, ως μια οθόνη ταξινόμησης, για να δείτε πότε είναι υπερ-εκμεταλλευθεί CPU του υπολογιστή σας. Για να μάθετε περισσότερα σχετικά με τους πίνακες εργαλείων, ανατρέξτε στο θέμα [Δημιουργία προσαρμοσμένου πίνακα εργαλείων στην ανάλυση καταγραφής](log-analytics-dashboards.md). Μπορείτε επίσης να δημιουργήσετε και να χρησιμοποιήσετε τους πίνακες εργαλείων χρησιμοποιώντας την εφαρμογή για κινητές συσκευές. Για περισσότερες πληροφορίες, ανατρέξτε στο θέμα [Εφαρμογή Mobile OMS ](http://www.windowsphone.com/en-us/store/app/operational-insights/4823b935-83ce-466c-82bb-bd0a3f58d865). Στο τα πλακίδια κάτω δύο των παρακάτω εικόνα, μπορείτε να δείτε την οθόνη εμφανίζεται μια λίστα και με τη μορφή αριθμού. Ουσιαστικά, θέλετε πάντα ο αριθμός είναι μηδέν και τη λίστα για να είναι κενή. Διαφορετικά, υποδεικνύει μια συνθήκη ειδοποίησης. Εάν είναι απαραίτητο, μπορείτε να το χρησιμοποιήσετε για να δείτε σε ποια μηχανές είναι υπό πίεση.

![κινητές συσκευές πίνακα εργαλείων](./media/log-analytics-log-searches/oms-search-mobile.png)

## <a name="use-the-in-operator"></a>Χρησιμοποιήστε τον τελεστή in

Τον τελεστή *IN* , μαζί με *NOT IN* σάς επιτρέπει να χρησιμοποιήσετε subsearches, η οποία είναι αναζητήσεις που περιλαμβάνουν μια άλλη αναζήτηση ως όρισμα. Περιέχονται σε {} άγκιστρα μέσα σε άλλη *κύρια* ή *εξωτερική* αναζήτηση. Το αποτέλεσμα ενός subsearch, συχνά μια λίστα των αποτελεσμάτων distinct, στη συνέχεια, χρησιμοποιείται ως όρισμα σε την κύρια αναζήτηση.

Μπορείτε να χρησιμοποιήσετε subsearches ώστε να ταιριάζει με υποσύνολα των δεδομένων σας που δεν είναι δυνατό να περιγράψετε απευθείας στο έκφραση αναζήτησης, αλλά τα οποία μπορεί να δημιουργηθεί από μια αναζήτηση. Για παράδειγμα, εάν σας ενδιαφέρει χρησιμοποιώντας μία αναζήτησης για να βρείτε όλα τα συμβάντα από *υπολογιστές που λείπουν ενημερώσεις ασφαλείας*, στη συνέχεια, πρέπει να σχεδιάσετε μια subsearch που προσδιορίζει πρώτα αυτήν *υπολογιστές που λείπουν ενημερώσεις ασφαλείας* πριν να φτάσει συμβάντα που ανήκουν σε αυτές τις υπηρεσίες παροχής φιλοξενίας.

Επομένως, θα μπορούσε να εκφράζετε *υπολογιστές αυτήν τη στιγμή που λείπουν ενημερώσεις ασφαλείας απαιτείται* με το ακόλουθο ερώτημα:

```
Type:Update UpdateState=Needed Optional=false Classification="Security Updates" TimeGenerated>NOW-24HOURS | measure count() by Computer
```    

![Στο παράδειγμα αναζήτησης](./media/log-analytics-log-searches/oms-search-in01-revised.png)

Όταν έχετε ολοκληρώσει τη λίστα, μπορείτε να χρησιμοποιήσετε την αναζήτηση με μια εσωτερική αναζήτησης για τροφοδοσίας τη λίστα των υπολογιστών σε ένα εξωτερικό (κύρια) αναζήτησης που θα αναζητήσει συμβάντων για αυτούς τους υπολογιστές. Μπορείτε να το κάνετε αυτό με περικλείει εσωτερική αναζήτηση σε αγκύλες και διατροφής τα αποτελέσματά του ως πιθανές τιμές για ένα πεδίο/φίλτρου στο εξωτερικό αναζήτηση με χρήση του τελεστή IN. Το ερώτημα θα μοιάζει με:

```
Type=Event Computer IN {Type:Update UpdateState=Needed Optional=false Classification="Security Updates" TimeGenerated>NOW-24HOURS | measure count() by Computer}
```
![Στο παράδειγμα αναζήτησης](./media/log-analytics-log-searches/oms-search-in02-revised.png)


Επίσης ειδοποίηση σχετικά με το φίλτρο χρόνου χρησιμοποιούνται στο εσωτερικό αναζήτηση, επειδή η αξιολόγηση ενημέρωσης συστήματος δημιουργεί ένα στιγμιότυπο του όλους τους υπολογιστές κάθε 24 ώρες. Μπορείτε να κάνετε το εσωτερικό ερώτημα πιο απλές και ακριβείς κάνοντας αναζήτηση μόνο για την ημέρα. Εξωτερική αναζήτηση αντί για αυτό χρησιμοποιεί την επιλογή ώρας στο περιβάλλον εργασίας χρήστη, την ανάκτηση συμβάντα από τις τελευταίες 7 ημέρες. Για περισσότερες πληροφορίες σχετικά με τους τελεστές χρόνου, ανατρέξτε στο θέμα [Οι τελεστές Boolean](#boolean-operators) .

Επειδή έχετε πραγματικά χρήση μόνο η τιμή για το εξωτερικό μία για τα αποτελέσματα της αναζήτησης εσωτερική ως φίλτρο, μπορείτε να εφαρμόσετε εντολές στο εξωτερικό αναζήτηση. Για παράδειγμα, εξακολουθείτε να μπορείτε να ομαδοποιήσετε τα παραπάνω συμβάντα με κάποια άλλη μονάδα μέτρησης εντολή:

```
Type=Event Computer IN {Type:Update UpdateState=Needed Optional=false Classification="Security Updates" TimeGenerated>NOW-24HOURS | measure count() by Computer} | measure count() by Source
```

![Στο παράδειγμα αναζήτησης](./media/log-analytics-log-searches/oms-search-in03-revised.png)


Γενικά, θέλετε εσωτερική το ερώτημά σας να εκτελέσει γρήγορα επειδή ανάλυση καταγραφής έχει υπηρεσίας πλευρά χρονικών ορίων για αυτό, καθώς και για να λάβετε ένα μικρό ποσό των αποτελεσμάτων. Εάν το εσωτερικό ερώτημα επιστρέφει περισσότερα αποτελέσματα, περικόπτεται τη λίστα αποτελεσμάτων, που θα μπορούσε να προκαλέσει την εξωτερική αναζήτηση ώστε να επιστρέφει εσφαλμένα αποτελέσματα.

Ένας κανόνας είναι ότι εσωτερική αναζήτηση πρέπει αυτήν τη στιγμή για την παροχή *συγκεντρωτική* αποτελεσμάτων. Με άλλα λόγια, πρέπει να περιέχει μια εντολή *μέτρηση* . αυτήν τη στιγμή που δεν είναι δυνατό να τροφοδοσίας ανεπεξέργαστα αποτελέσματα σε ένα εξωτερικό αναζήτησης.

Επίσης, μπορεί να υπάρχει μόνο μία τελεστής και πρέπει να είναι το τελευταίο φίλτρο στο ερώτημα. Δεν είναι δυνατό να πολλούς τελεστές σε ή θα – αυτό ουσιαστικά αποτρέπει την εκτέλεση πολλών subsearches: το σημείο σημαντικό είναι ότι μόνο ένα sub/εσωτερική η αναζήτηση είναι δυνατή για κάθε εξωτερική αναζήτηση.

Ακόμα και με αυτά τα όρια, σε επιτρέπει πολλά είδη συσχετισμένης αναζητήσεις και σας επιτρέπει να ορίσετε κάτι παρόμοιο με ομάδες όπως υπολογιστές, οι χρήστες ή τα αρχεία – όποιο τα πεδία στα δεδομένα σας περιέχουν. Εδώ θα βρείτε περισσότερα παραδείγματα:

**Όλες τις ενημερώσεις που λείπουν από τους υπολογιστές όπου η ρύθμιση αυτόματης ενημέρωσης είναι απενεργοποιημένη**

```
Type=Update UpdateState=Needed Optional=false Computer IN {Type=UpdateSummary WindowsUpdateSetting=Manual | measure count() by Computer} | measure count() by KBID
```

**Όλα τα συμβάντα σφάλματος από τους υπολογιστές που εκτελεί τον SQL Server (= όπου έχει εκτελεστεί εκτίμηση SQL)**

```
Type=Event EventLevelName=error Computer IN {Type=SQLAssessmentRecommendation | measure count() by Computer}
```

**Όλα τα συμβάντα ασφαλείας από τους υπολογιστές που είναι ελεγκτές τομέα (= όπου έχει εκτελεστεί εκτίμηση AD)**

```
Type=SecurityEvent Computer IN { Type=ADAssessmentRecommendation | measure count() by Computer }
```

**Που τους άλλους λογαριασμούς έχετε συνδεθεί με το ίδιο υπολογιστές όπου έχει συνδεδεμένος λογαριασμός BACONLAND\jochan;**

```
Type=SecurityEvent EventID=4624   Account!="BACONLAND\\jochan" Computer IN { Type=SecurityEvent EventID=4624   Account="BACONLAND\\jochan" | measure count() by Computer } | measure count() by Account
```

## <a name="use-the-distinct-command"></a>Χρησιμοποιήστε την εντολή distinct

Όπως υποδηλώνει το όνομα, αυτή η εντολή παρέχει μια λίστα με διακριτές τιμές για ένα πεδίο. Είναι σαφές ότι απλό αλλά αρκετά χρήσιμο. Το ίδιο μπορεί να επιτύχετε με την εντολή count() μέτρηση καθώς και, όπως φαίνεται παρακάτω.

```
Type=Event | Measure count() by Computer
```

![Παράδειγμα εντολής ΔΙΑΚΡΙΤΏΝ αναζήτησης](./media/log-analytics-log-searches/oms-search-distinct01-revised.png)

Ωστόσο, εάν όλα που σας ενδιαφέρει είναι απλώς μια λίστα με διακριτές τιμές και όχι το πλήθος των εγγράφων που έχουν ότι μπορούν να παρέχουν τιμές, στη συνέχεια, DISTINCT πιο καθαρή και πιο ευανάγνωστο εξόδου και συντομότερη σύνταξη, όπως φαίνεται παρακάτω.

```
Type=Event | Distinct Computer
```
![Παράδειγμα εντολής ΔΙΑΚΡΙΤΈΣ αναζήτησης](./media/log-analytics-log-searches/oms-search-distinct02-revised.png)

## <a name="use-the-countdistinct-function-with-the-measure-command"></a>Χρησιμοποιήστε τη συνάρτηση countdistinct με την εντολή μέτρησης
Η συνάρτηση countdistinct μετρά τον αριθμό των διακριτές τιμές μέσα σε κάθε ομάδα. Για παράδειγμα, θα μπορούσε να χρησιμοποιηθεί για να μετρήσετε τον αριθμό των μοναδικών υπολογιστών αναφοράς για κάθε τύπο:

```
* | measure countdistinct(Computer) by Type
```

![OMS countdistinct](./media/log-analytics-log-searches/oms-countdistinct.png)

## <a name="use-the-measure-interval-command"></a>Χρησιμοποιήστε την εντολή διάστημα μέτρησης
Με κοντά στη συλλογή δεδομένων επιδόσεων σε πραγματικό χρόνο, μπορείτε να συλλέξετε και απεικόνιση οποιαδήποτε μετρητή επιδόσεων στο αρχείο καταγραφής αναλυτικών στοιχείων. Απλώς πληκτρολογώντας το ερώτημα **Τύπου: επιδόσεων** θα επιστρέψει χιλιάδων μετρικό γραφημάτων με βάση τον αριθμό των μετρητών και διακομιστές στο περιβάλλον του αρχείου καταγραφής ανάλυσης. Με συνάθροιση μετρικό στη ζήτηση, μπορείτε να δείτε τη συνολική μετρικά στο περιβάλλον σας με μια υψηλού επιπέδου και βαθύ κατάρρευση σε πιο λεπτομερές δεδομένα που χρειάζεστε για να.

Ας υποθέσουμε ότι θέλετε να μάθετε τι είναι η μέση CPU σε όλους τους υπολογιστές σας. Εξετάζοντας τον μέσο όρο CPU για κάθε υπολογιστής ενδέχεται να μην είναι χρήσιμο επειδή αποτελέσματα ενδέχεται να λάβετε εξομάλυνση. Για να κάνετε αναζήτηση σε περισσότερες λεπτομέρειες, μπορείτε να συναθροίσετε το αποτέλεσμα στο μικρότερο φορά τμήματα των 32Κ παραθύρου και αναζητήστε την σε μια σειρά ώρας σε διαφορετικές διαστάσεις. Για παράδειγμα, μπορείτε να εκτελέσετε τον μέσο όρο ωριαία χρήση CPU σε όλους τους υπολογιστές σας ως εξής:

```
Type:Perf CounterName="% Processor Time" InstanceName="_Total" | measure avg(CounterValue) by Computer Interval 1HOUR
```

![Μέσος όρος διάστημα μέτρησης](./media/log-analytics-log-searches/oms-measure-avg-interval.png)

Από προεπιλογή αυτά τα αποτελέσματα θα εμφανίζονται σε ένα γράφημα πολλαπλών σειρών αλληλεπιδραστικών γραμμών.  Αυτό το γράφημα υποστηρίζει σειρά εναλλαγή (με άξονα y επαναλαμβάνω την αναλογία), μεγέθυνση και μετακινώντας το ποντίκι.  Η επιλογή Εμφάνιση πίνακα είναι εξακολουθεί να είναι διαθέσιμα για προβολή τα ανεπεξέργαστα δεδομένα, εάν είναι απαραίτητο.

Μπορείτε επίσης να ομαδοποιήσετε από άλλα πεδία. Σε αυτό το παράδειγμα, ψάχνω σε όλους τους μετρητές % για ένα συγκεκριμένο υπολογιστή και να θέλετε να μάθετε τι είναι το εκατοστημόριου ανά ώρα 70 κάθε μετρητή:

```
Type:Perf Computer=beefpatty4 CounterName=%* InstanceName=_Total | measure percentile70(CounterValue) by CounterName Interval 1HOUR
```
Ένα σημείο για να λάβετε υπόψη είναι ότι αυτά τα ερωτήματα δεν περιορίζονται στους μετρητές επιδόσεων. Μπορείτε να εφαρμόσετε τους σε οποιοδήποτε μετρικό σύστημα. Σε αυτό το παράδειγμα, ψάχνω σε αρχεία καταγραφής των υπηρεσιών IIS W3C. Θέλω να γνωρίζουν ποιος είναι ο μέγιστος χρόνος που απαιτείται πάνω από ένα διάστημα 5 λεπτών για την επεξεργασία κάθε αίτησης:

```
Type:W3CIISLog | measure max(TimeTaken) by csMethod Interval 5MINUTES
```

### <a name="use-multiple-aggregates-in-one-query"></a>Χρήση πολλών συγκεντρώσεων σε ένα ερώτημα
Μπορείτε να καθορίσετε πολλούς όρους συγκεντρωτικών αποτελεσμάτων σε μια εντολή μέτρηση.  Κάθε μία μπορεί να είναι με ψευδώνυμο ανεξάρτητα.  Εάν αυτό δεν έχει δοθεί ένα ψευδώνυμο στο όνομα του πεδίου που προκύπτει θα τη συνάρτηση συγκεντρωτικών αποτελεσμάτων που ήταν χρησιμοποιούνται (δηλαδή "avg(CounterValue)" για avg(CounterValue)).

 ```
Type=WireData | measure avg(ReceivedBytes), avg(SentBytes) by Direction interval 1hour
```
![OMS multiaggregates1](./media/log-analytics-log-searches/oms-multiaggregates1.png)

Ακολουθεί ένα ακόμη παράδειγμα:
 ```
* | measure countdistinct(Computer) as Computers, count() as TotalRecords by Type
```


## <a name="next-steps"></a>Επόμενα βήματα

Για πρόσθετες πληροφορίες σχετικά με το αρχείο καταγραφής αναζητήσεις, ανατρέξτε στα θέματα:

- Χρήση [προσαρμοσμένων πεδίων στο αρχείο καταγραφής ανάλυσης](log-analytics-custom-fields.md) για την επέκταση αρχείου καταγραφής αναζητήσεις.
- Αναθεώρηση [καταγραφής ανάλυσης σύνδεση αναφοράς αναζήτησης](log-analytics-search-reference.md) για να δείτε όλα τα πεδία αναζήτησης και όψεις που είναι διαθέσιμες στο αρχείο καταγραφής ανάλυσης.

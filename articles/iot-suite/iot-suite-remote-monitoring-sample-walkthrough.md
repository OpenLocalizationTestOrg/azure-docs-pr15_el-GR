<properties
 pageTitle="Απομακρυσμένη παρακολούθησης προ-διαμορφωμένες αναλυτικές οδηγίες λύση | Microsoft Azure"
 description="Μια περιγραφή για το Azure IoT προ-διαμορφωμένες λύση απομακρυσμένη παρακολούθηση και την αρχιτεκτονική."
 services=""
 suite="iot-suite"
 documentationCenter=""
 authors="dominicbetts"
 manager="timlt"
 editor=""/>

<tags
 ms.service="iot-suite"
 ms.devlang="na"
 ms.topic="get-started-article"
 ms.tgt_pltfrm="na"
 ms.workload="na"
 ms.date="08/17/2016"
 ms.author="dobett"/>

# <a name="remote-monitoring-preconfigured-solution-walkthrough"></a>Απομακρυσμένη παρακολούθηση προ-διαμορφωμένες αναλυτικές οδηγίες λύσης

## <a name="introduction"></a>Εισαγωγή

Ο απομακρυσμένος οικογένεια IoT παρακολούθηση [προ-διαμορφωμένες λύση] [ lnk-preconfigured-solutions] είναι μια εφαρμογή της μιας να ολοκληρωμένες παρακολούθηση λύση για πολλούς υπολογιστές που εκτελούν σε απομακρυσμένο θέσεις. Η λύση συνδυάζει κλειδιού Azure υπηρεσίες για την παροχή μια γενική υλοποίηση του σεναρίου επιχειρήσεις και μπορείτε να το χρησιμοποιήσετε ως σημείο εκκίνησης για τη δική σας εφαρμογή. Μπορείτε να [προσαρμόσετε] [ lnk-customize] της λύσης ώστε να ικανοποιεί τις δικές σας επαγγελματικές συγκεκριμένες απαιτήσεις.

Σε αυτό το άρθρο σάς καθοδηγεί σε ορισμένα από τα βασικά στοιχεία της απομακρυσμένης παρακολούθησης λύσης για να κατανοήσετε τον τρόπο που λειτουργεί. Αυτή η γνώση σάς βοηθά να:

- Αντιμετώπιση προβλημάτων της λύσης.
- Σχεδιασμός πώς μπορείτε να προσαρμόσετε τη λύση ώστε να ικανοποιεί τις δικές σας συγκεκριμένες απαιτήσεις. 
- Σχεδιάστε τη δική σας λύση IoT που χρησιμοποιεί Azure υπηρεσίες.

## <a name="logical-architecture"></a>Λογική αρχιτεκτονική

Το παρακάτω διάγραμμα περιγράφει τη λογική στοιχεία της λύσης προδιαμορφωμένο:

![Λογική αρχιτεκτονική](media/iot-suite-remote-monitoring-sample-walkthrough/remote-monitoring-architecture.png)


## <a name="simulated-devices"></a>Προσομοιωμένη συσκευές

Στην προδιαμορφωμένο λύση, η προσομοιωμένη συσκευή αντιπροσωπεύει μια συσκευή ψύξης (όπως κλιματισμού δόμησης ή μονάδα χειρισμού αέρα εγκατάστασης). Κατά την ανάπτυξη της λύσης προδιαμορφωμένο, αυτόματα προμήθεια τέσσερις προσομοιωμένη συσκευές που λειτουργούν σε ένα [Azure WebJob][lnk-webjobs]. Προσομοιωμένη συσκευές διευκολύνετε τους για να εξερευνήσετε τη συμπεριφορά της λύσης χωρίς να χρειάζεται να αναπτύξετε όλες τις συσκευές φυσικής. Για να αναπτύξετε μια πραγματική φυσική συσκευή, ανατρέξτε στο θέμα [σύνδεση τη συσκευή σας για τον απομακρυσμένο παρακολούθηση προδιαμορφωμένο λύση] [ lnk-connect-rm] το πρόγραμμα εκμάθησης.

Κάθε συσκευή προσομοιωμένη μπορεί να στείλει τους ακόλουθους τύπους μήνυμα με διανομέα IoT:

| Μήνυμα  | Περιγραφή |
|----------|-------------|
| Εκκίνησης  | Κατά την εκκίνηση της συσκευής, στέλνει ένα μήνυμα **συσκευή-πληροφορίες** που περιέχει πληροφορίες σχετικά με την ίδια πίσω στο τέλος. Τα δεδομένα αυτά περιλαμβάνουν το αναγνωριστικό της συσκευής, τα μετα-δεδομένα συσκευής, μια λίστα με τις εντολές η συσκευή υποστηρίζει και την τρέχουσα ρύθμιση παραμέτρων της συσκευής. |
| Παρουσίας | Μια συσκευή περιοδικά στέλνει ένα μήνυμα **παρουσίας** για την αναφορά εάν η συσκευή να αναγνωρίζει την παρουσία ενός αισθητήρα. |
| Τηλεμετρίας | Μια συσκευή περιοδικά στέλνει ένα μήνυμα **τηλεμετρίας** που αναφέρει προσομοιωμένη τιμές για τη θερμοκρασία και υγρασία που συλλέγονται από τη συσκευή προσομοιωμένη αισθητήρες. |


Προσομοιωμένη συσκευές στείλετε τις ακόλουθες ιδιότητες συσκευής σε ένα μήνυμα **συσκευή-πληροφορίες** :

| Ιδιότητα               |  Σκοπός |
|------------------------|--------- |
| Αναγνωριστικό συσκευής              | Αναγνωριστικό που είναι που παρέχεται ή που έχουν εκχωρηθεί όταν δημιουργείται μια συσκευή στη λύση. |
| Κατασκευαστή           | Τον κατασκευαστή της συσκευής |
| Αριθμός μοντέλου           | Αριθμός μοντέλο της συσκευής |
| Σειριακό αριθμό          | Σειριακό αριθμό της συσκευής |
| Υλικολογισμικού               | Τρέχουσα έκδοση του υλικολογισμικού στη συσκευή |
| Πλατφόρμα               | Αρχιτεκτονική πλατφόρμας της συσκευής |
| Επεξεργαστής              | Επεξεργαστής εκτελεί τη συσκευή |
| Εγκατεστημένη RAM          | Μνήμη RAM που είναι εγκατεστημένο στη συσκευή |
| Ο διανομέας με δυνατότητα κατάσταση      | Ιδιότητα state IoT διανομέα της συσκευής |
| Χρόνος δημιουργίας           | Ώρα στη συσκευή δημιουργίας της λύσης |
| Ώρα ενημέρωσης           | Τελευταία φορά που ενημερώθηκαν ιδιότητες για τη συσκευή |
| Γεωγραφικό πλάτος               | Γεωγραφικό πλάτος θέση της συσκευής |
| Γεωγραφικού              | Θέση γεωγραφικού της συσκευής |

Το simulator σπέρματα αυτές τις ιδιότητες σε προσομοιωμένη συσκευές με δείγματα τιμών.  Κάθε φορά που το simulator προετοιμάζει μια πρόχειρη συσκευή, η συσκευή δημοσιεύσεις τα μετα-δεδομένα προκαθορισμένες IoT διανομέα. Παρατηρήστε πώς αυτό που αντικαθιστούν οποιαδήποτε ενημερώσεις μετα-δεδομένων που έχουν γίνει στην πύλη του συσκευή.


Προσομοιωμένη συσκευές μπορεί να χειρίζεται τις παρακάτω εντολές που στέλνεται από τον πίνακα εργαλείων λύση μέσω του διανομέα IoT:

| Εντολή                | Περιγραφή                                         |
|------------------------|-----------------------------------------------------|
| PingDevice             | Αποστέλλει μια _εντολή ping_ στη συσκευή για να ελέγξετε είναι ενεργή   |
| StartTelemetry         | Ξεκινά η συσκευή αποστολή τηλεμετρίας                 |
| StopTelemetry          | Διακόπτει τη συσκευή από την αποστολή τηλεμετρίας             |
| ChangeSetPointTemp     | Αλλάζει την τιμή Ορισμός σημείου γύρω από την οποία δημιουργείται τυχαία δεδομένων |
| DiagnosticTelemetry    | Ενεργοποιεί το simulator συσκευή για να στείλετε μια τιμή επιπλέον τηλεμετρίας (externalTemp) |
| ChangeDeviceState      | Αλλάζει μια ιδιότητα εκτεταμένη κατάσταση για τη συσκευή και στέλνει το μήνυμα πληροφορίες συσκευή από τη συσκευή |

Η συσκευή επιβεβαίωση εντολή μέχρι το τέλος πίσω λύση παρέχεται μέσω του διανομέα IoT.

## <a name="iot-hub"></a>Ο διανομέας IoT

Ο [διανομέας IoT] [ lnk-iothub] ingests δεδομένα που αποστέλλονται από τις συσκευές στο cloud και κάνει διαθέσιμο στις εργασίες ανάλυσης ροή Azure (ASA). Διανομέα IoT αποστέλλει επίσης εντολές για τις συσκευές σας εκ μέρους της πύλης συσκευή. Κάθε εργασία ASA ροή χρησιμοποιεί μια ξεχωριστή ομάδα καταναλωτή διανομέα IoT ανάγνωση της ροής των μηνυμάτων από τις συσκευές σας.

## <a name="azure-stream-analytics"></a>Ανάλυση Azure ροής

Στην απομακρυσμένη λύση παρακολούθησης, [Ανάλυση ροή Azure] [ lnk-asa] (ASA) αποστέλλει συσκευή μηνυμάτων που έχουν ληφθεί από την ενότητα IoT σε άλλα στοιχεία παρασκηνίου για επεξεργασία ή την αποθήκευση. Διαφορετικά έργα ASA εκτελούν συγκεκριμένες λειτουργίες, με βάση το περιεχόμενο των μηνυμάτων.

**Εργασία 1: Κατάσταση συσκευής** φιλτράρει μηνύματα πληροφορίες συσκευή από τη ροή εισερχόμενων μηνυμάτων και τις στέλνει ένα τελικό σημείο διανομέα συμβάν. Μια συσκευή στέλνει μηνύματα πληροφορίες συσκευή κατά την εκκίνηση και απάντηση σε μια εντολή **SendDeviceInfo** . Αυτή η εργασία χρησιμοποιεί τον ακόλουθο ορισμό ερωτήματος για τον προσδιορισμό **συσκευή info** μηνύματα:

```
SELECT * FROM DeviceDataStream Partition By PartitionId WHERE  ObjectType = 'DeviceInfo'
```

Αυτή η εργασία στέλνει τα αποτελέσματά με ένα διανομέα συμβάντων για περαιτέρω επεξεργασία.

**Εργασία 2: κανόνες** εκτελείται εισερχόμενων τιμές τηλεμετρίας θερμοκρασίας και υγρασίας σε σχέση με τα όρια ανά συσκευή. Οριακές τιμές έχουν οριστεί στο πρόγραμμα επεξεργασίας κανόνων που είναι διαθέσιμα στον πίνακα εργαλείων λύση. Κάθε ζεύγος συσκευή/τιμή αποθηκεύεται από χρονικής σήμανσης σε ένα αντικείμενο blob που διαβάζει ροή ανάλυσης στο ως **Δεδομένα αναφοράς**. Η εργασία συγκρίνει κάθε μη κενή τιμή σε σχέση με το όριο του συνόλου για τη συσκευή. Εάν υπερβαίνει το ' >' συνθήκη, η εργασία εξάγει ένα συμβάν **ειδοποίησης** που υποδεικνύει ότι το όριο είναι υπέρβαση και παρέχει τη συσκευή, τιμή και τιμές χρονικής σήμανσης. Αυτή η εργασία χρησιμοποιεί τον ακόλουθο ορισμό ερωτήματος για τον προσδιορισμό τηλεμετρίας τα μηνύματα που θα πρέπει να ενεργοποιήσετε μια ηχητική ειδοποίηση:

```
WITH AlarmsData AS 
(
SELECT
     Stream.IoTHub.ConnectionDeviceId AS DeviceId,
     'Temperature' as ReadingType,
     Stream.Temperature as Reading,
     Ref.Temperature as Threshold,
     Ref.TemperatureRuleOutput as RuleOutput,
     Stream.EventEnqueuedUtcTime AS [Time]
FROM IoTTelemetryStream Stream
JOIN DeviceRulesBlob Ref ON Stream.IoTHub.ConnectionDeviceId = Ref.DeviceID
WHERE
     Ref.Temperature IS NOT null AND Stream.Temperature > Ref.Temperature

UNION ALL

SELECT
     Stream.IoTHub.ConnectionDeviceId AS DeviceId,
     'Humidity' as ReadingType,
     Stream.Humidity as Reading,
     Ref.Humidity as Threshold,
     Ref.HumidityRuleOutput as RuleOutput,
     Stream.EventEnqueuedUtcTime AS [Time]
FROM IoTTelemetryStream Stream
JOIN DeviceRulesBlob Ref ON Stream.IoTHub.ConnectionDeviceId = Ref.DeviceID
WHERE
     Ref.Humidity IS NOT null AND Stream.Humidity > Ref.Humidity
)

SELECT *
INTO DeviceRulesMonitoring
FROM AlarmsData

SELECT *
INTO DeviceRulesHub
FROM AlarmsData
```

Η εργασία αποστέλλει τα αποτελέσματά με ένα διανομέα συμβάντων για περαιτέρω επεξεργασία και αποθηκεύει λεπτομέρειες από κάθε ειδοποίηση με το χώρο αποθήκευσης αντικειμένων blob από όπου ο πίνακας εργαλείων λύση να διαβάσετε τις πληροφορίες ειδοποίησης.

**Εργασία 3: Τηλεμετρίας** λειτουργεί στη ροή τηλεμετρίας εισερχόμενες συσκευής με δύο τρόπους. Το πρώτο στέλνει όλα τα μηνύματα τηλεμετρίας από συσκευές με το χώρο αποθήκευσης αντικειμένων blob μόνιμη για μακροπρόθεσμη αποθήκευση. Η δεύτερη υπολογίζει τιμές μέσος όρος, ελάχιστο και μέγιστο υγρασία πάνω από ένα παράθυρο κυλιόμενο 5 λεπτών και σας αποστέλλει αυτά τα δεδομένα με το χώρο αποθήκευσης αντικειμένων blob. Στον πίνακα εργαλείων λύση διαβάζει τα δεδομένα τηλεμετρίας από χώρο αποθήκευσης αντικειμένων blob για να συμπληρώσετε τα γραφήματα. Αυτή η εργασία χρησιμοποιεί τον ακόλουθο ορισμό ερωτήματος:

```
WITH 
    [StreamData]
AS (
    SELECT
        *
    FROM [IoTHubStream]
    WHERE
        [ObjectType] IS NULL -- Filter out device info and command responses
) 

SELECT
    IoTHub.ConnectionDeviceId AS DeviceId,
    Temperature,
    Humidity,
    ExternalTemperature,
    EventProcessedUtcTime,
    PartitionId,
    EventEnqueuedUtcTime,
    * 
INTO
    [Telemetry]
FROM
    [StreamData]

SELECT
    IoTHub.ConnectionDeviceId AS DeviceId,
    AVG (Humidity) AS [AverageHumidity],
    MIN(Humidity) AS [MinimumHumidity],
    MAX(Humidity) AS [MaxHumidity],
    5.0 AS TimeframeMinutes 
INTO
    [TelemetrySummary]
FROM [StreamData]
WHERE
    [Humidity] IS NOT NULL
GROUP BY
    IoTHub.ConnectionDeviceId,
    SlidingWindow (mi, 5)
```

## <a name="event-hubs"></a>Διανομείς συμβάντος

Τις εργασίες ASA **κανόνες** και **πληροφορίες συσκευή** εξόδου τα δεδομένα σε διανομείς συμβάντων για την προώθηση αξιόπιστα στο ο **Επεξεργαστής συμβάντων** εκτελείται στο το WebJob.

## <a name="azure-storage"></a>Azure χώρου αποθήκευσης

Η λύση χρησιμοποιεί χώρο αποθήκευσης αντικειμένων blob του Azure για να παραμένει όλα τα δεδομένα τηλεμετρίας ανεπεξέργαστα και συνοψίζεται από τις συσκευές στη λύση. Πίνακας εργαλείων διαβάζει τα δεδομένα τηλεμετρίας από χώρο αποθήκευσης αντικειμένων blob για να συμπληρώσετε τα γραφήματα. Για να εμφανίσετε τις ειδοποιήσεις, στον πίνακα εργαλείων διαβάζει τα δεδομένα από το χώρο αποθήκευσης αντικειμένων blob που καταγράφει όταν τηλεμετρίας τιμές υπερβεί τις τιμές υπέρβαση του ορίου. Η λύση χρησιμοποιεί επίσης χώρος αποθήκευσης αντικειμένων blob για να καταγράψετε τα όρια που ορίζετε στον πίνακα εργαλείων.

## <a name="webjobs"></a>WebJobs

Εκτός από φιλοξενίας εξομοιωτών τη συσκευή, το WebJobs στη λύση φιλοξενεί επίσης ο **Επεξεργαστής συμβάντων** εκτελείται σε ένα WebJob Azure που λαβές συσκευή πληροφορίες μηνύματα και τις απαντήσεις εντολή. Χρησιμοποιεί:

- Μηνύματα πληροφορίες συσκευή για να ενημερώσετε το μητρώο συσκευής (αποθηκεύονται στη βάση δεδομένων DocumentDB) με τις τρέχουσες πληροφορίες συσκευή.
- Εντολή μηνύματα απάντησης για να ενημερώσετε το ιστορικό εντολών συσκευή (αποθηκεύονται στη βάση δεδομένων DocumentDB).

## <a name="documentdb"></a>DocumentDB

Η λύση χρησιμοποιεί μια βάση δεδομένων DocumentDB για την αποθήκευση πληροφοριών σχετικά με τις συσκευές που συνδέονται στη λύση. Αυτές οι πληροφορίες περιλαμβάνουν συσκευή μετα-δεδομένων και το ιστορικό των εντολών που στέλνονται σε συσκευές από τον πίνακα εργαλείων.

## <a name="web-apps"></a>Εφαρμογές Web

### <a name="remote-monitoring-dashboard"></a>Πίνακας εργαλείων απομακρυσμένης παρακολούθησης
Αυτή η σελίδα στην εφαρμογή web χρησιμοποιεί στοιχεία ελέγχου javascript PowerBI (ανατρέξτε στο θέμα [repo PowerBI-οπτικά εφέ](https://www.github.com/Microsoft/PowerBI-visuals)) για την απεικόνιση των δεδομένων τηλεμετρίας από τις συσκευές. Η λύση χρησιμοποιεί την εργασία τηλεμετρίας ASA για να γράψετε τα δεδομένα τηλεμετρίας για χώρο αποθήκευσης blob.


### <a name="device-administration-portal"></a>Πύλη διαχείρισης συσκευών

Αυτή η εφαρμογή web σάς επιτρέπει να:

- Παροχή μιας νέας συσκευής. Αυτή η ενέργεια ορίζει το αναγνωριστικό συσκευής μοναδικών τιμών και δημιουργεί το κλειδί ελέγχου ταυτότητας. Το καταγράφει πληροφορίες σχετικά με τη συσκευή τόσο το μητρώο ταυτότητας IoT διανομέας και τη βάση δεδομένων DocumentDB συγκεκριμένη λύση.
- Διαχείριση ιδιότητες των συσκευών. Αυτή η ενέργεια περιλαμβάνει ιδιότητες υπάρχουσα προβολή και ενημέρωση με νέες ιδιότητες.
- Αποστολή εντολών σε μια συσκευή.
- Προβολή του ιστορικού εντολής για μια συσκευή.
- Ενεργοποίηση και απενεργοποίηση συσκευές.

## <a name="next-steps"></a>Επόμενα βήματα

Οι παρακάτω δημοσιεύσεις ιστολογίου στο TechNet παρέχει περισσότερες λεπτομέρειες σχετικά με το απομακρυσμένο λύση παρακολούθησης προδιαμορφωμένο:

- [IoT οικογένεια προγραμμάτων - σύνθετων - απομακρυσμένη παρακολούθηση](http://social.technet.microsoft.com/wiki/contents/articles/32941.iot-suite-under-the-hood-remote-monitoring.aspx)
- [IoT οικογένεια προγραμμάτων - απομακρυσμένη παρακολούθηση - Προσθήκη ζωντανή και προσομοιωμένη συσκευών](http://social.technet.microsoft.com/wiki/contents/articles/32975.iot-suite-remote-monitoring-adding-live-and-simulated-devices.aspx)

Μπορείτε να συνεχίσετε γρήγορα αποτελέσματα με την οικογένεια προγραμμάτων IoT διαβάζοντας τα ακόλουθα άρθρα:

- [Συνδέστε τη συσκευή με το απομακρυσμένο προδιαμορφωμένο λύση παρακολούθησης][lnk-connect-rm]
- [Δικαιώματα στην τοποθεσία της azureiotsuite.com][lnk-permissions]

[lnk-preconfigured-solutions]: iot-suite-what-are-preconfigured-solutions.md
[lnk-customize]: iot-suite-guidance-on-customizing-preconfigured-solutions.md
[lnk-iothub]: https://azure.microsoft.com/documentation/services/iot-hub/
[lnk-asa]: https://azure.microsoft.com/documentation/services/stream-analytics/
[lnk-webjobs]: https://azure.microsoft.com/documentation/articles/websites-webjobs-resources/
[lnk-connect-rm]: iot-suite-connecting-devices.md
[lnk-permissions]: iot-suite-permissions.md
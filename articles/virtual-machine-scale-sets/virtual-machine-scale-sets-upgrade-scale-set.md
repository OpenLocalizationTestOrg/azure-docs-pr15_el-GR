<properties
    pageTitle="Αναπτύξτε μια εφαρμογή στα σύνολα κλίμακα εικονική μηχανή | Microsoft Azure"
    description="Αναπτύξτε μια εφαρμογή στα σύνολα κλίμακα εικονική μηχανή"
    services="virtual-machine-scale-sets"
    documentationCenter=""
    authors="gbowerman"
    manager="timlt"
    editor=""
    tags="azure-resource-manager"/>

<tags
    ms.service="virtual-machine-scale-sets"
    ms.workload="na"
    ms.tgt_pltfrm="na"
    ms.devlang="na"
    ms.topic="article"
    ms.date="09/13/2016"
    ms.author="guybo"/>


# <a name="upgrade-a-virtual-machine-scale-set"></a>Αναβάθμιση ενός συνόλου κλίμακα εικονική μηχανή

Σε αυτό το άρθρο περιγράφει πώς μπορείτε να ανάπτυξη μια ενημερωμένη έκδοση του λειτουργικού Συστήματος σε κλίμακα Azure εικονική μηχανή Ορισμός χωρίς οποιαδήποτε χρόνου εκτός λειτουργίας. Σε αυτό το πλαίσιο, μια ενημερωμένη έκδοση του λειτουργικού Συστήματος περιλαμβάνει την αλλαγή της έκδοσης ή SKU του λειτουργικού Συστήματος ή η αλλαγή του URI μιας προσαρμοσμένης εικόνας. Ενημέρωση χωρίς χρόνου εκτός λειτουργίας σημαίνει ενημερώνετε εικονικές μηχανές μία κάθε φορά ή σε ομάδες (όπως έναν τομέα σφαλμάτων κάθε φορά) και όχι όλες ταυτόχρονα. Με αυτόν τον τρόπο, να διατηρήσετε εκτελεί οποιαδήποτε εικονικές μηχανές οι οποίες δεν γίνεται αναβάθμιση.

Για να αποφύγετε ασαφειών, ας διακρίνετε τρεις τύποι ενημερωμένη έκδοση λειτουργικού Συστήματος που μπορεί να θέλετε να εκτελέσετε:

- Αλλαγή της έκδοσης ή SKU πλατφόρμα εικόνας. Για παράδειγμα, η αλλαγή Ubuntu 14.04.2-LTS έκδοση από 14.04.201506100 να 14.04.201507060, ή να αλλάξετε την Ubuntu 15.10/τελευταία SKU σε 16.04.0-LTS/latest. Αυτό το σενάριο καλύπτεται σε αυτό το άρθρο.

- Αλλάζοντας το URI που σας οδηγεί σε μια νέα έκδοση του μια προσαρμοσμένη εικόνα ενσωματωμένη (**Ιδιότητες** > **virtualMachineProfile** > **storageProfile** > **osDisk** > **εικόνα** > **uri**). Αυτό το σενάριο καλύπτεται σε αυτό το άρθρο.

- Ενημέρωση του λειτουργικού Συστήματος από μέσα σε μια εικονική μηχανή (αυτό παραδείγματα κατά την εγκατάσταση μια ενημερωμένη έκδοση ασφαλείας κώδικα και την εκτέλεση του Windows Update). Αυτό το σενάριο είναι υποστηρίζονται, αλλά δεν καλύπτεται σε αυτό το άρθρο.

Οι πρώτες δύο επιλογές είναι υποστηριζόμενοι απαιτήσεις που καλύπτονται από αυτό το άρθρο. Θα χρειαστεί να δημιουργήσετε μια νέα κλίμακα ρύθμιση να εκτελέσει την τρίτη επιλογή.

Εικονική μηχανή κλίμακα σύνολα που έχουν αναπτυχθεί ως μέρος του ένα σύμπλεγμα [Ύφασμα υπηρεσίας Azure](https://azure.microsoft.com/services/service-fabric/) δεν καλύπτονται εδώ.

Η βασική ακολουθία για να αλλάξετε την έκδοση/SKU OS πλατφόρμα εικόνας ή το URI της μια προσαρμοσμένη εικόνα έχει ως εξής:

1. Λήψη του μοντέλου εικονική μηχανή κλίμακα σύνολο.

2. Αλλάξτε την τιμή για την έκδοση, SKU ή URI στο μοντέλο.

3. Ενημερώστε το μοντέλο.

4. Κάνετε μια κλήση *manualUpgrade* στην τις εικονικές μηχανές του συνόλου κλίμακα. Αυτό το βήμα είναι σχετικό μόνο εάν *upgradePolicy* έχει οριστεί σε **μη αυτόματα** στο σύνολο σας κλίμακα. Εάν έχει οριστεί σε **αυτόματα**, όλες τις εικονικές μηχανές αναβαθμίζονται ταυτόχρονα, προκαλώντας έτσι χρόνου εκτός λειτουργίας.


Με αυτές τις πληροφορίες φόντου υπόψη, ας δούμε πώς θα μπορούσε να ενημερώνετε την έκδοση του κλίμακα Ορισμός στο PowerShell και χρησιμοποιώντας το REST API. Αυτά τα παραδείγματα εξώφυλλο πεζών / κεφαλαίων σε μια εικόνα πλατφόρμα, αλλά αυτό το άρθρο παρέχει επαρκείς πληροφορίες για να προσαρμόσετε αυτήν τη διαδικασία σε μια προσαρμοσμένη εικόνα.

## <a name="powershell"></a>PowerShell##

Αυτό το παράδειγμα ενημερώνει μια κλίμακα εικονική μηχανή Windows ρύθμιση για τη νέα έκδοση 4.0.20160229. Μετά την ενημέρωση του μοντέλου, κάνει μια ενημερωμένη έκδοση μία παρουσία εικονική μηχανή κάθε φορά.

```powershell
$rgname = "myrg"
$vmssname = "myvmss"
$newversion = "4.0.20160229"
$instanceid = "1"

# get the VMSS model
$vmss = Get-AzureRmVmss -ResourceGroupName $rgname -VMScaleSetName $vmssname

# set the new version in the model data
$vmss.virtualMachineProfile.storageProfile.imageReference.version = $newversion

# update the virtual machine scale set model
Update-AzureRmVmss -ResourceGroupName $rgname -Name $vmssname -VirtualMachineScaleSet $vmss

# now start updating instances
Update-AzureRmVmssInstance -ResourceGroupName $rgname -VMScaleSetName $vmssname -InstanceId $instanceId
```

Εάν θέλετε να ενημερώσετε το URI για μια προσαρμοσμένη εικόνα αντί να αλλάξετε μια έκδοση εικόνα πλατφόρμα, αντικαταστήστε στη γραμμή "ορίστε τη νέα έκδοση" με κάπως έτσι:

```powershell
# set the new version in the model data
$vmss.virtualMachineProfile.storageProfile.osDisk.image.uri= $newURI
```


## <a name="the-rest-api"></a>Το REST API

Ακολουθούν μερικά παραδείγματα Python που χρησιμοποιούν το Azure REST API να αναπτύξετε μια ενημέρωση έκδοση λειτουργικού Συστήματος. Και τα δύο να χρησιμοποιήσετε τη βιβλιοθήκη ελαφριά [azurerm](https://pypi.python.org/pypi/azurerm) συναρτήσεων περιτυλίγματος Azure REST API για να κάνετε το ΔΕΊΤΕ στο μοντέλο σύνολο κλίμακα, ακολουθούμενο από μια ΘΈΣΗ με ένα μοντέλο ενημερωμένο. Επίσης κοιτάζει εικονική μηχανή παρουσίες προβολές για να προσδιορίσετε το εικονικές μηχανές από τον τομέα ενημερωμένη έκδοση.

### <a name="vmssupgrade"></a>Vmssupgrade

 [Vmssupgrade](https://github.com/gbowerman/vmsstools) είναι μια δέσμη ενεργειών Python που χρησιμοποιείται για την ανάπτυξη του αναβάθμιση του λειτουργικού Συστήματος σε μια κλίμακα εκτελείται εικονική μηχανή ορίσετε έναν τομέα ενημέρωση κάθε φορά.

![Δέσμη ενεργειών Vmssupgrade για την επιλογή εικονικές μηχανές ή έναν τομέα ενημέρωσης](./media/virtual-machine-scale-sets-upgrade-scale-set/vmssupgrade-screenshot.png)

Αυτή η δέσμη ενεργειών σάς επιτρέπει να επιλέξετε συγκεκριμένα εικονικές μηχανές για να ενημερώσετε ή να καθορίσετε έναν τομέα ενημερωμένη έκδοση. Υποστηρίζει αλλαγής μια έκδοση εικόνα πλατφόρμα ή αλλάζοντας το URI μιας προσαρμοσμένης εικόνας.

### <a name="vmsseditor"></a>Vmsseditor

[Vmsseditor](https://github.com/gbowerman/vmssdashboard) είναι μια γενικής χρήσης πρόγραμμα επεξεργασίας για σύνολα κλίμακα εικονική μηχανή που εμφανίζει την κατάσταση εικονική μηχανή ως μια heatmap όπου μία γραμμή αντιπροσωπεύει έναν τομέα ενημερωμένη έκδοση. Μεταξύ άλλων, μπορείτε να ενημερώσετε το μοντέλο για ένα σύνολο κλίμακα με μια νέα έκδοση, SKU ή προσαρμοσμένο εικόνα URI και, στη συνέχεια, επιλέξτε τομείς σφαλμάτων για να αναβαθμίσετε. Όταν κάνετε κάτι τέτοιο, όλες τις εικονικές μηχανές σε αυτόν τον τομέα ενημέρωσης αναβαθμίζονται στο νέο μοντέλο. Εναλλακτικά, μπορείτε να κάνετε αναβάθμιση με βάση το μέγεθος δέσμης της επιλογής σας.  

Το παρακάτω στιγμιότυπο οθόνης εμφανίζει ένα μοντέλο κλίμακας για Ubuntu 14.04-2LTS έκδοση 14.04.201507060. Πολλές περισσότερες επιλογές έχουν προστεθεί σε αυτό το εργαλείο επειδή αυτό το στιγμιότυπο οθόνης που λήφθηκε.

![Μοντέλο Vmsseditor κλίμακας για Ubuntu 14.04-2LTS](./media/virtual-machine-scale-sets-upgrade-scale-set/vmssEditor1.png)

Αφού κάνετε κλικ στο κουμπί **αναβάθμιση** και, στη συνέχεια, **Να λεπτομέρειες**, ξεκινήστε εικονικές μηχανές στο UD 0 για να ενημερώσετε.

![Ενημέρωση που εμφανίζει Vmsseditor σε εξέλιξη](./media/virtual-machine-scale-sets-upgrade-scale-set/vmssEditor2.png)
